/*! For license information please see main.190d98f8.chunk.js.LICENSE.txt */
(this.webpackJsonprachel=this.webpackJsonprachel||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(24),i=n.n(o);n(35);var s=n(3),l=n(1),u=n(2),c=n(4),p=n(5),h=n(14),f=(n(36),function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:this.props.className,onClick:this.props.onClick,style:this.props.style},this.props.text,a.a.createElement("span",{className:"tooltip "+(void 0!==this.props.tooltipClassName?this.props.tooltipClassName:""),style:this.props.tooltipStyle,onClick:function(e){e.stopPropagation(),e.preventDefault()}},this.props.tooltip))}}]),n}(a.a.Component)),d=n(10),m=n(19),v=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this,e)).range=r,a}return n}(Object(m.a)(Error));function g(e,t){return e instanceof v&&void 0===e.range&&(e.range=t),e}var y="EN",b="false",E=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"init",value:function(){if(e.storageSupported){var t=localStorage.getItem("csvValueSeparator");";"!==t&&","!==t?(console.log("csvValueSeparator not found in localStorage and set to default"),localStorage.setItem("csvValueSeparator",";"),e.csvValueSeparator=";"):e.csvValueSeparator=localStorage.getItem("csvValueSeparator"),n=localStorage.getItem("language"),k.includes(n)?e.language=localStorage.getItem("language"):(console.log("language not found in localStorage and set to default"),localStorage.setItem("language",y),e.language=y),"true"!==localStorage.getItem("darkTheme")&&"false"!==localStorage.getItem("darkTheme")?(console.log("darkTheme not found in localStorage and set to default"),localStorage.setItem("darkTheme",b),e.darkTheme=b):e.darkTheme=localStorage.getItem("darkTheme")}else console.warn("LocalStorage not supported in the browser. Default values used."),e.csvValueSeparator=";",e.language=y,e.darkTheme=b;var n;e.isInit=!0}},{key:"getCsvValueSeparator",value:function(){return e.isInit||e.init(),e.csvValueSeparator}},{key:"setCsvValueSeparator",value:function(t){e.csvValueSeparator=t,e.storageSupported&&localStorage.setItem("csvValueSeparator",t)}},{key:"getLanguage",value:function(){return e.isInit||e.init(),e.language}},{key:"setLanguage",value:function(t){e.language=t,e.storageSupported&&localStorage.setItem("language",t)}},{key:"getDarkTheme",value:function(){return e.isInit||e.init(),"true"===e.darkTheme}},{key:"setDarkTheme",value:function(t){e.darkTheme=String(t),e.storageSupported&&localStorage.setItem("darkTheme",String(t))}}]),e}();E.isInit=!1,E.storageSupported="undefined"!==typeof Storage,E.csvValueSeparator=void 0,E.language=void 0,E.darkTheme=void 0;var x={abbr:"EN",relationErrors:{emptyColumn:"Column name cannot be empty",duplicitColumn:"Duplicit column name",keywordColumn:"Column name cannot be a keyword",invalidColumn:"Invalid characters in a column name",unsupportedNull:"Null values are not supported",invalidNumber:"Given string is not a number",invalidBoolean:"Given string is not a boolean"},codeErrors:{resultSection_nodeIndexNotFound:["ResultSection.getCurrentRelation: Selected node index in the evaluation tree was not found."],resultSection_evalError:["ResultSection.getCurrentRelation: Evaluation error in result section: ","."],resultSection_nullRelationToSave:["ResultSection.saveResultRelation: Resulting relation is null when trying to save it."],resultSection_nullRelationToAdd:["ResultSection.handleAddRelation: Resulting relation is null when trying to add it."],row_absentColumn:["Row.getOrderedValues: Column "," is missing in a row with columns: ","."],valueParser_unexpectedToken:["ValueParser.rpnToVETreeRecursive: Unexpected token: ","."],exprParser_unexpectedToken:["ExprParser.isValidSequence: Unexpected token: ","."],exprParser_thetaJoinBranchError:["ExprParser.parseTokensForWhisper: Error in theta join branch: ","."],exprParser_projectionBranchError:["ExprParser.parseTokensForWhisper: Error in projection branch: ","."]},semanticErrors:{exprParser_relationNotDefined:['Relation "','" is not defined. Check definitions of relations.'],binaryNode_commonColumns:["Source relations for ",' have common columns "','".'],setOperationNode_notEqualColumns:['Source relations "','" and "','" for set '," do not have the same column sets."],divisionNode_rightColumnsNotSubset:['Right-hand relation schema "','" is not a subset of the left-hand relation schema "','".'],divisionNode_rightColumnsNotProperSubset:['Right-hand relation schema "','" is not a proper subset of the left-hand relation schema "','". There must exist at least one column in the left relation which is not present in the right relation.'],renameNode_absentOriginalColumn:['Invalid renaming attempt, column "','" does not exist in the source relation.'],renameNode_changeToDuplicit:['Invalid renaming attempt, new column name "','" is ambiguous in the changed relation.'],projectionNode_absentColumn:['Invalid projection of the column "','". It does not exist in the source relation.'],projectionNode_emptyProjection:["Invalid projection attempt, no column to project."],referenceValue_absentColumn:['Column "','" is missing in a schema with columns: ',"."]},semanticError:"Semantic error: ",syntaxErrors:{exprParser_emptyStringGiven:["Cannot parse an expression from an empty string."],exprParser_outerJoinWhenNullNotSupported:["Found "," when null values are not supported."],exprParser_unexpectedPart:['Unexpected part "','" in an expression.'],exprParser_bothBranchesError:['All combinations throw error in "','". When treated as projection:\n',"\nWhen treated as theta join:\n",""],exprParser_invalidExpression:["Given string is not a valid relational algebra expression."],exprParser_invalidParentheses:["Invalid structure of parentheses in the expression."],exprParser_invalidStart:["Relational algebra expression cannot start with ","."],exprParser_invalidEnd:["Relational algebra expression cannot end with ","."],exprParser_relationAfterRelation:['Relation "','" after relation "','".'],exprParser_relationAfterUnary:['Relation "','" after unary operator "','".'],exprParser_relationAfterClosing:['Relation "','" after closing parenthesis.'],exprParser_unaryAfterBinary:['Unary operator "','" after binary operator "','".'],exprParser_unaryAfterOpening:['Unary operator "','" after opening parenthesis.'],exprParser_binaryAfterBinary:['Binary operator "','" after binary operator "','".'],exprParser_binaryAfterOpening:['Binary operator "','" after opening parenthesis.'],exprParser_openingAfterRelation:['Opening parenthesis after relation "','".'],exprParser_openingAfterUnary:['Opening parenthesis after unary operator "','".'],exprParser_openingAfterClosing:["Opening parenthesis after closing parenthesis."],exprParser_closingAfterBinary:['Closing parenthesis after binary operator "','".'],exprParser_closingAfterOpening:["Closing parenthesis after opening parenthesis."],valueParser_emptyInput:["Empty string given as a condition."],valueParser_unsupportedNull:["Null constant used when null values are not supported."],valueParser_unexpectedPart:['Unexpected part "','" in the expression.'],valueParser_missingOpeningParenthesis:["Missing opening parenthesis '(' in an expression."],valueParser_missingClosingParenthesis:["Missing closing parenthesis ')' in an expression."],valueParser_invalidExpression:["Given string is not a valid expression."],valueParser_invalidStart:['Expression cannot start with "','".'],valueParser_invalidEnd:['Expression cannot end with "','".'],valueParser_literalAfterLiteral:['Literal "','" after literal "','".'],valueParser_literalAfterReference:['Literal "','" after reference to column "','".'],valueParser_literalAfterClosing:['Literal "','" after closing parenthesis.'],valueParser_referenceAfterLiteral:['Reference to column "','" after literal "','".'],valueParser_referenceAfterReference:['Reference to column "','" after reference to column "','".'],valueParser_referenceAfterClosing:['Reference to column "','" after closing parenthesis.'],valueParser_notAfterLiteral:['Logical not operator "','" after literal "','".'],valueParser_notAfterReference:['Logical not operator "','" after reference to column "','".'],valueParser_notAfterClosing:['Logical not operator "','" after closing parenthesis.'],valueParser_binaryAfterOperator:['Binary operator "','" after binary operator "','".'],valueParser_binaryAfterOpening:['Binary operator "','" after opening parenthesis.'],valueParser_openingAfterLiteral:['Opening parenthesis after literal "','".'],valueParser_openingAfterReference:['Opening parenthesis after reference to column "','".'],valueParser_openingAfterClosing:["Opening parenthesis after closing parenthesis."],valueParser_closingAfterOperator:['Closing parenthesis after binary operator "','".'],valueParser_closingAfterOpening:["Closing parenthesis after opening parenthesis."],stringUtils_missingClosingChar:["Missing '","' after opening '","'."],stringUtils_charNotFound:['Expected "','" not found.'],renameNode_missingArrow:['Invalid renaming attempt, use the "OldName -> NewName" format separated by commas.'],renameNode_invalidNewName:['Invalid renaming attempt to "','". New column name must contain letters, numbers and underscores only and start with a letter or an underscore.'],renameNode_keywordNewName:['Invalid renaming attempt to "','". New column name cannot be a keyword.'],renameNode_multipleRenameOfTheColumn:['Multiple renaming attempts of column "','".'],selectionNode_resultNotBoolean:["Result of the selection condition "," is not a boolean value, but ","."],thetaJoinNode_resultNotBoolean:["Result of the theta join condition "," is not a boolean value, but ","."],comparingOperator_differentInputTypes:['Inputs for "','"  have different types '," and ","."],computingOperator_inputTypesNotNumbers:['Inputs for "','" are not both numbers, they are '," and ","."],logicalOperator_leftInputNotBoolean:['Left-hand input value for "','" is not a boolean, but ',"."],logicalOperator_rightInputNotBoolean:['Right-hand input value for "','" is not a boolean, but ',"."]},syntaxError:"Syntax error: ",userMessages:{loadedRelationsTotalNo:"No relations loaded in the application at the moment.",loadedRelationsTotalSome:" relations loaded at the moment: ",loadRelationNew:"Relation loaded to application.",loadAllRelationsNew:[" relations loaded to application, "," skipped for errors."],deleteLoadedRelations:" relations deleted.",relationsExportOK:"Relations saved.",relationsExportErr:"Relations saving failed: ",relationsImport:[" relations loaded, "," files skipped."],expressionsExportOK:"Expressions saved.",expressionsExportErr:"Expressions saving failed: ",expressionsImport:[" expressions loaded from "," files ("," expressions skipped, "," files skipped)."]},operations:{selection:"Selection",projection:"Projection",rename:"Rename",union:"Union",intersection:"Intersection",difference:"Difference",naturalJoin:"Natural join",cartesianProduct:"Cartesian product",leftSemiJoin:"Left semijoin",rightSemiJoin:"Right semijoin",leftAntijoin:"Left antijoin",rightAntijoin:"Right antijoin",thetaJoin:"Theta join",leftThetaSemiJoin:"Left theta semijoin",rightThetaSemiJoin:"Right theta semijoin",fullOuterJoin:"Full outer join",leftOuterJoin:"Left outer join",rightOuterJoin:"Right outer join",division:"Division"},managementSection:{batchButton:"Batch",loadButton:"Load",saveButton:"Save",samplesButton:"Samples",samplesMenuTitle:"Sample projects",settingsButton:"Settings",settingsNullValues:"Null values",settingsNullValuesAllowed:"allowed",settingsNullValuesForbidden:"forbidden",settingsCSVSeparator:"CSV separator",settingsCSVSeparatorSemicolon:"semicolon",settingsCSVSeparatorComma:"comma",settingsTheme:"Theme",settingsThemeLight:"light",settingsThemeDark:"dark",settingsLanguage:"Language",aboutButton:"About"},relationSection:{relationSectionHeader:"Relations",loadAllButton:"Load all",loadAllButtonTooltip:"Loads all valid relation into the application",removeLoadedButton:"Remove loaded",removeLoadedButtonTooltip:"Removes all the currently loaded relations",importButton:"Import",importButtonTooltip:"Adds new relations from files",exportButton:"Export",exportButtonTooltip:"Saves all stored relations to files",loadButton:"Load",loadButtonTooltip:"Loads the selected relation into the application",renameButton:"Rename",deleteButton:"Delete",deleteButtonTooltip:"Deletes the selected relation",revertButton:"Revert",revertButtonTooltip:"Reverts the selected relation to the last loaded state"},expressionSection:{expressionSectionHeader:"Expressions",importButton:"Import",importButtonTooltip:"Adds new expressions from a file",exportButton:"Export",exportButtonTooltip:"Saves expressions to a file",evaluateButton:"Evaluate",evaluateButtonTooltip:"Evaluates the selected expression",renameButton:"Rename",deleteButton:"Delete",deleteButtonTooltip:"Deletes the selected expression",expressionTextareaPlaceholder:"Write relational algebra expression here...",lineComment:"Line comment",blockComment:"Block comment"},resultSection:{resultSectionHeader:"Result",exportEvalTreeButton:"Export",exportEvalTreeButtonTooltip:"Saves the evaluation tree as an image",evalTreeTitle:"Evaluation tree of",resultRelationTitle:"Result relation",intermediateRelationTitle:"Intermediate relation",addButton:"Add",addButtonTooltip:"Adds the given relation between the stored ones",exportRelationButton:"Export",exportRelationButtonTooltip:"Saves the selected relation to a file"}},k=["EN","CS"],S=new Map([["EN",x],["CS",{abbr:"CS",relationErrors:{emptyColumn:"N\xe1zev sloupce nem\u016f\u017ee b\xfdt pr\xe1zdn\xfd",duplicitColumn:"Duplicitn\xed n\xe1zev sloupce",keywordColumn:"N\xe1zev sloupce nem\u016f\u017ee b\xfdt kl\xed\u010dov\xe9 slovo",invalidColumn:"Nepovolen\xe9 znaky v n\xe1zvu sloupce",unsupportedNull:"Null hodonoty nejsou podporov\xe1ny",invalidNumber:"Dan\xfd \u0159et\u011bzec nen\xed \u010d\xedslo",invalidBoolean:"Dan\xfd \u0159et\u011bzec nen\xed boolean"},codeErrors:x.codeErrors,semanticErrors:{exprParser_relationNotDefined:['Relace "','" nen\xed definov\xe1na. Zkontrolujte definice relac\xed.'],binaryNode_commonColumns:["Vstupn\xed relace pro ",' maj\xed spole\u010dn\xe9 sloupce "','".'],setOperationNode_notEqualColumns:['Vstupn\xed relace "','" a "','" pro '," mno\u017ein nemaj\xed stejn\xe9 sch\xe9ma."],divisionNode_rightColumnsNotSubset:['Sch\xe9ma prav\xe9 vstupn\xed relace "','" nen\xed podmno\u017einou sch\xe9matu lev\xe9 vstupn\xed relace "','".'],divisionNode_rightColumnsNotProperSubset:['Sch\xe9ma prav\xe9 vstupn\xed relace "','" nen\xed vlastn\xed podmno\u017einou sch\xe9matu lev\xe9 vstupn\xed relace "',". V lev\xe9 relaci mus\xed existovat sloupec, kter\xfd neexistuje v prav\xe9 relaci."],renameNode_absentOriginalColumn:['Nepovolen\xe9 p\u0159ejmenov\xe1n\xed, sloupec "','" neexistuje ve vstupn\xed relaci.'],renameNode_changeToDuplicit:['Nepovolen\xe9 p\u0159ejmenov\xe1n\xed, nov\xfd n\xe1zev sloupce "','" je duplicitn\xed ve zm\u011bn\u011bn\xe9 relaci.'],projectionNode_absentColumn:['Nepovolen\xe1 projekce sloupce "','". Tento sloupec neexistuje ve vstupn\xed relaci.'],projectionNode_emptyProjection:["Nepovolen\xe1 projekce, v\u017edy mus\xed b\xfdt zachov\xe1n alespo\u0148 jeden sloupec."],referenceValue_absentColumn:['Sloupec "','" neexistuje ve sch\xe9matu se sloupci ',"."]},semanticError:"S\xe9mantick\xe1 chyba: ",syntaxErrors:{exprParser_emptyStringGiven:["V\xfdraz nelze parsovat z pr\xe1zdn\xe9ho \u0159et\u011bzce."],exprParser_outerJoinWhenNullNotSupported:["Nalezeno ",", p\u0159esto\u017ee null hodnoty jsou zak\xe1z\xe1ny."],exprParser_unexpectedPart:['Ne\u010dekan\xe1 \u010d\xe1st "','" v RA v\xfdrazu.'],exprParser_bothBranchesError:['V\u0161echny kombinace zp\u016fsobuj\xed chybu v "','". Pova\u017eov\xe1no za projekci:\n',"\nPova\u017eov\xe1no za theta spojen\xed:\n",""],exprParser_invalidExpression:["Dan\xfd v\xfdraz nen\xed korektn\xed v\xfdraz rela\u010dn\xed algebry."],exprParser_invalidParentheses:["Chybn\xe9 uz\xe1vorkov\xe1n\xed ve v\xfdrazu."],exprParser_invalidStart:["RA v\xfdraz nem\u016f\u017ee za\u010d\xednat na ","."],exprParser_invalidEnd:["RA v\xfdraz nem\u016f\u017ee kon\u010dit na ","."],exprParser_relationAfterRelation:['Relace "','" po relaci "','".'],exprParser_relationAfterUnary:['Relace "','" po un\xe1rn\xedm oper\xe1toru "','".'],exprParser_relationAfterClosing:['Relace "','" po uzav\xedrac\xed z\xe1vorce.'],exprParser_unaryAfterBinary:['Un\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_unaryAfterOpening:['Un\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vorce.'],exprParser_binaryAfterBinary:['Bin\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_binaryAfterOpening:['Bin\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vorce.'],exprParser_openingAfterRelation:['Otev\xedrac\xed z\xe1vorka po relaci "','".'],exprParser_openingAfterUnary:['Otev\xedrac\xed z\xe1vorka po un\xe1rn\xedm oper\xe1toru "','".'],exprParser_openingAfterClosing:["Otev\xedrac\xed z\xe1vorka po uzav\xedrac\xed z\xe1vorce."],exprParser_closingAfterBinary:['Uzav\xedrac\xed z\xe1vorka po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_closingAfterOpening:["Uzav\xedrac\xed z\xe1vorka po otev\xedrac\xed z\xe1vorce."],valueParser_emptyInput:["Jako podm\xednka nem\u016f\u017ee b\xfdt pr\xe1zdn\xfd \u0159et\u011bzec."],valueParser_unsupportedNull:["Nalezena null konstanta, p\u0159esto\u017ee null hodnoty jsou zak\xe1z\xe1ny."],valueParser_unexpectedPart:['Ne\u010dekan\xe1 \u010d\xe1st "','" ve v\xfdrazu.'],valueParser_missingOpeningParenthesis:["Chyb\u011bj\xedc\xed otev\xedrac\xed z\xe1vorka ve v\xfdrazu."],valueParser_missingClosingParenthesis:["Chyb\u011bj\xedc\xed uzav\xedrac\xed z\xe1vorka ve v\xfdrazu."],valueParser_invalidExpression:["Dan\xfd v\xfdraz nen\xed korektn\xed."],valueParser_invalidStart:['V\xfdraz nem\u016f\u017ee za\u010d\xednat na "','".'],valueParser_invalidEnd:['V\xfdraz nem\u016f\u017ee kon\u010dit na "','".'],valueParser_literalAfterLiteral:['Konstanta "','" po konstant\u011b "','".'],valueParser_literalAfterReference:['Konstanta "','" po referenci sloupce "','".'],valueParser_literalAfterClosing:['Konstanta "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_referenceAfterLiteral:['Reference sloupce "','" po konstant\u011b "','".'],valueParser_referenceAfterReference:['Reference sloupce "','" po referenci sloupce "','".'],valueParser_referenceAfterClosing:['Reference sloupce "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_notAfterLiteral:['Logick\xe1 negace "','" po konstant\u011b "','".'],valueParser_notAfterReference:['Logick\xe1 negace "','" po referenci sloupce "','".'],valueParser_notAfterClosing:['Logick\xe1 negace "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_binaryAfterOperator:['Bin\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],valueParser_binaryAfterOpening:['Bin\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vroce.'],valueParser_openingAfterLiteral:['Otev\xedrac\xed z\xe1vorka po konstant\u011b "','".'],valueParser_openingAfterReference:['Otev\xedrac\xed z\xe1vorka po referenci sloupce "','".'],valueParser_openingAfterClosing:["Otev\xedrac\xed z\xe1vorka po uzav\xedrac\xed z\xe1vorce."],valueParser_closingAfterOperator:['Uzav\xedrac\xed z\xe1vorka po bin\xe1rn\xedm oper\xe1toru "','".'],valueParser_closingAfterOpening:["Uzav\xedrac\xed z\xe1vorka po otev\xedrac\xed z\xe1vroce."],stringUtils_missingClosingChar:["Chyb\u011bj\xedc\xed '","' po \xfavodn\xed '","'."],stringUtils_charNotFound:['O\u010dek\xe1van\xfd znak "','" nenalezen.'],renameNode_missingArrow:['Chybn\xe9 p\u0159ejmenov\xe1n\xed, pou\u017eijte form\xe1t "Star\xfdN\xe1zev -> Nov\xfdN\xe1zev" odd\u011blen\xfd \u010d\xe1rkami.'],renameNode_invalidNewName:['Chybn\xe9 p\u0159ejmenov\xe1n\xed na "','". Nov\xfd n\xe1zev sloupce mus\xed obsahovat pouze p\xedsmena, \u010d\xedsla a podtr\u017e\xedtka a za\u010d\xednat p\xedsmenem nebo podtr\u017e\xedtkem.'],renameNode_keywordNewName:['Chybn\xe9 p\u0159ejmenov\xe1n\xed na "','". Nov\xfd n\xe1zev nem\u016f\u017ee b\xfdt kl\xed\u010dov\xe9 slovo.'],renameNode_multipleRenameOfTheColumn:['V\xedcen\xe1sobn\xe9 p\u0159ejmenov\xe1n\xed sloupce "','".'],selectionNode_resultNotBoolean:["V\xfdsledek podm\xednky v selekci "," nen\xed boolean, ale ","."],thetaJoinNode_resultNotBoolean:["V\xfdsledek podm\xednky v theta joinu "," nen\xed boolean, ale ","."],comparingOperator_differentInputTypes:['Vstupy pro "','" nemaj\xed stejn\xe9 typy, ale '," a ","."],computingOperator_inputTypesNotNumbers:['Vstupy pro "','" nejsou \u010d\xedsla, ale '," a ","."],logicalOperator_leftInputNotBoolean:['Lev\xfd vstup logick\xe9ho oper\xe1toru "','" nen\xed boolean, ale ',"."],logicalOperator_rightInputNotBoolean:['Prav\xfd vstup logick\xe9ho oper\xe1toru "','" nen\xed boolean, ale ',"."]},syntaxError:"Syntaktick\xe1 chyba: ",userMessages:{loadedRelationsTotalNo:"Nyn\xed nejsou v aplikaci nahran\xe9 \u017e\xe1dn\xe9 relace.",loadedRelationsTotalSome:" relac\xed celkov\u011b nahr\xe1no v aplikaci: ",loadRelationNew:"Relace nahr\xe1na do aplikace.",loadAllRelationsNew:[" relac\xed nahr\xe1no do aplikace, "," p\u0159esko\u010deno kv\u016fli chyb\xe1m."],deleteLoadedRelations:" relac\xed odebr\xe1no.",relationsExportOK:"Relace sta\u017eeny.",relationsExportErr:"Stahov\xe1n\xed relac\xed selhalo: ",relationsImport:[" relac\xed nahr\xe1no, "," soubor\u016f p\u0159esko\u010deno."],expressionsExportOK:"V\xfdrazy sta\u017eeny do souboru.",expressionsExportErr:"Stahov\xe1n\xed v\xfdraz\u016f selhalo: ",expressionsImport:[" v\xfdraz\u016f nahr\xe1no z "," soubor\u016f ("," v\xfdraz\u016f p\u0159esko\u010deno, "," soubor\u016f p\u0159esko\u010deno)."]},operations:{selection:"Selekce",projection:"Projekce",rename:"P\u0159ejmenov\xe1n\xed",union:"Sjednocen\xed",intersection:"Pr\u016fnik",difference:"Rozd\xedl",naturalJoin:"P\u0159irozen\xe9 spojen\xed",cartesianProduct:"Kart\xe9zsk\xfd sou\u010din",leftSemiJoin:"Lev\xe9 vnit\u0159n\xed spojen\xed",rightSemiJoin:"Prav\xe9 vnit\u0159n\xed spojen\xed",leftAntijoin:"Lev\xfd antijoin",rightAntijoin:"Prav\xfd antijoin",thetaJoin:"Theta spojen\xed",leftThetaSemiJoin:"Lev\xe9 theta spojen\xed",rightThetaSemiJoin:"Prav\xe9 theta spojen\xed",fullOuterJoin:"Pln\xe9 vn\u011bj\u0161\xed spojen\xed",leftOuterJoin:"Lev\xe9 vn\u011bj\u0161\xed spojen\xed",rightOuterJoin:"Prav\xe9 vn\u011bj\u0161\xed spojen\xed",division:"D\u011blen\xed"},managementSection:{batchButton:"Batch",loadButton:"Nahr\xe1t",saveButton:"Ulo\u017eit",samplesButton:"Uk\xe1zky",samplesMenuTitle:"P\u0159ipraven\xe9 vzorov\xe9 projekty",settingsButton:"Nastaven\xed",settingsNullValues:"Null hodnoty",settingsNullValuesAllowed:"povoleny",settingsNullValuesForbidden:"zak\xe1z\xe1ny",settingsCSVSeparator:"CSV odd\u011blova\u010d",settingsCSVSeparatorSemicolon:"st\u0159edn\xedk",settingsCSVSeparatorComma:"\u010d\xe1rka",settingsTheme:"Re\u017eim",settingsThemeLight:"sv\u011btl\xfd",settingsThemeDark:"tmav\xfd",settingsLanguage:"Jazyk",aboutButton:"O aplikaci"},relationSection:{relationSectionHeader:"Relace",loadAllButton:"Nahr\xe1t v\u0161echny",loadAllButtonTooltip:"Nahraje v\u0161echny bezchybn\xe9 relace do aplikace",removeLoadedButton:"Odebrat nahran\xe9",removeLoadedButtonTooltip:"Odebere v\u0161echny nahran\xe9 relace z aplikace",importButton:"Import",importButtonTooltip:"Nahraje nov\xe9 relace ze soubor\u016f",exportButton:"Export",exportButtonTooltip:"St\xe1hne editovan\xe9 relace do soubor\u016f",loadButton:"Nahr\xe1t",loadButtonTooltip:"Nahraje relaci do aplikace",renameButton:"P\u0159ejmenovat",deleteButton:"Odstranit",deleteButtonTooltip:"Odstran\xed vybranou relaci",revertButton:"Obnovit",revertButtonTooltip:"Obnov\xed relaci do posledn\xedho nahran\xe9ho stavu"},expressionSection:{expressionSectionHeader:"V\xfdrazy",importButton:"Import",importButtonTooltip:"Nahraje nov\xe9 v\xfdrazy ze souboru",exportButton:"Export",exportButtonTooltip:"St\xe1hne v\xfdrazy do souboru",evaluateButton:"Vyhodnotit",evaluateButtonTooltip:"Vyhodnot\xed vybran\xfd rela\u010dn\xed v\xfdraz",renameButton:"P\u0159ejmenovat",deleteButton:"Odstranit",deleteButtonTooltip:"Odstran\xed vybran\xfd rela\u010dn\xed v\xfdraz",expressionTextareaPlaceholder:"Zde napi\u0161te sv\u016fj rela\u010dn\xed v\xfdraz...",lineComment:"\u0158\xe1dkov\xfd koment\xe1\u0159",blockComment:"Blokov\xfd koment\xe1\u0159"},resultSection:{resultSectionHeader:"V\xfdsledek",exportEvalTreeButton:"Export",exportEvalTreeButtonTooltip:"Ulo\u017e\xed evalua\u010dn\xed strom jako obr\xe1zek",evalTreeTitle:"Evalua\u010dn\xed strom pro",resultRelationTitle:"V\xfdsledn\xe1 relace",intermediateRelationTitle:"Meziv\xfdsledn\xe1 relace",addButton:"P\u0159idat",addButtonTooltip:"P\u0159id\xe1 zvolenou relaci mezi editovan\xe9",exportRelationButton:"Export",exportRelationButtonTooltip:"St\xe1hne zvolenou relaci do souboru"}}]]);function R(){var e=S.get(E.getLanguage());return void 0===e?x:e}var w=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),a=t.call(this,R().syntaxError+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(d.a)(a),n),a.name="RASyntaxError",a}return n}(v),C=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),a=t.call(this,R().semanticError+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(d.a)(a),n),a.name="RASemanticError",a}return n}(v);n(37);function j(e,t){var n="0123456789qwertyuiopasdfghjkllzxcvbnmQWERTYUIOOPASDFGHJKLLZXCVBNM!@#$%^&*()_+[];',./",r=document.createElement("div");r.setAttribute("style","font-family: ".concat(e,"; font-size: ").concat(t,"; position: absolute; white-space: nowrap;")),r.innerText=n,document.documentElement.appendChild(r);var a=r.clientWidth,o=r.clientHeight;return r.remove(),{fontWidth:a/n.length,fontHeight:o}}function O(e,t){for(var n=e.slice(0,t),r=n.length-1;;){if(!n.charAt(r).match(/\w/)){++r;break}if(0===r)break;--r}return r}var N=getComputedStyle(document.querySelector(":root")),T=N.getPropertyValue("--x-textarea-font-size"),P=N.getPropertyValue("--x-textarea-font-family"),A=j(P,T).fontWidth,_=Number(N.getPropertyValue("--x-textarea-line-height")),V=N.getPropertyValue("--light-color-b"),I=N.getPropertyValue("--dark-color-b"),L=N.getPropertyValue("--text-color-light"),D=N.getPropertyValue("--text-color-dark"),B=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).textarea=void 0,e}return Object(u.a)(n,[{key:"getSelection",value:function(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}}},{key:"setSelection",value:function(e,t){this.textarea.setSelectionRange(e,t||e)}},{key:"isFocused",value:function(){return null!==document.activeElement&&document.activeElement.id===this.props.id+"-ta"}},{key:"focus",value:function(){this.textarea.focus()}},{key:"setPlaceholder",value:function(e){this.textarea.placeholder=e}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=document.getElementById(t.id),r=document.createElement("table");r.setAttribute("cellspacing","0"),r.setAttribute("cellpadding","0"),r.classList.add("x-textarea-table");var a=document.createElement("tr"),o=document.createElement("td");o.setAttribute("id",t.id+"-td1"),o.classList.add("x-textarea-table-td1");var i=document.createElement("td");i.classList.add("x-textarea-table-td2"),a.appendChild(o),a.appendChild(i),r.appendChild(a);var s=document.createElement("textarea");s.setAttribute("id",t.id+"-ta"),s.setAttribute("spellcheck","false"),s.mouseIsDown=!1,s.setAttribute("placeholder",this.props.placeholder),s.classList.add("x-textarea","scrollbar-container"),s.value=t.text;var l=document.createElement("canvas");l.width=28,l.classList.add("x-textarea-canvas"),s.canvasLines=l,o.appendChild(l),i.appendChild(s),n.appendChild(r);var u=document.createElement("div");u.classList.add("whisper-div"),u.isShown=!1,u.selectedIndex=-1,u.changeSelected=function(e){this.setSelected(this.selectedIndex+e)},u.setSelected=function(e){var t,n;this.childElementCount>0&&(this.selectedIndex>-1&&this.selectedIndex<this.childElementCount&&this.children[this.selectedIndex].classList.remove("selected-whisper"),this.selectedIndex=(t=e,n=this.childElementCount,(t%n+n)%n),this.children[this.selectedIndex].classList.add("selected-whisper"))},u.getSelectedWhisper=function(){if(this.selectedIndex>-1&&this.childElementCount>0)return this.children[this.selectedIndex].innerText},s.whisperDiv=u,i.appendChild(u),s.paintLineNumbers=function(e){try{var t=this.canvasLines;t.height!==this.clientHeight&&(t.height=this.clientHeight);var n=t.getContext("2d");n.fillStyle=e?I:V,n.fillRect(0,0,26,this.scrollHeight+1),n.fillStyle=e?D:L,n.font=T+" "+P;for(var r=0;r<this.linesCount;r++){var a=""+(r+1);n.fillText(a,24-8*a.length,19+r*_)}}catch(o){console.log("XTextArea paintLineNumbers error: "+o)}},s.update=function(e,t){this.value=e;for(var n=1,r=0;r<e.length;++r)"\n"===e.charAt(r)&&++n;this.linesCount=n,this.style.height=n*_+8+"px",this.scrollHeight>this.clientHeight&&(this.style.height=this.scrollHeight+_+10+"px"),this.paintLineNumbers(t),this.updateParentheses()},s.createWhisper=function(e){var t=this;0===e.length?this.hideWhisper():(this.whisperDiv.innerHTML="",e.forEach((function(e,n){var r=document.createElement("div");r.innerHTML=e,r.onclick=function(e){t.focus(),t.whisperDiv.setSelected(n),e.stopPropagation()},r.ondblclick=function(e){t.focus(),t.insertCurrentSelectedWhisper(),t.notAutoShowWhisper=!0,e.stopPropagation()},t.whisperDiv.appendChild(r)})),this.whisperDiv.setSelected(0),this.whisperDiv.isShown=!0,this.moveWhisper())},s.moveWhisper=function(){if(this.whisperDiv.isShown){var e=z(this.value,this.selectionEnd),t=(e.line+1)*_,n=e.column*A,r=t-this.scrollTop,a=n-this.scrollLeft+4;0<=r&&r<this.clientHeight&&0<=a&&a<this.clientWidth?this.getBoundingClientRect().y+r<=window.innerHeight/2?this.whisperDiv.setAttribute("style","display: block; top: ".concat(r+4,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: block; bottom: ".concat(this.getBoundingClientRect().height-r+_,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: none;")}},s.hideWhisper=function(){this.whisperDiv.setAttribute("style","display: none;"),this.whisperDiv.isShown=!1},s.insertCurrentSelectedWhisper=function(){var e=this.whisperDiv.getSelectedWhisper();if(void 0!==e){var n=O(this.value,this.selectionEnd),r=this.value.slice(0,n),a=this.value.slice(this.selectionEnd),o=n+e.length;t.onChange(r+e+a,o),this.setSelectionRange(o,o),this.hideWhisper()}},s.notAutoShowWhisper=!1,s.errorDivs=[],s.moveErrors=function(){var e=this;this.errorDivs.forEach((function(t){var n=(t.startLine+1)*_+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=t.rangeLength*A,a=t.startColumn*A+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),e.getBoundingClientRect().x+a>=window.innerWidth/2&&t.messageSpan.setAttribute("style","right: 50%; left: unset;"),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},s.updateErrors=function(e){var t=this;this.errorDivs.forEach((function(e){e.remove()})),this.errorDivs=[];var n=function(e){t.parentElement.appendChild(e),t.errorDivs.push(e)};e.forEach((function(e){var r=z(t.value,e.start),a=z(t.value,e.end);if(r.line===a.line)n(U(r.line,r.column,a.column-r.column,e.msg,t));else{n(U(r.line,r.column,W(t.value,r.line)-r.column,e.msg,t));for(var o=r.line+1;o<a.line;++o)n(U(o,0,W(t.value,o),e.msg,t));n(U(a.line,0,a.column,e.msg,t))}})),this.moveErrors()},s.parentheses=[],s.parenthesesDivs=[],s.updateParentheses=function(){if(s.parenthesesDivs.forEach((function(e){e.remove()})),s.parenthesesDivs=[],s.selectionStart===s.selectionEnd){var e=s.selectionStart,t=e-1,n=s.parentheses.filter((function(n){return n.start===e||n.start===t||n.end===e||n.end===t})),r=!0;n.forEach((function(e){var t=z(s.value,e.start),n=z(s.value,e.end),a=J(t.line,t.column,s),o=J(n.line,n.column,s);s.parentElement.appendChild(a),s.parentElement.appendChild(o),s.parenthesesDivs.push(a),s.parenthesesDivs.push(o),a.classList.toggle("first-pair",r),a.classList.toggle("second-pair",!r),o.classList.toggle("first-pair",r),o.classList.toggle("second-pair",!r),r=!1})),s.moveParentheses()}},s.moveParentheses=function(){var e=this;s.parenthesesDivs.forEach((function(t){var n=(t.startLine+1)*_+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=A,a=t.startColumn*A+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},s.insertPairSymbol=function(e,n){var r=s.value.slice(0,this.selectionStart),a=s.value.slice(this.selectionStart,this.selectionEnd),o=s.value.slice(this.selectionEnd),i=s.selectionEnd+1;t.onChange(r+e+a+n+o,i),this.setSelectionRange(i,i),this.hideWhisper()},s.checkPairSymbolDelete=function(){if(s.selectionStart===s.selectionEnd){var e=s.selectionStart-1,n=s.selectionStart;if(0<=e&&n<s.value.length){var r=this.value.charAt(e),a=this.value.charAt(n);if("("===r&&")"===a||"["===r&&"]"===a||'"'===r&&'"'===a&&"\\"!==this.value.charAt(e-1)){var o=s.value.slice(0,e),i=s.value.slice(n+1);return t.onChange(o+i,e),this.setSelectionRange(e,e),!0}}}return!1},window.addEventListener("scroll",(function(){return s.moveWhisper()})),window.addEventListener("resize",(function(){s.moveWhisper(),s.moveErrors(),s.moveParentheses()})),window.addEventListener("click",(function(){return s.hideWhisper()})),s.onscroll=function(){s.paintLineNumbers(e.props.darkTheme),s.moveWhisper(),s.moveErrors(),s.moveParentheses()},s.onmousedown=function(e){s.mouseIsDown=!0,setTimeout(s.updateParentheses,0),e.stopPropagation()},s.onmouseup=function(){s.mouseIsDown=!1,s.paintLineNumbers(e.props.darkTheme),setTimeout(s.updateParentheses,0)},s.onmousemove=function(){s.mouseIsDown&&s.paintLineNumbers(e.props.darkTheme)},s.oninput=function(t){e.props.onChange(t.target.value,t.target.selectionStart)},s.onkeydown=function(t){if(s.whisperDiv.isShown){if("ArrowDown"===t.key&&(s.whisperDiv.changeSelected(1),t.preventDefault()),"ArrowUp"===t.key&&(s.whisperDiv.changeSelected(-1),t.preventDefault()),"PageDown"===t.key&&(s.whisperDiv.setSelected(-1),t.preventDefault()),"PageUp"===t.key&&(s.whisperDiv.setSelected(0),t.preventDefault()),"End"!==t.key&&"Home"!==t.key||s.hideWhisper(),"Escape"!==t.key&&"Esc"!==t.key||(s.hideWhisper(),t.preventDefault()),"Enter"!==t.key||t.ctrlKey||(s.insertCurrentSelectedWhisper(),t.preventDefault()),"Enter"===t.key&&t.ctrlKey&&(s.hideWhisper(),t.preventDefault()),"Tab"===t.key&&(s.insertCurrentSelectedWhisper(),t.preventDefault()),"ArrowLeft"===t.key){var n=0===s.selectionStart?0:s.selectionStart-1;e.props.onChange(s.value,n)}if("ArrowRight"===t.key){var r=s.selectionStart===s.value.length?s.selectionStart:s.selectionStart+1;e.props.onChange(s.value,r)}}"Enter"!==t.key&&"Tab"!==t.key||(s.notAutoShowWhisper=!0),"Backspace"!==t.key||s.whisperDiv.isShown||(s.notAutoShowWhisper=!0),t.ctrlKey&&(" "===t.key&&(s.whisperDiv.isShown?s.hideWhisper():e.props.onChange(s.value,s.selectionStart)),e.props.onCtrlInput(t)),"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key&&"PageUp"!==t.key&&"PageDown"!==t.key||setTimeout(s.updateParentheses,0),"("===t.key&&(s.insertPairSymbol("(",")"),t.preventDefault()),"["===t.key&&(s.insertPairSymbol("[","]"),t.preventDefault()),'"'===t.key&&"\\"!==s.value.charAt(s.selectionStart-1)&&(s.insertPairSymbol('"','"'),t.preventDefault()),"Backspace"===t.key&&s.checkPairSymbolDelete()&&t.preventDefault()},s.update(this.props.text,this.props.darkTheme),s.updateErrors(this.props.errors),this.textarea=s}},{key:"componentDidUpdate",value:function(e){this.textarea.update(this.props.text,this.props.darkTheme),e.darkTheme!==this.props.darkTheme&&this.textarea.paintLineNumbers(this.props.darkTheme),this.props.whispers!==e.whispers&&(this.textarea.notAutoShowWhisper?this.textarea.notAutoShowWhisper=!1:this.textarea.createWhisper(this.props.whispers)),void 0!==this.props.errors?this.textarea.updateErrors(this.props.errors):this.props.errors!==e.errors&&this.textarea.classList.remove("x-textarea-err"),this.props.parentheses!==e.parentheses&&(this.textarea.parentheses=this.props.parentheses,this.textarea.updateParentheses())}},{key:"render",value:function(){return a.a.createElement("div",{id:this.props.id,className:"x-textarea-div"})}}]),n}(a.a.Component);function z(e,t){var n=e.slice(0,t),r=(n.match(/\n/g)||[]).length,a=n.lastIndexOf("\n");return{line:r,column:n.length-a-1}}function W(e,t){for(var n=0,r=0,a=0,o=0;o<e.length;++o)if("\n"===e.charAt(o))if(++n===t)r=o;else if(n===t+1){a=o;break}return 0===a&&(a=e.length),a-r}function U(e,t,n,r,a){var o=document.createElement("div");o.classList.add("x-textarea-highlight"),o.startLine=e,o.startColumn=t,o.rangeLength=n,o.onclick=function(e){var t=new MouseEvent(e.type,Object(h.a)({},e));a.dispatchEvent(t),e.stopPropagation()};var i=document.createElement("span");return i.classList.add("highlight-tooltip"),i.innerText=r,o.messageSpan=i,o.appendChild(i),o}function J(e,t,n){var r=document.createElement("div");return r.classList.add("x-textarea-parentheses"),r.startLine=e,r.startColumn=t,r.onclick=function(e){var t=new MouseEvent(e.type,Object(h.a)({},e));n.dispatchEvent(t),e.stopPropagation()},r}var F=n(8),M=function(){function e(t){Object(l.a)(this,e),this.name=void 0,this.columns=new Map,this.columnNames=[],this.rows=[],this.finishedSchema=!1,this.name=t}return Object(u.a)(e,[{key:"getName",value:function(){return this.name}},{key:"hasFinishedSchema",value:function(){return this.finishedSchema}},{key:"finishSchema",value:function(){this.finishedSchema=!0}},{key:"addColumn",value:function(e,t){return!this.hasColumn(e)&&!this.hasFinishedSchema()&&(this.columns.set(e,t),this.columnNames.push(e),!0)}},{key:"hasColumn",value:function(e){return this.columnNames.some((function(t){return t===e}))}},{key:"getColumns",value:function(){return this.columns}},{key:"forEachColumn",value:function(e){return this.columns.forEach(e)}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"getColumnsCount",value:function(){return this.columnNames.length}},{key:"addRow",value:function(e){return!!Object(F.isEqual)(e.getTypes(),this.columns)&&(this.finishSchema(),e.finish(),this.rows.some((function(t){return t.equals(e)}))||this.rows.push(e),!0)}},{key:"getRows",value:function(){return this.rows}},{key:"getRowsCount",value:function(){return this.rows.length}},{key:"getSchemaString",value:function(){return this.name+"("+Object(s.a)(this.columns).map((function(e){return e[0]+": "+e[1]})).join(", ")+")"}},{key:"getNamesSchemaString",value:function(){return this.name+"("+this.columnNames.join(", ")+")"}},{key:"contentString",value:function(){var e=this,t=this.columnNames.map((function(t){return e.columns.get(t)})),n=Object(s.a)(this.rows).map((function(t){return t.getOrderedPrintValues(e.columnNames)})),r=this.columnNames.map((function(e){return e.length}));t.forEach((function(e,t){e.length>r[t]&&(r[t]=e.length)})),n.forEach((function(e){e.forEach((function(e,t){r[t]<e.length&&(r[t]=e.length)}))}));var a=function(e){return e.map((function(e,t){return e.padEnd(r[t]," ")})).join(" | ")};return a(this.columnNames)+"\n"+a(t)+"\n"+r.map((function(e){return"-".repeat(e)})).join("-+-")+"\n"+n.map((function(e){return a(e)})).join("\n")}},{key:"equals",value:function(t){return t instanceof e&&(this.name===t.name&&Object(F.isEqual)(this.columns,t.columns)&&Object(F.isEqual)(new Set(this.rows),new Set(t.rows)))}}]),e}(),q=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),r=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(Object(d.a)(r),n),r.name="CodeError",r}return n}(Object(m.a)(Error)),H=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"codeError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return K(e.length-1,n),new q(G(e,n))}},{key:"semanticError",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return K(e.length-1,r),new C(G(e,r),t)}},{key:"syntaxError",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return K(e.length-1,r),new w(G(e,r),t)}}]),e}();function K(e,t){if(t.length!==e)for(console.log("Unexpected params count, expected "+e+", given "+t.length);t.length<e;)t.push("")}function G(e,t){for(var n,r=e.length,a=Array(2*r-2),o=1;o<r;o++)a[2*o-2]=t[o-1],a[2*o-1]=e[o];return(n=e[0]).concat.apply(n,a)}var Z=function(){function e(t,n){Object(l.a)(this,e),this.str=t,this.type=n}return Object(u.a)(e,[{key:"getRange",value:function(){return this.str.getRange()}}]),e}(),Q=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(Z),X=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,"OpeningParenthesis")}return n}(Q),$=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,"ClosingParenthesis")}return n}(Q),Y=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,"RelationToken")}return n}(Z),ee=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){return Object(l.a)(this,n),t.call(this,e,r)}return Object(u.a)(n,null,[{key:"selection",value:function(e){return new n(e,"selection")}},{key:"projection",value:function(e){return new n(e,"projection")}},{key:"rename",value:function(e){return new n(e,"rename")}}]),n}(Z),te=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,e,a)).precedence=r,o}return Object(u.a)(n,null,[{key:"naturalJoin",value:function(e){return new n(e,10,"natural join")}},{key:"cartesianProduct",value:function(e){return new n(e,10,"cartesian product")}},{key:"union",value:function(e){return new n(e,8,"union")}},{key:"intersection",value:function(e){return new n(e,9,"intersection")}},{key:"difference",value:function(e){return new n(e,8,"difference")}},{key:"leftSemijoin",value:function(e){return new n(e,10,"left semijoin")}},{key:"rightSemijoin",value:function(e){return new n(e,10,"right semijoin")}},{key:"leftAntijoin",value:function(e){return new n(e,10,"left antijoin")}},{key:"rightAntijoin",value:function(e){return new n(e,10,"right antijoin")}},{key:"thetaJoin",value:function(e){return new n(e,10,"theta join")}},{key:"leftThetaSemijoin",value:function(e){return new n(e,10,"left theta semijoin")}},{key:"rightThetaSemijoin",value:function(e){return new n(e,10,"right theta semijoin")}},{key:"fullOuterJoin",value:function(e){return new n(e,10,"full outer join")}},{key:"leftOuterJoin",value:function(e){return new n(e,10,"left outer join")}},{key:"rightOuterJoin",value:function(e){return new n(e,10,"right outer join")}},{key:"division",value:function(e){return new n(e,10,"division")}}]),n}(Z),ne=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"isWord",value:function(t){return t.length>0&&t.split("").every((function(t){return e.isLetter(t)}))}},{key:"isName",value:function(t){return 0!==t.length&&(!(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))&&t.split("").every((function(t){return e.isNameChar(t)})))}},{key:"isWhitespacesOnly",value:function(e){var t=/\s*/.exec(e);return null!==t&&t[0]===e}},{key:"isLetter",value:function(e){return 1===e.length&&e.toLowerCase()!==e.toUpperCase()}},{key:"isNameChar",value:function(t){return e.isLetter(t)||e.isDigit(t)||"_"===t}},{key:"isDigit",value:function(e){return 1===e.length&&null!==e.match(/\d/)}},{key:"isNumber",value:function(e){return/^[-]?[\d]+([.][\d]+)?$/.test(e)}},{key:"nextWord",value:function(t){if(""===t)return{first:"",second:""};for(var n=0;n<t.length;){if(!e.isLetter(t.charAt(n)))return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextName",value:function(t){if(""===t)return{first:"",second:""};if(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))return{first:"",second:t};for(var n=0;n<t.length;){var r=t.charAt(n);if(!e.isLetter(r)&&!e.isDigit(r)&&"_"!==r)return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextNonWhitespacePart",value:function(e){if(""===e)return{first:"",second:""};for(var t=0;t<e.length;){if(e.charAt(t).match(/\s/))return{first:e.substring(0,t),second:e.substring(t)};++t}return{first:e,second:""}}},{key:"nextNumber",value:function(t){if(""===t)return{first:"",second:""};var n=0;if("-"===t.charAt(0)){if(!(t.length>1&&e.isDigit(t.charAt(1))))return{first:"",second:t};n=1}for(var r=!1,a=!1;n<t.length;)if(e.isDigit(t.charAt(n)))r=!0,++n;else{if("."!==t.charAt(n))break;if(a||!r)break;a=!0,++n}return{first:t.substring(0,n),second:t.substring(n)}}},{key:"nextQuotedString",value:function(e){for(var t=1,n=0;t<e.length;){var r=e.charAt(t);if(++t,'"'===r&&n%2===0)return{first:e.slice(0,t),second:e.slice(t),error:void 0};if("\n"===r)return{first:e.slice(0,t),second:e.slice(t),error:H.syntaxError(R().syntaxErrors.stringUtils_missingClosingChar,void 0,'"','"')};"\\"===r?++n:n=0}return{first:e,second:"",error:H.syntaxError(R().syntaxErrors.stringUtils_missingClosingChar,void 0,'"','"')}}},{key:"nextBorderedPart",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0",a=1,o=1,i=!1,s=1===n.length,l=0,u=0;o<e.length;){var c=e.charAt(o);if(n.indexOf(c)>-1&&u%2===0&&!i?--a:c===t&&u%2===0&&s&&!i?++a:'"'===c&&l%2===0&&(i=!i),c===r?++u:u=0,"\\"===c?++l:l=0,++o,0===a)return{first:e.slice(0,o),second:e.slice(o)}}throw H.syntaxError(R().syntaxErrors.stringUtils_missingClosingChar,void 0,n.split("").join("' / '"),t)}},{key:"skipWhitespacesAndChar",value:function(e,t){for(var n=!1,r=0;r<e.length;)if(e.charAt(r).match(/\s/))++r;else{if(e.charAt(r)!==t||n)break;n=!0,++r}if(!n)throw H.syntaxError(R().syntaxErrors.stringUtils_charNotFound,void 0,t);return e.substring(r)}}]),e}(),re=function(){function e(){Object(l.a)(this,e),this.resultRelation=void 0}return Object(u.a)(e,[{key:"isEvaluated",value:function(){return void 0!==this.resultRelation}},{key:"getResult",value:function(){return void 0===this.resultRelation&&this.eval(),this.resultRelation}}]),e}(),ae=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this)).resultRelation=e,r}return Object(u.a)(n,[{key:"eval",value:function(){}},{key:"fakeEval",value:function(e){return{result:this.resultRelation,whispers:[],errors:[]}}},{key:"printInLine",value:function(){return this.resultRelation.getName()}},{key:"getOperationName",value:function(){return this.resultRelation.getName()}},{key:"getOperationSymbol",value:function(){return""}}]),n}(re),oe=function(){function e(t,n){Object(l.a)(this,e),this.str=t,this.chars=n}return Object(u.a)(e,null,[{key:"new",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t,t.split("").map((function(e,t){return{char:e,index:t+n}})))}},{key:"empty",value:function(){return new e("",[])}},{key:"newFromArray",value:function(t){return new e(t.map((function(e){return e.char})).join(""),t)}}]),Object(u.a)(e,[{key:"toString",value:function(){return this.str}},{key:"length",value:function(){return this.str.length}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"getChars",value:function(){return this.chars}},{key:"getFirstIndex",value:function(){return this.isEmpty()?NaN:this.chars[0].index}},{key:"getLastIndex",value:function(){return this.isEmpty()?NaN:this.chars[this.length()-1].index}},{key:"getRange",value:function(){if(!this.isEmpty())return{start:this.chars[0].index,end:this.chars[this.length()-1].index}}},{key:"charAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].char}},{key:"indexAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].index}},{key:"split",value:function(t){var n=this;if(this.isEmpty())return""===t?[]:[e.empty()];var r=t.length,a=this.str.split(t),o=Array(a.length);o[0]=0;for(var i=1;i<a.length;i++)o[i]=o[i-1]+a[i-1].length+r;return a.map((function(t,r){return new e(t,n.chars.slice(o[r],o[r]+t.length))}))}},{key:"slice",value:function(t,n){var r=t<0?this.length()+t:t,a=void 0!==n?n<0?this.length()+n:n:this.length();if(r>a||r<0||a>this.length())throw new RangeError;return e.newFromArray(this.chars.slice(r,a))}},{key:"trim",value:function(){var t=this.str.trim();if(""===t)return new e("",[]);var n=this.str.indexOf(t.charAt(0));return e.newFromArray(this.chars.slice(n,n+t.length))}},{key:"concat",value:function(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.newFromArray((t=this.chars).concat.apply(t,Object(s.a)(r.map((function(e){return e.chars})))))}},{key:"startsWith",value:function(e,t){return this.str.startsWith(e,t)}},{key:"endsWith",value:function(e,t){return this.str.endsWith(e,t)}},{key:"replace",value:function(e,t){return this.str.replace(e,t)}},{key:"copy",value:function(){return new e(this.str,this.chars.map((function(e){return{char:e.char,index:e.index}})))}},{key:"containsAny",value:function(e){for(var t=0;t<e.length;++t)if(this.str.indexOf(e[t])>-1)return!0;return!1}}]),e}(),ie=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"isWord",value:function(e){return ne.isWord(e.toString())}},{key:"isName",value:function(e){return ne.isName(e.toString())}},{key:"isWhitespacesOnly",value:function(e){return ne.isWhitespacesOnly(e.toString())}},{key:"isLetter",value:function(e){return ne.isLetter(e.toString())}},{key:"isNameChar",value:function(e){return ne.isNameChar(e.toString())}},{key:"isDigit",value:function(e){return ne.isDigit(e.toString())}},{key:"isNumber",value:function(e){return ne.isNumber(e.toString())}},{key:"nextWord",value:function(e){var t=ne.nextWord(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextName",value:function(e){var t=ne.nextName(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNonWhitespacePart",value:function(e){var t=ne.nextNonWhitespacePart(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNumber",value:function(e){var t=ne.nextNumber(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextQuotedString",value:function(e){var t=ne.nextQuotedString(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length),error:g(t.error,{start:e.getFirstIndex(),end:e.getFirstIndex()})}}},{key:"nextBorderedPart",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0";try{var a=ne.nextBorderedPart(e.toString(),t,n,r);return{first:e.slice(0,a.first.length),second:e.slice(a.first.length)}}catch(o){throw g(o,{start:e.getFirstIndex(),end:e.getFirstIndex()})}}},{key:"deleteAllComments",value:function(e){for(var t=e.copy().getChars(),n=!1,r=!1,a=-1,o=0,i=0;i<t.length;++i){var s=t[i].char;'"'!==s||o%2!==0||r||-1!==a?"/"===s&&i+1<t.length&&"/"===t[i+1].char&&!n&&!r&&-1===a?(r=!0,t[i].char="\0",++i):"\n"===s?r=!1:"/"===s&&i+1<t.length&&"*"===t[i+1].char&&!n&&!r&&-1===a?(a=i,t[i].char="\0",t[++i].char=" "):"*"===s&&i+1<t.length&&"/"===t[i+1].char&&-1!==a&&(a=-1,t[i].char="\0",t[++i].char=" "):n=!n,"\\"===s?++o:o=0,(r||-1!==a)&&(t[i].char="\0")}var l=void 0;if(-1!==a){var u=t[a].index;l=H.syntaxError(R().syntaxErrors.stringUtils_missingClosingChar,{start:u,end:u+1},"*/","/*")}return{str:oe.newFromArray(t.filter((function(e){return"\0"!==e.char}))),err:l}}},{key:"skipWhitespacesAndChar",value:function(e,t){try{var n=ne.skipWhitespacesAndChar(e.toString(),t);return e.slice(e.length()-n.length)}catch(r){throw g(r,e.getRange())}}}]),e}(),se=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this)).subtree=void 0,r.subtree=e,r}return Object(u.a)(n,[{key:"getSubtree",value:function(){return this.subtree}}]),n}(re),le=function(){function e(t){var n=this;Object(l.a)(this,e),this.types=new Map,this.values=new Map,this.finished=void 0,t.forEach((function(e,t){n.values.set(t,null)})),this.types=t,this.finished=!1}return Object(u.a)(e,[{key:"isFinished",value:function(){return this.finished}},{key:"finish",value:function(){this.finished=!0}},{key:"getColumnNames",value:function(){return this.types.keys()}},{key:"addValue",value:function(e,t){return!(this.finished||!this.types.has(e))&&((null===t||typeof t===this.types.get(e))&&(this.values.set(e,t),!0))}},{key:"getValue",value:function(e){return this.values.get(e)}},{key:"getType",value:function(e){return this.types.get(e)}},{key:"getTypes",value:function(){return this.types}},{key:"getValues",value:function(){return this.values}},{key:"getOrderedPrintValues",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.values.get(e),a=t.types.get(e);if(void 0===r||void 0===a)throw H.codeError(R().codeErrors.row_absentColumn,e,Object(s.a)(t.types.values()).join(", "));if("string"===a){var o=String(r).replace(/\\"/g,'"').replace(/\\\\/g,"\\");n.push(o)}else n.push(String(r))})),n}},{key:"equals",value:function(t){return t instanceof e&&(Object(F.isEqual)(this.types,t.types)&&Object(F.isEqual)(this.values,t.values))}}]),e}(),ue=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this,r)).projection=void 0,a.stringRange=void 0,a.projection=e,a.stringRange=e.getRange(),a}return Object(u.a)(n,[{key:"parseProjection",value:function(){for(var e=new Set,t=this.projection.toString().replace(/]/g,","),n=this.stringRange.start,r=1,a=1;a<this.projection.length();++a)if(","===t.charAt(a)){var o=r===a?{start:n+r-1,end:n+a-1}:{start:n+r,end:n+a-1};e.add({str:t.slice(r,a).trim(),range:o}),r=a+1}return e}},{key:"eval",value:function(){if(!this.isEvaluated()){if(0===this.projection.toString().slice(1,-1).trim().length)throw H.semanticError(R().semanticErrors.projectionNode_emptyProjection,this.stringRange);var e=this.subtree.getResult(),t=Object(s.a)(this.parseProjection());t.forEach((function(t){if(!e.hasColumn(t.str))throw H.semanticError(R().semanticErrors.projectionNode_absentColumn,t.range,t.str)}));var n=t.map((function(e){return e.str})),r=new M(e.getName()+"[...]");e.forEachColumn((function(e,t){n.indexOf(t)>-1&&r.addColumn(t,e)})),e.getRows().forEach((function(e){var t=new le(r.getColumns());e.getValues().forEach((function(e,r){n.indexOf(r)>-1&&t.addValue(r,e)})),r.addRow(t)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=new M(t.result.name+"[...]");if(0===this.projection.toString().slice(1,-1).trim().length)return r.push(H.semanticError(R().semanticErrors.projectionNode_emptyProjection,this.stringRange)),{result:a,whispers:n,errors:r};var o=this.parseProjection(),i=[];return o.forEach((function(e){var n=e.str;t.result.hasColumn(n)?a.addColumn(n,t.result.getColumns().get(n)):i.push(e)})),i.forEach((function(e){r.push(H.semanticError(R().semanticErrors.projectionNode_absentColumn,e.range,e.str))})),{result:a,whispers:n,errors:r}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return R().operations.projection}},{key:"getOperationSymbol",value:function(){return this.projection.replace(/\s+/g," ")}}]),n}(se),ce=n(25),pe=["null","true","false",""],he=["F","L","R",""];function fe(e){return pe.indexOf(e.toString().toLowerCase())>-1}var de,me=function(){function e(){Object(l.a)(this,e),this.map=new Map}return Object(u.a)(e,[{key:"get",value:function(e){var t=this.map.get(e.toString());return void 0===t?void 0:t.value}},{key:"set",value:function(e,t){this.map.set(e.toString(),{key:e,value:t})}},{key:"delete",value:function(e){return this.map.delete(e.toString())}},{key:"has",value:function(e){return this.map.has(e.toString())}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(e){Object(s.a)(this.map.values()).forEach((function(t,n){return e(t.value,t.key,n)}))}}]),e}(),ve=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this,r)).rename=void 0,a.stringRange=void 0,a.rename=e,a.stringRange=e.getRange(),a}return Object(u.a)(n,[{key:"parseChanges",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){if(e)throw t;n.push(t)},a=this.rename.slice(1,-1).split(","),o=new me,i=Object(ce.a)(a);try{for(i.s();!(t=i.n()).done;){var s=t.value,l=s.split("->").map((function(e){return e.trim()})),u=!1,c=!1;if(2!==l.length){var p=s.getRange();s.isEmpty()&&void 0!==this.stringRange&&(p={start:this.stringRange.start,end:this.stringRange.start}),r(H.syntaxError(R().syntaxErrors.renameNode_missingArrow,p)),u=!0,c=!0}!u&&o.has(l[0])&&(r(H.syntaxError(R().syntaxErrors.renameNode_multipleRenameOfTheColumn,l[0].getRange(),l[0].toString())),u=!0),c||ne.isName(l[1].toString())||(r(H.syntaxError(R().syntaxErrors.renameNode_invalidNewName,l[1].getRange(),l[1].toString())),c=!0),!c&&fe(l[1])&&(r(H.syntaxError(R().syntaxErrors.renameNode_keywordNewName,l[1].getRange(),l[1].toString())),c=!0),u||c?u?c||o.set(oe.empty(),l[0]):o.set(l[0],l[0]):o.set(l[0],l[1])}}catch(h){i.e(h)}finally{i.f()}return o}},{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.parseChanges(!0),n=this.subtree.getResult();t.forEach((function(e,t){if(-1===n.getColumnNames().indexOf(t.toString()))throw H.semanticError(R().semanticErrors.renameNode_absentOriginalColumn,t.getRange(),t.toString())}));var r=new M(n.getName()+"<...>"),a=new Map;n.forEachColumn((function(e,n){t.has(n)?a.set(n,e):r.addColumn(n,e)})),a.forEach((function(n,a){if(!r.addColumn(t.get(a).toString(),n)){var o=t.get(a);throw H.semanticError(R().semanticErrors.renameNode_changeToDuplicit,e.rename.getRange(),o?o.toString():"")}})),n.getRows().forEach((function(e){var n=new le(r.getColumns());e.getValues().forEach((function(e,r){var a=t.get(r);"undefined"===typeof a?n.addValue(r,e):n.addValue(a.toString(),e)})),r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=this.parseChanges(!1,r),o=new M(t.result.getName()+"<...>");t.result.forEachColumn((function(e,t){a.has(t)||o.addColumn(t,e)}));var i=[],s=[];return a.forEach((function(e,n){var r=n.toString(),a=e.toString();t.result.hasColumn(r)||n.isEmpty()?o.addColumn(a,t.result.getColumns().get(r))||s.push(e):i.push(n)})),i.forEach((function(e){r.push(H.semanticError(R().semanticErrors.renameNode_absentOriginalColumn,e.getRange(),e.toString()))})),s.forEach((function(e){r.push(H.semanticError(R().semanticErrors.renameNode_changeToDuplicit,e.getRange(),e.toString()))})),{result:o,whispers:n,errors:r}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return R().operations.rename}},{key:"getOperationSymbol",value:function(){return this.rename.replace(/\s+/g," ")}}]),n}(se),ge=function e(){Object(l.a)(this,e)};!function(e){e[e.equal=0]="equal",e[e.nonEqual=1]="nonEqual",e[e.less=2]="less",e[e.more=3]="more",e[e.lessOrEqual=4]="lessOrEqual",e[e.moreOrEqual=5]="moreOrEqual"}(de||(de={}));var ye,be=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,o){var i;return Object(l.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(u.a)(n,null,[{key:"equal",value:function(e,t,r){return new n(de.equal,e,t,r)}},{key:"nonEqual",value:function(e,t,r){return new n(de.nonEqual,e,t,r)}},{key:"less",value:function(e,t,r){return new n(de.less,e,t,r)}},{key:"more",value:function(e,t,r){return new n(de.more,e,t,r)}},{key:"lessOrEqual",value:function(e,t,r){return new n(de.lessOrEqual,e,t,r)}},{key:"moreOrEqual",value:function(e,t,r){return new n(de.moreOrEqual,e,t,r)}}]),Object(u.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("null"!==t.type&&"null"!==n.type&&t.type!==n.type)throw H.syntaxError(R().syntaxErrors.comparingOperator_differentInputTypes,this.operator.getRange(),this.operator.toString(),t.type,n.type);return null===t.value&&null===n.value&&"null"!==t.type&&"null"!==n.type?{value:!1,type:"boolean"}:this.type===de.equal?{value:t.value===n.value,type:"boolean"}:this.type===de.nonEqual?null===t.value&&"null"!==t.type||null===n.value&&"null"!==n.type?{value:!1,type:"boolean"}:{value:t.value!==n.value,type:"boolean"}:this.type===de.less?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<n.value,type:"boolean"}:this.type===de.more?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>n.value,type:"boolean"}:this.type===de.lessOrEqual?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<=n.value,type:"boolean"}:null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>=n.value,type:"boolean"}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(ge);!function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(ye||(ye={}));var Ee,xe=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,o){var i;return Object(l.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(u.a)(n,null,[{key:"and",value:function(e,t,r){return new n(ye.and,e,t,r)}},{key:"or",value:function(e,t,r){return new n(ye.or,e,t,r)}},{key:"not",value:function(e,t){return new n(ye.not,e,t)}}]),Object(u.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e);if("boolean"!==t.type)throw H.syntaxError(R().syntaxErrors.logicalOperator_leftInputNotBoolean,this.operator.getRange(),this.operator.toString(),t.type);if(this.type===ye.not)return null===t.value?{value:!1,type:"boolean"}:{value:!t.value,type:"boolean"};var n=this.right.eval(e);if("boolean"!==n.type)throw H.syntaxError(R().syntaxErrors.logicalOperator_rightInputNotBoolean,this.operator.getRange(),this.operator.toString(),n.type);return this.type===ye.and?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value&&n.value,type:"boolean"}:null===t.value&&null===n.value?{value:!1,type:"boolean"}:null===t.value?{value:n.value,type:"boolean"}:null===n.value?{value:t.value,type:"boolean"}:{value:t.value||n.value,type:"boolean"}}},{key:"toString",value:function(){return this.type===ye.not?this.operator.toString()+"("+this.left.toString()+")":"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(ge),ke=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this)).value=e,a.type=r,a}return Object(u.a)(n,[{key:"eval",value:function(e){return{value:this.value,type:this.type}}},{key:"toString",value:function(){return null===this.value?"null":this.value.toString()}}]),n}(ge),Se=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this)).columnName=e,r}return Object(u.a)(n,[{key:"eval",value:function(e){var t=e.getValue(this.columnName.toString()),n=e.getType(this.columnName.toString());if(void 0===t||void 0===n)throw H.semanticError(R().semanticErrors.referenceValue_absentColumn,this.columnName.getRange(),this.columnName.toString(),Object(s.a)(e.getColumnNames()).join(", "));return{value:t,type:n}}},{key:"toString",value:function(){return this.columnName.toString()}}]),n}(ge);!function(e){e.plus="+",e.minus="-",e.multiplication="*",e.division="/"}(Ee||(Ee={}));var Re=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,o){var i;return Object(l.a)(this,n),(i=t.call(this)).type=e,i.left=r,i.right=a,i.range=o,i}return Object(u.a)(n,null,[{key:"add",value:function(e,t,r){return new n(Ee.plus,e,t,r)}},{key:"deduct",value:function(e,t,r){return new n(Ee.minus,e,t,r)}},{key:"multiply",value:function(e,t,r){return new n(Ee.multiplication,e,t,r)}},{key:"divide",value:function(e,t,r){return new n(Ee.division,e,t,r)}}]),Object(u.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("number"!==t.type||"number"!==n.type)throw H.syntaxError(R().syntaxErrors.computingOperator_inputTypesNotNumbers,this.range,this.type,t.type,n.type);if(null===t.value||null===n.value)return{value:null,type:"number"};switch(this.type){case Ee.plus:return{value:t.value+n.value,type:"number"};case Ee.minus:return{value:t.value-n.value,type:"number"};case Ee.multiplication:return{value:t.value*n.value,type:"number"};case Ee.division:return{value:t.value/n.value,type:"number"}}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.type+" "+this.right.toString()+")"}}]),n}(ge),we=function(){function e(t){Object(l.a)(this,e),this.str=t}return Object(u.a)(e,[{key:"getRange",value:function(){return this.str.getRange()}}]),e}(),Ce=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this,e)).precedence=r,a}return n}(we),je=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,50)}return n}(Ce),Oe=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,10)}return n}(Ce),Ne=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,5)}return n}(Ce),Te=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,30)}return n}(Ce),Pe=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,30)}return n}(Ce),Ae=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,25)}return n}(Ce),_e=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e,25)}return n}(Ce),Ve=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this,r,20)).type=e,a}return n}(Ce),Ie=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return n}(we),Le=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return n}(Ie),De=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return n}(Ie),Be=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,e)).value=r,o.type=a,o}return n}(we),ze=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return n}(we),We=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"parse",value:function(t,n){var r=e.parseTokens(t,n,!0);this.assertValidInfixTokens(r,!0),r=this.simplify(r);try{var a=e.toRPN(r);return e.rpnToVETree(a)}catch(o){throw g(o,t.getRange())}}},{key:"fakeParse",value:function(t,n,r){var a=[],o=e.parseTokens(t,n,!1,a);return o.forEach((function(e){e instanceof ze&&-1===r.indexOf(e.str.toString())&&a.push(H.semanticError(R().semanticErrors.referenceValue_absentColumn,e.str.getRange(),e.str.toString(),r.join(", ")))})),this.assertValidInfixTokens(o,!1,a),a}},{key:"parseTokens",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(e){if(n)throw e;r.push(e)},o=e.trim();o.isEmpty()&&a(H.syntaxError(R().syntaxErrors.valueParser_emptyInput,void 0));for(var i=[];!o.isEmpty();){if(o.startsWith("("))i.push(new Le(o.slice(0,1))),o=o.slice(1);else if(o.startsWith(")"))i.push(new De(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("+"))i.push(new Ae(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("-"))i.push(new _e(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("*"))i.push(new Te(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("/"))i.push(new Pe(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("=="))i.push(new Ve(de.equal,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("="))i.push(new Ve(de.equal,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!="))i.push(new Ve(de.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<>"))i.push(new Ve(de.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<="))i.push(new Ve(de.lessOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith(">="))i.push(new Ve(de.moreOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<"))i.push(new Ve(de.less,o.slice(0,1))),o=o.slice(1);else if(o.startsWith(">"))i.push(new Ve(de.more,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!")||o.startsWith("~")||o.startsWith("\xac"))i.push(new je(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("&&"))i.push(new Oe(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("&")||o.startsWith("\u2227"))i.push(new Oe(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("||"))i.push(new Ne(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("|")||o.startsWith("\u2228"))i.push(new Ne(o.slice(0,1))),o=o.slice(1);else if(o.startsWith('"')){var s=ie.nextQuotedString(o);void 0!==s.error&&a(s.error);var l=s.first.length()>1?-1:void 0,u=s.first.slice(1,l);i.push(new Be(u,u.toString(),"string")),o=s.second}else if(ne.isDigit(o.charAt(0))){var c=ie.nextNumber(o);i.push(new Be(c.first,Number(c.first.toString()),"number")),o=c.second}else if(o.startsWith("null"))t||a(H.syntaxError(R().syntaxErrors.valueParser_unsupportedNull,o.slice(0,4).getRange())),i.push(new Be(o.slice(0,4),null,"null")),o=o.slice(4);else if(o.startsWith("true")||o.startsWith("True")||o.startsWith("TRUE"))i.push(new Be(o.slice(0,4),!0,"boolean")),o=o.slice(4);else if(o.startsWith("false")||o.startsWith("False")||o.startsWith("FALSE"))i.push(new Be(o.slice(0,5),!1,"boolean")),o=o.slice(5);else if(ne.isLetter(o.charAt(0))||"_"===o.charAt(0)){var p=ie.nextName(o);i.push(new ze(p.first)),o=p.second}else{var h=ie.nextNonWhitespacePart(o);a(H.syntaxError(R().syntaxErrors.valueParser_unexpectedPart,h.first.getRange(),h.first.toString())),o=o.slice(h.first.length())}o=o.trim()}return i}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0!==e.length){var r=function(e){if(t)throw e;n.push(e)};(e[0]instanceof De||e[0]instanceof Ce&&!(e[0]instanceof je))&&r(H.syntaxError(R().syntaxErrors.valueParser_invalidStart,e[0].getRange(),e[0].str.toString())),(e[e.length-1]instanceof Le||e[e.length-1]instanceof Ce)&&r(H.syntaxError(R().syntaxErrors.valueParser_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString()));for(var a=1;a<e.length;){var o=e[a-1],i=e[a];++a,i instanceof Be?(o instanceof Be&&r(H.syntaxError(R().syntaxErrors.valueParser_literalAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof ze&&r(H.syntaxError(R().syntaxErrors.valueParser_literalAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof De&&r(H.syntaxError(R().syntaxErrors.valueParser_literalAfterClosing,i.getRange(),i.str.toString()))):i instanceof ze?(o instanceof Be&&r(H.syntaxError(R().syntaxErrors.valueParser_referenceAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof ze&&r(H.syntaxError(R().syntaxErrors.valueParser_referenceAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof De&&r(H.syntaxError(R().syntaxErrors.valueParser_referenceAfterClosing,i.getRange(),i.str.toString()))):i instanceof je?(o instanceof Be&&r(H.syntaxError(R().syntaxErrors.valueParser_notAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof ze&&r(H.syntaxError(R().syntaxErrors.valueParser_notAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof De&&r(H.syntaxError(R().syntaxErrors.valueParser_notAfterClosing,i.getRange(),i.str.toString()))):i instanceof Ce?(o instanceof Ce&&r(H.syntaxError(R().syntaxErrors.valueParser_binaryAfterOperator,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Le&&r(H.syntaxError(R().syntaxErrors.valueParser_binaryAfterOpening,i.getRange(),i.str.toString()))):i instanceof Le?(o instanceof Be&&r(H.syntaxError(R().syntaxErrors.valueParser_openingAfterLiteral,i.getRange(),o.str.toString())),o instanceof ze&&r(H.syntaxError(R().syntaxErrors.valueParser_openingAfterReference,i.getRange(),o.str.toString())),o instanceof De&&r(H.syntaxError(R().syntaxErrors.valueParser_openingAfterClosing,i.getRange()))):i instanceof De&&(o instanceof Ce&&r(H.syntaxError(R().syntaxErrors.valueParser_closingAfterOperator,i.getRange(),o.str.toString())),o instanceof Le&&r(H.syntaxError(R().syntaxErrors.valueParser_closingAfterOpening,i.getRange())))}}}},{key:"simplify",value:function(e){var t=[],n=new Set;e.forEach((function(e,n){e instanceof je&&t.push(n)}));for(var r=1;r<t.length;++r)t[r-1]+1===t[r]&&(n.add(t[r-1]),n.add(t[r]),t[r]=NaN);return 0===n.size?e:e.filter((function(e,t){return!n.has(t)}))}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof Be||e instanceof ze)t.push(e);else if(e instanceof Ce){for(;n.length>0&&n[n.length-1]instanceof Ce;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof Le)n.push(e);else if(e instanceof De)for(;;){if(0===n.length)throw H.syntaxError(R().syntaxErrors.valueParser_missingOpeningParenthesis,void 0);if(n[n.length-1]instanceof Le){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof Le)throw H.syntaxError(R().syntaxErrors.valueParser_missingClosingParenthesis,void 0);t.push(r)}return t}},{key:"rpnToVETree",value:function(e){var t=this.rpnToVETreeRecursive(e);if(e.length>0)throw H.syntaxError(R().syntaxErrors.valueParser_invalidExpression,void 0);return t}},{key:"rpnToVETreeRecursive",value:function(t){if(0===t.length)throw H.syntaxError(R().syntaxErrors.valueParser_invalidExpression,void 0);var n=t.pop();if(n instanceof je){var r=e.rpnToVETreeRecursive(t);return xe.not(n.str,r)}if(n instanceof Oe){var a=e.rpnToVETreeRecursive(t),o=e.rpnToVETreeRecursive(t);return xe.and(n.str,o,a)}if(n instanceof Ne){var i=e.rpnToVETreeRecursive(t),s=e.rpnToVETreeRecursive(t);return xe.or(n.str,s,i)}if(n instanceof Ve){var l=e.rpnToVETreeRecursive(t),u=e.rpnToVETreeRecursive(t);return new be(n.type,n.str,u,l)}if(n instanceof Be)return new ke(n.value,n.type);if(n instanceof ze)return new Se(n.str);if(n instanceof Ae){var c=e.rpnToVETreeRecursive(t),p=e.rpnToVETreeRecursive(t);return Re.add(p,c,n.getRange())}if(n instanceof _e){var h=e.rpnToVETreeRecursive(t),f=e.rpnToVETreeRecursive(t);return Re.deduct(f,h,n.getRange())}if(n instanceof Te){var d=e.rpnToVETreeRecursive(t),m=e.rpnToVETreeRecursive(t);return Re.multiply(m,d,n.getRange())}if(n instanceof Pe){var v=e.rpnToVETreeRecursive(t),g=e.rpnToVETreeRecursive(t);return Re.divide(g,v,n.getRange())}throw H.codeError(R().codeErrors.valueParser_unexpectedToken,JSON.stringify(n))}}]),e}(),Ue=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(l.a)(this,n),(a=t.call(this)).leftSubtree=void 0,a.rightSubtree=void 0,a.leftSubtree=e,a.rightSubtree=r,a}return Object(u.a)(n,[{key:"getLeftSubtree",value:function(){return this.leftSubtree}},{key:"getRightSubtree",value:function(){return this.rightSubtree}},{key:"fakeEvalBinary",value:function(e,t){var n,r=this.leftSubtree.fakeEval(e),a=this.rightSubtree.fakeEval(e),o=new M("Binary");return"left"!==t&&"union"!==t||r.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),"right"!==t&&"union"!==t||a.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),(n=r.errors).push.apply(n,Object(s.a)(a.errors)),{result:o,whispers:0!==r.whispers.length?r.whispers:a.whispers,errors:r.errors}}}]),n}(re);function Je(e,t){var n=0;return function e(r){if(n===t)return r;if(n++,r instanceof se)return e(r.getSubtree());if(r instanceof Ue){var a=e(r.getLeftSubtree());return null===a?e(r.getRightSubtree()):a}return null}(e)}function Fe(e){if(e instanceof Ue){var t=Fe(e.getLeftSubtree()),n=Fe(e.getRightSubtree());return Math.max(t,n)+1}return e instanceof se?Fe(e.getSubtree())+1:0}function Me(e,t,n){if(void 0!==t&&t.start<e&&e<=t.end){for(var r=t.end-t.start,a=n.toString(),o=e-t.start,i=!1,s=0,l=0;l<r;++l){var u=a.charAt(l);if('"'===u&&s%2===0&&(i=!i),i&&"\\"===u?++s:s=0,l===o-1)return!i&&n.getChars().some((function(t){return t.index===e-1}))}console.warn("isInRangeAndNotInQuotes outside range")}return!1}var qe,He=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,r)).selection=void 0,o.stringRange=void 0,o.nullValuesSupport=void 0,o.selection=e,o.stringRange=e.getRange(),o.nullValuesSupport=a,o}return Object(u.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=We.parse(this.selection.slice(1,-1),this.nullValuesSupport)}catch(a){throw g(a,this.stringRange)}var n=this.subtree.getResult(),r=new M(n.name+"(...)");n.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.getRows().forEach((function(n){var a=t.eval(n);if("boolean"!==a.type)throw H.syntaxError(R().syntaxErrors.selectionNode_resultNotBoolean,e.stringRange,e.selection.replace(/\s+/g," "),a.type);a.value&&r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.result,r=t.whispers,a=t.errors,o=new M(n.getName()+"(...)");return n.forEachColumn((function(e,t){o.addColumn(t,e)})),n=o,Me(e,this.stringRange,this.selection)&&(r=n.getColumnNames()),0===this.selection.toString().slice(1,-1).trim().length?a.push(H.syntaxError(R().syntaxErrors.valueParser_emptyInput,this.stringRange)):a.push.apply(a,Object(s.a)(We.fakeParse(this.selection.slice(1,-1),this.nullValuesSupport,n.getColumnNames()))),{result:n,whispers:r,errors:a}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return R().operations.selection}},{key:"getOperationSymbol",value:function(){return this.selection.replace(/\s+/g," ")}}]),n}(se);!function(e){e.left="\u22b3",e.right="\u22b2"}(qe||(qe={}));var Ke,Ge=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(u.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e,t,n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult(),a=n.getColumnNames().filter((function(e){return r.hasColumn(e)})),o=new M("("+n.getName()+this.type+r.getName()+")");this.type===qe.left?(n.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=n.getRows(),t=r.getRows()):(r.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=r.getRows(),t=n.getRows()),e.forEach((function(e){if(!t.some((function(t){return a.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var n=new le(o.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),o.addRow(n)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.type===qe.left?"left":"right";return this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=R().operations;return this.type===qe.left?e.leftAntijoin:e.rightAntijoin}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ue),Ze=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(u.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=new M("("+t.getName()+"\u2a2f"+n.getName()+")");t.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.forEachColumn((function(t,n){if(!r.addColumn(n,t))throw H.semanticError(R().semanticErrors.binaryNode_commonColumns,e.stringRange,"cartesian product",n)})),t.getRows().forEach((function(e){n.getRows().forEach((function(t){var n=new le(r.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),t.getValues().forEach((function(e,t){return n.addValue(t,e)})),r.addRow(n)}))})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t,n=this.leftSubtree.fakeEval(e),r=this.rightSubtree.fakeEval(e),a=new M("");n.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),r.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),(t=n.errors).push.apply(t,Object(s.a)(r.errors));var o=[];return n.result.getColumnNames().forEach((function(e){r.result.hasColumn(e)&&o.push(e)})),o.length>0&&n.errors.push(H.semanticError(R().semanticErrors.binaryNode_commonColumns,this.stringRange,"cartesian product",o.join('", "'))),{result:a,whispers:0!==n.whispers.length?n.whispers:r.whispers,errors:n.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return R().operations.cartesianProduct}},{key:"getOperationSymbol",value:function(){return"\u2a2f"}}]),n}(Ue),Qe=n(29),Xe=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(u.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=e.getColumns(),r=t.getColumns();if(!Object(s.a)(r).every((function(e){return n.has(e[0])&&n.get(e[0])===e[1]})))throw H.semanticError(R().semanticErrors.divisionNode_rightColumnsNotSubset,this.stringRange,t.getSchemaString(),e.getSchemaString());var a=new Map;if(n.forEach((function(e,t){r.has(t)||a.set(t,e)})),0===a.size)throw H.semanticError(R().semanticErrors.divisionNode_rightColumnsNotProperSubset,this.stringRange,t.getNamesSchemaString(),e.getNamesSchemaString());var o=new M("("+e.getName()+"\xf7"+t.getName()+")");a.forEach((function(e,t){return o.addColumn(t,e)}));var i=e.getRows(),l=t.getRows();i.forEach((function(e){if(l.every((function(t){var r=new le(n);return a.forEach((function(t,n){return r.addValue(n,e.getValue(n))})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),Object(s.a)(i).some((function(e){return e.equals(r)}))}))){var t=new le(o.getColumns());a.forEach((function(n,r){return t.addValue(r,e.getValue(r))})),o.addRow(t)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=t.result.getColumns(),a=n.result.getColumns(),o=new Map(Object(s.a)(r.entries()).filter((function(e){var t=Object(Qe.a)(e,2),n=t[0];t[1];return!a.has(n)}))),i=new M("("+t.result.getName()+"\xf7"+n.result.getName()+")");o.forEach((function(e,t){return i.addColumn(t,e)}));var l=t.errors;return l.push.apply(l,Object(s.a)(n.errors)),Object(s.a)(a).every((function(e){return r.has(e[0])&&r.get(e[0])===e[1]}))||""===t.result.getName()?0===o.size&&""!==t.result.getName()&&l.push(H.semanticError(R().semanticErrors.divisionNode_rightColumnsNotProperSubset,this.stringRange,n.result.getNamesSchemaString(),t.result.getNamesSchemaString())):l.push(H.semanticError(R().semanticErrors.divisionNode_rightColumnsNotSubset,this.stringRange,n.result.getSchemaString(),t.result.getSchemaString())),{result:i,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:t.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return R().operations.division}},{key:"getOperationSymbol",value:function(){return"\xf7"}}]),n}(Ue);!function(e){e.left="*L*",e.right="*R*",e.full="*F*"}(Ke||(Ke={}));var $e,Ye=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(u.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=new M("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return n.addColumn(t,e)})),t.forEachColumn((function(e,t){return n.addColumn(t,e)}));var r=e.getRows(),a=t.getRows(),o=e.getColumnNames().filter((function(e){return t.hasColumn(e)}));r.forEach((function(e){a.forEach((function(t){if(o.every((function(n){return e.getValue(n)===t.getValue(n)}))){var r=new le(n.getColumns());e.getValues().forEach((function(e,t){return r.addValue(t,e)})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),n.addRow(r)}}))})),this.type!==Ke.left&&this.type!==Ke.full||r.forEach((function(e){if(!a.some((function(t){return o.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var t=new le(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.type!==Ke.right&&this.type!==Ke.full||a.forEach((function(e){if(!r.some((function(t){return o.every((function(n){return t.getValue(n)===e.getValue(n)}))}))){var t=new le(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){return this.fakeEvalBinary(e,"union")}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=R().operations;return this.type===Ke.left?e.leftOuterJoin:this.type===Ke.right?e.rightOuterJoin:e.fullOuterJoin}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ue);!function(e){e.natural="*",e.leftSemi="<*",e.rightSemi="*>"}($e||($e={}));var et,tt=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var o;return Object(l.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(u.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=t.getColumnNames().filter((function(e){return n.hasColumn(e)})),a=new M("("+t.getName()+this.type+n.getName()+")");this.type!==$e.leftSemi&&this.type!==$e.natural||t.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==$e.rightSemi&&this.type!==$e.natural||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),t.getRows().forEach((function(t){n.getRows().forEach((function(n){if(Object(s.a)(r).every((function(e){return t.getValue(e)===n.getValue(e)}))){var o=new le(a.getColumns());e.type!==$e.leftSemi&&e.type!==$e.natural||t.getValues().forEach((function(e,t){return o.addValue(t,e)})),e.type!==$e.rightSemi&&e.type!==$e.natural||n.getValues().forEach((function(e,t){return o.addValue(t,e)})),a.addRow(o)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t="union";return this.type===$e.leftSemi?t="left":this.type===$e.rightSemi&&(t="right"),this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=R().operations;return this.type===$e.leftSemi?e.leftSemiJoin:this.type===$e.rightSemi?e.rightSemiJoin:e.naturalJoin}},{key:"getOperationSymbol",value:function(){return"*"}},{key:"getType",value:function(){return this.type}}]),n}(Ue);!function(e){e.union="\u222a",e.intersection="\u2229",e.difference="\\"}(et||(et={}));var nt,rt=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,o){var i;return Object(l.a)(this,n),(i=t.call(this,r,a)).stringRange=o,i.type=void 0,i.type=e,i}return Object(u.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult();if(!Object(F.isEqual)(e.getColumns(),t.getColumns())){var n=this.getOperationName().toLowerCase();throw H.semanticError(R().semanticErrors.setOperationNode_notEqualColumns,this.stringRange,e.getSchemaString(),t.getSchemaString(),n)}var r=new M("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return r.addColumn(t,e)}));var a=e.getRows(),o=t.getRows();(this.type===et.union?[].concat(Object(s.a)(a),Object(s.a)(o)):this.type===et.intersection?Object(s.a)(a).filter((function(e){return Object(s.a)(o).some((function(t){return e.equals(t)}))})):Object(s.a)(a).filter((function(e){return!Object(s.a)(o).some((function(t){return e.equals(t)}))}))).forEach((function(e){return r.addRow(e)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=new M("("+t.result.getName()+this.type+n.result.getName()+")");t.result.forEachColumn((function(e,t){n.result.hasColumn(t)&&r.addColumn(t,e)}));var a=t.errors;if(a.push.apply(a,Object(s.a)(n.errors)),!Object(F.isEqual)(t.result.getColumns(),n.result.getColumns())&&""!==t.result.getName()&&""!==n.result.getName()){var o=this.getOperationName().toLowerCase();a.push(H.semanticError(R().semanticErrors.setOperationNode_notEqualColumns,this.stringRange,t.result.getSchemaString(),n.result.getSchemaString(),o))}return{result:r,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:t.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=R().operations;return this.type===et.union?e.union:this.type===et.intersection?e.intersection:e.difference}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ue);!function(e){e.full="[]",e.left="\u27e8]",e.right="[\u27e9"}(nt||(nt={}));var at=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,o,i){var s;return Object(l.a)(this,n),(s=t.call(this,a,o)).type=void 0,s.condition=void 0,s.stringRange=void 0,s.nullValuesSupport=void 0,s.condition=r,s.stringRange=r.getRange(),s.nullValuesSupport=i,s.type=e,s}return Object(u.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=We.parse(this.condition.slice(1,-1),this.nullValuesSupport)}catch(i){throw g(i,this.stringRange)}var n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult();n.getColumnNames().forEach((function(t){if(r.hasColumn(t))throw H.semanticError(R().semanticErrors.binaryNode_commonColumns,e.stringRange,e.getOperationName().toLowerCase(),t)}));var a=new M("("+n.getName()+this.type.charAt(0)+"..."+this.type.charAt(1)+r.getName()+")");this.type!==nt.left&&this.type!==nt.full||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==nt.right&&this.type!==nt.full||r.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=new Map(n.getColumns());r.forEachColumn((function(e,t){return o.set(t,e)})),n.getRows().forEach((function(n){r.getRows().forEach((function(r){var i=new le(o);n.getValues().forEach((function(e,t){return i.addValue(t,e)})),r.getValues().forEach((function(e,t){return i.addValue(t,e)}));var s=t.eval(i);if("boolean"!==s.type)throw H.syntaxError(R().syntaxErrors.thetaJoinNode_resultNotBoolean,e.stringRange,e.condition.replace(/\s+/g," "),s.type);if(s.value){var l=new le(a.getColumns());e.type!==nt.left&&e.type!==nt.full||n.getValues().forEach((function(e,t){return l.addValue(t,e)})),e.type!==nt.right&&e.type!==nt.full||r.getValues().forEach((function(e,t){return l.addValue(t,e)})),a.addRow(l)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=[];r.push.apply(r,Object(s.a)(t.result.getColumnNames())),r.push.apply(r,Object(s.a)(n.result.getColumnNames()));var a=new M(this.type);this.type!==nt.left&&this.type!==nt.full||t.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==nt.right&&this.type!==nt.full||n.result.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=0!==t.whispers.length?t.whispers:n.whispers;Me(e,this.stringRange,this.condition)&&(o=r);var i=t.errors;i.push.apply(i,Object(s.a)(n.errors));var l=[];return t.result.getColumnNames().forEach((function(e){n.result.hasColumn(e)&&l.push(e)})),l.length>0&&void 0!==this.stringRange&&i.push(H.semanticError(R().semanticErrors.binaryNode_commonColumns,{start:this.stringRange.start,end:this.stringRange.start},this.getOperationName().toLowerCase(),l.join('", "'))),0===this.condition.toString().slice(1,-1).trim().length?i.push(H.syntaxError(R().syntaxErrors.valueParser_emptyInput,this.stringRange)):i.push.apply(i,Object(s.a)(We.fakeParse(this.condition.slice(1,-1),this.nullValuesSupport,r))),{result:a,whispers:o,errors:i}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=R().operations;return this.type===nt.left?e.leftThetaSemiJoin:this.type===nt.right?e.rightThetaSemiJoin:e.thetaJoin}},{key:"getOperationSymbol",value:function(){return this.condition.replace(/\s+/g," ")}},{key:"getType",value:function(){return this.type}}]),n}(Ue),ot=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"createUnary",value:function(e,t,n,r){switch(e){case"projection":return new ue(r,t);case"rename":return new ve(r,t);case"selection":return new He(r,t,n)}}},{key:"createBinary",value:function(e,t,n,r,a){switch(e){case"left antijoin":return new Ge(qe.left,t,n);case"right antijoin":return new Ge(qe.right,t,n);case"cartesian product":return new Ze(t,n,a.getRange());case"division":return new Xe(t,n,a.getRange());case"natural join":return new tt($e.natural,t,n);case"left outer join":return new Ye(Ke.left,t,n);case"right outer join":return new Ye(Ke.right,t,n);case"full outer join":return new Ye(Ke.full,t,n);case"left semijoin":return new tt($e.leftSemi,t,n);case"right semijoin":return new tt($e.rightSemi,t,n);case"union":return new rt(et.union,t,n,a.getRange());case"intersection":return new rt(et.intersection,t,n,a.getRange());case"difference":return new rt(et.difference,t,n,a.getRange());case"theta join":return new at(nt.full,a,t,n,r);case"left theta semijoin":return new at(nt.left,a,t,n,r);case"right theta semijoin":return new at(nt.right,a,t,n,r)}}}]),e}(),it=function(){function e(t,n){Object(l.a)(this,e),this.relations=t,this.nullValuesSupport=n}return Object(u.a)(e,[{key:"parse",value:function(e){var t=ie.deleteAllComments(oe.new(e)),n=t.str,r=t.err;if(void 0!==r)throw r;var a=this.parseTokens(n).tokens;if(0===a.length)throw H.syntaxError(R().syntaxErrors.exprParser_emptyStringGiven,void 0);this.assertValidInfixTokens(a);var o=this.toRPN(a);return this.rpnToRATree(o)}},{key:"fakeParse",value:function(e,t){if(""===e.trim())return{whispers:Object(s.a)(this.relations.keys()),errors:[],parentheses:[]};var n=ie.deleteAllComments(oe.new(e)),r=n.str,a=n.err,o=this.parseTokens(r,!1,t),i=o.whispers,l=o.tokens,u=o.errors,c=o.parentheses;if(void 0!==a&&u.push(a),0===l.length)return{whispers:i,errors:u,parentheses:c};this.assertValidInfixTokens(l,!1,u);var p=this.toRPN(l),h=this.rpnToRATree(p,!1,u).fakeEval(t);return u.push.apply(u,Object(s.a)(h.errors)),h.whispers.length>0?{whispers:h.whispers,errors:u,parentheses:c}:{whispers:i,errors:u,parentheses:c}}},{key:"parseTokens",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;if(e.isEmpty())return{tokens:[],whispers:Object(s.a)(this.relations.keys()),errors:[],parentheses:[]};for(var r=[],a=0===n?Object(s.a)(this.relations.keys()):[],o=[],i=[],l=function(e){if(t)throw e;o.push(e)},u=function(e){i.push({start:e.getFirstIndex(),end:e.getLastIndex()})},c=!1,p=e;!p.isEmpty();){var h=p.getFirstIndex();if(h===n&&(a=Object(s.a)(this.relations.keys())),p.startsWith("(")){var f=void 0;try{f=ie.nextBorderedPart(p,"(",")")}catch(T){if(T instanceof v&&l(T),c)r.push(ee.selection(p.concat(oe.new(")",p.getLastIndex()+1))));else{r.push(new X(p.slice(0,1)));var d,m=this.parseTokens(p.slice(1),t,n);if(o.push.apply(o,Object(s.a)(m.errors)),0===a.length)(d=a).push.apply(d,Object(s.a)(m.whispers));r.push.apply(r,Object(s.a)(m.tokens)),i.push.apply(i,Object(s.a)(m.parentheses)),r.push(new $(oe.new(")",NaN)))}break}if(u(f.first),c)r.push(ee.selection(f.first));else{r.push(new X(f.first.slice(0,1)));var g,y=this.parseTokens(f.first.slice(1,-1),t,n);if(o.push.apply(o,Object(s.a)(y.errors)),0===a.length)(g=a).push.apply(g,Object(s.a)(y.whispers));r.push.apply(r,Object(s.a)(y.tokens)),i.push.apply(i,Object(s.a)(y.parentheses)),r.push(new $(f.first.slice(-1))),c=!0}p=f.second}else if(p.startsWith("[")){var b=void 0,E=!1;try{b=ie.nextBorderedPart(p,"[","]\u27e9")}catch(T){E=!0,T instanceof v&&l(T),b={first:p.concat(oe.new("]",p.getLastIndex()+1)),second:oe.empty()}}u(b.first),E||b.first.getLastIndex()!==n-1||(a=Object(s.a)(this.relations.keys())),b.first.endsWith("\u27e9")?(r.push(te.rightThetaSemijoin(b.first)),c=!1,p=b.second):b.first.containsAny('=<>+/*&|~"()!')?(r.push(te.thetaJoin(b.first)),c=!1,p=b.second):(r.push(ee.projection(b.first)),c=!0,p=b.second)}else if(p.startsWith("*F*")||p.startsWith("*L*")||p.startsWith("*R*")){var x=p.slice(0,3);x.getLastIndex()===n-1&&(a=Object(s.a)(this.relations.keys())),p.startsWith("*F")?r.push(te.fullOuterJoin(x)):p.startsWith("*L")?r.push(te.leftOuterJoin(x)):r.push(te.rightOuterJoin(x)),p=p.slice(3),c=!1}else if(p.startsWith("<*")||p.startsWith("*>")){var k=p.slice(0,2);k.getLastIndex()===n-1&&(a=Object(s.a)(this.relations.keys())),p.startsWith("<*")?r.push(te.leftSemijoin(k)):r.push(te.rightSemijoin(k)),p=p.slice(2),c=!1}else if("*\u2a2f\u222a\u2229\\\u22b3\u22b2\xf7".indexOf(p.charAt(0))>-1){var S=p.slice(0,1);S.getLastIndex()===n-1&&(a=Object(s.a)(this.relations.keys())),p.startsWith("*")?r.push(te.naturalJoin(S)):p.startsWith("\u2a2f")?r.push(te.cartesianProduct(S)):p.startsWith("\u222a")?r.push(te.union(S)):p.startsWith("\u2229")?r.push(te.intersection(S)):p.startsWith("\\")?r.push(te.difference(S)):p.startsWith("\u22b3")?r.push(te.leftAntijoin(S)):p.startsWith("\u22b2")?r.push(te.rightAntijoin(S)):p.startsWith("\xf7")&&r.push(te.division(S)),p=p.slice(1),c=!1}else if(p.startsWith("<"))try{var w=ie.nextBorderedPart(p,"<",">","-");u(w.first),w.first.getLastIndex()===n-1&&(a=Object(s.a)(this.relations.keys())),r.push(ee.rename(w.first)),c=!0,p=w.second}catch(T){T instanceof v&&l(T),r.push(ee.rename(p.concat(oe.new(">",p.getLastIndex()+1))));break}else if(p.startsWith("\u27e8"))try{var C=ie.nextBorderedPart(p,"\u27e8","]");u(C.first),C.first.getLastIndex()===n-1&&(a=Object(s.a)(this.relations.keys())),r.push(te.leftThetaSemijoin(C.first)),c=!1,p=C.second}catch(T){T instanceof v&&l(T),r.push(te.leftThetaSemijoin(p.concat(oe.new("]",p.getLastIndex()+1))));break}else if(ne.isLetter(p.charAt(0))||"_"===p.charAt(0)){var j=ie.nextName(p);j.first.getFirstIndex()<=n-1&&n-1<=j.first.getLastIndex()&&(a=Object(s.a)(this.relations.keys())),r.push(new Y(j.first)),p=j.second,c=!0}else if(p.charAt(0).match(/\s/)){for(var O=0;O<p.length()&&p.charAt(O).match(/\s/);)p.indexAt(O)===n-1&&(a=Object(s.a)(this.relations.keys())),++O;p=p.slice(O)}else{var N=ie.nextNonWhitespacePart(p);l(H.syntaxError(R().syntaxErrors.exprParser_unexpectedPart,N.first.getRange(),N.first.toString())),p=p.slice(N.first.length())}}return{tokens:r,whispers:a,errors:o,parentheses:i}}},{key:"assertValidInfixTokens",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(r,a,o,i){for(var s=arguments.length,l=new Array(s>4?s-4:0),u=4;u<s;u++)l[u-4]=arguments[u];var c=H.syntaxError.apply(H,[o,i].concat(l));if(t)throw c;"binary"===a?(n.push(c),e.splice(r,0,te.naturalJoin(oe.new("*")))):(n.push(c),e.splice(r,0,new Y(oe.new(""))))};(e[0]instanceof ee||e[0]instanceof te||e[0]instanceof $)&&r(0,"relation",R().syntaxErrors.exprParser_invalidStart,e[0].getRange(),e[0].str.toString()),(e[e.length-1]instanceof X||e[e.length-1]instanceof te)&&r(e.length,"relation",R().syntaxErrors.exprParser_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString());for(var a=1;a<e.length;){var o=e[a-1],i=e[a];if(i instanceof Y)o instanceof Y&&r(a,"binary",R().syntaxErrors.exprParser_relationAfterRelation,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ee&&r(a,"binary",R().syntaxErrors.exprParser_relationAfterUnary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof $&&r(a,"binary",R().syntaxErrors.exprParser_relationAfterClosing,i.getRange(),i.str.toString());else if(i instanceof ee)o instanceof te&&r(a,"relation",R().syntaxErrors.exprParser_unaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof X&&r(a,"relation",R().syntaxErrors.exprParser_unaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof te)o instanceof te&&r(a,"relation",R().syntaxErrors.exprParser_binaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof X&&r(a,"relation",R().syntaxErrors.exprParser_binaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof X)o instanceof Y&&r(a,"binary",R().syntaxErrors.exprParser_openingAfterRelation,i.getRange(),o.str.toString()),o instanceof ee&&r(a,"binary",R().syntaxErrors.exprParser_openingAfterUnary,i.getRange(),o.str.toString()),o instanceof $&&r(a,"binary",R().syntaxErrors.exprParser_openingAfterClosing,i.getRange());else{if(!(i instanceof $))throw H.codeError(R().codeErrors.exprParser_unexpectedToken,JSON.stringify(i));o instanceof te&&r(a,"relation",R().syntaxErrors.exprParser_closingAfterBinary,i.getRange(),o.str.toString()),o instanceof X&&r(a,"relation",R().syntaxErrors.exprParser_closingAfterOpening,i.getRange())}++a}}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof Y||e instanceof ee)t.push(e);else if(e instanceof te){for(;n.length>0&&n[n.length-1]instanceof te;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof X)n.push(e);else if(e instanceof $)for(;;){if(0===n.length)throw H.syntaxError(R().syntaxErrors.exprParser_invalidParentheses,void 0);if(n[n.length-1]instanceof X){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof X)throw H.syntaxError(R().syntaxErrors.exprParser_invalidParentheses,void 0);t.push(r)}return t}},{key:"rpnToRATree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.rpnToRATreeRecursive(e,t,n);if(e.length>0){if(t)throw H.syntaxError(R().syntaxErrors.exprParser_invalidExpression,void 0);return new ae(new M(""))}return r}},{key:"rpnToRATreeRecursive",value:function(e,t,n){if(0===e.length)throw H.syntaxError(R().syntaxErrors.exprParser_invalidExpression,void 0);var r=e.pop();if(r instanceof Y){var a=this.relations.get(r.str.toString());if(void 0===a){var o=H.semanticError(R().semanticErrors.exprParser_relationNotDefined,r.getRange(),r.str.toString());if(t)throw o;return n.push(o),new ae(new M(""))}return new ae(a)}if(r instanceof ee){var i=this.rpnToRATreeRecursive(e,t,n);return ot.createUnary(r.type,i,this.nullValuesSupport,r.str)}if(r instanceof te){var s=this.rpnToRATreeRecursive(e,t,n),l=this.rpnToRATreeRecursive(e,t,n);return ot.createBinary(r.type,l,s,this.nullValuesSupport,r.str)}throw H.codeError(R().codeErrors.exprParser_unexpectedToken,JSON.stringify(r))}}]),e}(),st=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).inputRef=void 0,r.handleChange=function(e){e=e.replace(/\t/g,"    ");var t=r.props.forbidden(e);r.setState({value:e,buttonDisable:t})},r.handleKeyDown=function(e){"Enter"===e.key?r.state.buttonDisable||r.handleSubmit():"Escape"!==e.key&&"Esc"!==e.key||null!==r.inputRef.current&&r.inputRef.current.blur()},r.handleSubmit=function(){r.props.onSubmit(r.state.value)},r.state={value:r.props.value,buttonDisable:r.props.forbidden(r.props.value)},r.inputRef=a.a.createRef(),r}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{ref:this.inputRef,type:"text",id:this.props.id,spellCheck:!1,autoComplete:"off",value:this.state.value,onChange:function(t){return e.handleChange(t.target.value)},onKeyDown:this.handleKeyDown,className:"text-input"}),a.a.createElement("button",{onClick:this.handleSubmit,disabled:this.state.buttonDisable},this.props.buttonText))}}]),n}(a.a.Component),lt=(n(39),getComputedStyle(document.querySelector(":root"))),ut=Number(lt.getPropertyValue("--message-box-margin-num")),ct=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"init",value:function(){var t=document.createElement("div");t.classList.add("message-box"),t.style.visibility="hidden",t.onmouseenter=function(){e.clearHideTimeout()},t.onmouseleave=function(){e.setHideTimeout()};var n=document.createElement("p");t.appendChild(n);var r=document.createElement("button");return r.innerText="\u2716",r.onclick=function(){e.hideBox()},t.appendChild(r),window.addEventListener("resize",(function(){e.moveBox()})),document.body.appendChild(t),t}},{key:"display",value:function(t,n){var r=e.box;r.firstElementChild.innerText=t,r.style.visibility="visible",r.classList.toggle("message-box-message",!n),r.classList.toggle("message-box-error",n),e.moveBox(),e.setHideTimeout()}},{key:"message",value:function(t){e.display(t,!1)}},{key:"error",value:function(t){e.display(t,!0)}}]),e}();ct.hideTimeout=5e3,ct.box=ct.init(),ct.hideIntervalId=void 0,ct.setHideTimeout=function(){ct.clearHideTimeout(),ct.hideIntervalId=setTimeout(ct.hideBox,ct.hideTimeout)},ct.clearHideTimeout=function(){clearTimeout(ct.hideIntervalId)},ct.hideBox=function(){ct.box.style.visibility="hidden"},ct.moveBox=function(){"visible"===ct.box.style.visibility&&(ct.box.style.width=document.body.clientWidth-2*ut+"px")};var pt=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).textAreaRef=void 0,r.lastChange=0,r.lastWhisperAndErrorsUpdate=0,r.whispersAndErrorsUpdateRate=400,r.updateErrorsAndParentheses=function(){var e=r.getCurExpr().text,t=new it(r.props.relations,r.props.nullValuesSupport).fakeParse(e,r.state.cursorIndex),n=t.errors,a=t.parentheses;r.setState({errors:n.filter((function(e){return void 0!==e.range&&!isNaN(e.range.start)&&!isNaN(e.range.end)})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}})),parentheses:a.filter((function(e){return!isNaN(e.start)&&!isNaN(e.end)}))})},r.evalExpr=function(){try{var e=new it(r.props.relations,r.props.nullValuesSupport).parse(r.props.expressions[r.props.currentExpressionIndex].text);e.eval(),r.setState({errors:[]}),r.props.onEval(e)}catch(t){t instanceof v&&void 0!==t.range&&(t.range.end+=1,r.setState((function(e){var n=e.errors;return n.every((function(e){return e.start!==t.range.start||e.end!==t.range.end}))&&n.push(Object(h.a)(Object(h.a)({},t.range),{},{msg:t.message})),{errors:n}}))),r.showError(t)}},r.newExpression=function(){r.props.onNewExpression()},r.deleteExpression=function(){r.props.onDeleteExpression(r.updateErrorsAndParentheses)},r.exportExpressions=function(){r.props.onExportExpressions(ct.message)},r.importExpressions=function(){r.props.onImportExpressions((function(e){ct.message(e),r.updateErrorsAndParentheses()}))},r.addSpecialString=function(e,t){var n=r.textAreaRef.current.getSelection(),a=n.start,o=n.end,i=r.getCurExpr().text.substring(0,a),s=r.getCurExpr().text.substring(o),l=i.length+e.length-t,u=i+e+s;r.handleExprChange(u,l,(function(){r.textAreaRef.current.setSelection(l),r.textAreaRef.current.focus()}))},r.handleExprChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};r.props.onChange(r.getCurExpr().name,e),r.setState({cursorIndex:t},n),r.lastChange=Date.now()},r.handleCtrlInput=function(e){"Enter"===e.key&&r.evalExpr()},r.updateWhispersAndErrors=function(){var e=r.textAreaRef.current;if(null!==e&&e.isFocused()&&r.lastChange>r.lastWhisperAndErrorsUpdate){var t=r.getCurExpr().text,n=new it(r.props.relations,r.props.nullValuesSupport).fakeParse(t,r.state.cursorIndex),a=t.slice(O(t,r.state.cursorIndex),r.state.cursorIndex),o=function(e,t){var n=e.map((function(e){var n=0,r=e.toLowerCase().indexOf(t.toLowerCase());if(r>-1){n+=0===r?2:1;var a=r+t.length;e=e.slice(0,r)+"<span class='whisper-matched-word'>"+e.slice(r,a)+"</span>"+e.slice(a)}return 0===n&&(e="<span class='whisper-rejected-word'>"+e+"</span>"),{whisper:e,likelihood:n}}));return""!==t&&n.sort((function(e,t){return t.likelihood-e.likelihood})),n.map((function(e){return e.whisper}))}(n.whispers,a);r.setState({whispers:o,errors:n.errors.filter((function(e){return void 0!==e.range&&!isNaN(e.range.start)&&!isNaN(e.range.end)})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}})),parentheses:n.parentheses.filter((function(e){return!isNaN(e.start)&&!isNaN(e.end)}))}),r.lastWhisperAndErrorsUpdate=Date.now()}},r.handleExprNameChange=function(e){r.props.onChange(e,r.getCurExpr().text)},r.showError=function(e){e instanceof w||e instanceof C?ct.error(e.message):(r.props.onUnexpectedError(e),ct.error("UNEXPECTED ERROR: "+e.message+"\nPlease, help us and report your last actions, thank you!"))},r.handleDragDrop=function(e,t){e.preventDefault();var n=e.dataTransfer.getData("text/plain"),a=Number(n.slice(1));"E"!==n.charAt(0)||isNaN(a)||r.props.onDragExpression(a,t)},r.state={sectionClicked:!1,whispers:[],errors:[],parentheses:[],cursorIndex:0},r.textAreaRef=a.a.createRef(),setInterval((function(){return r.updateWhispersAndErrors()}),r.whispersAndErrorsUpdateRate),r}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e){if(this.props.language!==e.language){var t=this.textAreaRef.current;null!==t&&t.setPlaceholder(this.props.language.expressionSection.expressionTextareaPlaceholder)}}},{key:"getCurExpr",value:function(){return this.props.expressions[this.props.currentExpressionIndex]}},{key:"handleSelectDifferentExpression",value:function(e){this.props.onSelectDifferentExpression(e)}},{key:"render",value:function(){var e=this,t=this.props.language.expressionSection,n=this.props.language.operations,r=function(e,t,n,r){return a.a.createElement(f,{key:e,text:e,onClick:t,style:r,tooltip:n})},o=function(t,n,r,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return a.a.createElement(f,{key:t,text:r,onClick:function(){return e.addSpecialString(n,i)},tooltip:o,style:s})},i={marginRight:"10px"};return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.expressionSectionHeader),r(t.importButton,this.importExpressions,t.importButtonTooltip),r(t.exportButton,this.exportExpressions,t.exportButtonTooltip)),a.a.createElement("menu",{className:"page-section-tab-menu"},e.props.expressions.map((function(t,n){var r=e.props.currentExpressionIndex===n?"button-clicked":"";return a.a.createElement("button",{key:n,onClick:function(){return e.handleSelectDifferentExpression(n)},className:r,draggable:!0,onDragStart:function(e){return e.dataTransfer.setData("text/plain","E"+String(n))},onDragOver:function(e){return e.preventDefault()},onDrop:function(t){return e.handleDragDrop(t,n)}},t.name)})),a.a.createElement("button",{onClick:this.newExpression,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(B,{ref:this.textAreaRef,id:"expression-section-textarea",text:this.getCurExpr().text,placeholder:t.expressionTextareaPlaceholder,errors:this.state.errors,whispers:this.state.whispers,parentheses:this.state.parentheses,onChange:this.handleExprChange,onCtrlInput:this.handleCtrlInput,darkTheme:this.props.darkTheme}),a.a.createElement("menu",{className:"expressions-operators-menu"},o("unary_a","()","()",n.selection,1),o("unary_b","[]","[]",n.projection,1),o("unary_c","< -> >","<>",n.rename,5,i),o("set_a","\u222a","\u222a",n.union,0),o("set_b","\u2229","\u2229",n.intersection,0),o("set_c","\\","\\",n.difference,0,i),o("inner_a","*","*",n.naturalJoin,0),o("inner_b","\u2a2f","\u2a2f",n.cartesianProduct,0),o("inner_c","<*","<*",n.leftSemiJoin,0),o("inner_d","*>","*>",n.rightSemiJoin,0),o("inner_e","\u22b3","\u22b3",n.leftAntijoin,0),o("inner_f","\u22b2","\u22b2",n.rightAntijoin,0),o("inner_g","[]","[]",n.thetaJoin,1),o("inner_h","\u27e8]","\u27e8]",n.leftThetaSemiJoin,1),o("inner_i","[\u27e9","[\u27e9",n.rightThetaSemiJoin,1,i),this.props.nullValuesSupport&&o("outer_a","*F*","*F*",n.fullOuterJoin,0),this.props.nullValuesSupport&&o("outer_b","*L*","*L*",n.leftOuterJoin,0),this.props.nullValuesSupport&&o("outer_c","*R*","*R*",n.rightOuterJoin,0,i),o("division","\xf7","\xf7",n.division,0,i),o("line_comment","//","//",t.lineComment,0),o("block_comment","/**/","/*",t.blockComment,2)),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(f,{text:t.evaluateButton,onClick:this.evalExpr,className:"action-button",style:{marginRight:"40px"},tooltip:t.evaluateButtonTooltip}),a.a.createElement(st,{value:this.getCurExpr().name,buttonText:t.renameButton,onSubmit:this.handleExprNameChange,forbidden:function(){return!1},id:"expression-name-input"}),r(t.deleteButton,this.deleteExpression,t.deleteButtonTooltip)))}}]),n}(a.a.Component),ht=n(26),ft=n.n(ht),dt=(n(40),function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).getOrderByText=function(){return 1===r.state.orderDir?" \u25bc":" \u25b2"},r.state={orderBy:-1,orderDir:1},r}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.relation!==this.props.relation&&this.setState({orderDir:1,orderBy:-1})}},{key:"updateOrderBy",value:function(e){this.setState((function(t){return t.orderBy===e?{orderDir:-t.orderDir,orderBy:e}:{orderDir:1,orderBy:e}}))}},{key:"createHeaderRow",value:function(e){var t=this;return a.a.createElement("tr",null,a.a.createElement("td",{className:"row-number-td"}),e.map((function(e,n){var r=t.state.orderBy===n?e+t.getOrderByText():e;return a.a.createElement("th",{key:n,onClick:function(){return t.updateOrderBy(n)}},r)})))}},{key:"createRows",value:function(e){var t=this;if(0===this.props.relation.getRowsCount())return a.a.createElement("tr",{key:"1"},a.a.createElement("td",{className:"row-number-td"}),a.a.createElement("td",{key:"1",colSpan:e.length},"<<NO ROWS>>"));var n=this.props.relation.getRows();if(this.state.orderBy>-1&&this.state.orderBy<e.length){var r=e[this.state.orderBy];"number"===n[0].getType(r)?n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*(e.getValue(r)-n.getValue(r)):0})):n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*String(e.getValue(r)).localeCompare(String(n.getValue(r))):0}))}return n.map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1),t.getOrderedPrintValues(e).map((function(e,t){return a.a.createElement("td",{key:t},e)})))}))}},{key:"render",value:function(){var e=this.props.relation.getColumnNames(),t=this.createHeaderRow(e),n=this.createRows(e);return a.a.createElement("div",{className:"result-table-container scrollbar-container"},a.a.createElement("table",{className:"result-table"},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,n)))}}]),n}(a.a.Component)),mt=n(72),vt=n(28),gt=n(74),yt=n(73),bt=n(27),Et=n.n(bt),xt=n(71),kt=(n(41),function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(Et.a,null,(function(t){var n=t.width;return a.a.createElement(zt,{raTree:e.props.tree,selected:e.props.selected,width:n,onClick:e.props.onClick,darkTheme:e.props.darkTheme})}))}}]),n}(a.a.Component)),St=getComputedStyle(document.querySelector(":root")),Rt=St.getPropertyValue("--eval-tree-font-size"),wt=St.getPropertyValue("--eval-tree-font-family"),Ct=j(wt,Rt),jt=Ct.fontWidth,Ot=Ct.fontHeight,Nt=2*Ot+24,Tt=St.getPropertyValue("--light-color-a"),Pt=St.getPropertyValue("--dark-color-a"),At=St.getPropertyValue("--text-color-light"),_t=St.getPropertyValue("--text-color-dark"),Vt=St.getPropertyValue("--light-color-c"),It=St.getPropertyValue("--light-color-b"),Lt=St.getPropertyValue("--dark-color-d"),Dt=St.getPropertyValue("--dark-color-c");function Bt(e){var t=e.node,n=e.selected,r=e.onClick,o=e.darkTheme,i=Object(xt.a)(),s=i.tooltipOpen,l=i.showTooltip,u=i.hideTooltip,c=Math.max(t.data.title.length,t.data.symbol.length)*jt+24;return c<Nt&&(c=Nt),a.a.createElement(mt.a,{top:t.y,left:t.x},a.a.createElement("rect",{height:Nt,width:c,y:-Nt/2,x:-c/2,rx:5,fill:o?n||s?Lt:Dt:n||s?Vt:It,onClick:function(){r(t.data.index)},cursor:"pointer",onMouseOver:function(){l({tooltipLeft:0,tooltipTop:0})},onMouseOut:u}),a.a.createElement("text",{y:"-4px",dy:".2em",fontSize:Rt,fontFamily:wt,textAnchor:"middle",style:{pointerEvents:"none"},fill:o?_t:At},""===t.data.symbol?a.a.createElement("tspan",{x:"0",dy:".5em"},t.data.title):a.a.createElement(a.a.Fragment,null,a.a.createElement("tspan",{x:"0",dy:"0"},t.data.title),a.a.createElement("tspan",{x:"0",dy:"1.2em"},t.data.symbol))))}function zt(e){var t=e.raTree,n=e.selected,r=e.width,o=e.onClick,i=e.darkTheme,s=Fe(t),l=(s+1)*Nt+s*Nt/2+Nt,u={top:Nt,left:0,right:0,bottom:Nt},c=l-u.top-u.bottom,p=r-u.left-u.right,h=function(e){var t=0;return function e(n){var r=n.getOperationSymbol();return r.length>30&&(r=r.slice(0,26)+"..."+r.charAt(r.length-1)),n instanceof se?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getSubtree())]}:n instanceof Ue?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getLeftSubtree()),e(n.getRightSubtree())]}:{title:n.getOperationName(),symbol:r,index:t++}}(e)}(t),f=Object(vt.b)(h);return r<10?null:a.a.createElement("svg",{id:"eval-tree-svg",width:r,height:l},a.a.createElement("rect",{width:r,height:l,rx:14,fill:i?Pt:Tt}),a.a.createElement(gt.a,{root:f,size:[p,c]},(function(e){return a.a.createElement(mt.a,{top:u.top,left:u.left},e.links().map((function(e,t){return a.a.createElement(yt.a,{key:"cluster-link-".concat(t),data:e,stroke:i?_t:At,strokeWidth:"1",strokeOpacity:1,fill:"none"})})),e.descendants().map((function(e){return a.a.createElement(Bt,{key:"node-".concat(e.data.index),node:e,selected:e.data.index===n,onClick:o,darkTheme:i})})))})))}var Wt=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"openFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(e,">");var r=n.firstChild;r.addEventListener("change",(function(){var e=r.files[0],n=new FileReader;n.onload=function(){t({name:e.name,text:n.result})},n.readAsText(e)})),r.click()}))}},{key:"openFiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(n){e.openFilesHelper(n,t)}))}},{key:"openFilesHelper",value:function(e,t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(t," multiple>");var r=n.firstChild,a=[];r.addEventListener("change",(function(){var t=r.files;!function n(r){if(r===t.length)return e(a);var o=t[r],i=new FileReader;i.onload=function(e){a.push({name:o.name,text:e.target.result}),n(r+1),console.log("File "+(r+1)+"/"+t.length+" loaded")},i.readAsText(o)}(0)})),r.click()}}]),e}();function Ut(e,t){e+=t;for(var n=[],r=!1,a=0,o=0;o<e.length;){var i=e.charAt(o);if('"'===i){if(r){var s=e.charAt(o+1);if(s===t)n.push(e.slice(a+1,o).replace(/""/g,'"')),r=!1,a=o+2;else if('"'!==s)throw new Error;o+=2;continue}r=!0,a=o}else i!==t||r||(n.push(e.slice(a,o).replace(/""/g,'"')),a=o+1);++o}return n}var Jt=function(){function e(){Object(l.a)(this,e),this.map=new Map}return Object(u.a)(e,[{key:"get",value:function(e,t){return this.map.get(e+":"+t)}},{key:"set",value:function(e,t,n){this.map.set(e+":"+t,n)}},{key:"delete",value:function(e,t){return this.map.delete(e+":"+t)}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(t){Object(s.a)(this.map.entries()).map((function(t){return{value:t[1],key:e.parseKey(t[0])}})).forEach((function(e,n){return t(e.value,e.key.row,e.key.column,n)}))}}],[{key:"parseKey",value:function(e){var t=e.split(":");return{row:Number(t[0]),column:Number(t[1])}}}]),e}();var Ft=function(){function e(t,n,r,a,o){Object(l.a)(this,e),this.name=void 0,this.columnNames=void 0,this.columnTypes=void 0,this.rows=void 0,this.columnCount=void 0,this.rowCount=void 0,this.errors=void 0,this.nullValuesSupport=void 0,this.actual=void 0,this.revertState=void 0,this.name=t,this.columnNames=n,this.columnTypes=r,this.rows=a,this.columnCount=n.length,this.rowCount=a.length,this.errors=new Jt,this.nullValuesSupport=o,this.actual=!1,this.revertState=this.toDataObject(),this.recomputeErrors()}return Object(u.a)(e,null,[{key:"new",value:function(t,n){return new e(t,["Column1"],["number"],[],n)}},{key:"fromData",value:function(t,n){if(Mt(t)){var r=t;return new e(r.name,r.columnNames,r.columnTypes,r.rows,n)}throw new Error("Given object is not a valid relation.")}},{key:"fromRelation",value:function(t,n,r){var a=[],o=[];n.getColumns().forEach((function(e,t){a.push(t),o.push(e)}));var i=n.getRows().map((function(e){return e.getOrderedPrintValues(a)}));return new e(t,a,o,i,r)}},{key:"copy",value:function(t){return new e(t.name,Object(s.a)(t.columnNames),Object(s.a)(t.columnTypes),t.rows.map((function(e){return Object(s.a)(e)})),t.nullValuesSupport)}},{key:"format",value:function(e){var t=e.columnNames.map((function(e){return e.length}));e.columnTypes.forEach((function(e,n){t[n]<e.length&&(t[n]=e.length)})),e.rows.forEach((function(e){e.forEach((function(e,n){t[n]<e.length&&(t[n]=e.length)}))}));var n=function(e){return e.map((function(e,n){return e.padEnd(t[n]," ")})).join(" | ")};return n(e.columnNames)+"\n"+n(e.columnTypes)+"\n"+t.map((function(e){return"-".repeat(e)})).join("-+-")+"\n"+e.rows.map((function(e){return n(e)})).join("\n")+"\n\n"}}]),Object(u.a)(e,[{key:"recomputeErrors",value:function(){var e=this;this.errors.clear(),this.checkColumnNames();for(var t=function(t){Object(s.a)(new Array(e.rowCount).keys()).forEach((function(n){return e.checkRowInput(t,n)}))},n=0;n<this.columnCount;++n)t(n)}},{key:"checkColumnNames",value:function(){for(var e=this,t=R().relationErrors,n=function(n){var r=e.columnNames[n].trim();return""===r?(e.errors.set("name",n,t.emptyColumn),"continue"):e.columnNames.reduce((function(e,t){return t===r?e+1:e}),0)>1?(e.errors.set("name",n,t.duplicitColumn),"continue"):fe(r)?(e.errors.set("name",n,t.keywordColumn),"continue"):ne.isName(r)?void e.errors.delete("name",n):(e.errors.set("name",n,t.invalidColumn),"continue")},r=0;r<this.columnCount;++r)n(r)}},{key:"checkRowInput",value:function(e,t){var n=R().relationErrors;this.errors.delete(t,e);var r=this.rows[t][e].trim();if("null"===r||""===r&&"string"!==this.columnTypes[e])this.nullValuesSupport||this.errors.set(t,e,n.unsupportedNull);else if("number"===this.columnTypes[e])ne.isNumber(r.replace(/\s/g,""))||this.errors.set(t,e,n.invalidNumber);else if("boolean"===this.columnTypes[e]){var a=r.toLowerCase();"true"!==a&&"t"!==a&&"false"!==a&&"f"!==a&&this.errors.set(t,e,n.invalidBoolean)}}},{key:"checkColumnTypes",value:function(e){var t=this;this.rows.forEach((function(n,r){return t.checkRowInput(e,r)}))}},{key:"createRelation",value:function(){for(var e=this,t=new M(this.name),n=0;n<this.columnCount;++n)t.addColumn(this.columnNames[n],this.columnTypes[n]);return this.rows.forEach((function(n){var r=new le(t.getColumns());n.forEach((function(t,n){if("null"===(t=t.trim()))r.addValue(e.columnNames[n],null);else if("string"===e.columnTypes[n])t=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),r.addValue(e.columnNames[n],t);else if(""===t)r.addValue(e.columnNames[n],null);else if("number"===e.columnTypes[n])r.addValue(e.columnNames[n],Number(t.replace(/\s/g,"")));else{var a=t.toLowerCase();r.addValue(e.columnNames[n],"t"===a||"true"===a)}})),t.addRow(r)})),t.finishSchema(),t}},{key:"toDataObject",value:function(){return{name:this.name,columnNames:Object(s.a)(this.columnNames),columnTypes:Object(s.a)(this.columnTypes),rows:this.rows.map((function(e){return Object(s.a)(e)})),columnCount:this.columnCount,rowCount:this.rowCount}}},{key:"getErrors",value:function(){return this.errors}},{key:"isValid",value:function(){return 0===this.errors.size()}},{key:"setNullValuesSupport",value:function(e){e!==this.nullValuesSupport&&(this.nullValuesSupport=e,this.recomputeErrors())}},{key:"addNewColumn",value:function(){for(var e=this.columnNames.length+1,t="Column"+e;this.columnNames.indexOf(t)>-1;)t="Column"+ ++e;this.columnNames.push(t),this.columnTypes.push("number"),this.nullValuesSupport?this.rows.forEach((function(e){return e.push("")})):this.rows.forEach((function(e){return e.push("0")})),++this.columnCount,this.checkColumnNames(),this.actual=!1}},{key:"addNewRow",value:function(){var e=this;this.nullValuesSupport?this.rows.push(Object(s.a)(new Array(this.columnCount).keys()).map((function(e){return""}))):this.rows.push(Object(s.a)(new Array(this.columnCount).keys()).map((function(t){return"number"===e.columnTypes[t]?"0":"boolean"===e.columnTypes[t]?"false":""}))),++this.rowCount,this.actual=!1}},{key:"deleteColumn",value:function(e){var t=this;this.columnNames.splice(e,1),this.columnTypes.splice(e,1),this.rows.forEach((function(t){return t.splice(e,1)})),--this.columnCount,0===this.columnCount&&(this.rows=[],this.addNewColumn()),this.errors.forEach((function(n,r,a){a===e?t.errors.delete(r,a):a>e&&(t.errors.delete(r,a),t.errors.set(r,a,n))})),this.actual=!1}},{key:"deleteRow",value:function(e){var t=this;this.rows.splice(e,1),--this.rowCount,this.errors.forEach((function(n,r,a){r===e?t.errors.delete(r,a):"number"===typeof r&&r>e&&(t.errors.delete(r,a),t.errors.set(r-1,a,n))})),this.actual=!1}},{key:"getRowCount",value:function(){return this.rowCount}},{key:"getColumnCount",value:function(){return this.columnCount}},{key:"setName",value:function(e){this.name=e,this.actual=!1}},{key:"getName",value:function(){return this.name}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"setColumnName",value:function(e,t){this.columnNames[t]=e,this.checkColumnNames(),this.actual=!1}},{key:"getColumnTypes",value:function(){return this.columnTypes}},{key:"setColumnType",value:function(e,t){this.columnTypes[t]=e,this.checkColumnTypes(t),this.actual=!1}},{key:"getRows",value:function(){return this.rows}},{key:"setRowInput",value:function(e,t,n){this.rows[t][n]=e,this.checkRowInput(n,t),this.actual=!1}},{key:"isActual",value:function(){return this.actual}},{key:"setActual",value:function(e){this.actual=e,e&&(this.revertState=this.toDataObject())}},{key:"getRevertName",value:function(){return void 0!==this.revertState?this.revertState.name:""}},{key:"revert",value:function(){void 0!==this.revertState&&(this.name=this.revertState.name,this.columnNames=Object(s.a)(this.revertState.columnNames),this.columnTypes=Object(s.a)(this.revertState.columnTypes),this.rows=this.revertState.rows.map((function(e){return Object(s.a)(e)})),this.columnCount=this.revertState.columnCount,this.rowCount=this.revertState.rowCount,this.actual=!1,this.recomputeErrors())}}]),e}();function Mt(e){return"object"===typeof e&&("name"in e&&"string"===typeof e.name&&("columnCount"in e&&"number"===typeof e.columnCount&&!(e.columnCount<1)&&("rowCount"in e&&"number"===typeof e.rowCount&&(!(!("columnNames"in e)||!Array.isArray(e.columnNames)||e.columnNames.length!==e.columnCount||e.columnNames.some((function(e){return"string"!==typeof e})))&&(!(!("columnTypes"in e)||!Array.isArray(e.columnTypes)||e.columnTypes.length!==e.columnCount||e.columnTypes.some((function(e){return!function(e){return"string"===typeof e&&("string"===e||"number"===e||"boolean"===e)}(e)})))&&("rows"in e&&Array.isArray(e.rows)&&e.rows.every((function(t){return Array.isArray(t)&&t.length===e.columnCount&&t.every((function(e){return"string"===typeof e}))}))))))))}var qt=n(7),Ht=n(18),Kt=n.n(Ht),Gt=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"load",value:function(t){var n=this;return new Promise((function(r){Wt.openFiles(".csv").then((function(a){var o=[],i=0;a.forEach((function(r){if(r.name.match(/\.csv$/))try{o.push(n.csvToRelation(e.createValidName(r.name.slice(0,-4)),r.text,t))}catch(a){console.log("File "+r.name+" skipped for bad format of csv"),i+=1}else console.log("Unsupported filetype: "+r.name),i+=1})),r({relations:o,skipped:i})}))}))}},{key:"save",value:function(e,t,n){var r=this;if(0!==e.length)if(1!==e.length){var a=Kt()();e.forEach((function(e){a.file(e.getName()+".csv",r.relationToCsv(e,n))})),a.generateAsync({type:"blob"}).then((function(e){Object(qt.saveAs)(e,t+".zip")})).catch((function(e){throw e}))}else{var o=new Blob([this.relationToCsv(e[0],n)],{type:"text/plain;charset=utf-8"});Object(qt.saveAs)(o,e[0].getName()+".csv")}}},{key:"csvToRelation",value:function(e,t,n){if(null===t||""===t)throw console.log("null or empty string read from file "+e),Error();var r=(t=t.trim().replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ")).split("\n");if(r.length<2)throw console.log("file "+e+" has only one line"),new Error;r[0]=r[0].replace(/\s/g,""),r[1]=r[1].replace(/\s/g,"");var a=function(e){for(var t=!1,n=0;n<e.length;++n){var r=e.charAt(n);if('"'===r)if(t){var a=e.charAt(n+1);if(","===a||";"===a)return a;if('"'!==a)return;++n}else t=!0;if(!t&&(","===r||";"===r))return r}}(r[1]);void 0===a&&(a=";");var o=Ut(r[0],a),i=Ut(r[1],a).map((function(e){var t=e.toLowerCase();return"string"===t||"str"===t||"s"===t?"string":"number"===t||"num"===t||"n"===t?"number":"boolean"})),s=r.slice(2).map((function(e){return Ut(e,a)})),l=o.length;if(i.length!==l||s.some((function(e){return e.length!==l})))throw console.log("rows in file "+e+" do not have the same number of columns"),new Error;return new Ft(e,o,i,s,n)}},{key:"createValidName",value:function(e){return""===(e=e.split("").filter((function(e){return ne.isNameChar(e)})).join(""))?"relation":e}},{key:"relationToCsv",value:function(e,t){var n=e.getColumnNames().map((function(e){return'"'+e.replace(/"/g,'""')+'"'})).join(t),r=e.getColumnTypes().join(t),a=e.getRows().map((function(e){return e.map((function(e){return'"'+e.replace(/"/g,'""')+'"'})).join(t)}));return[n,r].concat(Object(s.a)(a)).join("\n")}}]),e}(),Zt=(n(61),function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.getCurrentRelation=function(){var e=Je(r.props.evaluationTreeRoot,r.state.selectedIndex);if(null===e&&null===(e=Je(r.props.evaluationTreeRoot,0)))return r.props.onUnexpectedError(H.codeError(R().codeErrors.resultSection_nodeIndexNotFound)),null;try{return e.getResult()}catch(t){return r.props.onUnexpectedError(H.codeError(R().codeErrors.resultSection_evalError,t.message)),null}},r.handleSelectedNodeChange=function(e){r.setState({selectedIndex:e})},r.exportEvalTreeAsPng=function(){var e=document.getElementById("eval-tree-svg");if(null!==e){var t=e.getBoundingClientRect(),n={width:3*t.width,height:3*t.height,svg:e,filename:r.props.expressionName+" - evaluation tree.png"};ft()(n)}},r.exportRelation=function(){if(null!==r.getCurrentRelation())try{Gt.save([Ft.fromRelation("rachel_result",r.getCurrentRelation(),!0)],"rachel_result",r.props.csvValueSeparator)}catch(e){console.warn("Saving error: "+e,!0)}else r.props.onUnexpectedError(H.codeError(R().codeErrors.resultSection_nullRelationToSave))},r.addRelation=function(){null!==r.getCurrentRelation()?r.props.onAddResult(r.getCurrentRelation()):r.props.onUnexpectedError(H.codeError(R().codeErrors.resultSection_nullRelationToAdd))},r.state={selectedIndex:0},r.sectionRef=a.a.createRef(),r}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e){e.evaluationTreeRoot!==this.props.evaluationTreeRoot&&this.setState({selectedIndex:0})}},{key:"render",value:function(){var e=this.getCurrentRelation();if(null===e)return null;var t=this.props.language.resultSection,n=0===this.state.selectedIndex?t.resultRelationTitle:t.intermediateRelationTitle,r=Je(this.props.evaluationTreeRoot,this.state.selectedIndex),o=null===r?null:r.printInLine();return a.a.createElement("section",{ref:this.sectionRef,className:"page-section result-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.resultSectionHeader),a.a.createElement(f,{text:t.exportEvalTreeButton,onClick:this.exportEvalTreeAsPng,tooltip:t.exportEvalTreeButtonTooltip})),a.a.createElement("p",{className:"upper-p"},a.a.createElement("strong",null,t.evalTreeTitle+" "+this.props.evaluationTreeRoot.printInLine()+":")),a.a.createElement(kt,{tree:this.props.evaluationTreeRoot,selected:this.state.selectedIndex,onClick:this.handleSelectedNodeChange,darkTheme:this.props.darkTheme}),a.a.createElement("p",{className:"lower-p"},a.a.createElement("strong",null,n," ",o,":")),a.a.createElement("menu",{className:"page-section-tab-menu"},a.a.createElement(f,{text:t.addButton,onClick:this.addRelation,tooltip:t.addButtonTooltip}),a.a.createElement(f,{text:t.exportRelationButton,onClick:this.exportRelation,tooltip:t.exportRelationButtonTooltip})),a.a.createElement(dt,{relation:e}))}}]),n}(a.a.Component)),Qt=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"load",value:function(){var e=this;return new Promise((function(t){Wt.openFiles(".txt").then((function(n){var r=[],a=0,o=0,i=0;n.forEach((function(t){null===t.text?(console.log("Null read from file "+t.name),i+=1):t.name.match(/\.txt$/)?(t.text=t.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    "),"\n".concat(t.text).split("\n### ").forEach((function(t){try{0!==t.trim().length&&r.push(e.splitExpressionNameAndText(t))}catch(n){a+=1}})),o+=1):(console.log("Unsupported filetype: "+t.name),i+=1)})),t({expressions:r,skippedExpressions:a,loadedFiles:o,skippedFiles:i})}))}))}},{key:"splitExpressionNameAndText",value:function(e){var t=e.indexOf("\n");if(-1===t)throw console.log("Expression does not contain first name line."),Error();var n=e.slice(0,t).trim();if(!n.endsWith(" ###"))throw console.log("Expression does not contain name between hashes."),Error();return{name:n.slice(0,-4),text:e.slice(t).trim()}}},{key:"save",value:function(e,t){var n=e.map((function(e){return"### "+e.name+" ###\n\n"+e.text})).join("\n\n"),r=new Blob([n],{type:"text/plain;charset=utf-8"});Object(qt.saveAs)(r,t+".txt")}}]),e}(),Xt=(n(62),[{name:"Cars and Owners (EN)",project:{relations:[{name:"Car",columnNames:["Id","Owner","Color","Electric","Weight"],columnTypes:["number","number","string","boolean","number"],rows:[["1","1","Blue","True","1000"],["2","1","Green","false","1 200"],["3","2","Blue","F","850.42"],["4","3","Black","t","1 111.111 111"]],columnCount:5,rowCount:4},{name:"Owner",columnNames:["Id","Name"],columnTypes:["number","string"],rows:[["1","George Smith"],["2",'Adam "Driver /\\" Jackson'],["3","Michael Trueman"],["Fix errors","before loading"],["Or delete","invalid rows"]],columnCount:2,rowCount:3}],expressions:[{name:"Relation only",text:"// You can use comments until the line end after '//'\n// You must load relations before using them in expressions\n\nCar\n\n// After evaluation, you will see the evaluation tree\n// and the result relation at the bottom of the page\n"},{name:"Unary operator",text:"// Unary operator comes after the source relation\n// If the relation is still not defined, go check its definition\n// This expression returns all owners with id 1\n\nOwner(Id = 1)\n"},{name:"Binary operator",text:"// Binary operator comes between source relations\n// This expression returns natural join of cars and owners\n\nCar*Owner\n"},{name:"Escapes",text:'// Strings in expressions are enclosed in quotes\n// To use quotes inside a string, you must escape them by a backslash \'\\"\'\n// To use backslash inside a string, you must escape it with second one \'\\\\\'\n\nOwner(Name == "Adam \\"Driver /\\\\\\" Jackson")\n\n// This does not work: Owner(Name == "Adam "Driver /\\" Jackson")\n'},{name:"Example",text:"// Errors are highlighted by red underline - hover mouse over it to see details\n// While typing, Rachel shows you available relations or columns\n// (if relations are loaded in the application)\n// Try to write a query for: all cars' ids and their owners' names\n\nTODO...\n"},{name:"Example result",text:"// One possible expression is like this...\n\n(\n  Car\n  *\n  Owner< Id -> Owner >\n)[Id, Name]\n\n// For more detailed manual click 'About' button in the page header\n"}],nullValuesSupport:!0}},{name:"Auta a Majitel\xe9 (CS)",project:{relations:[{name:"Auto",columnNames:["Id","Majitel","Barva","Elektro","V\xe1ha"],columnTypes:["number","number","string","boolean","number"],rows:[["1","1","Modr\xe1","True","1000"],["2","1","Zelen\xe1","false","1 200"],["3","2","Modr\xe1","F","850.42"],["4","3","\u010cern\xe1","t","1 111.111 111"]],columnCount:5,rowCount:4},{name:"Majitel",columnNames:["Id","Jm\xe9no"],columnTypes:["number","string"],rows:[["1","Pepa Mr\xe1zek"],["2",'Adam "Z\xe1vodn\xedk /\\" Horv\xe1th'],["3","Michael Dvo\u0159\xe1k"],["P\u0159ed nahr\xe1n\xedm","oprav chyby"],["Nebo odstra\u0148","chybn\xe9 \u0159\xe1dky"]],columnCount:2,rowCount:3}],expressions:[{name:"Pouze relace",text:"// M\u016f\u017ee\u0161 pou\u017e\xedvat koment\xe1\u0159e po '//'\n// P\u0159ed pou\u017eit\xedm relac\xed ve v\xfdrazech je mus\xed\u0161 nahr\xe1t\n\nAuto\n\n// Po vyhodnocen\xed uvid\xed\u0161 evalua\u010dn\xed strom\n// a v\xfdslednou relaci dole na str\xe1nce\n"},{name:"Un\xe1rn\xed oper\xe1tor",text:"// Un\xe1rn\xed oper\xe1tory se p\xed\u0161\xed za vstupn\xed relaci\n// Pokud je tato relace st\xe1le nedefinovan\xe1, zkontroluj jej\xed definici\n// Tento dotaz vr\xe1t\xed v\u0161echny majitele s id = 1\n\nMajitel(Id = 1)\n"},{name:"Bin\xe1rn\xed oper\xe1tor",text:"// Bin\xe1rn\xed oper\xe1tory se p\xed\u0161\xed mezi vstupn\xed relace\n// Tento v\xfdraz vr\xe1t\xed p\u0159irozen\xe9 spojen\xed aut a majitel\u016f\n\nAuto*Majitel\n"},{name:"Escapes",text:'// Textov\xe9 \u0159et\u011bzce ve v\xfdrazech mus\xed b\xfdt mezi uvozovkami\n// Pro pou\u017eit\xed uvozovek v \u0159et\u011bzci p\u0159ed n\u011b mus\xed\u0161 napsat zp\u011btn\xe9 lom\xedtko \'\\"\'\n// Pro pou\u017eit\xed zp\u011btn\xe9ho lom\xedtka p\u0159ed n\u011bj mus\xed\u0161 napsat druh\xe9 \'\\\\\'\n\nMajitel(Jm\xe9no == "Adam \\"Z\xe1vodn\xedk /\\\\\\" Horv\xe1th")\n\n// Toto by nefungovalo: Majitel(Jm\xe9no == "Adam "Z\xe1vodn\xedk /\\" Horv\xe1th")\n'},{name:"P\u0159\xedklad",text:"// Chyby jsou zv\xfdrazn\u011bni \u010derven\xfdm podtr\u017een\xedm - p\u0159eje\u010f na n\u011b my\u0161\xed pro detaily\n// P\u0159i psan\xed ti Rachel nab\xedz\xed dostupn\xe9 relace nebo sloupce\n// (pokud jsou relace nahran\xe9 v aplikace)\n// Zkus napsat dotaz pro: id v\u0161ech aut a jm\xe9na jejich majitel\u016f\n\nTODO...\n"},{name:"V\xfdsledek p\u0159\xedkladu",text:"// Jedno mo\u017en\xe9 \u0159e\u0161en\xed je toto...\n\n(\n  Auto\n  *\n  Majitel< Id -> Majitel >\n)[Id, Jm\xe9no]\n\n// Pro v\xedce informac\xed nav\u0161tiv manu\xe1l p\u0159es odkaz 'O aplikaci' v horn\xedm menu\n"}],nullValuesSupport:!0}}]);function $t(){return Xt}var Yt=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={sectionClicked:!1},r}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.props.language.managementSection;return a.a.createElement("header",{className:"management-section"},a.a.createElement("h1",null,"RACHEL"),a.a.createElement("button",{onClick:e.props.onBatch},t.batchButton),a.a.createElement("button",{onClick:e.props.onLoadProject},t.loadButton),a.a.createElement("button",{onClick:e.props.onSaveProject},t.saveButton),function(){var n=a.a.createElement("ul",{className:"list-menu"},t.samplesMenuTitle,$t().map((function(t,n){return a.a.createElement("li",{key:n},a.a.createElement("button",{onClick:function(){return e.props.onLoadSample(t.project)}},t.name))})));return a.a.createElement("div",{className:"button-like"},t.samplesButton,n)}(),function(){var n=a.a.createElement("ul",{className:"list-menu"},a.a.createElement("li",null,a.a.createElement("span",null,t.settingsNullValues,":"),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"allowed",id:"null_values_support_allowed",checked:e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!0)}}),a.a.createElement("label",{htmlFor:"null_values_support_allowed"},t.settingsNullValuesAllowed),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"forbidden",id:"null_values_support_forbid",checked:!e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!1)}}),a.a.createElement("label",{htmlFor:"null_values_support_forbid"},t.settingsNullValuesForbidden)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsCSVSeparator,":"),a.a.createElement("input",{type:"radio",name:"value_separator",value:"semicolon",id:"value_separator_semi",checked:";"===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(";")}}),a.a.createElement("label",{htmlFor:"value_separator_semi"},t.settingsCSVSeparatorSemicolon),a.a.createElement("input",{type:"radio",name:"value_separator",value:"comma",id:"value_separator_comma",checked:","===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(",")}}),a.a.createElement("label",{htmlFor:"value_separator_comma"},t.settingsCSVSeparatorComma)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsTheme,":"),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"on",id:"dark_mode_on",checked:!e.props.darkTheme,onChange:function(){return e.props.onDarkThemeChange(!1)}}),a.a.createElement("label",{htmlFor:"dark_mode_on"},t.settingsThemeLight),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"off",id:"dark_mode_off",checked:e.props.darkTheme,onChange:function(){return e.props.onDarkThemeChange(!0)}}),a.a.createElement("label",{htmlFor:"dark_mode_off"},t.settingsThemeDark)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsLanguage,":"),k.map((function(t){return a.a.createElement("div",{key:t,style:{display:"inline"}},a.a.createElement("input",{type:"radio",name:"language",value:t,id:"language_"+t,checked:e.props.language.abbr===t,onChange:function(){return e.props.onLanguageChange(t)}}),a.a.createElement("label",{htmlFor:"language_"+t},t))}))));return a.a.createElement("div",{className:"button-like"},t.settingsButton,n)}(),a.a.createElement("a",{href:"https://github.com/kotliluk/rachel",target:"_blank",rel:"noreferrer",className:"button-like"},t.aboutButton))}}]),n}(a.a.Component);function en(e){return"object"!==typeof e?"The file cannot be parsed to an object.":"relations"in e&&Array.isArray(e.relations)&&0!==e.relations.length&&!e.relations.some((function(e){return!Mt(e)}))?"expressions"in e&&Array.isArray(e.expressions)&&0!==e.expressions.length&&!e.expressions.some((function(e){return!function(e){return"object"===typeof e&&"name"in e&&"string"===typeof e.name&&"text"in e&&"string"===typeof e.text}(e)}))?"nullValuesSupport"in e&&"boolean"===typeof e.nullValuesSupport?"OK":'The file must contain the field "nullValuesSupport: boolean"':'The file must contain the field "expressions: Expression[]" of length at least one':'The file must contain the field "relations: StoredRelationData[]" of length at least one'}function tn(e){return{relations:e.relations.map((function(e){return{name:(t=e).name,columnNames:Object(s.a)(t.columnNames),columnTypes:Object(s.a)(t.columnTypes),rows:t.rows.map((function(e){return Object(s.a)(e)})),columnCount:t.columnCount,rowCount:t.rowCount};var t})),expressions:e.expressions.map((function(e){return{name:(t=e).name,text:t.text};var t})),nullValuesSupport:e.nullValuesSupport}}var nn=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"load",value:function(){return new Promise((function(e,t){Wt.openFile(".rachel").then((function(n){if(null===n.text)t("Reading of the content of the file "+n.name+" failed.");else if(n.name.match(/\.rachel$/)){n.text=n.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");var r=JSON.parse(n.text),a=en(r);if("OK"===a)e(r);else t("Invalid structure of the JSON file. "+a)}else t("Please select a JSON file to load a project relation from.")}))}))}},{key:"save",value:function(e,t){var n=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});Object(qt.saveAs)(n,t+".rachel")}}]),e}();var rn=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"process",value:function(t){Wt.openFiles(".rachel").then((function(n){console.log(n.length+" files loaded to BatchProcessor"),console.time("Batch duration");var r=[],a=0,o=0,i=function(){var e=Kt()();r.forEach((function(t){e.file(t.name,t.text)})),e.generateAsync({type:"blob"}).then((function(e){Object(qt.saveAs)(e,t+".zip"),console.log("Batch finished: "+a+" files processed, "+o+" skipped."),ct.message("Batch finished: "+a+" files processed, "+o+" skipped.")})).catch((function(e){ct.error("Batch results saving error: "+e.message)})),console.timeEnd("Batch duration")};!function t(s){if(s>=n.length)return i();var l=n[s];null===l.text?(r.push({name:l.name+"-eval-report.txt",text:"ERROR: Source file cannot be loaded."}),o+=1,console.warn("Null read from "+l.name)):l.name.match(/\.rachel$/)?(r.push(e.processFile(l)),a+=1):(r.push({name:l.name+"-eval-report.txt",text:"ERROR: Source file is not a .rachel file, but: "+l.name}),o+=1,console.warn("Unsupported filetype: "+l.name)),ct.message("Batch in progress... "+(a+o)+"/"+n.length),setTimeout((function(){return t(s+1)}),0)}(0)}))}},{key:"parseRelations",value:function(e,t){var n=new Map;return e.forEach((function(e){try{var r=Ft.fromData(e,t);r.isValid()&&n.set(r.getName(),r.createRelation())}catch(a){}})),n}}]),e}();rn.processFile=function(e){var t=JSON.parse(e.text),n=en(t);if("OK"!==n)return{name:e.name.slice(0,-4)+"-eval-report.txt",text:"Invalid JSON file: "+n};var r=rn.parseRelations(t.relations,t.nullValuesSupport),a=new it(r,t.nullValuesSupport),o=t.expressions.length,i=t.expressions.map((function(e){return rn.processExpression(e,a)})),l=ln.apply(void 0,Object(s.a)(i.map((function(e){return e.counts})))),u=i.reduce((function(e,t){return e+t.error}),0);return{name:e.name.slice(0,-7)+"-eval-report.txt",text:rn.reportHeader(o,u,l,t.nullValuesSupport)+rn.formatRelations(t.relations)+an+"\n\nQUERIES ("+o+")\n\n"+i.map((function(e){return e.text})).join("")}},rn.processExpression=function(e,t){try{var n=t.parse(e.text),r=pn(n),a=n.getResult();return{text:on+"\n"+e.name+"\n\n"+e.text+"\n\n"+a.contentString()+"\n\n\n",counts:r,error:0}}catch(o){return{text:on+"\n"+e.name+"\n\n"+e.text+"\n\nERROR: "+o.message+"\n\n\n",counts:sn(),error:1}}},rn.reportHeader=function(e,t,n,r){var a,o,i=un(a=n)+cn(a),s=un(n),l=cn(n);return an+"\n\nRachel project report from "+(o=new Date,String(o.getDate()).padStart(2,"0")+"."+String(o.getMonth()+1).padStart(2,"0")+"."+String(o.getFullYear())+" "+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+"\n\n")+an+"\n\nExpressions: "+e+"    Errors: "+t+"\n\nUsed operations ("+i+" in total: "+s+" binary, "+l+" unary):\n    Selection: "+n.selection+"\n    Projection: "+n.projection+"\n    Rename: "+n.rename+"\n\n    Set Operations: "+n.setOperation+"\n\n    Natural join: "+n.natural+"\n    Cartesian product: "+n.cartesian+"\n    Semijoin: "+n.semijoin+"\n    Antijoin: "+n.antijoin+"\n    Theta Join: "+n.thetaJoin+"\n    Theta Semijoin: "+n.thetaSemijoin+"\n\n    Outer Join: "+n.outerJoin+"\n\n    Division: "+n.division+"\n\nNull values "+(r?"ALLOWED.\n\n":"FORBIDDEN.\n\n")},rn.formatRelations=function(e){var t=e.map((function(e){return e.name+"("+e.columnNames.join(", ")+")\n"})).join("");return an+"\n\nTABLES ("+e.length+")\n\n"+t+"\n"+e.map((function(e){return on+"\n"+e.name+"\n\n"+Ft.format(e)})).join("")};var an="################################################################################",on="--------------------------------------------------------------------------------";function sn(){return ln()}function ln(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{antijoin:t.reduce((function(e,t){return e+t.antijoin}),0),cartesian:t.reduce((function(e,t){return e+t.cartesian}),0),division:t.reduce((function(e,t){return e+t.division}),0),natural:t.reduce((function(e,t){return e+t.natural}),0),outerJoin:t.reduce((function(e,t){return e+t.outerJoin}),0),projection:t.reduce((function(e,t){return e+t.projection}),0),rename:t.reduce((function(e,t){return e+t.rename}),0),selection:t.reduce((function(e,t){return e+t.selection}),0),semijoin:t.reduce((function(e,t){return e+t.semijoin}),0),setOperation:t.reduce((function(e,t){return e+t.setOperation}),0),thetaJoin:t.reduce((function(e,t){return e+t.thetaJoin}),0),thetaSemijoin:t.reduce((function(e,t){return e+t.thetaSemijoin}),0)}}function un(e){return e.antijoin+e.cartesian+e.division+e.natural+e.outerJoin+e.semijoin+e.setOperation+e.thetaJoin+e.thetaSemijoin}function cn(e){return e.projection+e.rename+e.selection}function pn(e){return e instanceof se?ln(function(e){var t=sn();if(e instanceof ue)return t.projection=1,t;if(e instanceof ve)return t.rename=1,t;if(e instanceof He)return t.selection=1,t;return t}(e),pn(e.getSubtree())):e instanceof Ue?ln(function(e){var t=sn();if(e instanceof Ge)return t.antijoin=1,t;if(e instanceof Ze)return t.cartesian=1,t;if(e instanceof Xe)return t.division=1,t;if(e instanceof Ye)return t.outerJoin=1,t;if(e instanceof tt)return e.getType()===$e.natural?t.natural=1:t.semijoin=1,t;if(e instanceof rt)return t.setOperation=1,t;if(e instanceof at)return e.getType()===nt.full?t.thetaJoin=1:t.thetaSemijoin=1,t;return t}(e),pn(e.getLeftSubtree()),pn(e.getRightSubtree())):sn()}n(63);var hn=getComputedStyle(document.querySelector(":root")),fn=Number(hn.getPropertyValue("--cell-padding-sides-num")),dn=Number(hn.getPropertyValue("--input-margin-sides-num")),mn=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).containerRef=void 0,r.tableHeadRowRef=void 0,r.columnWidths=[],r.handleInputResize=function(e,t){e.scrollWidth>r.columnWidths[t]&&(r.columnWidths[t]=e.scrollWidth)},r.getErrors=function(){return r.props.relation.getErrors()},r.setSelectedInput=function(e,t){r.setState({selectedColumn:e,selectedRow:t})},r.moveSelectedInputRight=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e<r.props.relation.getColumnCount()-1&&r.setState({selectedColumn:e+1})},r.moveSelectedInputLeft=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e>0&&r.setState({selectedColumn:e-1})},r.moveSelectedInputUp=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&"number"===typeof t&&(0===t?r.setState({selectedRow:"names"}):r.setState({selectedRow:t-1}))},r.moveSelectedInputDown=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&("names"===t&&r.props.relation.getRowCount()>0&&r.setState({selectedRow:0}),"number"===typeof t&&t<r.props.relation.getRowCount()-1&&r.setState({selectedRow:t+1}))},r.handleKeyDown=function(e){"Enter"===e.key||"Esc"===e.key||"Escape"===e.key?r.setSelectedInput(void 0,void 0):"Tab"===e.key||e.ctrlKey&&"ArrowRight"===e.key?(r.moveSelectedInputRight(),e.preventDefault()):e.ctrlKey&&"ArrowLeft"===e.key?(r.moveSelectedInputLeft(),e.preventDefault()):e.ctrlKey&&"ArrowUp"===e.key?(r.moveSelectedInputUp(),e.preventDefault()):e.ctrlKey&&"ArrowDown"===e.key&&(r.moveSelectedInputDown(),e.preventDefault()),e.ctrlKey&&r.props.onCtrlInput(e)},r.handleChange=function(e,t,n){e=e.replace(/\t/g,"    "),"names"===n?r.props.onColumnNameChange(e,t):"types"===n?r.props.onColumnTypeChange(e,t):r.props.onRowInputChange(e,t,n)},r.handleNewColumn=function(){r.props.onNewColumn((function(){r.containerRef.current.scrollTo(r.containerRef.current.clientWidth,r.containerRef.current.scrollTop)}))},r.handleNewRow=function(){r.props.onNewRow((function(){r.containerRef.current.scrollTo(r.containerRef.current.scrollLeft,r.containerRef.current.clientHeight)}))},r.handleDeleteColumn=function(e){r.props.onDeleteColumn(e)},r.handleDeleteRow=function(e){r.props.onDeleteRow(e)},r.createInput=function(e,t,n){return a.a.createElement("input",{type:"text",className:"text-input",spellCheck:!1,value:e,onChange:function(e){r.handleChange(e.target.value,t,n),r.handleInputResize(e.target,t)},autoFocus:!0,style:{width:r.columnWidths[t]+"px"}})},r.createDeleteButton=function(e){return a.a.createElement("button",{className:"delete-row-or-column-button",onClick:e},"\u2716")},r.state={selectedColumn:void 0,selectedRow:void 0},r.containerRef=a.a.createRef(),r.tableHeadRowRef=a.a.createRef(),r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(){e.setSelectedInput(void 0,void 0)})),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e=this.tableHeadRowRef.current;if(null!==e){var t=Object(s.a)(e.cells).slice(1,-1);this.columnWidths=t.map((function(e){return e.clientWidth-2*(fn+dn)}))}}},{key:"createTooltip",value:function(e,t){return a.a.createElement("span",{className:"tooltip",style:t},e)}},{key:"createNamesRow",value:function(){var e=this,t=this.props.relation.getColumnNames().map((function(t,n){var r=t;e.state.selectedColumn===n&&"names"===e.state.selectedRow&&(r=e.createInput(t,n,"names"));var o=null,i="name-th",s=e.getErrors().get("name",n);return void 0!==s&&(o=e.createTooltip(s,{top:"90%",bottom:"auto"}),i+=" error-input"),a.a.createElement("th",{key:n,className:i,onClick:function(t){e.setSelectedInput(n,"names"),t.stopPropagation()}},r,o)}));return t.push(a.a.createElement("td",{key:"add-column",rowSpan:2,style:{width:"24px",border:"none",padding:"1px"}},a.a.createElement("button",{onClick:this.handleNewColumn,style:{width:"100%",height:"100%"}},a.a.createElement("strong",null,"+")))),a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createTypesRow",value:function(){var e=this,t=this.props.relation.getColumnTypes().map((function(t,n){var r=a.a.createElement("select",{value:t,onChange:function(t){return e.handleChange(t.target.value,n,"types")}},a.a.createElement("option",null,"number"),a.a.createElement("option",null,"string"),a.a.createElement("option",null,"boolean"));return a.a.createElement("th",{key:n,className:"type-th"},r,e.createDeleteButton((function(){return e.handleDeleteColumn(n)})))}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createRows",value:function(){var e=this;return 0===this.props.relation.getRows().length?null:this.props.relation.getRows().map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1,e.createDeleteButton((function(){return e.handleDeleteRow(n)}))),t.map((function(t,r){var o=t;e.state.selectedColumn===r&&e.state.selectedRow===n&&(o=e.createInput(t,r,n));var i=null,s="",l=e.getErrors().get(n,r);return void 0!==l&&(i=e.createTooltip(l),s="error-input"),a.a.createElement("td",{key:r,className:s,onClick:function(t){e.setSelectedInput(r,n),t.stopPropagation()}},o,i)})))}))}},{key:"createAddRow",value:function(){return a.a.createElement("tr",{key:"add-row"},a.a.createElement("td",{key:"add-row-column",className:"add-row-td"},a.a.createElement("button",{onClick:this.handleNewRow},a.a.createElement("strong",null,"+"))))}},{key:"render",value:function(){return a.a.createElement("div",{className:"edit-table-container scrollbar-container",ref:this.containerRef,onKeyDown:this.handleKeyDown},a.a.createElement("table",{className:"edit-table"},a.a.createElement("thead",null,a.a.createElement("tr",{ref:this.tableHeadRowRef},this.createNamesRow()),a.a.createElement("tr",null,this.createTypesRow())),a.a.createElement("tbody",null,this.createRows(),this.createAddRow())))}}]),n}(a.a.Component),vn=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).getCurRel=function(){return r.props.storedRelations[r.props.storedRelationIndex]},r.handleRelationNameChange=function(e){r.props.onRelationNameChange(e)},r.loadRelation=function(){r.getCurRel().isValid()?r.props.onLoadRelation(ct.message):ct.error("Cannot use the invalid relation. Check errors and try again.")},r.loadAllRelations=function(){r.props.onLoadAllRelations(ct.message)},r.exportRelations=function(){r.props.onExportRelations(ct.message)},r.importRelations=function(){r.props.onImportRelations(ct.message)},r.deleteRelation=function(){r.props.onDeleteStoredRelation()},r.revertRelation=function(){r.props.onRevertRelation()},r.newRelation=function(){r.props.onNewRelation()},r.removeLoadedRelations=function(){r.props.onRemoveLoadedRelations(ct.message)},r.handleCtrlInput=function(e){"Enter"===e.key&&r.loadRelation()},r.createRelationMenuButtons=function(){return r.props.storedRelations.map((function(e,t){var n=r.props.storedRelationIndex===t?"button-clicked":"",o=e.isActual()?"":"*",i=e.isValid()?{}:{border:"2px solid #fd3030"};return a.a.createElement("button",{key:t,onClick:function(){return r.handleSelectDifferentRelation(t)},className:n,style:i,draggable:!0,onDragStart:function(e){return e.dataTransfer.setData("text/plain","R"+String(t))},onDragOver:function(e){return e.preventDefault()},onDrop:function(e){return r.handleDragDrop(e,t)}},o+e.getName())}))},r.handleDragDrop=function(e,t){e.preventDefault();var n=e.dataTransfer.getData("text/plain"),a=Number(n.slice(1));"R"!==n.charAt(0)||isNaN(a)||r.props.onDragRelation(a,t)},r.state={sectionClicked:!1},r}return Object(u.a)(n,[{key:"handleSelectDifferentRelation",value:function(e){this.props.onSelectDifferentRelation(e)}},{key:"render",value:function(){var e=this,t=this.props.language.relationSection,n=function(e,t,n,r){return a.a.createElement(f,{key:e,text:e,onClick:t,style:r,tooltip:n})},r=this.props.storedRelations.filter((function(t,n){return n!==e.props.storedRelationIndex})).map((function(e){return e.getName()}));return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.relationSectionHeader),n(t.loadAllButton,this.loadAllRelations,t.loadAllButtonTooltip),n(t.removeLoadedButton,this.removeLoadedRelations,t.removeLoadedButtonTooltip),n(t.importButton,this.importRelations,t.importButtonTooltip),n(t.exportButton,this.exportRelations,t.exportButtonTooltip)),a.a.createElement("menu",{className:"page-section-tab-menu"},this.createRelationMenuButtons(),a.a.createElement("button",{onClick:this.newRelation,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(mn,{relation:this.getCurRel(),onColumnNameChange:this.props.onColumnNameChange,onColumnTypeChange:this.props.onColumnTypeChange,onRowInputChange:this.props.onRowInputChange,onNewRow:this.props.onNewRow,onNewColumn:this.props.onNewColumn,onDeleteRow:this.props.onDeleteRow,onDeleteColumn:this.props.onDeleteColumn,onCtrlInput:this.handleCtrlInput}),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(f,{text:t.loadButton,onClick:this.loadRelation,className:"action-button",style:{marginRight:"40px"},tooltip:t.loadButtonTooltip}),a.a.createElement(st,{value:this.getCurRel().getName(),buttonText:t.renameButton,onSubmit:this.handleRelationNameChange,forbidden:function(e){return r.indexOf(e)>-1||(!ne.isName(e)||(t=e,he.indexOf(t.toString())>-1));var t},id:"relation-name-input"}),n(t.deleteButton,this.deleteRelation,t.deleteButtonTooltip),n(t.revertButton,this.revertRelation,t.revertButtonTooltip+" ("+this.getCurRel().getRevertName()+")")))}}]),n}(a.a.Component),gn=function(){function e(t){Object(l.a)(this,e),this.accessToken=t}return Object(u.a)(e,[{key:"send",value:function(t,n){var r={access_token:this.accessToken,subject:t,text:n},a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status||4===a.readyState&&console.log("failed creating XMLHttpRequest in Mail.send: "+a.response)};var o=e.toParams(r);a.open("POST","https://postmail.invotes.com/send",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(o)}}],[{key:"toParams",value:function(e){return encodeURIComponent("access_token")+"="+encodeURIComponent(e.access_token)+"&"+encodeURIComponent("subject")+"="+encodeURIComponent(e.subject)+"&"+encodeURIComponent("text")+"="+encodeURIComponent(e.text)}}]),e}(),yn=function(e){Object(c.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(l.a)(this,n),(r=t.call(this,e)).expressionSectionRef=void 0,r.reportUnexpectedError=function(e){var t,n=new gn("5uog26ex8q9qu7sqib8ea0qd"),a="Unexpected error "+e.name+" in Rachel application.\n\nMessage:\n"+e.message+"\n\nDate:\n"+(new Date).toString()+"\n\nStack trace:\n"+e.stack+"\n\nLoaded relations: ----------------------------\n"+Object(s.a)(r.state.loadedRelations.values()).map((function(e){return e.getName()+"\n"+e.contentString()})).join("\n\n")+"\n\nStored relations: ----------------------------\nSelected relation (1-index): "+(r.state.selectedRelation+1)+"\n\n"+r.state.storedRelations.map((function(e){return Ft.format(e)})).join("\n\n")+"\n\nExpressions: ----------------------------\nSelected expression (1-index): "+(r.state.selectedExpression+1)+"\n\n"+r.state.expressions.map((function(e){return e.text})).join("\n\n###\n\n")+"\n\nEvaluation tree:\n"+(null===(t=r.state.evaluationTreeRoot)||void 0===t?void 0:t.printInLine())+"\n\nOther state: ----------------------------\ncsvValueSeparator: "+r.state.csvValueSeparator+"\nlanguage:          "+r.state.language+"\nnullValuesSupport: "+r.state.nullValuesSupport+"\ndarkTheme:         "+r.state.darkTheme;n.send("Rachel application unexpected error",a),console.error("Unexpected error: "+e.stack)},r.loadProject=function(e){r.setState({loadedRelations:new Map,storedRelations:e.relations.map((function(t){return Ft.fromData(t,e.nullValuesSupport)})),selectedRelation:0,expressions:e.expressions,nullValuesSupport:e.nullValuesSupport,selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:""},(function(){console.log("Project loaded."),r.updateExpressionsErrors()}))},r.ensureUniqueRelationName=function(e){if(r.state.storedRelations.map((function(e){return e.getName()})).indexOf(e)>-1)for(var t=2;;++t)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(e+t)){e+=t;break}return e},r.handleBatch=function(){rn.process("rachel-eval-results")},r.handleLoadProject=function(){nn.load().then(r.loadProject).catch(console.warn)},r.handleSaveProject=function(){try{nn.save({relations:r.state.storedRelations.map((function(e){return e.toDataObject()})),expressions:r.state.expressions,nullValuesSupport:r.state.nullValuesSupport},"project"),console.log("Project saved.")}catch(e){console.warn("Project saving failed: "+e.message)}},r.handleLoadSampleProject=function(e){r.loadProject(tn(e))},r.handleNullValuesSupportChange=function(e){r.state.storedRelations.forEach((function(t){return t.setNullValuesSupport(e)})),r.setState({nullValuesSupport:e},r.updateExpressionsErrors)},r.handleCsvValueSeparatorChange=function(e){E.setCsvValueSeparator(e),r.setState({csvValueSeparator:e})},r.handleLanguageChange=function(e){E.setLanguage(e),r.state.storedRelations.forEach((function(e){return e.recomputeErrors()})),r.setState({language:R()})},r.handleDarkThemeChange=function(e){E.setDarkTheme(e),r.setState({darkTheme:e}),document.body.classList.toggle("body-dark",e),document.body.classList.toggle("body-light",!e)},r.handleRelationNameChange=function(e){r.setState((function(t){var n=t.storedRelations;return n[r.state.selectedRelation].setName(e),{storedRelations:n}}))},r.handleRelationColumnNameChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnName(e,t),{storedRelations:a}}))},r.handleRelationColumnTypeChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnType(e,t),{storedRelations:a}}))},r.handleRelationRowInputChange=function(e,t,n){r.setState((function(a){var o=a.storedRelations;return o[r.state.selectedRelation].setRowInput(e,n,t),{storedRelations:o}}))},r.handleRelationNewRow=function(e){r.state.storedRelations[r.state.selectedRelation].addNewRow(),r.setState({},e)},r.handleRelationNewColumn=function(e){r.state.storedRelations[r.state.selectedRelation].addNewColumn(),r.setState({},e)},r.handleRelationDeleteRow=function(e){r.state.storedRelations[r.state.selectedRelation].deleteRow(e),r.setState({})},r.handleRelationDeleteColumn=function(e){r.state.storedRelations[r.state.selectedRelation].deleteColumn(e),r.setState({})},r.handleSelectDifferentRelation=function(e){r.setState({selectedRelation:e})},r.handleDragRelation=function(e,t){if(e>t){var n=r.state.storedRelations.slice(0,t),a=r.state.storedRelations.slice(t,e),o=r.state.storedRelations[e],i=r.state.storedRelations.slice(e+1),l=[].concat(Object(s.a)(n),[o],Object(s.a)(a),Object(s.a)(i));r.setState({storedRelations:l,selectedRelation:t})}else if(e<t){var u=r.state.storedRelations.slice(0,e),c=r.state.storedRelations[e],p=r.state.storedRelations.slice(e+1,t+1),h=r.state.storedRelations.slice(t+1),f=[].concat(Object(s.a)(u),Object(s.a)(p),[c],Object(s.a)(h));r.setState({storedRelations:f,selectedRelation:t})}},r.handleCreateNewRelation=function(){var e=r.state.selectedRelation+1,t=r.ensureUniqueRelationName("NewRelation");r.state.storedRelations.splice(e,0,Ft.new(t,r.state.nullValuesSupport)),r.setState({selectedRelation:e})},r.handleDeleteRelation=function(){if(1!==r.state.storedRelations.length){var e=r.state.selectedRelation;r.state.storedRelations.splice(e,1),e===r.state.storedRelations.length?r.setState({selectedRelation:e-1},r.updateExpressionsErrors):r.setState({},r.updateExpressionsErrors)}else r.setState({storedRelations:[Ft.new("Relation",r.state.nullValuesSupport)]})},r.handleRevertRelation=function(){r.setState((function(e){var t=e.storedRelations;return t[r.state.selectedRelation].revert(),{storedRelations:t}}))},r.handleRemoveLoadedRelations=function(e){var t=r.state.language.userMessages,n=r.state.loadedRelations.size;r.state.loadedRelations.clear(),r.state.storedRelations.forEach((function(e){return e.setActual(!1)})),e(n+t.deleteLoadedRelations),r.setState({},r.updateExpressionsErrors)},r.handleExportRelations=function(e){var t=r.state.language.userMessages;try{Gt.save(r.state.storedRelations,"relations",r.state.csvValueSeparator),e(r.state.storedRelations.length+t.relationsExportOK)}catch(n){e(t.relationsExportErr+n)}},r.handleImportRelations=function(e){var t=r.state.language.userMessages;Gt.load(r.state.nullValuesSupport).then((function(n){var a=r.state.storedRelations.length;n.relations.forEach((function(e){var t=r.ensureUniqueRelationName(e.getName());e.setName(t),r.state.storedRelations.push(e)})),n.relations.length>0&&r.setState({selectedRelation:a}),e(n.relations.length+t.relationsImport[0]+n.skipped+t.relationsImport[1])}))},r.handleLoadRelation=function(e){var t=r.state.language.userMessages,n=r.state.storedRelations[r.state.selectedRelation];n.setActual(!0),r.state.loadedRelations.set(n.getName(),n.createRelation());var a=0===r.state.loadedRelations.size?t.loadedRelationsTotalNo:r.state.loadedRelations.size+t.loadedRelationsTotalSome+Object(s.a)(r.state.loadedRelations.keys()).join(", ")+".";e(t.loadRelationNew+"\n"+a),r.setState({},r.updateExpressionsErrors)},r.handleLoadAllRelations=function(e){var t=r.state.language.userMessages,n=0,a=0;r.state.storedRelations.forEach((function(e){e.isValid()?(e.setActual(!0),r.state.loadedRelations.set(e.getName(),e.createRelation()),++n):++a}));var o=0===r.state.loadedRelations.size?t.loadedRelationsTotalNo:r.state.loadedRelations.size+t.loadedRelationsTotalSome+Object(s.a)(r.state.loadedRelations.keys()).join(", ")+".";e(n+t.loadAllRelationsNew[0]+a+t.loadAllRelationsNew[1]+"\n"+o),r.setState({},r.updateExpressionsErrors)},r.updateExpressionsErrors=function(){var e=r.expressionSectionRef.current;null!==e&&e.updateErrorsAndParentheses()},r.handleExprEval=function(e){r.setState({evaluationTreeRoot:e,evaluatedExpressionName:r.state.expressions[r.state.selectedExpression].name})},r.handleExprTextChange=function(e,t){r.setState((function(n){var r=n.expressions;return r[n.selectedExpression]={name:e,text:t},{expressions:r}}))},r.handleSelectDifferentExpression=function(e){r.setState({selectedExpression:e},r.updateExpressionsErrors)},r.handleDragExpression=function(e,t){if(e>t){var n=r.state.expressions.slice(0,t),a=r.state.expressions.slice(t,e),o=r.state.expressions[e],i=r.state.expressions.slice(e+1),l=[].concat(Object(s.a)(n),[o],Object(s.a)(a),Object(s.a)(i));r.setState({expressions:l,selectedExpression:t})}else if(e<t){var u=r.state.expressions.slice(0,e),c=r.state.expressions[e],p=r.state.expressions.slice(e+1,t+1),h=r.state.expressions.slice(t+1),f=[].concat(Object(s.a)(u),Object(s.a)(p),[c],Object(s.a)(h));r.setState({expressions:f,selectedExpression:t})}},r.handleCreateNewExpression=function(){var e=r.state.selectedExpression+1;r.state.expressions.splice(e,0,{name:"New expression",text:""}),r.setState({selectedExpression:e})},r.handleDeleteExpression=function(e){if(1===r.state.expressions.length)return r.handleExprTextChange("Expression 1","");var t=r.state.selectedExpression;r.state.expressions.splice(t,1),t===r.state.expressions.length?r.setState({selectedExpression:t-1},e):r.setState({},e)},r.handleExportExpressions=function(e){var t=r.state.language.userMessages;try{Qt.save(r.state.expressions,"expressions"),e(t.expressionsExportOK)}catch(n){e(t.expressionsExportErr+n.message)}},r.handleImportExpressions=function(e){var t=r.state.language.userMessages;Qt.load().then((function(n){var a;(a=r.state.expressions).push.apply(a,Object(s.a)(n.expressions)),r.setState({}),e(n.expressions.length+t.expressionsImport[0]+n.loadedFiles+t.expressionsImport[1]+ +n.skippedExpressions+t.expressionsImport[2]+n.skippedFiles+t.expressionsImport[3])}))},r.addResultRelation=function(e){var t=r.ensureUniqueRelationName("Evaluated"),n=Ft.fromRelation(t,e,r.state.nullValuesSupport);r.state.storedRelations.push(n),r.setState({selectedRelation:r.state.storedRelations.length-1})},document.body.classList.toggle("body-dark",E.getDarkTheme()),document.body.classList.toggle("body-light",!E.getDarkTheme());return r.state={samples:$t(),loadedRelations:new Map,storedRelations:[Ft.fromData({name:"Relation",columnNames:["Column1","Column2","Column3"],columnTypes:["number","string","boolean"],rows:[["","",""]],columnCount:3,rowCount:1},!0)],selectedRelation:0,expressions:[{name:"Expression 1",text:""}],selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:"",nullValuesSupport:!0,csvValueSeparator:E.getCsvValueSeparator(),language:R(),darkTheme:E.getDarkTheme()},r.expressionSectionRef=a.a.createRef(),r}return Object(u.a)(n,[{key:"render",value:function(){var e=null;return null!==this.state.evaluationTreeRoot&&(e=a.a.createElement(Zt,{evaluationTreeRoot:this.state.evaluationTreeRoot,expressionName:this.state.evaluatedExpressionName,onAddResult:this.addResultRelation,onUnexpectedError:this.reportUnexpectedError,csvValueSeparator:this.state.csvValueSeparator,darkTheme:this.state.darkTheme,language:this.state.language})),a.a.createElement("main",null,a.a.createElement(Yt,{onBatch:this.handleBatch,onLoadProject:this.handleLoadProject,onSaveProject:this.handleSaveProject,onLoadSample:this.handleLoadSampleProject,csvValueSeparator:this.state.csvValueSeparator,language:this.state.language,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,onCsvValueSeparatorChange:this.handleCsvValueSeparatorChange,onLanguageChange:this.handleLanguageChange,onNullValuesSupportChange:this.handleNullValuesSupportChange,onDarkThemeChange:this.handleDarkThemeChange}),a.a.createElement(vn,{storedRelations:this.state.storedRelations,storedRelationIndex:this.state.selectedRelation,loadedRelations:Object(s.a)(this.state.loadedRelations.values()),onRelationNameChange:this.handleRelationNameChange,onColumnNameChange:this.handleRelationColumnNameChange,onColumnTypeChange:this.handleRelationColumnTypeChange,onRowInputChange:this.handleRelationRowInputChange,onNewRow:this.handleRelationNewRow,onNewColumn:this.handleRelationNewColumn,onDeleteRow:this.handleRelationDeleteRow,onDeleteColumn:this.handleRelationDeleteColumn,onSelectDifferentRelation:this.handleSelectDifferentRelation,onDragRelation:this.handleDragRelation,onNewRelation:this.handleCreateNewRelation,onLoadRelation:this.handleLoadRelation,onDeleteStoredRelation:this.handleDeleteRelation,onRevertRelation:this.handleRevertRelation,onLoadAllRelations:this.handleLoadAllRelations,onRemoveLoadedRelations:this.handleRemoveLoadedRelations,onExportRelations:this.handleExportRelations,onImportRelations:this.handleImportRelations,nullValuesSupport:this.state.nullValuesSupport,language:this.state.language}),a.a.createElement(pt,{ref:this.expressionSectionRef,expressions:this.state.expressions,currentExpressionIndex:this.state.selectedExpression,relations:this.state.loadedRelations,onChange:this.handleExprTextChange,onEval:this.handleExprEval,onSelectDifferentExpression:this.handleSelectDifferentExpression,onDragExpression:this.handleDragExpression,onNewExpression:this.handleCreateNewExpression,onDeleteExpression:this.handleDeleteExpression,onExportExpressions:this.handleExportExpressions,onImportExpressions:this.handleImportExpressions,onUnexpectedError:this.reportUnexpectedError,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,language:this.state.language}),e)}}]),n}(r.Component);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(yn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[64,1,2]]]);
//# sourceMappingURL=main.190d98f8.chunk.js.map