/*! For license information please see main.957f2adc.chunk.js.LICENSE.txt */
(this.webpackJsonprachel=this.webpackJsonprachel||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(12),i=n.n(o),s=(n(35),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(5),c=n(1),h=n(2),p=n(3),d=n(4),f=n(10),g=n(21),v=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).range=r,a}return n}(Object(g.a)(Error));function m(e,t){return e instanceof v&&void 0===e.range&&(e.range=t),e}var y,k,x,b=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,"Semantic error: "+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(f.a)(a),n),a.name="RASemanticError",a}return n}(v),E=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,"Syntax error: "+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(f.a)(a),n),a.name="RASyntaxError",a}return n}(v),w=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),r=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(Object(f.a)(r),n),r.name="CodeError",r}return n}(Object(g.a)(Error));!function(e){e[e.resultSection_getCurrentRelation_nodeIndexNotFound=1]="resultSection_getCurrentRelation_nodeIndexNotFound",e[e.resultSection_getCurrentRelation_evalError=2]="resultSection_getCurrentRelation_evalError",e[e.resultSection_saveResultRelation_nullRelationToSave=3]="resultSection_saveResultRelation_nullRelationToSave",e[e.resultSection_handleAddRelation_nullRelationToAdd=4]="resultSection_handleAddRelation_nullRelationToAdd",e[e.row_getOrderedValues_absentColumn=5]="row_getOrderedValues_absentColumn",e[e.valueParser_rpnToVETreeRecursive_unexpectedToken=6]="valueParser_rpnToVETreeRecursive_unexpectedToken",e[e.exprParser_isValidSequence_unexpectedToken=7]="exprParser_isValidSequence_unexpectedToken",e[e.exprParser_rpnToVETreeRecursive_unexpectedToken=8]="exprParser_rpnToVETreeRecursive_unexpectedToken",e[e.exprParser_parseTokensForWhisper_thetaJoinBranchError=9]="exprParser_parseTokensForWhisper_thetaJoinBranchError",e[e.exprParser_parseTokensForWhisper_projectionBranchError=10]="exprParser_parseTokensForWhisper_projectionBranchError"}(y||(y={})),function(e){e[e.exprParser_parse_relationNotDefined=1001]="exprParser_parse_relationNotDefined",e[e.binaryNode_eval_commonColumnsInSources=1002]="binaryNode_eval_commonColumnsInSources",e[e.setOperationNode_eval_notEqualColumnsInSources=1003]="setOperationNode_eval_notEqualColumnsInSources",e[e.divisionNode_eval_rightColumnsNotSubsetOfLeft=1004]="divisionNode_eval_rightColumnsNotSubsetOfLeft",e[e.divisionNode_eval_rightColumnsNotProperSubsetOfLeft=1005]="divisionNode_eval_rightColumnsNotProperSubsetOfLeft",e[e.renameNode_eval_absentOriginalColumn=1006]="renameNode_eval_absentOriginalColumn",e[e.renameNode_eval_changeToDuplicitName=1007]="renameNode_eval_changeToDuplicitName",e[e.projectionNode_eval_absentColumn=1008]="projectionNode_eval_absentColumn",e[e.referenceValue_eval_absentColumn=1009]="referenceValue_eval_absentColumn"}(k||(k={})),function(e){e[e.exprParser_parse_emptyStringGiven=2001]="exprParser_parse_emptyStringGiven",e[e.exprParser_parseTokens_outerJoinWhenNullNotSupported=2002]="exprParser_parseTokens_outerJoinWhenNullNotSupported",e[e.exprParser_parseTokens_unexpectedPart=2003]="exprParser_parseTokens_unexpectedPart",e[e.exprParser_parseTokens_bothBranchesError=2004]="exprParser_parseTokens_bothBranchesError",e[e.exprParser_rpnToVETree_invalidExpression=2005]="exprParser_rpnToVETree_invalidExpression",e[e.exprParser_assertValidInfixTokens_invalidParentheses=2006]="exprParser_assertValidInfixTokens_invalidParentheses",e[e.exprParser_assertValidInfixTokens_invalidStart=2007]="exprParser_assertValidInfixTokens_invalidStart",e[e.exprParser_assertValidInfixTokens_invalidEnd=2008]="exprParser_assertValidInfixTokens_invalidEnd",e[e.exprParser_assertValidInfixTokens_relationAfterRelation=2009]="exprParser_assertValidInfixTokens_relationAfterRelation",e[e.exprParser_assertValidInfixTokens_relationAfterUnary=2010]="exprParser_assertValidInfixTokens_relationAfterUnary",e[e.exprParser_assertValidInfixTokens_relationAfterClosing=2011]="exprParser_assertValidInfixTokens_relationAfterClosing",e[e.exprParser_assertValidInfixTokens_unaryAfterBinary=2012]="exprParser_assertValidInfixTokens_unaryAfterBinary",e[e.exprParser_assertValidInfixTokens_unaryAfterOpening=2013]="exprParser_assertValidInfixTokens_unaryAfterOpening",e[e.exprParser_assertValidInfixTokens_binaryAfterBinary=2014]="exprParser_assertValidInfixTokens_binaryAfterBinary",e[e.exprParser_assertValidInfixTokens_binaryAfterOpening=2015]="exprParser_assertValidInfixTokens_binaryAfterOpening",e[e.exprParser_assertValidInfixTokens_openingAfterRelation=2016]="exprParser_assertValidInfixTokens_openingAfterRelation",e[e.exprParser_assertValidInfixTokens_openingAfterUnary=2017]="exprParser_assertValidInfixTokens_openingAfterUnary",e[e.exprParser_assertValidInfixTokens_openingAfterClosing=2018]="exprParser_assertValidInfixTokens_openingAfterClosing",e[e.exprParser_assertValidInfixTokens_closingAfterBinary=2019]="exprParser_assertValidInfixTokens_closingAfterBinary",e[e.exprParser_assertValidInfixTokens_closingAfterOpening=2020]="exprParser_assertValidInfixTokens_closingAfterOpening",e[e.valueParser_parseTokens_emptyInput=2021]="valueParser_parseTokens_emptyInput",e[e.valueParser_parseTokens_unsupportedNull=2022]="valueParser_parseTokens_unsupportedNull",e[e.valueParser_parseTokens_unexpectedPart=2023]="valueParser_parseTokens_unexpectedPart",e[e.valueParser_toRPN_missingOpeningParenthesis=2024]="valueParser_toRPN_missingOpeningParenthesis",e[e.valueParser_toRPN_missingClosingParenthesis=2025]="valueParser_toRPN_missingClosingParenthesis",e[e.valueParser_rpnToVETree_invalidExpression=2026]="valueParser_rpnToVETree_invalidExpression",e[e.valueParser_rpnToVETree_invalidStart=2027]="valueParser_rpnToVETree_invalidStart",e[e.valueParser_rpnToVETree_invalidEnd=2028]="valueParser_rpnToVETree_invalidEnd",e[e.valueParser_rpnToVETree_literalAfterLiteral=2029]="valueParser_rpnToVETree_literalAfterLiteral",e[e.valueParser_rpnToVETree_literalAfterReference=2030]="valueParser_rpnToVETree_literalAfterReference",e[e.valueParser_rpnToVETree_literalAfterClosing=2031]="valueParser_rpnToVETree_literalAfterClosing",e[e.valueParser_rpnToVETree_referenceAfterLiteral=2032]="valueParser_rpnToVETree_referenceAfterLiteral",e[e.valueParser_rpnToVETree_referenceAfterReference=2033]="valueParser_rpnToVETree_referenceAfterReference",e[e.valueParser_rpnToVETree_referenceAfterClosing=2034]="valueParser_rpnToVETree_referenceAfterClosing",e[e.valueParser_rpnToVETree_notAfterLiteral=2035]="valueParser_rpnToVETree_notAfterLiteral",e[e.valueParser_rpnToVETree_notAfterReference=2036]="valueParser_rpnToVETree_notAfterReference",e[e.valueParser_rpnToVETree_notAfterClosing=2037]="valueParser_rpnToVETree_notAfterClosing",e[e.valueParser_rpnToVETree_binaryAfterOperator=2038]="valueParser_rpnToVETree_binaryAfterOperator",e[e.valueParser_rpnToVETree_binaryAfterOpening=2039]="valueParser_rpnToVETree_binaryAfterOpening",e[e.valueParser_rpnToVETree_openingAfterLiteral=2040]="valueParser_rpnToVETree_openingAfterLiteral",e[e.valueParser_rpnToVETree_openingAfterReference=2041]="valueParser_rpnToVETree_openingAfterReference",e[e.valueParser_rpnToVETree_openingAfterClosing=2042]="valueParser_rpnToVETree_openingAfterClosing",e[e.valueParser_rpnToVETree_closingAfterOperator=2043]="valueParser_rpnToVETree_closingAfterOperator",e[e.valueParser_rpnToVETree_closingAfterOpening=2044]="valueParser_rpnToVETree_closingAfterOpening",e[e.parser_nextBorderedPart_missingClosingChar=2045]="parser_nextBorderedPart_missingClosingChar",e[e.parser_skipWhitespacesAndChar_charNotFound=2046]="parser_skipWhitespacesAndChar_charNotFound",e[e.projectionNode_constructor_invalidProjectionString=2047]="projectionNode_constructor_invalidProjectionString",e[e.projectionNode_parseProjection_invalidProjectedColumnName=2048]="projectionNode_parseProjection_invalidProjectedColumnName",e[e.renameNode_parseChanges_invalidRenameString=2049]="renameNode_parseChanges_invalidRenameString",e[e.renameNode_parseChanges_missingArrow=2050]="renameNode_parseChanges_missingArrow",e[e.renameNode_parseChanges_invalidNewName=2051]="renameNode_parseChanges_invalidNewName",e[e.renameNode_parseChanges_keywordNewName=2052]="renameNode_parseChanges_keywordNewName",e[e.renameNode_parseChanges_multipleRenameOfTheColumn=2053]="renameNode_parseChanges_multipleRenameOfTheColumn",e[e.selectionNode_constructor_invalidString=2054]="selectionNode_constructor_invalidString",e[e.selectionNode_constructor_emptyString=2055]="selectionNode_constructor_emptyString",e[e.selectionNode_eval_resultNotBoolean=2056]="selectionNode_eval_resultNotBoolean",e[e.thetaJoinNode_constructor_invalidString=2057]="thetaJoinNode_constructor_invalidString",e[e.thetaJoinNode_constructor_emptyString=2058]="thetaJoinNode_constructor_emptyString",e[e.thetaJoinNode_eval_resultNotBoolean=2059]="thetaJoinNode_eval_resultNotBoolean",e[e.thetaSemiJoinNode_constructor_invalidString=2060]="thetaSemiJoinNode_constructor_invalidString",e[e.thetaSemiJoinNode_constructor_emptyString=2061]="thetaSemiJoinNode_constructor_emptyString",e[e.thetaSemiJoinNode_eval_resultNotBoolean=2062]="thetaSemiJoinNode_eval_resultNotBoolean",e[e.comparingOperator_eval_differentInputTypes=2063]="comparingOperator_eval_differentInputTypes",e[e.computingOperator_eval_inputTypesNotNumbers=2064]="computingOperator_eval_inputTypesNotNumbers",e[e.logicalOperator_eval_leftInputNotBoolean=2065]="logicalOperator_eval_leftInputNotBoolean",e[e.logicalOperator_eval_rightInputNotBoolean=2066]="logicalOperator_eval_rightInputNotBoolean"}(x||(x={}));var R=new Map([[y.resultSection_getCurrentRelation_nodeIndexNotFound,["ResultSection.getCurrentRelation: Selected node index in evaluation tree not found."]],[y.resultSection_getCurrentRelation_evalError,["ResultSection.getCurrentRelation: Evaluation error in result section: ",""]],[y.resultSection_saveResultRelation_nullRelationToSave,["ResultSection.saveResultRelation: Result relation is null when tried to save it."]],[y.resultSection_handleAddRelation_nullRelationToAdd,["ResultSection.handleAddRelation: Result relation is null when tried to add it."]],[y.row_getOrderedValues_absentColumn,["Row.getOrderedValues: Column "," is absent in row with columns: ",""]],[y.valueParser_rpnToVETreeRecursive_unexpectedToken,["ValueParser.rpnToVETreeRecursive: Unexpected token: ","."]],[y.exprParser_isValidSequence_unexpectedToken,["ExprParser.isValidSequence: Unexpected token: ","."]],[y.exprParser_rpnToVETreeRecursive_unexpectedToken,["ExprParser.rpnToVETreeRecursive: Unexpected token: ","."]],[y.exprParser_parseTokensForWhisper_thetaJoinBranchError,["ExprParser.parseTokensForWhisper: Error in theta join branch: ","."]],[y.exprParser_parseTokensForWhisper_projectionBranchError,["ExprParser.parseTokensForWhisper: Error in projection branch: ","."]]]),_=new Map([[k.exprParser_parse_relationNotDefined,['Relation "','" is not defined. Please check relations definitions.']],[k.binaryNode_eval_commonColumnsInSources,["Source relations for ",' have common columns "','".']],[k.setOperationNode_eval_notEqualColumnsInSources,['Source relations "','" and "','" for set '," do not have the same column sets."]],[k.divisionNode_eval_rightColumnsNotSubsetOfLeft,['Right source relation "','" is not a subset of the left source relation "','".']],[k.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,['Right source relation "','" is not a proper subset of the left source relation "',". There must exist a column in the left relation which is not present in the right relation."]],[k.renameNode_eval_absentOriginalColumn,['Invalid rename, column "','" does not exist in the source relation.']],[k.renameNode_eval_changeToDuplicitName,['Invalid rename, new column name "','" is duplicit in the changed relation.']],[k.projectionNode_eval_absentColumn,['Invalid projection of the column "','". It does not exist in the source relation.']],[k.referenceValue_eval_absentColumn,['Column "','" is absent in a schema with columns: ',"."]]]),S=new Map([[x.exprParser_parse_emptyStringGiven,["Cannot parse an expression from an empty string."]],[x.exprParser_parseTokens_outerJoinWhenNullNotSupported,["Found "," when null values are not supported."]],[x.exprParser_parseTokens_unexpectedPart,['Unexpected part "','" in RA expression.']],[x.exprParser_parseTokens_bothBranchesError,['All combinations throw error in "','". When treated as projection:\n',"\nWhen treated as theta join:\n",""]],[x.exprParser_rpnToVETree_invalidExpression,["Given string is not a valid expression."]],[x.exprParser_assertValidInfixTokens_invalidParentheses,["Invalid structure of parentheses in the expression."]],[x.exprParser_assertValidInfixTokens_invalidStart,["RA expression cannot start with ","."]],[x.exprParser_assertValidInfixTokens_invalidEnd,["RA expression cannot end with ","."]],[x.exprParser_assertValidInfixTokens_relationAfterRelation,['Relation "','" after relation "','".']],[x.exprParser_assertValidInfixTokens_relationAfterUnary,['Relation "','" after unary operator "','".']],[x.exprParser_assertValidInfixTokens_relationAfterClosing,['Relation "','" after closing parenthesis.']],[x.exprParser_assertValidInfixTokens_unaryAfterBinary,['Unary operator "','" after binary operator "','".']],[x.exprParser_assertValidInfixTokens_unaryAfterOpening,['Unary operator "','" after opening parenthesis.']],[x.exprParser_assertValidInfixTokens_binaryAfterBinary,['Binary operator "','" after binary operator "','".']],[x.exprParser_assertValidInfixTokens_binaryAfterOpening,['Binary operator "','" after opening parenthesis.']],[x.exprParser_assertValidInfixTokens_openingAfterRelation,['Opening parentheses after relation "','".']],[x.exprParser_assertValidInfixTokens_openingAfterUnary,['Opening parentheses after unary operator "','".']],[x.exprParser_assertValidInfixTokens_openingAfterClosing,["Opening parentheses after closing parentheses."]],[x.exprParser_assertValidInfixTokens_closingAfterBinary,['Closing parentheses after binary operator "','".']],[x.exprParser_assertValidInfixTokens_closingAfterOpening,["Closing parentheses after opening parentheses."]],[x.valueParser_parseTokens_emptyInput,["An empty string given as a condition."]],[x.valueParser_parseTokens_unsupportedNull,["Null constant used when null values are not supported."]],[x.valueParser_parseTokens_unexpectedPart,['Unexpected part "','" in expression.']],[x.valueParser_toRPN_missingOpeningParenthesis,["Missing opening parenthesis '(' in an expression."]],[x.valueParser_toRPN_missingClosingParenthesis,["Missing closing parenthesis ')' in an expression."]],[x.valueParser_rpnToVETree_invalidExpression,["Given string is not a valid expression."]],[x.valueParser_rpnToVETree_invalidStart,['Expression cannot start with "','".']],[x.valueParser_rpnToVETree_invalidEnd,['Expression cannot end with "','".']],[x.valueParser_rpnToVETree_literalAfterLiteral,['Literal "','" after literal "','".']],[x.valueParser_rpnToVETree_literalAfterReference,['Literal "','" after reference to column "','".']],[x.valueParser_rpnToVETree_literalAfterClosing,['Literal "','" after closing parentheses.']],[x.valueParser_rpnToVETree_referenceAfterLiteral,['Reference to column "','" after literal "','".']],[x.valueParser_rpnToVETree_referenceAfterReference,['Reference to column "','" after reference to column "','".']],[x.valueParser_rpnToVETree_referenceAfterClosing,['Reference to column "','" after closing parentheses.']],[x.valueParser_rpnToVETree_notAfterLiteral,['Logical not operator "','" after literal "','".']],[x.valueParser_rpnToVETree_notAfterReference,['Logical not operator "','" after reference to column "','".']],[x.valueParser_rpnToVETree_notAfterClosing,['Logical not operator "','" after closing parentheses.']],[x.valueParser_rpnToVETree_binaryAfterOperator,['Binary operator "','" after binary operator "','".']],[x.valueParser_rpnToVETree_binaryAfterOpening,['Binary operator "','" after opening parentheses.']],[x.valueParser_rpnToVETree_openingAfterLiteral,['Opening parentheses after literal "','".']],[x.valueParser_rpnToVETree_openingAfterReference,['Opening parentheses after reference to column "','".']],[x.valueParser_rpnToVETree_openingAfterClosing,["Opening parentheses after closing parentheses."]],[x.valueParser_rpnToVETree_closingAfterOperator,['Closing parentheses after binary operator "','".']],[x.valueParser_rpnToVETree_closingAfterOpening,["Closing parentheses after opening parentheses."]],[x.parser_nextBorderedPart_missingClosingChar,["Missing '","' after opening '","'."]],[x.parser_skipWhitespacesAndChar_charNotFound,['Expected "','" not found.']],[x.projectionNode_constructor_invalidProjectionString,['"',"\" is not a projection string. It must be bordered with '[' and ']'."]],[x.projectionNode_parseProjection_invalidProjectedColumnName,['Invalid projection of column "','". Column name must contain letters, number and underscores only and start with a letter.']],[x.renameNode_parseChanges_invalidRenameString,['"',"\" is not a rename string. It must be bordered with '<' and '>'."]],[x.renameNode_parseChanges_missingArrow,["Invalid rename, please use \"OldName -> NewName\" for each column renaming separated by commas ','."]],[x.renameNode_parseChanges_invalidNewName,['Invalid rename to "','". New column name must contain letters, number and underscores only and start with a letter.']],[x.renameNode_parseChanges_keywordNewName,['Invalid rename to "','". New column name cannot be a keyword.']],[x.renameNode_parseChanges_multipleRenameOfTheColumn,['Multiple rename of column "','".']],[x.selectionNode_constructor_invalidString,["Invalid selection, it must be bordered with '(' and ')'."]],[x.selectionNode_constructor_emptyString,["The selection cannot be empty."]],[x.selectionNode_eval_resultNotBoolean,["Result of the selection condition "," is not a boolean value, but ","."]],[x.thetaJoinNode_constructor_invalidString,["Invalid theta join, it must be bordered with '[' and ']'."]],[x.thetaJoinNode_constructor_emptyString,["The theta join condition cannot be empty."]],[x.thetaJoinNode_eval_resultNotBoolean,["Result of the theta join condition "," is not a boolean value, but ","."]],[x.thetaSemiJoinNode_constructor_invalidString,["Invalid theta semijoin, it must be bordered with '<' and ']' or '[' and '>'."]],[x.thetaSemiJoinNode_constructor_emptyString,["The theta semijoin condition cannot be empty."]],[x.thetaSemiJoinNode_eval_resultNotBoolean,["Result of the theta semijoin condition "," is not a boolean value, but ","."]],[x.comparingOperator_eval_differentInputTypes,['Inputs for "','"  have different types '," and ","."]],[x.computingOperator_eval_inputTypesNotNumbers,['Inputs for "','" are not both numbers, they are '," and ","."]],[x.logicalOperator_eval_leftInputNotBoolean,['Left input value for "','" is not a boolean, but ',"."]],[x.logicalOperator_eval_rightInputNotBoolean,['Right input value for "','" is not a boolean, but ',"."]]]),T=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"codeError",value:function(e){var t=R.get(e);void 0===t&&(console.log("Unknown code of code error given: "+e),t=["Code error"]);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return N(t.length-1,r,e),new w(C(t,r))}},{key:"semanticError",value:function(e,t){var n=_.get(e);void 0===n&&(console.log("Unknown code of semantic error given: "+e),n=["Semantic error"]);for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return N(n.length-1,a,e),new b(C(n,a),t)}},{key:"syntaxError",value:function(e,t){var n=S.get(e);void 0===n&&(console.log("Unknown code of syntax error given: "+e),n=["Syntax error"]);for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return N(n.length-1,a,e),new E(C(n,a),t)}}]),e}();function N(e,t,n){if(t.length!==e)for(console.log("Unexpected params count for error "+n+", expected "+e+", given "+t.length);t.length<e;)t.push("")}function C(e,t){for(var n,r=e.length,a=Array(2*r-2),o=1;o<r;o++)a[2*o-2]=t[o-1],a[2*o-1]=e[o];return(n=e[0]).concat.apply(n,a)}var j=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"isWord",value:function(t){return t.length>0&&t.split("").every((function(t){return e.isLetter(t)}))}},{key:"isName",value:function(t){return 0!==t.length&&(!(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))&&t.split("").every((function(t){return e.isNameChar(t)})))}},{key:"isWhitespacesOnly",value:function(e){var t=/\s*/.exec(e);return null!==t&&t[0]===e}},{key:"isLetter",value:function(e){return 1===e.length&&e.toLowerCase()!==e.toUpperCase()}},{key:"isNameChar",value:function(t){return e.isLetter(t)||e.isDigit(t)||"_"===t}},{key:"isDigit",value:function(e){return 1===e.length&&null!==e.match(/\d/)}},{key:"isNumber",value:function(e){return/^[-]?[\d]+([.][\d]+)?$/.test(e)}},{key:"isStringLiteral",value:function(t){if(t.length<2||'"'!==t[0])return!1;try{return e.nextBorderedPart(t,'"','"',"\\").first.length===t.length}catch(n){return!1}}},{key:"nextWord",value:function(t){if(""===t)return{first:"",second:""};for(var n=0;n<t.length;){if(!e.isLetter(t.charAt(n)))return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextName",value:function(t){if(""===t)return{first:"",second:""};if(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))return{first:"",second:t};for(var n=0;n<t.length;){var r=t.charAt(n);if(!e.isLetter(r)&&!e.isDigit(r)&&"_"!==r)return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextNonWhitespacePart",value:function(e){if(""===e)return{first:"",second:""};for(var t=0;t<e.length;){if(e.charAt(t).match(/\s/))return{first:e.substring(0,t),second:e.substring(t)};++t}return{first:e,second:""}}},{key:"nextNumber",value:function(t){if(""===t)return{first:"",second:""};var n=0;if("-"===t.charAt(0)){if(!(t.length>1&&e.isDigit(t.charAt(1))))return{first:"",second:t};n=1}for(var r=!1,a=!1;n<t.length;)if(e.isDigit(t.charAt(n)))r=!0,++n;else{if("."!==t.charAt(n))break;if(a||!r)break;a=!0,++n}return{first:t.substring(0,n),second:t.substring(n)}}},{key:"nextBorderedPart",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0",a=1,o=1,i=!1,s=1===n.length,l=0,u=0;o<e.length;){var c=e.charAt(o);if(n.indexOf(c)>-1&&u%2===0&&!i?--a:c===t&&u%2===0&&s&&!i?++a:'"'===c&&l%2===0&&(i=!i),c===r?++u:u=0,"\\"===c?++l:l=0,++o,0===a){var h=e.substring(0,o),p=o<e.length?e.substring(o):"";return{first:h,second:p}}}throw T.syntaxError(x.parser_nextBorderedPart_missingClosingChar,void 0,n.split("").join("' or '"),t)}},{key:"skipWhitespacesAndChar",value:function(e,t){for(var n=!1,r=0;r<e.length;)if(e.charAt(r).match(/\s/))++r;else{if(e.charAt(r)!==t||n)break;n=!0,++r}if(!n)throw T.syntaxError(x.parser_skipWhitespacesAndChar_charNotFound,void 0,t);return e.substring(r)}},{key:"deleteCommentLines",value:function(e){return e.split("\n").map((function(e){for(var t=!1,n=0;n<e.length;++n)if('"'===e.charAt(n)&&(t&&"\\"!==e.charAt(n-1)?t=!1:t||(t=!0)),!t&&"/"===e.charAt(n)&&n>0&&"/"===e.charAt(n-1))return e.slice(0,n-1);return e})).join("\n")}}]),e}(),O=n(18),P=(n(36),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:this.props.className,onClick:this.props.onClick,style:this.props.style},this.props.text,a.a.createElement("span",{className:this.props.tooltipClassName,style:this.props.tooltipStyle},this.props.tooltip))}}]),n}(a.a.Component)),V=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return""===this.props.message?null:(e=this.props.darkTheme?this.props.error?"red":"white":this.props.error?"red":"black",a.a.createElement("p",{style:{color:e}},this.props.message));var e}}]),n}(a.a.Component);n(37);function A(e,t){var n="0123456789qwertyuiopasdfghjkllzxcvbnmQWERTYUIOOPASDFGHJKLLZXCVBNM!@#$%^&*()_+[];',./",r=document.createElement("div");r.setAttribute("style","font-family: ".concat(e,"; font-size: ").concat(t,"; position: absolute;")),r.innerText=n,document.documentElement.appendChild(r);var a=r.clientWidth,o=r.clientHeight;return r.remove(),{fontWidth:a/n.length,fontHeight:o}}function I(e,t){for(var n=e.slice(0,t),r=n.length-1;;){if(!n.charAt(r).match(/\w/)){++r;break}if(0===r)break;--r}return r}var L=getComputedStyle(document.querySelector(":root")),D=L.getPropertyValue("--x-textarea-font-size"),W=L.getPropertyValue("--x-textarea-font-family"),B=A(W,D).fontWidth,M=Number(L.getPropertyValue("--x-textarea-line-height")),F=L.getPropertyValue("--light-section"),J=L.getPropertyValue("--dark-section"),U=L.getPropertyValue("--text-color-light"),q=L.getPropertyValue("--text-color-dark"),H=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).reactDiv=a.a.createRef(),e.textarea=void 0,e}return Object(h.a)(n,[{key:"getSelection",value:function(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}}},{key:"setSelection",value:function(e,t){this.textarea.setSelectionRange(e,t||e)}},{key:"isFocused",value:function(){return null!==document.activeElement&&document.activeElement.id===this.props.id+"-ta"}},{key:"focus",value:function(){this.textarea.focus()}},{key:"componentDidMount",value:function(){var e=this,t=document.getElementById(this.props.id);t.classList.add(this.props.darkTheme?"x-textarea-div-dark":"x-textarea-div-light");var n=document.createElement("table");n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","0"),n.classList.add("x-textarea-table");var r=document.createElement("tr"),a=document.createElement("td");a.setAttribute("id",this.props.id+"-td1"),a.classList.add(this.props.darkTheme?"x-textarea-table-td1-dark":"x-textarea-table-td1-light");var o=document.createElement("td");o.classList.add("x-textarea-table-td2"),r.appendChild(a),r.appendChild(o),n.appendChild(r);var i=document.createElement("textarea");i.setAttribute("id",this.props.id+"-ta"),i.setAttribute("rows","2"),i.setAttribute("spellcheck","false"),i.mouseIsDown=!1,i.setAttribute("placeholder",this.props.placeholder),i.classList.add("x-textarea"),this.props.darkTheme?i.classList.add("x-textarea-dark","cursor-container-dark"):i.classList.add("x-textarea-light","cursor-container-light"),i.value=this.props.text;var s=document.createElement("canvas");s.width=28,s.classList.add(this.props.darkTheme?"canvas-dark":"canvas-light"),i.canvasLines=s,a.appendChild(s),o.appendChild(i),t.appendChild(n);var l=document.createElement("div");l.classList.add("whisper-div",this.props.darkTheme?"whisper-div-dark":"whisper-div-light"),l.isShown=!1,l.selectedIndex=-1,l.changeSelected=function(e){this.setSelected(this.selectedIndex+e)},l.setSelected=function(e){var t,n;this.childElementCount>0&&(this.selectedIndex>-1&&this.selectedIndex<this.childElementCount&&this.children[this.selectedIndex].classList.remove("selected-whisper"),this.selectedIndex=(t=e,n=this.childElementCount,(t%n+n)%n),this.children[this.selectedIndex].classList.add("selected-whisper"))},l.getSelectedWhisper=function(){if(this.selectedIndex>-1&&this.childElementCount>0)return this.children[this.selectedIndex].innerText},i.whisperDiv=l,o.appendChild(l),i.paintLineNumbers=function(e){try{var t=this.canvasLines;t.height!==this.clientHeight&&(t.height=this.clientHeight);var n=t.getContext("2d");n.fillStyle=e?J:F,n.fillRect(0,0,26,this.scrollHeight+1),n.fillStyle=e?q:U,n.font=D+" "+W;for(var r=Math.floor(this.scrollTop/M),a=r+Math.floor(this.clientHeight/M),o=r;o<=a;o++){var i=16-this.scrollTop+o*M,s=""+(o+1);n.fillText(s,24-6*s.length,i)}}catch(l){console.log("XTextArea paintLineNumbers error: "+l)}},i.showWhisper=function(e){if(0===e.length)this.hideWhisper();else{var t=this.whisperDiv.childElementCount;this.whisperDiv.innerHTML=e.map((function(e){return"<div>".concat(e,"</div>")})).join(""),this.whisperDiv.childElementCount!==t?this.whisperDiv.setSelected(0):this.whisperDiv.changeSelected(0),this.whisperDiv.isShown=!0,this.moveWhisper()}},i.moveWhisper=function(){if(this.whisperDiv.isShown){var e=K(this.value,this.selectionEnd),t=(e.line+1)*M,n=e.column*B,r=t-this.scrollTop,a=n-this.scrollLeft;0<=r&&r<this.clientHeight&&0<=a&&a<this.clientWidth?this.getBoundingClientRect().y+r<=window.innerHeight/2?this.whisperDiv.setAttribute("style","display: block; top: ".concat(r+4,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: block; bottom: ".concat(this.getBoundingClientRect().height-r+M,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: none;")}},i.hideWhisper=function(){l.innerHTML="",this.whisperDiv.setAttribute("style","display: none;"),this.whisperDiv.isShown=!1},i.insertCurrentSelectedWhisper=function(e){var t=this.whisperDiv.getSelectedWhisper();if(void 0!==t){var n=I(this.value,this.selectionEnd),r=this.value.slice(0,n),a=this.value.slice(this.selectionEnd),o=n+t.length;e(r+t+a,o),this.setSelectionRange(o,o),this.hideWhisper()}},i.errorDivs=[],i.moveErrors=function(){var e=this;this.errorDivs.forEach((function(t){var n=(t.startLine+1)*M+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=t.rangeLength*B,a=t.startColumn*B+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),e.getBoundingClientRect().x+a>=window.innerWidth/2&&t.messageSpan.setAttribute("style","right: 50%; left: unset;"),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},i.updateErrors=function(e){var t=this;this.errorDivs.forEach((function(e){e.remove()})),this.errorDivs=[];var n=function(e){t.parentElement.appendChild(e),t.errorDivs.push(e)};e.forEach((function(e){var r=K(t.value,e.start),a=K(t.value,e.end);if(r.line===a.line)n(G(r.line,r.column,a.column-r.column,e.msg,t));else{n(G(r.line,r.column,z(t.value,r.line)-r.column,e.msg,t));for(var o=r.line+1;o<a.line;++o)n(G(o,0,z(t.value,o),e.msg,t));n(G(a.line,0,a.column,e.msg,t))}})),this.moveErrors()},window.addEventListener("scroll",(function(){return i.moveWhisper()})),window.addEventListener("resize",(function(){i.moveWhisper(),i.moveErrors()})),i.onscroll=function(){i.paintLineNumbers(e.props.darkTheme),i.moveWhisper(),i.moveErrors()},i.addEventListener("focusout",(function(){return i.hideWhisper()})),i.onmousedown=function(){i.mouseIsDown=!0,i.hideWhisper()},i.onmouseup=function(){i.mouseIsDown=!1,i.paintLineNumbers(e.props.darkTheme)},i.onmousemove=function(){i.mouseIsDown&&i.paintLineNumbers(e.props.darkTheme)},i.oninput=function(t){e.props.onChange(t.target.value,t.target.selectionStart)},i.onkeydown=function(t){if(i.whisperDiv.isShown&&t.ctrlKey)i.hideWhisper();else if(i.whisperDiv.isShown){if("ArrowDown"===t.key&&(i.whisperDiv.changeSelected(1),t.preventDefault()),"ArrowUp"===t.key&&(i.whisperDiv.changeSelected(-1),t.preventDefault()),"PageDown"===t.key&&(i.whisperDiv.setSelected(-1),t.preventDefault()),"PageUp"===t.key&&(i.whisperDiv.setSelected(0),t.preventDefault()),"End"!==t.key&&"Home"!==t.key||i.hideWhisper(),"Escape"!==t.key&&"Esc"!==t.key||(i.hideWhisper(),t.preventDefault()),"Enter"!==t.key&&"Tab"!==t.key||(i.insertCurrentSelectedWhisper(e.props.onChange),t.preventDefault()),"ArrowLeft"===t.key){var n=0===i.selectionStart?0:i.selectionStart-1;e.props.onChange(i.value,n)}if("ArrowRight"===t.key){var r=i.selectionStart===i.value.length?i.selectionStart:i.selectionStart+1;e.props.onChange(i.value,r)}}t.ctrlKey&&"v"===t.key.toLowerCase()&&setTimeout((function(){return e.props.onTextInserted()}),1)},i.paintLineNumbers(this.props.darkTheme),i.updateErrors(this.props.errors),this.textarea=i}},{key:"componentDidUpdate",value:function(e){this.textarea.value=this.props.text,e.darkTheme!==this.props.darkTheme&&this.updateStyle(),this.props.whispers!==e.whispers&&this.textarea.showWhisper(this.props.whispers),void 0!==this.props.errors?this.textarea.updateErrors(this.props.errors):this.props.errors!==e.errors&&this.textarea.classList.remove("x-textarea-err")}},{key:"updateStyle",value:function(){this.reactDiv.current.classList.toggle("x-textarea-div-dark",this.props.darkTheme),this.reactDiv.current.classList.toggle("x-textarea-div-light",!this.props.darkTheme),this.textarea.classList.toggle("x-textarea-dark",this.props.darkTheme),this.textarea.classList.toggle("cursor-container-dark",this.props.darkTheme),this.textarea.classList.toggle("x-textarea-light",!this.props.darkTheme),this.textarea.classList.toggle("cursor-container-light",!this.props.darkTheme),this.textarea.paintLineNumbers(this.props.darkTheme),this.textarea.canvasLines.classList.toggle("canvas-dark",this.props.darkTheme),this.textarea.canvasLines.classList.toggle("canvas-light",!this.props.darkTheme),this.textarea.whisperDiv.classList.toggle("whisper-div-dark",this.props.darkTheme),this.textarea.whisperDiv.classList.toggle("whisper-div-light",!this.props.darkTheme),document.getElementById(this.props.id+"-td1").classList.toggle("x-textarea-table-td1-dark",this.props.darkTheme),document.getElementById(this.props.id+"-td1").classList.toggle("x-textarea-table-td1-light",!this.props.darkTheme)}},{key:"render",value:function(){return a.a.createElement("div",{ref:this.reactDiv,id:this.props.id,className:"x-textarea-div"})}}]),n}(a.a.Component);function K(e,t){var n=e.slice(0,t),r=(n.match(/\n/g)||[]).length,a=n.lastIndexOf("\n");return{line:r,column:n.length-a-1}}function z(e,t){for(var n=0,r=0,a=0,o=0;o<e.length;++o)if("\n"===e.charAt(o))if(++n===t)r=o;else if(n===t+1){a=o;break}return 0===a&&(a=e.length),a-r}function G(e,t,n,r,a){var o=document.createElement("div");o.classList.add("x-textarea-highlight"),o.startLine=e,o.startColumn=t,o.rangeLength=n,o.onclick=function(e){var t=new MouseEvent(e.type,Object(O.a)({},e));a.dispatchEvent(t),e.stopPropagation()};var i=document.createElement("span");return i.classList.add("highlight-tooltip"),i.innerText=r,o.messageSpan=i,o.appendChild(i),o}var X=n(7),$=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.columns=new Map,this.columnNames=[],this.rows=[],this.finishedSchema=!1,this.name=t}return Object(h.a)(e,[{key:"getName",value:function(){return this.name}},{key:"hasFinishedSchema",value:function(){return this.finishedSchema}},{key:"finishSchema",value:function(){this.finishedSchema=!0}},{key:"addColumn",value:function(e,t){return!this.hasColumn(e)&&!this.hasFinishedSchema()&&(this.columns.set(e,t),this.columnNames.push(e),!0)}},{key:"hasColumn",value:function(e){return this.columnNames.some((function(t){return t===e}))}},{key:"getColumns",value:function(){return this.columns}},{key:"forEachColumn",value:function(e){return this.columns.forEach(e)}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"getColumnsCount",value:function(){return this.columnNames.length}},{key:"addRow",value:function(e){return!!Object(X.isEqual)(e.getTypes(),this.columns)&&(this.finishSchema(),e.finish(),this.rows.some((function(t){return t.equals(e)}))||this.rows.push(e),!0)}},{key:"getRows",value:function(){return this.rows}},{key:"getRowsCount",value:function(){return this.rows.length}},{key:"getSchemaString",value:function(){return this.name+"("+Object(u.a)(this.columns).map((function(e){return e[0]+": "+e[1]})).join(", ")+")"}},{key:"getNamesSchemaString",value:function(){return this.name+"("+this.columnNames.join(", ")+")"}},{key:"contentString",value:function(){var e=this;return this.columnNames.join(", ")+"\n"+(this.columnNames.map((function(t){return e.columns.get(t)})).join(", ")+"\n")+Object(u.a)(this.rows).map((function(t){return t.getOrderedValues(e.columnNames).join(", ")})).join("\n")}},{key:"equals",value:function(t){return t instanceof e&&(this.name===t.name&&Object(X.isEqual)(this.columns,t.columns)&&Object(X.isEqual)(new Set(this.rows),new Set(t.rows)))}}]),e}(),Y=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"isWord",value:function(e){return j.isWord(e.toString())}},{key:"isName",value:function(e){return j.isName(e.toString())}},{key:"isWhitespacesOnly",value:function(e){return j.isWhitespacesOnly(e.toString())}},{key:"isLetter",value:function(e){return j.isLetter(e.toString())}},{key:"isNameChar",value:function(e){return j.isNameChar(e.toString())}},{key:"isDigit",value:function(e){return j.isDigit(e.toString())}},{key:"isNumber",value:function(e){return j.isNumber(e.toString())}},{key:"nextWord",value:function(e){var t=j.nextWord(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextName",value:function(e){var t=j.nextName(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNonWhitespacePart",value:function(e){var t=j.nextNonWhitespacePart(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNumber",value:function(e){var t=j.nextNumber(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextBorderedPart",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0";try{var a=j.nextBorderedPart(e.toString(),t,n,r);return{first:e.slice(0,a.first.length),second:e.slice(a.first.length)}}catch(i){var o=e.getFirstNonNaNIndex();if(void 0!==o)throw m(i,{start:o,end:o});throw i}}},{key:"skipWhitespacesAndChar",value:function(e,t){try{var n=j.skipWhitespacesAndChar(e.toString(),t);return e.slice(e.length()-n.length)}catch(r){throw m(r,e.getNonNaNRange())}}},{key:"deleteCommentLines",value:function(e){var t=e.split("\n").map((function(e){for(var t=!1,n=0;n<e.length();++n)if('"'===e.charAt(n)&&(t&&"\\"!==e.charAt(n-1)?t=!1:t||(t=!0)),!t&&"/"===e.charAt(n)&&n>0&&"/"===e.charAt(n-1))return e.slice(0,n-1);return e}));return Z.join(t,"\n")}}]),e}(),Z=function(){function e(t,n){Object(c.a)(this,e),this.str=t,this.chars=n}return Object(h.a)(e,null,[{key:"new",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t,t.split("").map((function(e,t){return{char:e,index:t+n}})))}},{key:"empty",value:function(){return new e("",[])}},{key:"newFromArray",value:function(t){return new e(t.map((function(e){return e.char})).join(""),t.map((function(e){return{char:e.char,index:e.index}})))}},{key:"join",value:function(t,n){var r;if(0===t.length)return e.empty();if(1===t.length)return t[0];void 0===n&&(n="");for(var a=e.new(n,NaN),o=Array(2*t.length-2),i=1;i<t.length;i++)o[2*i-2]=a,o[2*i-1]=t[i];return(r=t[0]).concat.apply(r,o)}}]),Object(h.a)(e,[{key:"toString",value:function(){return this.str}},{key:"length",value:function(){return this.str.length}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"getChars",value:function(){var e=Array(this.length());return this.chars.forEach((function(t,n){e[n]={char:t.char,index:t.index}})),e}},{key:"getFirstIndex",value:function(){if(!this.isEmpty())return this.chars[0].index}},{key:"getLastIndex",value:function(){if(!this.isEmpty())return this.chars[this.length()-1].index}},{key:"getFirstNonNaNIndex",value:function(){if(!this.isEmpty()){for(var e=0;e<this.length();e++)if(!isNaN(this.chars[e].index))return this.chars[e].index;return NaN}}},{key:"getLastNonNaNIndex",value:function(){if(!this.isEmpty()){for(var e=this.length()-1;e>=0;e--)if(!isNaN(this.chars[e].index))return this.chars[e].index;return NaN}}},{key:"getRange",value:function(){if(!this.isEmpty())return{start:this.chars[0].index,end:this.chars[this.length()-1].index}}},{key:"getNonNaNRange",value:function(){if(!this.isEmpty()){var e=this.getFirstNonNaNIndex();if(!isNaN(e))return{start:e,end:this.getLastNonNaNIndex()}}}},{key:"indexedCharAt",value:function(t){if(t<0||t>=this.length())throw new RangeError;return e.newFromArray([this.chars[t]])}},{key:"charAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].char}},{key:"indexAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].index}},{key:"split",value:function(t){var n=this;if(this.isEmpty())return""===t?[]:[e.empty()];var r=t.length,a=this.str.split(t),o=Array(a.length);o[0]=0;for(var i=1;i<a.length;i++)o[i]=o[i-1]+a[i-1].length+r;return a.map((function(t,r){return new e(t,n.chars.slice(o[r],o[r]+t.length))}))}},{key:"slice",value:function(t,n){var r=t<0?this.length()+t:t,a=void 0!==n?n<0?this.length()+n:n:this.length();if(r>a||r<0||a>this.length())throw new RangeError;return e.newFromArray(this.chars.slice(r,a))}},{key:"trim",value:function(){var t=this.str.trim();if(""===t)return new e("",[]);var n=this.str.indexOf(t.charAt(0));return e.newFromArray(this.chars.slice(n,n+t.length))}},{key:"concat",value:function(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.newFromArray((t=this.chars).concat.apply(t,Object(u.a)(r.map((function(e){return e.chars})))))}},{key:"startsWith",value:function(e,t){return this.str.startsWith(e,t)}},{key:"endsWith",value:function(e,t){return this.str.endsWith(e,t)}},{key:"replace",value:function(e,t){return this.str.replace(e,t)}},{key:"indexOf",value:function(e,t){return this.str.indexOf(e,t)}},{key:"match",value:function(e){return this.str.match(e)}},{key:"copy",value:function(){return new e(this.str,this.chars.map((function(e){return{char:e.char,index:e.index}})))}},{key:"removeWhitespaces",value:function(){return new e(this.str.replace(/\s/g,""),this.chars.filter((function(e){return!/\s/.test(e.char)})).map((function(e){return{char:e.char,index:e.index}})))}},{key:"getNextIndexOrNaN",value:function(){var e=this.getLastIndex();return void 0===e?NaN:e+1}}]),e}();function Q(e){return e instanceof Z?e.getNonNaNRange():void 0}function ee(e){return e instanceof Z?e.length():e.length}function te(e){return e instanceof Z?e.isEmpty():""===e}function ne(e,t,n,r){return e instanceof Z?Y.nextBorderedPart(e,t,n,r):j.nextBorderedPart(e,t,n,r)}var re=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(h.a)(e,[{key:"getRange",value:function(){return Q(this.str)}}]),e}(),ae=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return n}(re),oe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(ae),ie=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(ae),se=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(re),le=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).type=r,a}return Object(h.a)(n,null,[{key:"selection",value:function(e){return new n(e,"selection")}},{key:"projection",value:function(e){return new n(e,"projection")}},{key:"rename",value:function(e){return new n(e,"rename")}}]),n}(re),ue=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).precedence=r,o.type=a,o}return Object(h.a)(n,null,[{key:"naturalJoin",value:function(e){return new n(e,10,"natural join")}},{key:"cartesianProduct",value:function(e){return new n(e,10,"cartesian product")}},{key:"union",value:function(e){return new n(e,4,"union")}},{key:"intersection",value:function(e){return new n(e,6,"intersection")}},{key:"difference",value:function(e){return new n(e,5,"difference")}},{key:"leftSemijoin",value:function(e){return new n(e,9,"left semijoin")}},{key:"rightSemijoin",value:function(e){return new n(e,9,"right semijoin")}},{key:"leftAntijoin",value:function(e){return new n(e,9,"left antijoin")}},{key:"rightAntijoin",value:function(e){return new n(e,9,"right antijoin")}},{key:"thetaJoin",value:function(e){return new n(e,10,"theta join")}},{key:"leftThetaSemijoin",value:function(e){return new n(e,9,"left theta semijoin")}},{key:"rightThetaSemijoin",value:function(e){return new n(e,9,"right theta semijoin")}},{key:"fullOuterJoin",value:function(e){return new n(e,8,"full outer join")}},{key:"leftOuterJoin",value:function(e){return new n(e,8,"left outer join")}},{key:"rightOuterJoin",value:function(e){return new n(e,8,"right outer join")}},{key:"division",value:function(e){return new n(e,7,"division")}}]),n}(re),ce=function(){function e(){Object(c.a)(this,e),this.resultRelation=void 0}return Object(h.a)(e,[{key:"isEvaluated",value:function(){return void 0!==this.resultRelation}},{key:"getResult",value:function(){return void 0===this.resultRelation&&this.eval(),this.resultRelation}}]),e}(),he=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).resultRelation=e,r}return Object(h.a)(n,[{key:"eval",value:function(){}},{key:"fakeEval",value:function(e){return{result:this.resultRelation,whispers:[],errors:[]}}},{key:"printInLine",value:function(){return this.resultRelation.getName()}},{key:"getOperationName",value:function(){return this.resultRelation.getName()}}]),n}(ce),pe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).subtree=void 0,r.subtree=e,r}return Object(h.a)(n,[{key:"getSubtree",value:function(){return this.subtree}}]),n}(ce),de=function(){function e(t){var n=this;Object(c.a)(this,e),this.types=new Map,this.values=new Map,this.finished=void 0,t.forEach((function(e,t){n.values.set(t,null)})),this.types=t,this.finished=!1}return Object(h.a)(e,[{key:"isFinished",value:function(){return this.finished}},{key:"finish",value:function(){this.finished=!0}},{key:"getColumnNames",value:function(){return this.types.keys()}},{key:"addValue",value:function(e,t){return!(this.finished||!this.types.has(e))&&((null===t||typeof t===this.types.get(e))&&(this.values.set(e,t),!0))}},{key:"getValue",value:function(e){return this.values.get(e)}},{key:"getType",value:function(e){return this.types.get(e)}},{key:"getTypes",value:function(){return this.types}},{key:"getValues",value:function(){return this.values}},{key:"getOrderedValues",value:function(e){var t=this,n=new Array;return e.forEach((function(e){var r=t.values.get(e);if(void 0===r)throw T.codeError(y.row_getOrderedValues_absentColumn,e,Object(u.a)(t.types.values()).join(", "));n.push(r)})),n}},{key:"equals",value:function(t){return t instanceof e&&(Object(X.isEqual)(this.types,t.types)&&Object(X.isEqual)(this.values,t.values))}}]),e}(),fe=["null","true","false",""],ge=["F","L","R",""];function ve(e){return fe.indexOf(e.toString().toLowerCase())>-1}var me,ye=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).projection=void 0,a.stringRange=void 0,a.projection=e,a.stringRange=Q(e),a}return Object(h.a)(n,[{key:"parseProjection",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=new Set,a=this.projection instanceof Z,o=this.projection.slice(1,-1),i=o.split(",");return i.forEach((function(o){if(o=o.trim(),(a?Y.isName(o):j.isName(o))&&!ve(o))r.add(o);else{var i=Q(o);te(o)&&void 0!==t.stringRange&&(i={start:t.stringRange.start,end:t.stringRange.start});var s=T.syntaxError(x.projectionNode_parseProjection_invalidProjectedColumnName,i,o.toString());if(e)throw s;n.push(s)}})),r}},{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.subtree.getResult(),t=Object(u.a)(this.parseProjection(!0)).map((function(e){return e.toString()}));t.forEach((function(t){if(!e.hasColumn(t.toString()))throw T.semanticError(k.projectionNode_eval_absentColumn,Q(t),t.toString())}));var n=new $(e.getName()+"[...]");e.forEachColumn((function(e,r){t.indexOf(r)>-1&&n.addColumn(r,e)})),e.getRows().forEach((function(e){var r=new de(n.getColumns());e.getValues().forEach((function(e,n){t.indexOf(n)>-1&&r.addValue(n,e)})),n.addRow(r)})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=this.parseProjection(!1,r),o=new $(t.result.name+"[...]"),i=[];return a.forEach((function(e){var n=e.toString();t.result.hasColumn(n)?o.addColumn(n,t.result.getColumns().get(n)):i.push(e)})),i.forEach((function(e){r.push(T.semanticError(k.projectionNode_eval_absentColumn,Q(e),e.toString()))})),{result:o,whispers:n,errors:r}}},{key:"printInLine",value:function(){return"Projection of "+this.projection.replace(/\s/g,"")+" from {"+this.subtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return"Projection"}},{key:"getParameter",value:function(){return this.projection.replace(/\s/g,"")}}]),n}(pe),ke=n(27),xe=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(h.a)(e,[{key:"get",value:function(e){var t=this.map.get(e.toString());return void 0===t?void 0:t.value}},{key:"set",value:function(e,t){this.map.set(e.toString(),{key:e,value:t})}},{key:"delete",value:function(e){return this.map.delete(e.toString())}},{key:"has",value:function(e){return this.map.has(e.toString())}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(e){Object(u.a)(this.map.values()).forEach((function(t,n){return e(t.value,t.key,n)}))}}]),e}(),be=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).rename=void 0,a.stringRange=void 0,a.rename=e,a.stringRange=Q(e),a}return Object(h.a)(n,[{key:"parseChanges",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){if(e)throw t;n.push(t)},a=this.rename.slice(1,-1).split(","),o=new xe,i=Object(ke.a)(a);try{for(i.s();!(t=i.n()).done;){var s=t.value,l=s.split("->").map((function(e){return e.trim()})),u=!1,c=!1;if(2!==l.length){var h=Q(s);te(s)&&void 0!==this.stringRange&&(h={start:this.stringRange.start,end:this.stringRange.start}),r(T.syntaxError(x.renameNode_parseChanges_missingArrow,h)),u=!0,c=!0}!u&&o.has(l[0].toString())&&(r(T.syntaxError(x.renameNode_parseChanges_multipleRenameOfTheColumn,Q(l[0]),l[0].toString())),u=!0),c||j.isName(l[1].toString())||(r(T.syntaxError(x.renameNode_parseChanges_invalidNewName,Q(l[1]),l[1].toString())),c=!0),!c&&ve(l[1])&&(r(T.syntaxError(x.renameNode_parseChanges_keywordNewName,Q(l[1]),l[1].toString())),c=!0),u||c?u?c||o.set("",l[0]):o.set(l[0],l[0]):o.set(l[0],l[1])}}catch(p){i.e(p)}finally{i.f()}return o}},{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.parseChanges(!0),n=this.subtree.getResult();t.forEach((function(e,t){if(-1===n.getColumnNames().indexOf(t.toString()))throw T.semanticError(k.renameNode_eval_absentOriginalColumn,Q(t),t.toString())}));var r=new $(n.getName()+"<...>"),a=new Map;n.forEachColumn((function(e,n){t.has(n)?a.set(n,e):r.addColumn(n,e)})),a.forEach((function(n,a){if(!r.addColumn(t.get(a).toString(),n))throw T.semanticError(k.renameNode_eval_changeToDuplicitName,Q(e.rename),t.get(a))})),n.getRows().forEach((function(e){var n=new de(r.getColumns());e.getValues().forEach((function(e,r){var a=t.get(r);"undefined"===typeof a?n.addValue(r,e):n.addValue(a.toString(),e)})),r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;if(void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end){var r=this.rename.slice(0,e-this.stringRange.start).trim().match(/.*[^\w\s]/);null!==r&&(r[0].endsWith("<")||r[0].endsWith(","))&&(n=t.result.getColumnNames())}var a=t.errors,o=this.parseChanges(!1,a),i=new $(t.result.getName()+"<...>");t.result.forEachColumn((function(e,t){o.has(t)||i.addColumn(t,e)}));var s=[],l=[];return o.forEach((function(e,n){var r=n.toString(),a=e.toString();t.result.hasColumn(r)||""===n?i.addColumn(a,t.result.getColumns().get(r))||l.push(e):s.push(n)})),s.forEach((function(e){a.push(T.semanticError(k.renameNode_eval_absentOriginalColumn,Q(e),e.toString()))})),l.forEach((function(e){a.push(T.semanticError(k.renameNode_eval_changeToDuplicitName,Q(e),e.toString()))})),{result:i,whispers:n,errors:a}}},{key:"printInLine",value:function(){return"Projection of "+this.rename.replace(/\s+/g,"")+" from {"+this.subtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return"Rename"}},{key:"getParameter",value:function(){return this.rename.replace(/\s+/g," ")}}]),n}(pe),Ee=function e(){Object(c.a)(this,e)};!function(e){e[e.equal=0]="equal",e[e.nonEqual=1]="nonEqual",e[e.less=2]="less",e[e.more=3]="more",e[e.lessOrEqual=4]="lessOrEqual",e[e.moreOrEqual=5]="moreOrEqual"}(me||(me={}));var we,Re=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(h.a)(n,null,[{key:"equal",value:function(e,t,r){return new n(me.equal,e,t,r)}},{key:"nonEqual",value:function(e,t,r){return new n(me.nonEqual,e,t,r)}},{key:"less",value:function(e,t,r){return new n(me.less,e,t,r)}},{key:"more",value:function(e,t,r){return new n(me.more,e,t,r)}},{key:"lessOrEqual",value:function(e,t,r){return new n(me.lessOrEqual,e,t,r)}},{key:"moreOrEqual",value:function(e,t,r){return new n(me.moreOrEqual,e,t,r)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("null"!==t.type&&"null"!==n.type&&t.type!==n.type)throw T.syntaxError(x.comparingOperator_eval_differentInputTypes,Q(this.operator),this.operator.toString(),t.type,n.type);return null===t.value&&null===n.value&&"null"!==t.type&&"null"!==n.type?{value:!1,type:"boolean"}:this.type===me.equal?{value:t.value===n.value,type:"boolean"}:this.type===me.nonEqual?null===t.value&&"null"!==t.type||null===n.value&&"null"!==n.type?{value:!1,type:"boolean"}:{value:t.value!==n.value,type:"boolean"}:this.type===me.less?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<n.value,type:"boolean"}:this.type===me.more?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>n.value,type:"boolean"}:this.type===me.lessOrEqual?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<=n.value,type:"boolean"}:null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>=n.value,type:"boolean"}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.operator+" "+this.right.toString()+")"}}]),n}(Ee);!function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(we||(we={}));var _e,Se=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(h.a)(n,null,[{key:"and",value:function(e,t,r){return new n(we.and,e,t,r)}},{key:"or",value:function(e,t,r){return new n(we.or,e,t,r)}},{key:"not",value:function(e,t){return new n(we.not,e,t)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e);if("boolean"!==t.type)throw T.syntaxError(x.logicalOperator_eval_leftInputNotBoolean,Q(this.operator),this.operator.toString(),t.type);if(this.type===we.not)return null===t.value?{value:!1,type:"boolean"}:{value:!t.value,type:"boolean"};var n=this.right.eval(e);if("boolean"!==n.type)throw T.syntaxError(x.logicalOperator_eval_rightInputNotBoolean,Q(this.operator),this.operator.toString(),n.type);return this.type===we.and?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value&&n.value,type:"boolean"}:null===t.value&&null===n.value?{value:!1,type:"boolean"}:null===t.value?{value:n.value,type:"boolean"}:null===n.value?{value:t.value,type:"boolean"}:{value:t.value||n.value,type:"boolean"}}},{key:"toString",value:function(){return this.type===we.not?this.operator+"("+this.left.toString()+")":"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(Ee),Te=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).value=e,a.type=r,a}return Object(h.a)(n,[{key:"eval",value:function(e){return{value:this.value,type:this.type}}},{key:"toString",value:function(){return null===this.value?"null":this.value.toString()}}]),n}(Ee),Ne=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).columnName=e,r}return Object(h.a)(n,[{key:"eval",value:function(e){var t=e.getValue(this.columnName.toString()),n=e.getType(this.columnName.toString());if(void 0===t||void 0===n)throw T.semanticError(k.referenceValue_eval_absentColumn,Q(this.columnName),this.columnName.toString(),Object(u.a)(e.getColumnNames()).join(", "));return{value:t,type:n}}},{key:"toString",value:function(){return this.columnName.toString()}}]),n}(Ee);!function(e){e.plus="+",e.minus="-",e.multiplication="*",e.division="/"}(_e||(_e={}));var Ce,je=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.left=r,i.right=a,i.range=o,i}return Object(h.a)(n,null,[{key:"add",value:function(e,t,r){return new n(_e.plus,e,t,r)}},{key:"deduct",value:function(e,t,r){return new n(_e.minus,e,t,r)}},{key:"multiply",value:function(e,t,r){return new n(_e.multiplication,e,t,r)}},{key:"divide",value:function(e,t,r){return new n(_e.division,e,t,r)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("number"!==t.type||"number"!==n.type)throw T.syntaxError(x.computingOperator_eval_inputTypesNotNumbers,this.range,this.type,t.type,n.type);if(null===t.value||null===n.value)return{value:null,type:"number"};switch(this.type){case _e.plus:return{value:t.value+n.value,type:"number"};case _e.minus:return{value:t.value-n.value,type:"number"};case _e.multiplication:return{value:t.value*n.value,type:"number"};case _e.division:return{value:t.value/n.value,type:"number"}}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.type+" "+this.right.toString()+")"}}]),n}(Ee),Oe=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(h.a)(e,[{key:"getRange",value:function(){return this.str instanceof Z?this.str.getNonNaNRange():void 0}}]),e}(),Pe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).precedence=r,a}return n}(Oe),Ve=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,50)}return n}(Pe),Ae=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,10)}return n}(Pe),Ie=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,5)}return n}(Pe),Le=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Pe),De=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Pe),We=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Pe),Be=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Pe),Me=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r,20)).type=e,a}return n}(Pe),Fe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Oe),Je=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Fe),Ue=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Fe),qe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).value=r,o.type=a,o}return n}(Oe),He=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Oe),Ke=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"parse",value:function(t,n){var r=e.parseTokens(t,n,!0);this.assertValidInfixTokens(r,!0),r=this.simplify(r);try{var a=e.toRPN(r);return e.rpnToVETree(a)}catch(o){throw m(o,Q(t))}}},{key:"fakeParse",value:function(t,n,r){var a=[],o=e.parseTokens(t,n,!1,a);return o.forEach((function(e){e instanceof He&&-1===r.indexOf(e.str.toString())&&a.push(T.semanticError(k.referenceValue_eval_absentColumn,Q(e.str),e.str.toString(),r.join(", ")))})),this.assertValidInfixTokens(o,!1,a),a}},{key:"parseTokens",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(e){if(n)throw e;r.push(e)},o=e.trim();te(o)&&a(T.syntaxError(x.valueParser_parseTokens_emptyInput,void 0));for(var i=[];!te(o);)if((o=o.trim()).startsWith("("))i.push(new Je(o.slice(0,1))),o=o.slice(1);else if(o.startsWith(")"))i.push(new Ue(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("+"))i.push(new We(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("-"))i.push(new Be(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("*"))i.push(new Le(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("/"))i.push(new De(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("=="))i.push(new Me(me.equal,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("="))i.push(new Me(me.equal,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!="))i.push(new Me(me.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<>"))i.push(new Me(me.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<="))i.push(new Me(me.lessOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith(">="))i.push(new Me(me.moreOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<"))i.push(new Me(me.less,o.slice(0,1))),o=o.slice(1);else if(o.startsWith(">"))i.push(new Me(me.more,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!"))i.push(new Ve(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("~"))i.push(new Ve(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("&&"))i.push(new Ae(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("&"))i.push(new Ae(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("||"))i.push(new Ie(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("|"))i.push(new Ie(o.slice(0,1))),o=o.slice(1);else if(o.startsWith('"'))try{var s=ne(o,'"','"',"\\");i.push(new qe(s.first,s.first.toString(),"string")),o=s.second}catch(h){a(h);break}else if(j.isDigit(o.charAt(0))){var l=o instanceof Z?Y.nextNumber(o):j.nextNumber(o);i.push(new qe(l.first,Number(l.first.toString()),"number")),o=l.second}else if(o.startsWith("null"))t||a(T.syntaxError(x.valueParser_parseTokens_unsupportedNull,Q(o.slice(0,4)))),i.push(new qe(o.slice(0,4),null,"null")),o=o.slice(4);else if(o.startsWith("true")||o.startsWith("True")||o.startsWith("TRUE"))i.push(new qe(o.slice(0,4),!0,"boolean")),o=o.slice(4);else if(o.startsWith("false")||o.startsWith("False")||o.startsWith("FALSE"))i.push(new qe(o.slice(0,5),!1,"boolean")),o=o.slice(5);else if(j.isLetter(o.charAt(0))||"_"===o.charAt(0)){var u=o instanceof Z?Y.nextName(o):j.nextName(o);i.push(new He(u.first)),o=u.second}else{var c=o instanceof Z?Y.nextNonWhitespacePart(o):j.nextNonWhitespacePart(o);a(T.syntaxError(x.valueParser_parseTokens_unexpectedPart,Q(c.first),c.first.toString())),o=o.slice(ee(c.first))}return i}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0!==e.length){var r=function(e){if(t)throw e;n.push(e)};(e[0]instanceof Ue||e[0]instanceof Pe&&!(e[0]instanceof Ve))&&r(T.syntaxError(x.valueParser_rpnToVETree_invalidStart,e[0].getRange(),e[0].str.toString())),(e[e.length-1]instanceof Je||e[e.length-1]instanceof Pe)&&r(T.syntaxError(x.valueParser_rpnToVETree_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString()));for(var a=1;a<e.length;){var o=e[a-1],i=e[a];++a,i instanceof qe?(o instanceof qe&&r(T.syntaxError(x.valueParser_rpnToVETree_literalAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(T.syntaxError(x.valueParser_rpnToVETree_literalAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Ue&&r(T.syntaxError(x.valueParser_rpnToVETree_literalAfterClosing,i.getRange(),i.str.toString()))):i instanceof He?(o instanceof qe&&r(T.syntaxError(x.valueParser_rpnToVETree_referenceAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(T.syntaxError(x.valueParser_rpnToVETree_referenceAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Ue&&r(T.syntaxError(x.valueParser_rpnToVETree_referenceAfterClosing,i.getRange(),i.str.toString()))):i instanceof Ve?(o instanceof qe&&r(T.syntaxError(x.valueParser_rpnToVETree_notAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(T.syntaxError(x.valueParser_rpnToVETree_notAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Ue&&r(T.syntaxError(x.valueParser_rpnToVETree_notAfterClosing,i.getRange(),i.str.toString()))):i instanceof Pe?(o instanceof Pe&&r(T.syntaxError(x.valueParser_rpnToVETree_binaryAfterOperator,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Je&&r(T.syntaxError(x.valueParser_rpnToVETree_binaryAfterOpening,i.getRange(),i.str.toString()))):i instanceof Je?(o instanceof qe&&r(T.syntaxError(x.valueParser_rpnToVETree_openingAfterLiteral,i.getRange(),o.str.toString())),o instanceof He&&r(T.syntaxError(x.valueParser_rpnToVETree_openingAfterReference,i.getRange(),o.str.toString())),o instanceof Ue&&r(T.syntaxError(x.valueParser_rpnToVETree_openingAfterClosing,i.getRange()))):i instanceof Ue&&(o instanceof Pe&&r(T.syntaxError(x.valueParser_rpnToVETree_closingAfterOperator,i.getRange(),o.str.toString())),o instanceof Je&&r(T.syntaxError(x.valueParser_rpnToVETree_closingAfterOpening,i.getRange())))}}}},{key:"simplify",value:function(e){var t=[],n=new Set;e.forEach((function(e,n){e instanceof Ve&&t.push(n)}));for(var r=1;r<t.length;++r)t[r-1]+1===t[r]&&(n.add(t[r-1]),n.add(t[r]),t[r]=NaN);return 0===n.size?e:e.filter((function(e,t){return!n.has(t)}))}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof qe||e instanceof He)t.push(e);else if(e instanceof Pe){for(;n.length>0&&n[n.length-1]instanceof Pe;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof Je)n.push(e);else if(e instanceof Ue)for(;;){if(0===n.length)throw T.syntaxError(x.valueParser_toRPN_missingOpeningParenthesis,void 0);if(n[n.length-1]instanceof Je){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof Je)throw T.syntaxError(x.valueParser_toRPN_missingClosingParenthesis,void 0);t.push(r)}return t}},{key:"rpnToVETree",value:function(e){var t=this.rpnToVETreeRecursive(e);if(e.length>0)throw T.syntaxError(x.valueParser_rpnToVETree_invalidExpression,void 0);return t}},{key:"rpnToVETreeRecursive",value:function(t){if(0===t.length)throw T.syntaxError(x.valueParser_rpnToVETree_invalidExpression,void 0);var n=t.pop();if(n instanceof Ve){var r=e.rpnToVETreeRecursive(t);return Se.not(n.str,r)}if(n instanceof Ae){var a=e.rpnToVETreeRecursive(t),o=e.rpnToVETreeRecursive(t);return Se.and(n.str,o,a)}if(n instanceof Ie){var i=e.rpnToVETreeRecursive(t),s=e.rpnToVETreeRecursive(t);return Se.or(n.str,s,i)}if(n instanceof Me){var l=e.rpnToVETreeRecursive(t),u=e.rpnToVETreeRecursive(t);return new Re(n.type,n.str.toString(),u,l)}if(n instanceof qe)return new Te(n.value,n.type);if(n instanceof He)return new Ne(n.str);if(n instanceof We){var c=e.rpnToVETreeRecursive(t),h=e.rpnToVETreeRecursive(t);return je.add(h,c,n.getRange())}if(n instanceof Be){var p=e.rpnToVETreeRecursive(t),d=e.rpnToVETreeRecursive(t);return je.deduct(d,p,n.getRange())}if(n instanceof Le){var f=e.rpnToVETreeRecursive(t),g=e.rpnToVETreeRecursive(t);return je.multiply(g,f,n.getRange())}if(n instanceof De){var v=e.rpnToVETreeRecursive(t),m=e.rpnToVETreeRecursive(t);return je.divide(m,v,n.getRange())}throw T.codeError(y.valueParser_rpnToVETreeRecursive_unexpectedToken,JSON.stringify(n))}}]),e}(),ze=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r)).selection=void 0,o.stringRange=void 0,o.nullValuesSupport=void 0,o.selection=e,o.stringRange=Q(e),o.nullValuesSupport=a,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=Ke.parse(this.selection.slice(1,-1),this.nullValuesSupport)}catch(a){throw m(a,this.stringRange)}var n=this.subtree.getResult(),r=new $(n.name+"(...)");n.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.getRows().forEach((function(n){var a=t.eval(n);if("boolean"!==a.type)throw T.syntaxError(x.selectionNode_eval_resultNotBoolean,e.stringRange,e.selection.replace(/\s+/g," "),a.type);a.value&&r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.result,r=t.whispers,a=t.errors,o=new $(n.getName()+"(...)");return n.forEachColumn((function(e,t){o.addColumn(t,e)})),n=o,void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(r=n.getColumnNames()),0===this.selection.toString().slice(1,-1).trim().length?a.push(T.syntaxError(x.valueParser_parseTokens_emptyInput,this.stringRange)):this.selection instanceof Z&&a.push.apply(a,Object(u.a)(Ke.fakeParse(this.selection.slice(1,-1),this.nullValuesSupport,n.getColumnNames()))),{result:n,whispers:r,errors:a}}},{key:"printInLine",value:function(){return"Selection of "+this.selection.replace(/\s+/g," ")+" from {"+this.subtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return"Selection"}},{key:"getParameter",value:function(){return this.selection.replace(/\s+/g," ")}}]),n}(pe),Ge=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).leftSubtree=void 0,a.rightSubtree=void 0,a.leftSubtree=e,a.rightSubtree=r,a}return Object(h.a)(n,[{key:"getLeftSubtree",value:function(){return this.leftSubtree}},{key:"getRightSubtree",value:function(){return this.rightSubtree}},{key:"fakeEvalBinary",value:function(e,t){var n,r=this.leftSubtree.fakeEval(e),a=this.rightSubtree.fakeEval(e),o=new $("");return"left"!==t&&"union"!==t||r.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),"right"!==t&&"union"!==t||a.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),(n=r.errors).push.apply(n,Object(u.a)(a.errors)),{result:o,whispers:0!==r.whispers.length?r.whispers:a.whispers,errors:r.errors}}}]),n}(ce);!function(e){e.left="\u22b3",e.right="\u22b2"}(Ce||(Ce={}));var Xe,$e=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e,t,n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult(),a=n.getColumnNames().filter((function(e){return r.hasColumn(e)})),o=new $("("+n.getName()+this.type+r.getName()+")");this.type===Ce.left?(n.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=n.getRows(),t=r.getRows()):(r.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=r.getRows(),t=n.getRows()),e.forEach((function(e){if(!t.some((function(t){return a.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var n=new de(o.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),o.addRow(n)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.type===Ce.left?"left":"right";return this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return this.getOperationName()+" of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return this.type===Ce.left?"Left antijoin":"Right antijoin"}}]),n}(Ge),Ye=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=new $("("+t.getName()+"\u2a2f"+n.getName()+")");t.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.forEachColumn((function(t,n){if(!r.addColumn(n,t))throw T.semanticError(k.binaryNode_eval_commonColumnsInSources,e.stringRange,"cartesian product",n)})),t.getRows().forEach((function(e){n.getRows().forEach((function(t){var n=new de(r.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),t.getValues().forEach((function(e,t){return n.addValue(t,e)})),r.addRow(n)}))})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t,n=this.leftSubtree.fakeEval(e),r=this.rightSubtree.fakeEval(e),a=new $("");n.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),r.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),(t=n.errors).push.apply(t,Object(u.a)(r.errors));var o=[];return n.result.getColumnNames().forEach((function(e){r.result.hasColumn(e)&&o.push(e)})),o.length>0&&n.errors.push(T.semanticError(k.binaryNode_eval_commonColumnsInSources,this.stringRange,"cartesian product",o.join('", "'))),{result:a,whispers:0!==n.whispers.length?n.whispers:r.whispers,errors:n.errors}}},{key:"printInLine",value:function(){return"Cartesian product of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return"Cartesian product"}}]),n}(Ge),Ze=n(17),Qe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=e.getColumns(),r=t.getColumns();if(!Object(u.a)(r).every((function(e){return n.has(e[0])&&n.get(e[0])===e[1]})))throw T.semanticError(k.divisionNode_eval_rightColumnsNotSubsetOfLeft,this.stringRange,t.getSchemaString(),e.getSchemaString());var a=new Map;if(n.forEach((function(e,t){r.has(t)||a.set(t,e)})),0===a.size)throw T.semanticError(k.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,this.stringRange,t.getNamesSchemaString(),e.getNamesSchemaString());var o=new $("("+e.getName()+"\xf7"+t.getName()+")");a.forEach((function(e,t){return o.addColumn(t,e)}));var i=e.getRows(),s=t.getRows();i.forEach((function(e){if(s.every((function(t){var r=new de(n);return a.forEach((function(t,n){return r.addValue(n,e.getValue(n))})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),Object(u.a)(i).some((function(e){return e.equals(r)}))}))){var t=new de(o.getColumns());a.forEach((function(n,r){return t.addValue(r,e.getValue(r))})),o.addRow(t)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=t.result.getColumns(),a=n.result.getColumns(),o=new Map(Object(u.a)(r.entries()).filter((function(e){var t=Object(Ze.a)(e,2),n=t[0];t[1];return!a.has(n)}))),i=new $("("+t.result.getName()+"\xf7"+n.result.getName()+")");o.forEach((function(e,t){return i.addColumn(t,e)}));var s=t.errors;return s.push.apply(s,Object(u.a)(n.errors)),Object(u.a)(a).every((function(e){return r.has(e[0])&&r.get(e[0])===e[1]}))||""===t.result.getName()?0===o.size&&""!==t.result.getName()&&s.push(T.semanticError(k.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,this.stringRange,n.result.getNamesSchemaString(),t.result.getNamesSchemaString())):s.push(T.semanticError(k.divisionNode_eval_rightColumnsNotSubsetOfLeft,this.stringRange,n.result.getSchemaString(),t.result.getSchemaString())),{result:i,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:s}}},{key:"printInLine",value:function(){return"Division of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return"Division"}}]),n}(Ge);!function(e){e.left="*L*",e.right="*R*",e.full="*F*"}(Xe||(Xe={}));var et,tt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=new $("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return n.addColumn(t,e)})),t.forEachColumn((function(e,t){return n.addColumn(t,e)}));var r=e.getRows(),a=t.getRows(),o=e.getColumnNames().filter((function(e){return t.hasColumn(e)}));r.forEach((function(e){a.forEach((function(t){if(o.every((function(n){return e.getValue(n)===t.getValue(n)}))){var r=new de(n.getColumns());e.getValues().forEach((function(e,t){return r.addValue(t,e)})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),n.addRow(r)}}))})),this.type!==Xe.left&&this.type!==Xe.full||r.forEach((function(e){if(!a.some((function(t){return o.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var t=new de(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.type!==Xe.right&&this.type!==Xe.full||a.forEach((function(e){if(!r.some((function(t){return o.every((function(n){return t.getValue(n)===e.getValue(n)}))}))){var t=new de(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){return this.fakeEvalBinary(e,"union")}},{key:"printInLine",value:function(){return this.getOperationName()+" of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return(this.type===Xe.left?"Left":this.type===Xe.right?"Right":"Full")+" outer join"}}]),n}(Ge);!function(e){e.natural="*",e.leftSemi="<*",e.rightSemi="*>"}(et||(et={}));var nt,rt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=t.getColumnNames().filter((function(e){return n.hasColumn(e)})),a=new $("("+t.getName()+this.type+n.getName()+")");this.type!==et.leftSemi&&this.type!==et.natural||t.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==et.rightSemi&&this.type!==et.natural||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),t.getRows().forEach((function(t){n.getRows().forEach((function(n){if(Object(u.a)(r).every((function(e){return t.getValue(e)===n.getValue(e)}))){var o=new de(a.getColumns());e.type!==et.leftSemi&&e.type!==et.natural||t.getValues().forEach((function(e,t){return o.addValue(t,e)})),e.type!==et.rightSemi&&e.type!==et.natural||n.getValues().forEach((function(e,t){return o.addValue(t,e)})),a.addRow(o)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t="union";return this.type===et.leftSemi?t="left":this.type===et.rightSemi&&(t="right"),this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return this.getOperationName()+" of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return this.type===et.leftSemi?"Left semijoin":this.type===et.rightSemi?"Right semijoin":"Natural join"}},{key:"getType",value:function(){return this.type}}]),n}(Ge);!function(e){e.union="\u222a",e.intersection="\u2229",e.difference="\\"}(nt||(nt={}));var at,ot=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).stringRange=o,i.type=void 0,i.type=e,i}return Object(h.a)(n,[{key:"getTypeStr",value:function(){return this.type===nt.union?"Union":this.type===nt.intersection?"Intersection":"Difference"}},{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult();if(!Object(X.isEqual)(e.getColumns(),t.getColumns())){var n=this.getTypeStr().toLowerCase();throw T.semanticError(k.setOperationNode_eval_notEqualColumnsInSources,this.stringRange,e.getSchemaString(),t.getSchemaString(),n)}var r=new $("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return r.addColumn(t,e)}));var a=e.getRows(),o=t.getRows();(this.type===nt.union?[].concat(Object(u.a)(a),Object(u.a)(o)):this.type===nt.intersection?Object(u.a)(a).filter((function(e){return Object(u.a)(o).some((function(t){return e.equals(t)}))})):Object(u.a)(a).filter((function(e){return!Object(u.a)(o).some((function(t){return e.equals(t)}))}))).forEach((function(e){return r.addRow(e)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=new $("("+t.result.getName()+this.type+n.result.getName()+")");t.result.forEachColumn((function(e,t){n.result.hasColumn(t)&&r.addColumn(t,e)}));var a=t.errors;if(a.push.apply(a,Object(u.a)(n.errors)),!Object(X.isEqual)(t.result.getColumns(),n.result.getColumns())&&""!==t.result.getName()&&""!==n.result.getName()){var o=this.getTypeStr().toLowerCase();a.push(T.semanticError(k.setOperationNode_eval_notEqualColumnsInSources,this.stringRange,t.result.getSchemaString(),n.result.getSchemaString(),o))}return{result:r,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:a}}},{key:"printInLine",value:function(){return this.getOperationName()+" of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return this.getTypeStr()}}]),n}(Ge);!function(e){e.full="[]",e.left="<]",e.right="[>"}(at||(at={}));var it,st=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e,r,a,o,i){var s;return Object(c.a)(this,n),(s=t.call(this,a,o)).type=void 0,s.condition=void 0,s.stringRange=void 0,s.nullValuesSupport=void 0,s.condition=r,s.stringRange=Q(r),s.nullValuesSupport=i,s.type=e,s}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=Ke.parse(this.condition.slice(1,-1),this.nullValuesSupport)}catch(i){throw m(i,this.stringRange)}var n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult();n.getColumnNames().forEach((function(t){if(r.hasColumn(t))throw T.semanticError(k.binaryNode_eval_commonColumnsInSources,e.stringRange,e.getOperationName().toLowerCase(),t)}));var a=new $("("+n.getName()+this.type.charAt(0)+"..."+this.type.charAt(1)+r.getName()+")");this.type!==at.left&&this.type!==at.full||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==at.right&&this.type!==at.full||r.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=new Map(n.getColumns());r.forEachColumn((function(e,t){return o.set(t,e)})),n.getRows().forEach((function(n){r.getRows().forEach((function(r){var i=new de(o);n.getValues().forEach((function(e,t){return i.addValue(t,e)})),r.getValues().forEach((function(e,t){return i.addValue(t,e)}));var s=t.eval(i);if("boolean"!==s.type)throw T.syntaxError(x.thetaSemiJoinNode_eval_resultNotBoolean,e.stringRange,e.condition.replace(/\s+/g," "),s.type);if(s.value){var l=new de(a.getColumns());e.type!==at.left&&e.type!==at.full||n.getValues().forEach((function(e,t){return l.addValue(t,e)})),e.type!==at.right&&e.type!==at.full||r.getValues().forEach((function(e,t){return l.addValue(t,e)})),a.addRow(l)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=[];r.push.apply(r,Object(u.a)(t.result.getColumnNames())),r.push.apply(r,Object(u.a)(n.result.getColumnNames()));var a=new $("");this.type!==at.left&&this.type!==at.full||t.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==at.right&&this.type!==at.full||n.result.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=0!==t.whispers.length?t.whispers:n.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(o=r);var i=t.errors;i.push.apply(i,Object(u.a)(n.errors));var s=[];return t.result.getColumnNames().forEach((function(e){n.result.hasColumn(e)&&s.push(e)})),s.length>0&&void 0!==this.stringRange&&i.push(T.semanticError(k.binaryNode_eval_commonColumnsInSources,{start:this.stringRange.start,end:this.stringRange.start},this.getOperationName().toLowerCase(),s.join('", "'))),0===this.condition.toString().slice(1,-1).trim().length?i.push(T.syntaxError(x.valueParser_parseTokens_emptyInput,this.stringRange)):this.condition instanceof Z&&i.push.apply(i,Object(u.a)(Ke.fakeParse(this.condition.slice(1,-1),this.nullValuesSupport,r))),{result:a,whispers:o,errors:i}}},{key:"printInLine",value:function(){return this.getOperationName()+" of {"+this.leftSubtree.printInLine()+"} and {"+this.rightSubtree.printInLine()+"}"}},{key:"getOperationName",value:function(){return this.type===at.left?"Left theta semijoin":this.type===at.right?"Right theta semijoin":"Theta join"}},{key:"getParameter",value:function(){return this.condition.replace(/\s+/g," ")}},{key:"getType",value:function(){return this.type}}]),n}(Ge),lt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"createUnary",value:function(e,t,n,r){switch(e){case"projection":return new ye(r,t);case"rename":return new be(r,t);case"selection":return new ze(r,t,n)}}},{key:"createBinary",value:function(e,t,n,r,a){switch(e){case"left antijoin":return new $e(Ce.left,t,n);case"right antijoin":return new $e(Ce.right,t,n);case"cartesian product":return new Ye(t,n,Q(a));case"division":return new Qe(t,n,Q(a));case"natural join":return new rt(et.natural,t,n);case"left outer join":return new tt(Xe.left,t,n);case"right outer join":return new tt(Xe.right,t,n);case"full outer join":return new tt(Xe.full,t,n);case"left semijoin":return new rt(et.leftSemi,t,n);case"right semijoin":return new rt(et.rightSemi,t,n);case"union":return new ot(nt.union,t,n,Q(a));case"intersection":return new ot(nt.intersection,t,n,Q(a));case"difference":return new ot(nt.difference,t,n,Q(a));case"theta join":return new st(at.full,a,t,n,r);case"left theta semijoin":return new st(at.left,a,t,n,r);case"right theta semijoin":return new st(at.right,a,t,n,r)}}}]),e}();!function(e){e[e.NOT_THROW=0]="NOT_THROW",e[e.THROW_STRICT=1]="THROW_STRICT",e[e.THROW_NOT_STRICT=2]="THROW_NOT_STRICT"}(it||(it={}));var ut=function(){function e(t,n){Object(c.a)(this,e),this.relations=t,this.nullValuesSupport=n}return Object(h.a)(e,[{key:"parse",value:function(e){if(""===(e=j.deleteCommentLines(e)).trim())throw T.syntaxError(x.exprParser_parse_emptyStringGiven,void 0);var t=this.parseTokens(e);this.assertValidInfixTokens(t,it.THROW_STRICT);var n=this.toRPN(t);return this.rpnToRATree(n,!0)}},{key:"indexedParse",value:function(e){var t=Y.deleteCommentLines(Z.new(e));if(t.trim().isEmpty())throw T.syntaxError(x.exprParser_parse_emptyStringGiven,void 0);var n=this.parseTokens(t);this.assertValidInfixTokens(n,it.THROW_STRICT);var r=this.toRPN(n);return this.rpnToRATree(r,!0)}},{key:"fakeParse",value:function(e,t){var n=Y.deleteCommentLines(Z.new(e));if(n.trim().isEmpty())return{whispers:[],errors:[]};var r=this.fakeParseTokens(n,t),a=r.whispers,o=r.tokens,i=r.errors;if(0===o.length)return{whispers:[],errors:i};this.assertValidInfixTokens(o,it.NOT_THROW,i);var s=this.toRPN(o),l=this.rpnToRATree(s,!1,i).fakeEval(t);return i.push.apply(i,Object(u.a)(l.errors)),l.whispers.length>0?{whispers:l.whispers,errors:i}:{whispers:a,errors:i}}},{key:"parseTokens",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=e;!te(r);)if((r=r.trim()).startsWith("(")){var a=ne(r,"(",")");t?n.push(le.selection(a.first)):(n.push(new oe(a.first.slice(0,1))),n.push.apply(n,Object(u.a)(this.parseTokens(a.first.slice(1,-1)))),n.push(new ie(a.first.slice(-1))),t=!0),r=a.second}else if(r.startsWith("[")){var o=ne(r,"[","]");n.push(le.projection(o.first)),t=!0,r=o.second}else if(r.startsWith("{")){var i=ne(r,"{","}>");i.first.endsWith(">")?n.push(ue.rightThetaSemijoin(i.first)):n.push(ue.thetaJoin(i.first)),t=!1,r=i.second}else if(r.startsWith("*F*")||r.startsWith("*L*")||r.startsWith("*R*")){if(!this.nullValuesSupport){var s=void 0;throw r instanceof Z&&void 0!==r.getFirstNonNaNIndex()&&(s={start:r.getFirstNonNaNIndex(),end:r.getFirstNonNaNIndex()+2}),T.syntaxError(x.exprParser_parseTokens_outerJoinWhenNullNotSupported,s,"*F*")}r.startsWith("*F")?n.push(ue.fullOuterJoin(r.slice(0,3))):r.startsWith("*L")?n.push(ue.leftOuterJoin(r.slice(0,3))):n.push(ue.rightOuterJoin(r.slice(0,3))),r=r.slice(3),t=!1}else if(r.startsWith("<*"))n.push(ue.leftSemijoin(r.slice(0,2))),r=r.slice(2),t=!1;else if(r.startsWith("*>"))n.push(ue.rightSemijoin(r.slice(0,2))),r=r.slice(2),t=!1;else if("*\u2a2f\u222a\u2229\\\u22b3\u22b2\xf7".indexOf(r.charAt(0))>-1){var l=r.slice(0,1);r.startsWith("*")?n.push(ue.naturalJoin(l)):r.startsWith("\u2a2f")?n.push(ue.cartesianProduct(l)):r.startsWith("\u222a")?n.push(ue.union(l)):r.startsWith("\u2229")?n.push(ue.intersection(l)):r.startsWith("\\")?n.push(ue.difference(l)):r.startsWith("\u22b3")?n.push(ue.leftAntijoin(l)):r.startsWith("\u22b2")?n.push(ue.rightAntijoin(l)):r.startsWith("\xf7")&&n.push(ue.division(l)),r=r.slice(1),t=!1}else if(r.startsWith("<")){var c=ne(r,"<",">}","-");c.first.endsWith(">")?(n.push(le.rename(c.first)),t=!0):(n.push(ue.leftThetaSemijoin(c.first)),t=!1),r=c.second}else{if(!j.isLetter(r.charAt(0))&&"_"!==r.charAt(0)){var h=r instanceof Z?Y.nextNonWhitespacePart(r):j.nextNonWhitespacePart(r);throw T.syntaxError(x.exprParser_parseTokens_unexpectedPart,Q(h.first),h.first.toString())}var p=r instanceof Z?Y.nextName(r):j.nextName(r);n.push(new se(p.first)),r=p.second,t=!0}return n}},{key:"fakeParseTokens",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,a=[],o=[],i=[],s=e;!s.isEmpty();){var l=s.getFirstNonNaNIndex();if(l===t&&(r=!0,a=Object(u.a)(this.relations.keys())),(s=s.trim()).startsWith("(")){var c=void 0;try{c=Y.nextBorderedPart(s,"(",")")}catch(A){if(A instanceof v&&i.push(A),n)o.push(le.selection(s.concat(Z.newFromArray([{char:" ",index:s.getNextIndexOrNaN()},{char:")",index:NaN}]))));else{l===t-1&&(r=!0,a=Object(u.a)(this.relations.keys())),o.push(new oe(s.slice(0,1)));var h=this.fakeParseTokens(s.slice(1),t);i.push.apply(i,Object(u.a)(h.errors)),h.whispersFound&&(r=!0,a=h.whispers),o.push.apply(o,Object(u.a)(h.tokens)),o.push(new ie(Z.new(")",NaN)))}break}if(n)o.push(le.selection(c.first));else{o.push(new oe(c.first.slice(0,1)));var p=this.fakeParseTokens(c.first.slice(1,-1),t);i.push.apply(i,Object(u.a)(p.errors)),p.whispersFound&&(r=!0,a=p.whispers),o.push.apply(o,Object(u.a)(p.tokens)),o.push(new ie(c.first.slice(-1))),n=!0}s=c.second}else if(s.startsWith("[")){var d=void 0;try{d=Y.nextBorderedPart(s,"[","]"),o.push(le.projection(d.first)),s=d.second;var f=d.first.getLastNonNaNIndex();f===t-1&&(r=!0,a=Object(u.a)(this.relations.keys()))}catch(A){A instanceof v&&i.push(A),o.push(le.projection(s.concat(Z.new("]",s.getNextIndexOrNaN()))));break}}else if(s.startsWith("{")){var g=void 0;try{(g=Y.nextBorderedPart(s,"{","}>")).first.endsWith(">")?o.push(ue.rightThetaSemijoin(g.first)):o.push(ue.thetaJoin(g.first)),s=g.second;var m=g.first.getLastNonNaNIndex();m===t-1&&(r=!0,a=Object(u.a)(this.relations.keys()))}catch(A){A instanceof v&&i.push(A),o.push(ue.thetaJoin(s.concat(Z.new("}",s.getNextIndexOrNaN()))));break}}else if(s.startsWith("*F*")||s.startsWith("*L*")||s.startsWith("*R*")){var y=s.slice(0,3),k=y.getLastNonNaNIndex();k===t-1&&(r=!0,a=Object(u.a)(this.relations.keys())),s.startsWith("*F")?o.push(ue.fullOuterJoin(y)):s.startsWith("*L")?o.push(ue.leftOuterJoin(y)):o.push(ue.rightOuterJoin(y)),s=s.slice(3),n=!1}else if(s.startsWith("<*")||s.startsWith("*>")){var b=s.slice(0,2),E=b.getLastNonNaNIndex();E===t-1&&(r=!0,a=Object(u.a)(this.relations.keys())),s.startsWith("<*")?o.push(ue.leftSemijoin(b)):o.push(ue.rightSemijoin(b)),s=s.slice(2),n=!1}else if("*\u2a2f\u222a\u2229\\\u22b3\u22b2\xf7".indexOf(s.charAt(0))>-1){var w=s.slice(0,1),R=w.getLastNonNaNIndex();R===t-1&&(r=!0,a=Object(u.a)(this.relations.keys())),s.startsWith("*")?o.push(ue.naturalJoin(w)):s.startsWith("\u2a2f")?o.push(ue.cartesianProduct(w)):s.startsWith("\u222a")?o.push(ue.union(w)):s.startsWith("\u2229")?o.push(ue.intersection(w)):s.startsWith("\\")?o.push(ue.difference(w)):s.startsWith("\u22b3")?o.push(ue.leftAntijoin(w)):s.startsWith("\u22b2")?o.push(ue.rightAntijoin(w)):s.startsWith("\xf7")&&o.push(ue.division(w)),s=s.slice(1),n=!1}else if(s.startsWith("<"))try{var _=Y.nextBorderedPart(s,"<",">}","-");if(_.first.endsWith(">")){var S=_.first.getLastNonNaNIndex();S===t-1&&(r=!0,a=[]),o.push(le.rename(_.first)),n=!0}else{var N=_.first.getLastNonNaNIndex();N===t-1&&(r=!0,a=Object(u.a)(this.relations.keys())),o.push(ue.leftThetaSemijoin(_.first)),n=!1}s=_.second}catch(I){o.push(le.rename(s.concat(Z.new(">",s.getNextIndexOrNaN()))));break}else if(j.isLetter(s.charAt(0))||"_"===s.charAt(0)){var C=Y.nextName(s),O=C.first.getFirstNonNaNIndex(),P=C.first.getLastNonNaNIndex();"number"===typeof O&&"number"===typeof P&&O<=t-1&&t-1<=P&&(r=!0,a=Object(u.a)(this.relations.keys())),o.push(new se(C.first)),s=C.second,n=!0}else{var V=Y.nextNonWhitespacePart(s);i.push(T.syntaxError(x.exprParser_parseTokens_unexpectedPart,Q(V.first),V.first.toString())),s=s.slice(V.first.length())}}return r?{whispersFound:r,tokens:o,whispers:a,errors:i}:{whispersFound:r,tokens:o,whispers:[],errors:i}}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(r,a,o,i){for(var s=arguments.length,l=new Array(s>4?s-4:0),u=4;u<s;u++)l[u-4]=arguments[u];var c=T.syntaxError.apply(T,[o,i].concat(l));if(t!==it.NOT_THROW)throw c;"binary"===a?(n.push(c),e.splice(r,0,ue.naturalJoin("*"))):(n.push(c),e.splice(r,0,new se("")))};t!==it.THROW_NOT_STRICT&&(e[0]instanceof le||e[0]instanceof ue||e[0]instanceof ie)&&r(0,"relation",x.exprParser_assertValidInfixTokens_invalidStart,e[0].getRange(),e[0].str.toString()),(e[e.length-1]instanceof oe||e[e.length-1]instanceof ue)&&r(e.length,"relation",x.exprParser_assertValidInfixTokens_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString());for(var a=1;a<e.length;){var o=e[a-1],i=e[a];if(i instanceof se)o instanceof se&&r(a,"binary",x.exprParser_assertValidInfixTokens_relationAfterRelation,i.getRange(),i.str.toString(),o.str.toString()),o instanceof le&&r(a,"binary",x.exprParser_assertValidInfixTokens_relationAfterUnary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ie&&r(a,"binary",x.exprParser_assertValidInfixTokens_relationAfterClosing,i.getRange(),i.str.toString());else if(i instanceof le)o instanceof ue&&r(a,"relation",x.exprParser_assertValidInfixTokens_unaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof oe&&r(a,"relation",x.exprParser_assertValidInfixTokens_unaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof ue)o instanceof ue&&r(a,"relation",x.exprParser_assertValidInfixTokens_binaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof oe&&r(a,"relation",x.exprParser_assertValidInfixTokens_binaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof oe)o instanceof se&&r(a,"binary",x.exprParser_assertValidInfixTokens_openingAfterRelation,i.getRange(),o.str.toString()),o instanceof le&&r(a,"binary",x.exprParser_assertValidInfixTokens_openingAfterUnary,i.getRange(),o.str.toString()),o instanceof ie&&r(a,"binary",x.exprParser_assertValidInfixTokens_openingAfterClosing,i.getRange());else{if(!(i instanceof ie))throw T.codeError(y.exprParser_isValidSequence_unexpectedToken,JSON.stringify(i));o instanceof ue&&r(a,"relation",x.exprParser_assertValidInfixTokens_closingAfterBinary,i.getRange(),o.str.toString()),o instanceof oe&&r(a,"relation",x.exprParser_assertValidInfixTokens_closingAfterOpening,i.getRange())}++a}}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof se||e instanceof le)t.push(e);else if(e instanceof ue){for(;n.length>0&&n[n.length-1]instanceof ue;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof oe)n.push(e);else if(e instanceof ie)for(;;){if(0===n.length)throw T.syntaxError(x.exprParser_assertValidInfixTokens_invalidParentheses,void 0);if(n[n.length-1]instanceof oe){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof oe)throw T.syntaxError(x.exprParser_assertValidInfixTokens_invalidParentheses,void 0);t.push(r)}return t}},{key:"rpnToRATree",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.rpnToRATreeRecursive(e,t,n);if(e.length>0){if(t)throw T.syntaxError(x.exprParser_rpnToVETree_invalidExpression,void 0);return new he(new $(""))}return r}},{key:"rpnToRATreeRecursive",value:function(e,t,n){if(0===e.length)throw T.syntaxError(x.exprParser_rpnToVETree_invalidExpression,void 0);var r=e.pop();if(r instanceof se){var a=this.relations.get(r.str.toString());if(void 0===a){var o=T.semanticError(k.exprParser_parse_relationNotDefined,r.getRange(),r.str.toString());if(t)throw o;return n.push(o),new he(new $(""))}return new he(a)}if(r instanceof le){var i=this.rpnToRATreeRecursive(e,t,n);return lt.createUnary(r.type,i,this.nullValuesSupport,r.str)}if(r instanceof ue){var s=this.rpnToRATreeRecursive(e,t,n),l=this.rpnToRATreeRecursive(e,t,n);return lt.createBinary(r.type,l,s,this.nullValuesSupport,r.str)}throw T.codeError(y.exprParser_rpnToVETreeRecursive_unexpectedToken,JSON.stringify(r))}}]),e}(),ct=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).inputRef=void 0,r.handleChange=function(e){e=e.replace(/\t/g,"    ");var t=r.props.forbidden(e);r.setState({value:e,buttonDisable:t})},r.handleKeyDown=function(e){"Enter"===e.key?r.state.buttonDisable||r.handleSubmit():"Escape"!==e.key&&"Esc"!==e.key||null!==r.inputRef.current&&r.inputRef.current.blur()},r.handleSubmit=function(){r.props.onSubmit(r.state.value)},r.state={value:r.props.value,buttonDisable:r.props.forbidden(r.props.value)},r.inputRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{style:this.props.style},a.a.createElement("label",{htmlFor:this.props.id},this.props.label),a.a.createElement("input",{ref:this.inputRef,type:"text",id:this.props.id,spellCheck:!1,autoComplete:"off",value:this.state.value,onChange:function(t){return e.handleChange(t.target.value)},onKeyDown:this.handleKeyDown,className:this.props.darkTheme?"text-input-dark":"text-input-light"}),a.a.createElement("button",{onClick:this.handleSubmit,disabled:this.state.buttonDisable,className:this.props.darkTheme?"button-dark":"button-light"},this.props.buttonText))}}]),n}(a.a.Component),ht=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).buttonPropsFirstPart=[{key:"unary_a",char:"()",text:"()",tooltip:"Selection (P1)",shift:1},{key:"unary_b",char:"[]",text:"[]",tooltip:"Projection (P1)",shift:1},{key:"unary_c",char:"< -> >",text:"<>",tooltip:"Rename (P1)",shift:5},{key:"a",char:"*",text:"*",tooltip:"Natural join (P2)",shift:0},{key:"b",char:"\u2a2f",text:"\u2a2f",tooltip:"Cartesian product (P2)",shift:0},{key:"c",char:"{}",text:"{}",tooltip:"Theta join (P2)",shift:1},{key:"d",char:"<*",text:"<*",tooltip:"Left semijoin (P3)",shift:0},{key:"e",char:"*>",text:"*>",tooltip:"Right semijoin (P3)",shift:0},{key:"f",char:"\u22b3",text:"\u22b3",tooltip:"Left antijoin (P3)",shift:0},{key:"g",char:"\u22b2",text:"\u22b2",tooltip:"Right antijoin (P3)",shift:0},{key:"h",char:"<}",text:"<}",tooltip:"Left theta semijoin (P3)",shift:1},{key:"i",char:"{>",text:"{>",tooltip:"Right theta semijoin (P3)",shift:1}],r.buttonPropsSecondPart=[{key:"j",char:"\xf7",text:"\xf7",tooltip:"Division (P5)",shift:0},{key:"k",char:"\u2229",text:"\u2229",tooltip:"Intersection (P6)",shift:0},{key:"l",char:"\\",text:"\\",tooltip:"Difference (P7)",shift:0},{key:"m",char:"\u222a",text:"\u222a",tooltip:"Union (P8)",shift:0}],r.nullSupportRequiredButtonProps=[{key:"null_a",char:"*F*",text:"*F*",tooltip:"Full outer join (P4)",shift:0},{key:"null_b",char:"*L*",text:"*L*",tooltip:"Left outer join (P4)",shift:0},{key:"null_c",char:"*R*",text:"*R*",tooltip:"Right outer join (P4)",shift:0}],r.textAreaRef=void 0,r.lastChange=0,r.lastWhisperAndErrorsUpdate=0,r.whispersAndErrorsUpdateRate=200,r.sectionRef=void 0,r.updateErrors=function(){var e=r.getCurExpr().text,t=new ut(r.props.relations,r.props.nullValuesSupport).fakeParse(e,r.state.cursorIndex).errors;r.setState({errors:t.filter((function(e){return void 0!==e.range})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}}))})},r.evalExpr=function(){r.showMessage("");try{var e=new ut(r.props.relations,r.props.nullValuesSupport).indexedParse(r.props.expressions[r.props.currentExpressionIndex].text);e.eval(),r.setState({errors:[]}),r.props.onEval(e)}catch(t){t instanceof v&&void 0!==t.range&&(t.range.end+=1,r.setState((function(e){var n=e.errors;return n.every((function(e){return e.start!==t.range.start||e.end!==t.range.end}))&&n.push(Object(O.a)(Object(O.a)({},t.range),{},{msg:t.message})),{errors:n}}))),r.showError(t)}},r.newExpression=function(){r.props.onNewExpression()},r.deleteExpression=function(){r.props.onDeleteExpression(r.updateErrors)},r.saveExpressions=function(){r.props.onExportExpressions(r.showMessage)},r.loadExpressions=function(){r.setState({errors:[]}),r.props.onImportExpressions((function(e){r.showMessage(e),r.updateErrors()}))},r.addSpecialString=function(e,t){var n=r.textAreaRef.current.getSelection(),a=n.start,o=n.end,i=r.getCurExpr().text.substring(0,a),s=r.getCurExpr().text.substring(o),l=i.length+e.length-t,u=i+e+s;r.handleExprChange(u,l,(function(){r.textAreaRef.current.setSelection(l),r.textAreaRef.current.focus()}))},r.handleExprChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};r.props.onChange(r.getCurExpr().name,e),r.setState({cursorIndex:t},n),r.lastChange=Date.now()},r.handleTextInsert=function(){var e=r.getCurExpr().text.replace(/\t/g,"    ");r.props.onChange(r.getCurExpr().name,e),r.lastChange=Date.now()},r.updateWhispersAndErrors=function(){var e=r.textAreaRef.current;if(null!==e&&e.isFocused()&&r.lastChange>r.lastWhisperAndErrorsUpdate){var t=r.getCurExpr().text,n=new ut(r.props.relations,r.props.nullValuesSupport).fakeParse(t,r.state.cursorIndex),a=n.whispers,o=n.errors;!function(e,t){var n=function(e){return(e.charAt(0).toLowerCase()===t.charAt(0).toLowerCase()?64:0)+(e.toLowerCase().indexOf(t.toLowerCase())>-1?128:0)};""!==t&&e.sort((function(e,t){return n(t)-n(e)}))}(a,t.slice(I(t,r.state.cursorIndex),r.state.cursorIndex)),r.setState({whispers:a,errors:o.filter((function(e){return void 0!==e.range})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}}))}),r.lastWhisperAndErrorsUpdate=Date.now()}},r.handleExprNameChange=function(e){r.props.onChange(e,r.getCurExpr().text)},r.showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState({messageText:e,isMessageError:t})},r.showError=function(e){e instanceof E||e instanceof b?r.showMessage(e.message,!0):(r.props.onUnexpectedError(e),r.showMessage("UNEXPECTED ERROR: "+e.message+"\nPlease, report it with your last actions, thank you!",!0))},r.state={sectionClicked:!1,whispers:[],errors:[],cursorIndex:0,messageText:"",isMessageError:!1},r.textAreaRef=a.a.createRef(),r.sectionRef=a.a.createRef(),setInterval((function(){return r.updateWhispersAndErrors()}),r.whispersAndErrorsUpdateRate),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.sectionRef.current;null!==t&&t.addEventListener("click",(function(){e.setState({sectionClicked:!0})}),!0),window.addEventListener("click",(function(){e.setState({sectionClicked:!1})}),!0),window.addEventListener("keydown",(function(t){e.state.sectionClicked&&t.ctrlKey&&("Enter"===t.key?(e.evalExpr(),t.preventDefault()):t.shiftKey&&"a"===t.key.toLowerCase()?(e.newExpression(),t.preventDefault()):t.shiftKey&&"d"===t.key.toLowerCase()&&(e.deleteExpression(),t.preventDefault()))})),this.updateErrors()}},{key:"getCurExpr",value:function(){return this.props.expressions[this.props.currentExpressionIndex]}},{key:"handleSelectDifferentExpression",value:function(e){this.setState({errors:[]}),this.props.onSelectDifferentExpression(e),this.showMessage("")}},{key:"render",value:function(){var e=this,t=function(t,n,r,o){return a.a.createElement(P,{key:t,text:t,onClick:n,className:e.props.darkTheme?"button-dark":"button-light",style:o,tooltip:r,tooltipClassName:"tooltip "+(e.props.darkTheme?"tooltip-dark":"tooltip-light")})},n=function(t){return t.map((function(t){return a.a.createElement(P,{key:t.key,text:t.text,onClick:function(){return e.addSpecialString(t.char,t.shift)},className:e.props.darkTheme?"button-dark":"button-light",tooltip:t.tooltip,tooltipClassName:"tooltip "+(e.props.darkTheme?"tooltip-dark":"tooltip-light")})}))},r=this.props.darkTheme?"section-border-dark":"section-border-light";return this.state.sectionClicked&&(r=this.props.darkTheme?"section-border-dark-clicked":"section-border-light-clicked"),a.a.createElement("section",{ref:this.sectionRef,className:r},a.a.createElement("div",{className:"expressions-list-menu"},e.props.expressions.map((function(t,n){var r=e.props.darkTheme?e.props.currentExpressionIndex===n?"button-clicked-dark":"button-dark":e.props.currentExpressionIndex===n?"button-clicked-light":"button-light";return a.a.createElement(P,{key:n,text:t.name,onClick:function(){return e.handleSelectDifferentExpression(n)},className:r,style:{width:98/e.props.expressions.length+"%"},tooltip:t.name,tooltipClassName:"tooltip "+(e.props.darkTheme?"tooltip-dark":"tooltip-light")})}))),a.a.createElement(H,{ref:this.textAreaRef,id:"expression-section-textarea",text:this.getCurExpr().text,placeholder:"Write RA expression here...",errors:this.state.errors,whispers:this.state.whispers,onChange:this.handleExprChange,onTextInserted:this.handleTextInsert,darkTheme:this.props.darkTheme}),a.a.createElement("div",null,n(this.buttonPropsFirstPart),this.props.nullValuesSupport?n(this.nullSupportRequiredButtonProps):null,n(this.buttonPropsSecondPart)),a.a.createElement("div",{className:"expressions-management-menu"},a.a.createElement("div",{className:"expressions-management-menu-left"},a.a.createElement(ct,{label:"",value:this.getCurExpr().name,buttonText:"Rename",onSubmit:this.handleExprNameChange,forbidden:function(){return!1},id:"expression-name-input",darkTheme:this.props.darkTheme})),a.a.createElement("div",{className:"expressions-management-menu-right"},t("Evaluate",this.evalExpr,"Evaluates given RA expression",{marginRight:"20px"}),t("New",this.newExpression,"Creates a new RA expression"),t("Delete",this.deleteExpression,"Deletes current RA expression",{marginRight:"20px"}),t("Import",this.loadExpressions,"Loads expressions from a file"),t("Export",this.saveExpressions,"Saves expressions to a file"))),a.a.createElement(V,{message:this.state.messageText,darkTheme:this.props.darkTheme,error:this.state.isMessageError}),a.a.createElement("div",{style:{clear:"both"}}))}}]),n}(a.a.Component),pt=(n(39),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).getOrderByText=function(){return 1===r.state.orderDir?" \u25bc":" \u25b2"},r.state={orderBy:-1,orderDir:1},r}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.relation!==this.props.relation&&this.setState({orderDir:1,orderBy:-1})}},{key:"updateOrderBy",value:function(e){this.setState((function(t){return t.orderBy===e?{orderDir:-t.orderDir,orderBy:e}:{orderDir:1,orderBy:e}}))}},{key:"createHeaderRow",value:function(e){var t=this;return a.a.createElement("tr",null,e.map((function(e,n){var r=t.state.orderBy===n?e+t.getOrderByText():e;return a.a.createElement("th",{key:n,onClick:function(){return t.updateOrderBy(n)}},r)})))}},{key:"createRows",value:function(e){var t=this;if(0===this.props.relation.getRowsCount())return a.a.createElement("tr",{key:"1"},a.a.createElement("td",{key:"1",colSpan:e.length},"<<NO ROWS>>"));var n=this.props.relation.getRows();if(this.state.orderBy>-1&&this.state.orderBy<e.length){var r=e[this.state.orderBy];"number"===n[0].getType(r)?n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*(e.getValue(r)-n.getValue(r)):0})):n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*String(e.getValue(r)).localeCompare(String(n.getValue(r))):0}))}return n.map((function(t,n){return a.a.createElement("tr",{key:n},t.getOrderedValues(e).map((function(e,t){return a.a.createElement("td",{key:t},String(e))})))}))}},{key:"render",value:function(){var e=this.props.relation.getColumnNames(),t=this.createHeaderRow(e),n=this.createRows(e),r="result-table-container result-table-container-light cursor-container-light",o="result-table result-table-light";return this.props.darkTheme&&(r="result-table-container result-table-container-dark cursor-container-dark",o="result-table result-table-dark"),a.a.createElement("div",{className:r},a.a.createElement("table",{className:o},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,n)))}}]),n}(a.a.Component)),dt=n(73),ft=n(74),gt=n(77),vt=n(75),mt=n(28),yt=n.n(mt),kt=n(72),xt=n(76);n(40);function bt(e,t){var n=0;return function e(r){if(n===t)return r;if(n++,r instanceof pe)return e(r.getSubtree());if(r instanceof Ge){var a=e(r.getLeftSubtree());return null===a?e(r.getRightSubtree()):a}return null}(e)}function Et(e){if(e instanceof Ge){var t=Et(e.getLeftSubtree()),n=Et(e.getRightSubtree());return Math.max(t,n)+1}return e instanceof pe?Et(e.getSubtree())+1:0}var wt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(yt.a,null,(function(t){var n=t.width;return a.a.createElement(Mt,{raTree:e.props.tree,selected:e.props.selected,width:n,onClick:e.props.onClick,darkTheme:e.props.darkTheme})}))}}]),n}(a.a.Component),Rt=getComputedStyle(document.querySelector(":root")),_t=Rt.getPropertyValue("--eval-tree-font-size"),St=Rt.getPropertyValue("--eval-tree-font-family"),Tt=A(St,_t),Nt=Tt.fontWidth,Ct=Tt.fontHeight,jt=Ct+20,Ot=Rt.getPropertyValue("--light-background"),Pt=Rt.getPropertyValue("--dark-background"),Vt=Rt.getPropertyValue("--text-color-light"),At=Rt.getPropertyValue("--text-color-dark"),It=Rt.getPropertyValue("--light-details"),Lt=Rt.getPropertyValue("--light-section"),Dt=Rt.getPropertyValue("--dark-details"),Wt=Rt.getPropertyValue("--dark-section");function Bt(e){var t=e.node,n=e.selected,r=e.onClick,o=e.darkTheme,i=Object(kt.a)(),s=i.tooltipLeft,l=i.tooltipTop,u=i.tooltipOpen,c=i.showTooltip,h=i.hideTooltip,p=Object(xt.a)({detectBounds:!0,scroll:!0}),d=p.containerRef,f=p.TooltipInPortal,g=t.data.title.length*Nt+20;return g=g>jt?g:jt,a.a.createElement(dt.a,{top:t.y,left:t.x},a.a.createElement("rect",{height:jt,width:g,y:-jt/2,x:-g/2,rx:10,fill:o?n||u?Dt:Wt:n||u?It:Lt,onClick:function(){r(t.data.index)},ref:d,cursor:"pointer",onMouseOver:function(){c({tooltipLeft:0,tooltipTop:0})},onMouseOut:h},u&&a.a.createElement(f,{key:Math.random(),top:void 0===l?l:l+20,left:s},t.data.tooltip)),a.a.createElement("text",{dy:".33em",fontSize:_t,fontFamily:St,textAnchor:"middle",style:{pointerEvents:"none"},fill:o?At:Vt},t.data.title))}function Mt(e){var t=e.raTree,n=e.selected,r=e.width,o=e.onClick,i=e.darkTheme,s=(Et(t)+1)*jt*1.5,l={top:jt/2,left:0,right:0,bottom:jt/2},u=s-l.top-l.bottom,c=r-l.left-l.right,h=function(e){var t=0;return function e(n){var r=n.getResult(),a=void 0!==n.getParameter?"\n\n"+n.getParameter():"",o=r.getName()+a+"\n\n"+r.getColumnsCount()+" columns\n"+r.getRowsCount()+" rows";return n instanceof pe?{title:n.getOperationName(),tooltip:o,index:t++,children:[e(n.getSubtree())]}:n instanceof Ge?{title:n.getOperationName(),tooltip:o,index:t++,children:[e(n.getLeftSubtree()),e(n.getRightSubtree())]}:{title:n.getOperationName(),tooltip:o,index:t++}}(e)}(t),p=Object(ft.a)(h);return r<10?null:a.a.createElement("svg",{width:r,height:s},a.a.createElement("rect",{width:r,height:s,rx:14,fill:i?Pt:Ot}),a.a.createElement(gt.a,{root:p,size:[c,u]},(function(e){return a.a.createElement(dt.a,{top:l.top,left:l.left},e.links().map((function(e,t){return a.a.createElement(vt.a,{key:"cluster-link-".concat(t),data:e,stroke:i?At:Vt,strokeWidth:"1",strokeOpacity:1,fill:"none"})})),e.descendants().map((function(e){return a.a.createElement(Bt,{key:"node-".concat(e.data.index),node:e,selected:e.data.index===n,onClick:o,darkTheme:i})})))})))}var Ft=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"openFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(e,">");var r=n.firstChild;r.addEventListener("change",(function(){var e=r.files[0],n=new FileReader;n.onload=function(){t({name:e.name,text:n.result})},n.readAsText(e)})),r.click()}))}},{key:"openFiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(n){e.openFilesHelper(n,t)}))}},{key:"openFilesHelper",value:function(e,t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(t," multiple>");var r=n.firstChild,a=[];r.addEventListener("change",(function(){var t=r.files;!function n(r){if(r===t.length)return e(a);var o=t[r],i=new FileReader;i.onload=function(e){a.push({name:o.name,text:e.target.result}),n(r+1),console.log("File "+(r+1)+"/"+t.length+" loaded")},i.readAsText(o)}(0)})),r.click()}}]),e}();var Jt=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(h.a)(e,[{key:"get",value:function(e,t){return this.map.get(e+":"+t)}},{key:"set",value:function(e,t,n){this.map.set(e+":"+t,n)}},{key:"delete",value:function(e,t){return this.map.delete(e+":"+t)}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(t){Object(u.a)(this.map.entries()).map((function(t){return{value:t[1],key:e.parseKey(t[0])}})).forEach((function(e,n){return t(e.value,e.key.row,e.key.column,n)}))}}],[{key:"parseKey",value:function(e){var t=e.split(":");return{row:Number(t[0]),column:Number(t[1])}}}]),e}(),Ut=function(){function e(t,n,r,a,o){Object(c.a)(this,e),this.name=void 0,this.columnNames=void 0,this.columnTypes=void 0,this.rows=void 0,this.columnCount=void 0,this.rowCount=void 0,this.errors=void 0,this.nullValuesSupport=void 0,this.actual=void 0,this.name=t,this.columnNames=n,this.columnTypes=r,this.rows=a,this.columnCount=n.length,this.rowCount=a.length,this.errors=new Jt,this.nullValuesSupport=o,this.actual=!1,this.recomputeErrors()}return Object(h.a)(e,null,[{key:"new",value:function(t,n){return new e(t,["Column1"],["number"],[],n)}},{key:"fromData",value:function(t,n){if(qt(t)){var r=t;return new e(r.name,r.columnNames,r.columnTypes,r.rows,n)}throw new Error("Given object is not a valid relation.")}},{key:"fromRelation",value:function(t,n,r){var a=[],o=[];n.getColumns().forEach((function(e,t){a.push(t),o.push(e)}));var i=n.getRows().map((function(e){return e.getOrderedValues(a).map((function(e){return String(e)}))}));return new e(t,a,o,i,r)}}]),Object(h.a)(e,[{key:"recomputeErrors",value:function(){var e=this;this.errors.clear(),this.checkColumnNames();for(var t=function(t){Object(u.a)(new Array(e.rowCount).keys()).forEach((function(n){return e.checkRowInput(t,n)}))},n=0;n<this.columnCount;++n)t(n)}},{key:"checkColumnNames",value:function(){for(var e=this,t=function(t){var n=e.columnNames[t].trim();return""===n?(e.errors.set("name",t,"Column name cannot be empty"),"continue"):e.columnNames.reduce((function(e,t){return t===n?e+1:e}),0)>1?(e.errors.set("name",t,"Duplicit column name"),"continue"):ve(n)?(e.errors.set("name",t,"Column name cannot be a keyword"),"continue"):j.isName(n)?void e.errors.delete("name",t):(e.errors.set("name",t,"Invalid characters in column name"),"continue")},n=0;n<this.columnCount;++n)t(n)}},{key:"checkRowInput",value:function(e,t){var n=this.rows[t][e].trim(),r=n.toLowerCase();if(""!==r&&"null"!==r){if("number"===this.columnTypes[e]){if(!j.isNumber(n.replace(/\s/g,"")))return void this.errors.set(t,e,"Given string is not a number")}else if("string"===this.columnTypes[e]){if(!j.isStringLiteral(n))return void this.errors.set(t,e,"Given string is not a string literal")}else if("true"!==r&&"t"!==r&&"false"!==r&&"f"!==r)return void this.errors.set(t,e,"Given string is not a boolean");this.errors.delete(t,e)}else this.nullValuesSupport?this.errors.delete(t,e):this.errors.set(t,e,"Null values are not supported")}},{key:"checkColumnTypes",value:function(e){var t=this;this.rows.forEach((function(n,r){return t.checkRowInput(e,r)}))}},{key:"createRelation",value:function(){for(var e=this,t=new $(this.name),n=0;n<this.columnCount;++n)t.addColumn(this.columnNames[n],this.columnTypes[n]);return this.rows.forEach((function(n){var r=new de(t.getColumns());n.forEach((function(t,n){if(""===(t=t.trim())||"null"===t)r.addValue(e.columnNames[n],null);else if("string"===e.columnTypes[n])r.addValue(e.columnNames[n],t);else if("number"===e.columnTypes[n])r.addValue(e.columnNames[n],Number(t.replace(/\s/g,"")));else{var a=t.toLowerCase();r.addValue(e.columnNames[n],"t"===a||"true"===a)}})),t.addRow(r)})),t.finishSchema(),t}},{key:"toDataObject",value:function(){return{name:this.name,columnNames:this.columnNames,columnTypes:this.columnTypes,rows:this.rows,columnCount:this.columnCount,rowCount:this.rowCount}}},{key:"getErrors",value:function(){return this.errors}},{key:"isValid",value:function(){return 0===this.errors.size()}},{key:"setNullValuesSupport",value:function(e){e!==this.nullValuesSupport&&(this.nullValuesSupport=e,this.recomputeErrors())}},{key:"addNewColumn",value:function(){for(var e=this.columnNames.length+1,t="Column"+e;this.columnNames.indexOf(t)>-1;)t="Column"+ ++e;this.columnNames.push(t),this.columnTypes.push("number"),this.nullValuesSupport?this.rows.forEach((function(e){return e.push("")})):this.rows.forEach((function(e){return e.push("0")})),++this.columnCount,this.checkColumnNames(),this.actual=!1}},{key:"addNewRow",value:function(){var e=this;this.nullValuesSupport?this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(e){return""}))):this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(t){return"number"===e.columnTypes[t]?"0":"boolean"===e.columnTypes[t]?"false":'""'}))),++this.rowCount,this.actual=!1}},{key:"deleteColumn",value:function(e){var t=this;this.columnNames.splice(e,1),this.columnTypes.splice(e,1),this.rows.forEach((function(t){return t.splice(e,1)})),--this.columnCount,0===this.columnCount&&(this.rows=[],this.addNewColumn()),this.errors.forEach((function(n,r,a){a===e?t.errors.delete(r,a):a>e&&(t.errors.delete(r,a),t.errors.set(r,a,n))})),this.actual=!1}},{key:"deleteRow",value:function(e){var t=this;this.rows.splice(e,1),--this.rowCount,this.errors.forEach((function(n,r,a){r===e?t.errors.delete(r,a):r>e&&(t.errors.delete(r,a),t.errors.set({column:key.column,row:key.row-1},n))})),this.actual=!1}},{key:"getRowCount",value:function(){return this.rowCount}},{key:"getColumnCount",value:function(){return this.columnCount}},{key:"setName",value:function(e){this.name=e,this.actual=!1}},{key:"getName",value:function(){return this.name}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"setColumnName",value:function(e,t){this.columnNames[t]=e,this.checkColumnNames(),this.actual=!1}},{key:"getColumnTypes",value:function(){return this.columnTypes}},{key:"setColumnType",value:function(e,t){this.columnTypes[t]=e,this.checkColumnTypes(t),this.actual=!1}},{key:"getRows",value:function(){return this.rows}},{key:"setRowInput",value:function(e,t,n){this.rows[t][n]=e,this.checkRowInput(n,t),this.actual=!1}},{key:"isActual",value:function(){return this.actual}},{key:"setActual",value:function(e){this.actual=e}}]),e}();function qt(e){return"object"===typeof e&&("name"in e&&"string"===typeof e.name&&("columnCount"in e&&"number"===typeof e.columnCount&&!(e.columnCount<1)&&("rowCount"in e&&"number"===typeof e.rowCount&&(!(!("columnNames"in e)||!Array.isArray(e.columnNames)||e.columnNames.length!==e.columnCount||e.columnNames.some((function(e){return"string"!==typeof e})))&&(!(!("columnTypes"in e)||!Array.isArray(e.columnTypes)||e.columnTypes.length!==e.columnCount||e.columnTypes.some((function(e){return!function(e){return"string"===typeof e&&("string"===e||"number"===e||"boolean"===e)}(e)})))&&("rows"in e&&Array.isArray(e.rows)&&e.rows.every((function(t){return Array.isArray(t)&&t.length===e.columnCount&&t.every((function(e){return"string"===typeof e}))}))))))))}var Ht=n(8),Kt=n(20),zt=n.n(Kt),Gt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(t){var n=this;return new Promise((function(r){Ft.openFiles(".csv").then((function(a){var o=[],i=0;a.forEach((function(r){if(r.name.match(/\.csv$/))try{o.push(n.csvToRelation(e.createValidName(r.name.slice(0,-4)),r.text,t))}catch(a){console.log("File "+r.name+" skipped for bad format of csv"),i+=1}else console.log("Unsupported filetype: "+r.name),i+=1})),r({relations:o,skipped:i})}))}))}},{key:"save",value:function(e,t,n){var r=this;if(0!==e.length)if(1!==e.length){var a=zt()();e.forEach((function(e){a.file(e.getName()+".csv",r.relationToCsv(e,n))})),a.generateAsync({type:"blob"}).then((function(e){Object(Ht.saveAs)(e,t+".zip")})).catch((function(e){throw e}))}else{var o=new Blob([this.relationToCsv(e[0],n)],{type:"text/plain;charset=utf-8"});Object(Ht.saveAs)(o,t+".csv")}}},{key:"csvToRelation",value:function(t,n,r){if(null===n||""===n)throw console.log("null or empty string read from file "+t),Error();var a=(n=n.trim().replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ")).split("\n");if(a.length<2)throw console.log("file "+t+" has only one line"),Error();a[0]=a[0].replace(/\s/g,""),a[1]=a[1].replace(/\s/g,"");var o=function(e){for(var t=0;t<e.length;++t){var n=e.charAt(t);if(","===n)return",";if(";"===n)return";"}}(a[1]);void 0===o&&(o=";");var i=a[0].split(o),s=a[1].split(o).map((function(e){var t=e.toLowerCase();return"string"===t||"str"===t||"s"===t?"string":"number"===t||"num"===t||"n"===t?"number":"boolean"})),l=a.slice(2).map((function(t){var n=[];for(t=t.trim();;){var r=e.nextRowInput(t,o);if(n.push(r.input),void 0===r.rest)break;t=r.rest}return n})),u=i.length;if(s.length!==u||l.some((function(e){return e.length!==u})))throw console.log("rows in file "+t+" do not have the same number of columns"),new Error;return new Ut(t,i,s,l,r)}},{key:"createValidName",value:function(e){return""===(e=e.split("").filter((function(e){return j.isNameChar(e)})).join(""))?"relation":e}},{key:"nextRowInput",value:function(e,t){for(var n=!1,r=0,a=0;a<e.length;){var o=e.charAt(a);if(!n&&o===t)return{input:e.slice(0,a),rest:e.slice(a+1)};"\\"===o?++r:r=0,'"'===o&&r%2===0&&(n=!n),++a}return{input:e,rest:void 0}}},{key:"relationToCsv",value:function(e,t){var n=e.getColumnNames().join(t),r=e.getColumnTypes().join(t),a=e.getRows().map((function(e){return e.join(t)}));return[n,r].concat(Object(u.a)(a)).join("\n")}}]),e}(),Xt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.getCurrentRelation=function(){var e=bt(r.props.evaluationTreeRoot,r.state.selectedIndex);if(null===e&&null===(e=bt(r.props.evaluationTreeRoot,0)))return r.props.onUnexpectedError(T.codeError(y.resultSection_getCurrentRelation_nodeIndexNotFound)),null;try{return e.getResult()}catch(t){return r.props.onUnexpectedError(T.codeError(y.resultSection_getCurrentRelation_evalError,t.message)),null}},r.handleSelectedNodeChange=function(e){r.setState({selectedIndex:e})},r.saveResultRelation=function(){if(null!==r.getCurrentRelation()){var e=r.state.relationName;if(""!==e)try{Gt.save([Ut.fromRelation(e,r.getCurrentRelation(),!0)],e,r.props.csvValueSeparator),r.showMessage("Relation saved to file.",!1)}catch(t){r.showMessage("Saving error: "+t,!0)}else r.showMessage("Relation name cannot be empty.",!0)}else r.showError(T.codeError(y.resultSection_saveResultRelation_nullRelationToSave))},r.handleRelationNameChange=function(e){r.setState({relationName:e.target.value.replace(/\t/g,"    ")})},r.handleAddRelation=function(){null!==r.getCurrentRelation()?r.props.onAddResult(r.state.relationName,r.getCurrentRelation(),(function(){return r.showMessage('Relation "'+r.state.relationName+'" was added to definitions.')}),(function(e){return r.showMessage(e,!0)})):r.showError(T.codeError(y.resultSection_handleAddRelation_nullRelationToAdd))},r.showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState({messageText:e,isMessageError:t})},r.showError=function(e){e instanceof E||e instanceof b?r.showMessage(e.message,!0):(r.props.onUnexpectedError(e),r.showMessage("UNEXPECTED ERROR: "+e.message+"\nPlease, report it with your last actions, thank you!",!0))},r.state={sectionClicked:!1,selectedIndex:0,relationName:"ResultRelation",messageText:"",isMessageError:!1},r.sectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.sectionRef.current;null!==t&&t.addEventListener("click",(function(){e.setState({sectionClicked:!0})}),!0),window.addEventListener("click",(function(){e.setState({sectionClicked:!1})}),!0)}},{key:"componentDidUpdate",value:function(e){e.evaluationTreeRoot!==this.props.evaluationTreeRoot&&this.setState({selectedIndex:0})}},{key:"render",value:function(){var e=this;if(null===this.getCurrentRelation())return null;var t=function(t,n,r){return a.a.createElement(P,{text:t,onClick:n,className:e.props.darkTheme?"button-dark":"button-light",tooltip:r,tooltipClassName:"tooltip "+(e.props.darkTheme?"tooltip-dark":"tooltip-light")})},n=bt(this.props.evaluationTreeRoot,this.state.selectedIndex),r=null===n?null:n.getResult().getName(),o=this.props.darkTheme?"section-border-dark":"section-border-light";return this.state.sectionClicked&&(o=this.props.darkTheme?"section-border-dark-clicked":"section-border-light-clicked"),a.a.createElement("section",{ref:this.sectionRef,className:o},a.a.createElement("p",null,a.a.createElement("strong",null,'Evaluation tree of "'+this.props.expressionName+'":')),a.a.createElement(wt,{tree:this.props.evaluationTreeRoot,selected:this.state.selectedIndex,onClick:this.handleSelectedNodeChange,darkTheme:this.props.darkTheme}),a.a.createElement("p",null,a.a.createElement("strong",null,r,":")),a.a.createElement(pt,{relation:this.getCurrentRelation(),darkTheme:this.props.darkTheme}),a.a.createElement("footer",null,a.a.createElement("input",{type:"text",className:this.props.darkTheme?"text-input-dark":"text-input-light",spellCheck:!1,value:this.state.relationName,onChange:this.handleRelationNameChange}),t("Add",this.handleAddRelation,"Adds given relation to stored ones"),t("Save",this.saveResultRelation,"Saves given relation to a file"),a.a.createElement(V,{message:this.state.messageText,darkTheme:this.props.darkTheme,error:this.state.isMessageError})))}}]),n}(a.a.Component),$t=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(){var e=this;return new Promise((function(t){Ft.openFiles(".txt").then((function(n){var r=[],a=0,o=0,i=0;n.forEach((function(t){null===t.text?(console.log("Null read from file "+t.name),i+=1):t.name.match(/\.txt$/)?(t.text=t.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    "),"\n".concat(t.text).split("\n### ").forEach((function(t){try{0!==t.trim().length&&r.push(e.splitExpressionNameAndText(t.trim()))}catch(n){a+=1}})),o+=1):(console.log("Unsupported filetype: "+t.name),i+=1)})),t({expressions:r,skippedExpressions:a,loadedFiles:o,skippedFiles:i})}))}))}},{key:"splitExpressionNameAndText",value:function(e){var t=e.indexOf("\n");if(-1===t)throw console.log("Expression does not contain first name line."),Error();var n=e.slice(0,t).trim();if(!n.endsWith(" ###"))throw console.log("Expression does not contain name between hashes."),Error();return{name:n.slice(0,-4),text:e.slice(t).trim()}}},{key:"save",value:function(e,t){var n=e.map((function(e){return"### "+e.name+" ###\n\n"+e.text})).join("\n\n"),r=new Blob([n],{type:"text/plain;charset=utf-8"});Object(Ht.saveAs)(r,t+".txt")}}]),e}(),Yt=(n(61),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.handleStateChange=function(e){if(r.setState({batchMessage:"",projectMessage:""}),r.state.state===e)return r.setState({state:"hidden"});r.setState({state:e})},r.createBatch=function(){return a.a.createElement("section",null,a.a.createElement("p",null,"Select multiple input files with expressions. The expressions will be evaluated and the reports will be generated. Please be patient, the action freezes the application for couple of seconds. You can see progress in the browser console (F12)."),a.a.createElement("button",{onClick:function(){return r.props.onBatch((function(e){return r.setState({batchMessage:e})}))},className:r.props.darkTheme?"button-dark":"button-light"},"Select files and evaluate"),a.a.createElement("p",null,r.state.batchMessage))},r.createProject=function(){return a.a.createElement("section",null,a.a.createElement("p",null,"Import or export project's data (i.e., stored relations, all expressions and null values support flag)."),a.a.createElement("button",{onClick:function(){return r.props.onImportProject((function(e){return r.setState({projectMessage:e})}))},className:r.props.darkTheme?"button-dark":"button-light"},"Import"),a.a.createElement("button",{onClick:function(){return r.props.onExportProject((function(e){return r.setState({projectMessage:e})}))},className:r.props.darkTheme?"button-dark":"button-light"},"Export"),a.a.createElement("p",null,r.state.projectMessage))},r.createSettings=function(){return a.a.createElement("ul",{style:{listStyleType:"none"}},a.a.createElement("li",null,"Null values:",a.a.createElement("input",{type:"radio",name:"null_values_support",value:"allowed",id:"null_values_support_allowed",checked:r.props.nullValuesSupport,onClick:function(){return r.props.onNullValuesSupportChange(!0)}}),a.a.createElement("label",{htmlFor:"null_values_support_allowed"},"allowed"),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"forbidden",id:"null_values_support_forbid",checked:!r.props.nullValuesSupport,onClick:function(){return r.props.onNullValuesSupportChange(!1)}}),a.a.createElement("label",{htmlFor:"null_values_support_forbid"},"forbidden")),a.a.createElement("li",null,"CSV separator:",a.a.createElement("input",{type:"radio",name:"value_separator",value:"semicolon",id:"value_separator_semi",checked:";"===r.props.csvValueSeparator,onClick:function(){return r.props.onCsvValueSeparatorChange(";")}}),a.a.createElement("label",{htmlFor:"value_separator_semi"},"semicolon"),a.a.createElement("input",{type:"radio",name:"value_separator",value:"comma",id:"value_separator_comma",checked:","===r.props.csvValueSeparator,onClick:function(){return r.props.onCsvValueSeparatorChange(",")}}),a.a.createElement("label",{htmlFor:"value_separator_comma"},"comma")),a.a.createElement("li",null,"Theme:",a.a.createElement("input",{type:"radio",name:"dark_mode",value:"on",id:"dark_mode_on",checked:!r.props.darkTheme,onClick:function(){return r.props.onDarkModeChange(!1)}}),a.a.createElement("label",{htmlFor:"dark_mode_on"},"light"),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"off",id:"dark_mode_off",checked:r.props.darkTheme,onClick:function(){return r.props.onDarkModeChange(!0)}}),a.a.createElement("label",{htmlFor:"dark_mode_off"},"dark")))},r.state={sectionClicked:!1,state:"hidden",batchMessage:"",projectMessage:""},r.sectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.sectionRef.current;null!==t&&t.addEventListener("click",(function(){e.setState({sectionClicked:!0})}),!0),window.addEventListener("click",(function(){e.setState({sectionClicked:!1})}),!0)}},{key:"render",value:function(){var e=this,t=function(t,n){var r=e.props.darkTheme?e.state.state===n?"button-clicked-dark":"button-dark":e.state.state===n?"button-clicked-light":"button-light";return a.a.createElement("button",{onClick:function(){return e.handleStateChange(n)},className:r},t)},n=null;"batch"===this.state.state?n=this.createBatch():"project"===this.state.state?n=this.createProject():"settings"===this.state.state&&(n=this.createSettings());var r=this.props.darkTheme?"section-border-dark":"section-border-light";return this.state.sectionClicked&&(r=this.props.darkTheme?"section-border-dark-clicked":"section-border-light-clicked"),a.a.createElement("header",{ref:this.sectionRef,className:r,style:{paddingTop:"5px",paddingBottom:"5px",marginTop:"5px"}},a.a.createElement("div",null,t("Batch processing","batch"),t("Project","project"),t("Settings","settings"),function(){var t="button-like-link "+(e.props.darkTheme?"button-dark":"button-light");return a.a.createElement("a",{href:"https://github.com/kotliluk/rachel",target:"_blank",rel:"noreferrer",className:t},"About")}()),n)}}]),n}(a.a.Component));function Zt(e){return"object"!==typeof e?"The file cannot be parsed to an object.":"relations"in e&&Array.isArray(e.relations)&&0!==e.relations.length&&!e.relations.some((function(e){return!qt(e)}))?"expressions"in e&&Array.isArray(e.expressions)&&0!==e.expressions.length&&!e.expressions.some((function(e){return!function(e){return"object"===typeof e&&"name"in e&&"string"===typeof e.name&&"text"in e&&"string"===typeof e.text}(e)}))?"nullValuesSupport"in e&&"boolean"===typeof e.nullValuesSupport?"OK":'The file must contain the field "nullValuesSupport: boolean"':'The file must contain the field "expressions: Expression[]" of length at least one':'The file must contain the field "relations: StoredRelationData[]" of length at least one'}var Qt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(){return new Promise((function(e,t){Ft.openFile(".json").then((function(n){if(null===n.text)t("Reading of the content of the file "+n.name+" failed.");else if(n.name.match(/\.json$/)){n.text=n.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");var r=JSON.parse(n.text),a=Zt(r);if("OK"===a)e(r);else t("Invalid structure of the JSON file. "+a)}else t("Please select a JSON file to load a project relation from.")}))}))}},{key:"save",value:function(e,t){var n=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});Object(Ht.saveAs)(n,t+".json")}}]),e}();var en="ENG",tn="false",nn=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"init",value:function(){if(e.storageSupported){var t=localStorage.getItem("csvValueSeparator");";"!==t&&","!==t?(console.log("csvValueSeparator not found in localStorage and set to default"),localStorage.setItem("csvValueSeparator",";"),e.csvValueSeparator=";"):e.csvValueSeparator=localStorage.getItem("csvValueSeparator"),"ENG"!==(n=localStorage.getItem("language"))&&"CZE"!==n?(console.log("language not found in localStorage and set to default"),localStorage.setItem("language",en),e.language=en):e.language=localStorage.getItem("language"),"true"!==localStorage.getItem("darkTheme")&&"false"!==localStorage.getItem("darkTheme")?(console.log("darkTheme not found in localStorage and set to default"),localStorage.setItem("darkTheme",tn),e.darkTheme=tn):e.darkTheme=localStorage.getItem("darkTheme")}else console.warn("LocalStorage not supported in the browser. Default values used."),e.csvValueSeparator=";",e.language=en,e.darkTheme=tn;var n;e.isInit=!0}},{key:"getCsvValueSeparator",value:function(){return e.isInit||e.init(),e.csvValueSeparator}},{key:"setCsvValueSeparator",value:function(t){e.csvValueSeparator=t,e.storageSupported&&localStorage.setItem("csvValueSeparator",t)}},{key:"getLanguage",value:function(){return e.isInit||e.init(),e.language}},{key:"setLanguage",value:function(t){e.language=t,e.storageSupported&&localStorage.setItem("language",t)}},{key:"getDarkMode",value:function(){return e.isInit||e.init(),"true"===e.darkTheme}},{key:"setDarkMode",value:function(t){e.darkTheme=String(t),e.storageSupported&&localStorage.setItem("darkTheme",String(t))}}]),e}();nn.isInit=!1,nn.storageSupported="undefined"!==typeof Storage,nn.csvValueSeparator=void 0,nn.language=void 0,nn.darkTheme=void 0;var rn=function(){function e(){var t=this;Object(c.a)(this,e),this.processFile=function(e){var n=JSON.parse(e.text),r=Zt(n);if("OK"!==r)return{name:e.name.slice(0,-4)+"-eval-report.txt",text:"Invalid JSON file: "+r};var a=t.parseRelations(n.relations,n.nullValuesSupport),o=new ut(a,n.nullValuesSupport),i=n.expressions.length,s=n.expressions.map((function(e){return t.processExpression(e,o)})),l=on.apply(void 0,Object(u.a)(s.map((function(e){return e.counts})))),c=s.reduce((function(e,t){return e+t.error}),0);return{name:e.name.slice(0,-5)+"-eval-report.txt",text:t.reportHeader(i,c,l,n.nullValuesSupport)+t.formatRelations(n.relations)+s.map((function(e){return e.text})).join("")}},this.processExpression=function(e,t){try{var n=t.parse(e.text),r=un(n),a=n.getResult();return{text:"### "+e.name+" ###\n\n"+e.text+"\n\n# Result #\n\n"+a.contentString()+"\n\n",counts:r,error:0}}catch(o){return{text:"### "+e.name+" ###\n\n"+e.text+"\n\n# Error #\n\n"+o.message+"\n\n",counts:an(),error:1}}},this.reportHeader=function(e,t,n,r){var a,o,i=sn(a=n)+ln(a),s=sn(n),l=ln(n);return"Rachel project report from "+(o=new Date,String(o.getDate()).padStart(2,"0")+"."+String(o.getMonth()+1).padStart(2,"0")+"."+String(o.getFullYear())+" "+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+"\n\nExpressions: ")+e+"    Errors: "+t+"\n\nUsed operations ("+i+" in total: "+s+" binary, "+l+" unary):\n    Antijoin: "+n.antijoin+"\n    Cartesian product: "+n.cartesian+"\n    Division: "+n.division+"\n    Natural join: "+n.natural+"\n    Outer Join: "+n.outerJoin+"\n    Projection: "+n.projection+"\n    Rename: "+n.rename+"\n    Selection: "+n.selection+"\n    Semijoin: "+n.semijoin+"\n    Set Operations: "+n.setOperation+"\n    Theta Join: "+n.thetaJoin+"\n    Theta Semijoin: "+n.thetaSemijoin+"\n\n"+(r?"Null values ALLOWED.\n\n":"Null values FORBIDDEN.\n\n")},this.formatRelations=function(e){return"### Defined relations ###\n\n"+e.map((function(e){return"# "+e.name+" #\n"+e.columnNames.join(", ")+"\n"+e.columnTypes.join(", ")+"\n"+e.rows.map((function(e){return e.join(", ")})).join("\n")+"\n\n"})).join("")}}return Object(h.a)(e,[{key:"process",value:function(e){var t=this;return new Promise((function(n,r){Ft.openFiles(".json").then((function(a){console.log(a.length+" files loaded to BatchProcessor"),console.time("Batch duration");var o=[],i=0,s=0;a.forEach((function(e){null===e.text?(console.log("null read from "+e.name),s+=1):e.name.match(/\.json$/)?(o.push(t.processFile(e)),i+=1):(console.log("Unsupported filetype: "+e.name),s+=1),console.log("Batch in progress... "+(i+s)+"/"+a.length)})),console.timeEnd("Batch duration"),0===o.length&&n("Batch finished: "+i+" files processed, "+s+" skipped.");var l=zt()();o.forEach((function(e){l.file(e.name,e.text)})),l.generateAsync({type:"blob"}).then((function(t){Object(Ht.saveAs)(t,e+".zip"),console.log("Batch finished: "+i+" files processed, "+s+" skipped."),n("Batch finished: "+i+" files processed, "+s+" skipped.")})).catch((function(e){r("Results saving error: "+e.message)}))}))}))}},{key:"parseRelations",value:function(e,t){var n=new Map;return e.forEach((function(e){try{var r=Ut.fromData(e,t);r.isValid()&&n.set(r.getName(),r.createRelation())}catch(a){console.log("Definition of relation "+e.name+" has errors, skipping.")}})),n}}]),e}();function an(){return on()}function on(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{antijoin:t.reduce((function(e,t){return e+t.antijoin}),0),cartesian:t.reduce((function(e,t){return e+t.cartesian}),0),division:t.reduce((function(e,t){return e+t.division}),0),natural:t.reduce((function(e,t){return e+t.natural}),0),outerJoin:t.reduce((function(e,t){return e+t.outerJoin}),0),projection:t.reduce((function(e,t){return e+t.projection}),0),rename:t.reduce((function(e,t){return e+t.rename}),0),selection:t.reduce((function(e,t){return e+t.selection}),0),semijoin:t.reduce((function(e,t){return e+t.semijoin}),0),setOperation:t.reduce((function(e,t){return e+t.setOperation}),0),thetaJoin:t.reduce((function(e,t){return e+t.thetaJoin}),0),thetaSemijoin:t.reduce((function(e,t){return e+t.thetaSemijoin}),0)}}function sn(e){return e.antijoin+e.cartesian+e.division+e.natural+e.outerJoin+e.semijoin+e.setOperation+e.thetaJoin+e.thetaSemijoin}function ln(e){return e.projection+e.rename+e.selection}function un(e){return e instanceof pe?on(function(e){var t=an();if(e instanceof ye)return t.projection=1,t;if(e instanceof be)return t.rename=1,t;if(e instanceof ze)return t.selection=1,t;return t}(e),un(e.getSubtree())):e instanceof Ge?on(function(e){var t=an();if(e instanceof $e)return t.antijoin=1,t;if(e instanceof Ye)return t.cartesian=1,t;if(e instanceof Qe)return t.division=1,t;if(e instanceof tt)return t.outerJoin=1,t;if(e instanceof rt)return e.getType()===et.natural?t.natural=1:t.semijoin=1,t;if(e instanceof ot)return t.setOperation=1,t;if(e instanceof st)return e.getType()===at.full?t.thetaJoin=1:t.thetaSemijoin=1,t;return t}(e),un(e.getLeftSubtree()),un(e.getRightSubtree())):an()}n(62),n(63);var cn=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).containerRef=void 0,r.deleteButtonRef=void 0,r.getErrors=function(){return r.props.relation.getErrors()},r.setSelectedInput=function(e,t){r.props.editable&&r.setState({selectedColumn:e,selectedRow:t})},r.moveSelectedInputRight=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e<r.props.relation.getColumnCount()-1&&r.setState({selectedColumn:e+1})},r.moveSelectedInputLeft=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e>0&&r.setState({selectedColumn:e-1})},r.moveSelectedInputUp=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&"number"===typeof t&&(0===t?r.setState({selectedRow:"names"}):r.setState({selectedRow:t-1}))},r.moveSelectedInputDown=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&("names"===t&&r.props.relation.getRowCount()>0&&r.setState({selectedRow:0}),"number"===typeof t&&t<r.props.relation.getRowCount()-1&&r.setState({selectedRow:t+1}))},r.handleRightClick=function(e,t,n){if(r.props.editable){var a=r.deleteButtonRef.current;"names"!==n&&"types"!==n||void 0===t?"number"===typeof n&&(a.onclick=function(e){return r.handleDeleteRow(e,n)},a.innerText="Delete row "+(n+1),a.style.top=e.clientY+"px",a.style.left=e.clientX-r.containerRef.current.getBoundingClientRect().left+"px",a.style.visibility="visible"):(a.onclick=function(e){return r.handleDeleteColumn(e,t)},a.innerText="Delete column "+r.props.relation.getColumnNames()[t],a.style.top=e.clientY+"px",a.style.left=e.clientX-r.containerRef.current.getBoundingClientRect().left+"px",a.style.visibility="visible"),e.preventDefault()}},r.handleKeyDown=function(e){"Enter"===e.key?r.setSelectedInput(void 0,void 0):"Tab"===e.key||e.ctrlKey&&"ArrowRight"===e.key?(r.moveSelectedInputRight(),e.preventDefault()):e.ctrlKey&&"ArrowLeft"===e.key?(r.moveSelectedInputLeft(),e.preventDefault()):e.ctrlKey&&"ArrowUp"===e.key?(r.moveSelectedInputUp(),e.preventDefault()):e.ctrlKey&&"ArrowDown"===e.key&&(r.moveSelectedInputDown(),e.preventDefault())},r.handleChange=function(e,t,n){e=e.replace(/\t/g,"    "),"names"===n?r.props.onColumnNameChange(e,t):"types"===n?r.props.onColumnTypeChange(e,t):r.props.onRowInputChange(e,t,n)},r.handleNewColumn=function(){r.props.onNewColumn((function(){r.containerRef.current.scrollTo(r.containerRef.current.clientWidth,r.containerRef.current.scrollTop)}))},r.handleNewRow=function(){r.props.onNewRow((function(){r.containerRef.current.scrollTo(r.containerRef.current.scrollLeft,r.containerRef.current.clientHeight)}))},r.handleDeleteColumn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=r.deleteButtonRef.current;n?(r.props.onDeleteColumn(t),a.style.visibility="hidden"):(a.onclick=function(e){return r.handleDeleteColumn(e,t,!0)},a.innerText="Really delete this column?"),e.stopPropagation(),e.preventDefault()},r.handleDeleteRow=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=r.deleteButtonRef.current;n?(r.props.onDeleteRow(t),a.style.visibility="hidden"):(a.onclick=function(e){return r.handleDeleteRow(e,t,!0)},a.innerText="Really delete this row?"),e.stopPropagation(),e.preventDefault()},r.state={selectedColumn:void 0,selectedRow:void 0},r.containerRef=a.a.createRef(),r.deleteButtonRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(){null!==e.deleteButtonRef.current&&(e.deleteButtonRef.current.style.visibility="hidden")})),window.addEventListener("keydown",(function(t){"Escape"!==t.key&&"Esc"!==t.key||(null!==e.deleteButtonRef.current&&(e.deleteButtonRef.current.style.visibility="hidden"),e.setSelectedInput(void 0,void 0))}))}},{key:"createInput",value:function(e,t,n){var r=this;return a.a.createElement("input",{type:"text",className:this.props.darkTheme?"text-input-dark":"text-input-light",spellCheck:!1,value:e,onChange:function(e){return r.handleChange(e.target.value,t,n)},autoFocus:!0})}},{key:"createTooltip",value:function(e,t){return a.a.createElement("span",{className:"tooltip "+(this.props.darkTheme?"tooltip-dark":"tooltip-light"),style:t},e)}},{key:"createNamesRow",value:function(){var e=this,t=this.props.relation.getColumnNames().map((function(t,n){var r=t;e.state.selectedColumn===n&&"names"===e.state.selectedRow&&e.props.editable&&(r=e.createInput(t,n,"names"));var o=null,i="name-th",s=e.getErrors().get("name",n);return void 0!==s&&(o=e.createTooltip(s,{top:"120%",bottom:"auto"}),i+=" error-input"),a.a.createElement("th",{key:n,className:i,onClick:function(){return e.setSelectedInput(n,"names")},onContextMenu:function(t){return e.handleRightClick(t,n,"names")}},r,o)}));return this.props.editable&&t.push(a.a.createElement("td",{key:"add-column-column",style:{width:"20px",border:"none"}})),a.a.createElement("tr",null,t)}},{key:"createTypesRow",value:function(){var e=this,t=this.props.relation.getColumnTypes().map((function(t,n){var r=e.props.editable?a.a.createElement("select",{value:t,onChange:function(t){return e.handleChange(t.target.value,n,"types")}},a.a.createElement("option",null,"number"),a.a.createElement("option",null,"string"),a.a.createElement("option",null,"boolean")):t;return a.a.createElement("th",{key:n,className:"type-th",onContextMenu:function(t){return e.handleRightClick(t,n,"types")}},r)}));return this.props.editable&&t.push(a.a.createElement("td",{key:"add-column",rowSpan:this.props.relation.getRowCount()+1,style:{width:"20px",border:"none",padding:"1px"}},a.a.createElement("button",{onClick:this.handleNewColumn,className:this.props.darkTheme?"button-dark":"button-light",style:{width:"100%",height:"100%"}},a.a.createElement("strong",null,"+")))),a.a.createElement("tr",null,t)}},{key:"createRows",value:function(){var e=this;return 0===this.props.relation.getRows().length?null:this.props.relation.getRows().map((function(t,n){return a.a.createElement("tr",{key:n,onContextMenu:function(t){return e.handleRightClick(t,void 0,n)}},t.map((function(t,r){var o=t;e.state.selectedColumn===r&&e.state.selectedRow===n&&e.props.editable&&(o=e.createInput(t,r,n));var i=null,s="",l=e.getErrors().get(n,r);return void 0!==l&&(i=e.createTooltip(l),s="error-input"),a.a.createElement("td",{key:r,className:s,onClick:function(){return e.setSelectedInput(r,n)}},o,i)})))}))}},{key:"createAddRow",value:function(){return a.a.createElement("tr",{key:"add-row"},a.a.createElement("td",{key:"add-row-column",colSpan:this.props.relation.getColumnCount(),style:{border:"none",padding:"2px"}},a.a.createElement("button",{onClick:this.handleNewRow,className:this.props.darkTheme?"button-dark":"button-light",style:{width:"100%",height:"100%"}},a.a.createElement("strong",null,"+"))))}},{key:"render",value:function(){var e=this,t=this.createNamesRow(),n=this.createTypesRow(),r=this.createRows(),o=this.props.editable?this.createAddRow():null,i="edit-table-container edit-table-container-light cursor-container-light",s="edit-table edit-table-light",l="table-right-click-menu button-light";return this.props.darkTheme&&(i="edit-table-container edit-table-container-dark cursor-container-dark",s="edit-table edit-table-dark",l="table-right-click-menu button-dark"),a.a.createElement("div",{className:i,ref:this.containerRef,onKeyDown:this.handleKeyDown},a.a.createElement("button",{className:l,ref:this.deleteButtonRef}),a.a.createElement("table",{className:s,onBlur:function(){return e.setSelectedInput(void 0,void 0)}},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,n,r,o)))}}]),n}(a.a.Component),hn=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.isShowingStored=function(){return"stored"===r.state.contentToShow},r.getCurRel=function(){if(r.isShowingStored())return r.props.storedRelations[r.props.storedRelationIndex];var e=Object(u.a)(r.props.loadedRelations.values())[r.state.loadedRelationIndex];return Ut.fromRelation(e.name,e,r.props.nullValuesSupport)},r.changeContentToShow=function(){r.isShowingStored()?0===r.props.loadedRelations.length?r.showMessage("No relations loaded in the application at the moment."):r.setState({contentToShow:"loaded",loadedRelationIndex:0}):r.setState({contentToShow:"stored"})},r.handleRelationNameChange=function(e){r.props.onRelationNameChange(e)},r.loadRelation=function(){r.getCurRel().isValid()?r.props.onLoadRelation(r.showMessage):r.showMessage("Cannot use the invalid relation. Check errors and try again.",!0)},r.loadAllRelations=function(){r.props.onLoadAllRelations(r.showMessage)},r.exportRelations=function(){r.props.onExportRelations(r.showMessage)},r.importRelations=function(){r.props.onImportRelations(r.showMessage)},r.deleteRelation=function(){if(r.isShowingStored())r.props.onDeleteStoredRelation();else{var e=r.props.loadedRelations[r.state.loadedRelationIndex].getName(),t={};r.props.loadedRelations.length<=1?t={contentToShow:"stored"}:r.state.loadedRelationIndex===r.props.loadedRelations.length-1&&(t={loadedRelationIndex:r.state.loadedRelationIndex-1}),r.setState(t,(function(){return r.props.onDeleteLoadedRelation(e,r.showMessage)}))}},r.newRelation=function(){r.props.onNewRelation()},r.deleteAllLoadedRelations=function(){r.setState({contentToShow:"stored"},(function(){return r.props.onDeleteLoadedRelation(!1,r.showMessage)}))},r.showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState({messageText:e,isMessageError:t})},r.createRelationMenuButtons=function(){return r.isShowingStored()?r.props.storedRelations.map((function(e,t){var n=r.props.darkTheme?r.props.storedRelationIndex===t?"button-clicked-dark":"button-dark":r.props.storedRelationIndex===t?"button-clicked-light":"button-light",o=e.isActual()?"":" *",i=e.isActual()?" (loaded)":" (NOT loaded)",s=96/r.props.storedRelations.length+"%",l=e.isValid()?{width:s}:{width:s,border:"2px solid red"};return a.a.createElement(P,{key:t,text:e.getName()+o,onClick:function(){return r.handleSelectDifferentRelation(t)},className:n,style:l,tooltip:e.getName()+i,tooltipClassName:"tooltip "+(r.props.darkTheme?"tooltip-dark":"tooltip-light")})})):r.props.loadedRelations.map((function(e,t){var n=r.props.darkTheme?r.state.loadedRelationIndex===t?"button-clicked-dark":"button-dark":r.state.loadedRelationIndex===t?"button-clicked-light":"button-light";return a.a.createElement(P,{key:t,text:e.getName(),onClick:function(){return r.handleSelectDifferentRelation(t)},className:n,style:{width:96/r.props.loadedRelations.length+"%"},tooltip:e.getName()+" (current version loaded)",tooltipClassName:"tooltip "+(r.props.darkTheme?"tooltip-dark":"tooltip-light")})}))},r.state={sectionClicked:!1,contentToShow:"stored",loadedRelationIndex:0,messageText:"",isMessageError:!1},r.sectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.sectionRef.current;null!==t&&t.addEventListener("click",(function(){e.setState({sectionClicked:!0})}),!0),window.addEventListener("click",(function(){e.setState({sectionClicked:!1})}),!0),window.addEventListener("keydown",(function(t){e.state.sectionClicked&&t.ctrlKey&&("Enter"===t.key&&e.isShowingStored()?(e.loadRelation(),t.preventDefault()):t.shiftKey&&"a"===t.key.toLowerCase()&&e.isShowingStored()?(e.newRelation(),t.preventDefault()):t.shiftKey&&"d"===t.key.toLowerCase()&&(e.deleteRelation(),t.preventDefault()))}))}},{key:"handleSelectDifferentRelation",value:function(e){this.isShowingStored()?(this.props.onSelectDifferentRelation(e),this.showMessage("")):this.setState({loadedRelationIndex:e})}},{key:"render",value:function(){var e=this,t=function(t,n,r,o){return a.a.createElement(P,{key:t,text:t,onClick:n,className:e.props.darkTheme?"button-dark":"button-light",style:o,tooltip:r,tooltipClassName:"tooltip "+(e.props.darkTheme?"tooltip-dark":"tooltip-light")})},n=this.props.storedRelations.filter((function(t,n){return n!==e.props.storedRelationIndex})).map((function(e){return e.getName()}));n.push.apply(n,Object(u.a)(ge));var r="relation-section ";return this.state.sectionClicked?r+=this.props.darkTheme?"section-border-dark-clicked":"section-border-light-clicked":r+=this.props.darkTheme?"section-border-dark":"section-border-light",a.a.createElement("section",{ref:this.sectionRef,className:r},a.a.createElement("div",{className:"relations-names-menu"},this.createRelationMenuButtons()),a.a.createElement(cn,{relation:this.getCurRel(),editable:this.isShowingStored(),onColumnNameChange:this.props.onColumnNameChange,onColumnTypeChange:this.props.onColumnTypeChange,onRowInputChange:this.props.onRowInputChange,onNewRow:this.props.onNewRow,onNewColumn:this.props.onNewColumn,onDeleteRow:this.props.onDeleteRow,onDeleteColumn:this.props.onDeleteColumn,darkTheme:this.props.darkTheme}),a.a.createElement("div",{className:"relations-management-menu"},a.a.createElement("div",{className:"relations-management-menu-left"},a.a.createElement(ct,{label:"",value:this.getCurRel().getName(),buttonText:"Rename",onSubmit:this.handleRelationNameChange,forbidden:function(e){return n.indexOf(e)>-1||!j.isName(e)},id:"relation-name-input",darkTheme:this.props.darkTheme,style:this.isShowingStored()?{}:{visibility:"hidden"}})),a.a.createElement("div",{className:"relations-management-menu-right"},t("Load",this.loadRelation,"Loads the relation into the application",this.isShowingStored()?void 0:{visibility:"hidden"}),t("Load all",this.loadAllRelations,"Loads all valid relations into the application",this.isShowingStored()?{marginRight:"20px"}:{visibility:"hidden"}),t("New",this.newRelation,"Creates a new relation",this.isShowingStored()?{}:{visibility:"hidden"}),t("Delete",this.deleteRelation,this.isShowingStored()?"Deletes current selected stored relation":"Deletes current selected loaded relation",{marginRight:"20px"}),t(this.isShowingStored()?"Show loaded":"Show stored",this.changeContentToShow,this.isShowingStored()?"Shows relations currently loaded in the application":"Shows relations currently stored for editing"),t("Delete loaded",this.deleteAllLoadedRelations,"Deletes relations loaded in the application",{marginRight:"20px"}),t("Import",this.importRelations,"Adds new relations from files"),t("Export",this.exportRelations,"Saves stored relations to files"))),a.a.createElement(V,{message:this.state.messageText,darkTheme:this.props.darkTheme,error:this.state.isMessageError}),a.a.createElement("div",{style:{clear:"both"}}))}}]),n}(a.a.Component),pn=function(){function e(t){Object(c.a)(this,e),this.accessToken=t}return Object(h.a)(e,[{key:"send",value:function(t,n){var r={access_token:this.accessToken,subject:t,text:n},a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status||4===a.readyState&&console.log("failed creating XMLHttpRequest in PostMail.send: "+a.response)};var o=e.toParams(r);a.open("POST","https://postmail.invotes.com/send",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(o)}}],[{key:"toParams",value:function(e){return encodeURIComponent("access_token")+"="+encodeURIComponent(e.access_token)+"&"+encodeURIComponent("subject")+"="+encodeURIComponent(e.subject)+"&"+encodeURIComponent("text")+"="+encodeURIComponent(e.text)}}]),e}(),dn=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).expressionSectionRef=void 0,r.reportUnexpectedError=function(e){var t,n=new pn("5uog26ex8q9qu7sqib8ea0qd"),a="Unexpected error "+e.name+" in Rachel application.\n\nMessage:\n"+e.message+"\n\nDate:\n"+(new Date).toString()+"\n\nStack trace:\n"+e.stack+"\n\nLoaded relations: ----------------------------\n"+Object(u.a)(r.state.loadedRelations.values()).map((function(e){return e.getName()+"\n"+e.contentString()})).join("\n\n")+"\n\nStored relations: ----------------------------\nSelected relation (1-index): "+(r.state.selectedRelation+1)+"\n\n"+r.state.storedRelations.map((function(e){return e.getName()+"\n"+e.getColumnNames().join(", ")+"\n"+e.getColumnTypes().join(", ")+"\n"+e.getRows().map((function(e){return e.join(", ")})).join("\n")})).join("\n\n")+"\n\nExpressions: ----------------------------\nSelected expression (1-index): "+(r.state.selectedExpression+1)+"\n\n"+r.state.expressions.map((function(e){return e.text})).join("\n\n###\n\n")+"\n\nEvaluation tree:\n"+(null===(t=r.state.evaluationTreeRoot)||void 0===t?void 0:t.printInLine())+"\n\nOther state: ----------------------------\ncsvValueSeparator: "+r.state.csvValueSeparator+"\nlanguage:          "+r.state.language+"\nnullValuesSupport: "+r.state.nullValuesSupport+"\ndarkTheme:         "+r.state.darkTheme;n.send("Rachel application unexpected error",a),console.error("Unexpected error: "+e.stack)},r.handleBatch=function(e){(new rn).process("rachel-eval-results").then(e).catch(e)},r.handleImportProject=function(e){Qt.load().then((function(t){r.setState({loadedRelations:new Map,storedRelations:t.relations.map((function(e){return Ut.fromData(e,t.nullValuesSupport)})),expressions:t.expressions,nullValuesSupport:t.nullValuesSupport,selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:""},(function(){e("Project loaded."),r.updateExpressionsErrors()}))})).catch(e)},r.handleExportProject=function(e){try{Qt.save({relations:r.state.storedRelations.map((function(e){return e.toDataObject()})),expressions:r.state.expressions,nullValuesSupport:r.state.nullValuesSupport},"rachel_project"),e("Project saved.")}catch(t){e("Project saving failed: "+t.message)}},r.handleNullValuesSupportChange=function(e){r.state.storedRelations.forEach((function(t){return t.setNullValuesSupport(e)})),r.setState({nullValuesSupport:e},r.updateExpressionsErrors)},r.handleCsvValueSeparatorChange=function(e){nn.setCsvValueSeparator(e),r.setState({csvValueSeparator:e})},r.handleLanguageChange=function(e){nn.setLanguage(e),r.setState({language:e})},r.handleDarkModeChange=function(e){nn.setDarkMode(e),r.setState({darkTheme:e}),document.body.classList.toggle("body-dark",e),document.body.classList.toggle("cursor-container-dark",e),document.body.classList.toggle("body-light",!e),document.body.classList.toggle("cursor-container-light",!e)},r.handleRelationNameChange=function(e){r.setState((function(t){var n=t.storedRelations;return n[r.state.selectedRelation].setName(e),{storedRelations:n}}))},r.handleRelationColumnNameChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnName(e,t),{storedRelations:a}}))},r.handleRelationColumnTypeChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnType(e,t),{storedRelations:a}}))},r.handleRelationRowInputChange=function(e,t,n){r.setState((function(a){var o=a.storedRelations;return o[r.state.selectedRelation].setRowInput(e,n,t),{storedRelations:o}}))},r.handleRelationNewRow=function(e){r.state.storedRelations[r.state.selectedRelation].addNewRow(),r.setState({},e)},r.handleRelationNewColumn=function(e){r.state.storedRelations[r.state.selectedRelation].addNewColumn(),r.setState({},e)},r.handleRelationDeleteRow=function(e){r.state.storedRelations[r.state.selectedRelation].deleteRow(e),r.setState({})},r.handleRelationDeleteColumn=function(e){r.state.storedRelations[r.state.selectedRelation].deleteColumn(e),r.setState({})},r.handleSelectDifferentRelation=function(e){r.setState({selectedRelation:e})},r.handleCreateNewRelation=function(){for(var e=r.state.selectedRelation+1,t="NewRelation",n=1;;++n)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t+n)){t+=n;break}r.state.storedRelations.splice(e,0,Ut.new(t,r.state.nullValuesSupport)),r.setState({selectedRelation:e})},r.handleDeleteRelation=function(){if(1!==r.state.storedRelations.length){var e=r.state.selectedRelation;r.state.storedRelations.splice(e,1),e===r.state.storedRelations.length?r.setState({selectedRelation:e-1},r.updateExpressionsErrors):r.setState({},r.updateExpressionsErrors)}else r.setState({storedRelations:[Ut.new("Relation",r.state.nullValuesSupport)]})},r.handleDeleteLoadedRelation=function(e,t){!1===e?(r.state.loadedRelations.clear(),r.state.storedRelations.forEach((function(e){return e.setActual(!1)})),t("All loaded relations deleted.")):(r.state.loadedRelations.delete(e),r.state.storedRelations.filter((function(t){return t.getName()===e})).forEach((function(e){return e.setActual(!1)})),t('Relation "'+e+'" deleted from loaded relations.')),r.setState({},r.updateExpressionsErrors)},r.handleExportRelations=function(e){try{Gt.save(r.state.storedRelations,"rachel_relations",r.state.csvValueSeparator),e(r.state.storedRelations.length+" relations saved.")}catch(t){e("Saving error: "+t)}},r.handleImportRelations=function(e){Gt.load(r.state.nullValuesSupport).then((function(t){var n=r.state.storedRelations.length;t.relations.forEach((function(e){var t=e.getName();if(r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t)>-1)for(var n=2;;++n)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t+n)){e.setName(t+n);break}r.state.storedRelations.push(e)})),t.relations.length>0&&r.setState({selectedRelation:n}),e(t.relations.length+" relations loaded, "+t.skipped+" files skipped.")}))},r.handleLoadRelation=function(e){var t=r.state.storedRelations[r.state.selectedRelation];t.setActual(!0),r.state.loadedRelations.set(t.getName(),t.createRelation()),e("Relation loaded to application.\nAll current loaded relations ("+r.state.loadedRelations.size+"): "+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+"."),r.setState({},r.updateExpressionsErrors)},r.handleLoadAllRelations=function(e){var t=0,n=0;r.state.storedRelations.forEach((function(e){e.isValid()?(e.setActual(!0),r.state.loadedRelations.set(e.getName(),e.createRelation()),++t):++n})),e(t+" relations loaded to application, "+n+" skipped.\nAll current loaded relations ("+r.state.loadedRelations.size+"): "+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+"."),r.setState({},r.updateExpressionsErrors)},r.updateExpressionsErrors=function(){var e=r.expressionSectionRef.current;null!==e&&e.updateErrors()},r.handleExprEval=function(e){r.setState({evaluationTreeRoot:e,evaluatedExpressionName:r.state.expressions[r.state.selectedExpression].name})},r.handleExprTextChange=function(e,t){r.setState((function(n){var r=n.expressions;return r[n.selectedExpression]={name:e,text:t},{expressions:r}}))},r.handleSelectDifferentExpression=function(e){r.setState({selectedExpression:e},r.updateExpressionsErrors)},r.handleCreateNewExpression=function(){var e=r.state.selectedExpression+1;r.state.expressions.splice(e,0,{name:"New expression",text:""}),r.setState({selectedExpression:e})},r.handleDeleteExpression=function(e){if(1===r.state.expressions.length)return r.handleExprTextChange("Expression 1","");var t=r.state.selectedExpression;r.state.expressions.splice(t,1),t===r.state.expressions.length?r.setState({selectedExpression:t-1},e):r.setState({},e)},r.handleExportExpressions=function(e){try{$t.save(r.state.expressions,"rachel_expressions"),e("Expressions saved in a textual file.")}catch(t){e("Expressions saving failed: "+t.message)}},r.handleImportExpressions=function(e){$t.load().then((function(t){var n;(n=r.state.expressions).push.apply(n,Object(u.a)(t.expressions)),r.setState({}),e(t.expressions.length+" expressions loaded from "+t.loadedFiles+" files ("+ +t.skippedExpressions+" expressions skipped, "+t.skippedFiles+" files skipped).")}))},r.addResultRelation=function(e,t,n,a){return""===e?a("Relation name cannot be empty."):j.isName(e)?r.state.storedRelations.map((function(e){return e.getName()})).indexOf(e)>-1?a('Name "'+e+'" is already used.'):(r.state.storedRelations.push(Ut.fromRelation(e,t,r.state.nullValuesSupport)),r.setState({selectedRelation:r.state.storedRelations.length-1}),void n()):a('"'+e+'" is not a valid name.')};var o=Ut.fromData({name:"Car",columnNames:["Id","Owner","Color","Electric"],columnTypes:["number","number","string","boolean"],rows:[["1","1",'"Blue"',"true"],["2","1",'"Green"',"false"],["3","2",'"Blue"',"false"],["4","3",'"Black"',"true"]],columnCount:4,rowCount:4},!0),i=Ut.fromData({name:"Owner",columnNames:["Id","Name"],columnTypes:["number","string"],rows:[["1",'"Luk\xe1\u0161 Kotl\xedk"'],["2",'"Karel IV."'],["3",'"Eminem"']],columnCount:2,rowCount:3},!0);return r.state={loadedRelations:new Map,storedRelations:[o,i],selectedRelation:0,expressions:[{name:"Expression 1",text:"Car"},{name:"Expression 2",text:"Car*Owner"},{name:"Expression 3",text:"Owner(Id = 1)"}],selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:"",nullValuesSupport:!0,csvValueSeparator:nn.getCsvValueSeparator(),language:nn.getLanguage(),darkTheme:nn.getDarkMode()},r.expressionSectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"render",value:function(){var e=null;return null!==this.state.evaluationTreeRoot&&(e=a.a.createElement(Xt,{evaluationTreeRoot:this.state.evaluationTreeRoot,expressionName:this.state.evaluatedExpressionName,onAddResult:this.addResultRelation,onUnexpectedError:this.reportUnexpectedError,csvValueSeparator:this.state.csvValueSeparator,darkTheme:this.state.darkTheme})),a.a.createElement("div",null,a.a.createElement("main",null,a.a.createElement(Yt,{onBatch:this.handleBatch,onImportProject:this.handleImportProject,onExportProject:this.handleExportProject,csvValueSeparator:this.state.csvValueSeparator,language:this.state.language,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,onCsvValueSeparatorChange:this.handleCsvValueSeparatorChange,onLanguageChange:this.handleLanguageChange,onNullValuesSupportChange:this.handleNullValuesSupportChange,onDarkModeChange:this.handleDarkModeChange}),a.a.createElement("div",null,a.a.createElement(hn,{storedRelations:this.state.storedRelations,storedRelationIndex:this.state.selectedRelation,loadedRelations:Object(u.a)(this.state.loadedRelations.values()),onRelationNameChange:this.handleRelationNameChange,onColumnNameChange:this.handleRelationColumnNameChange,onColumnTypeChange:this.handleRelationColumnTypeChange,onRowInputChange:this.handleRelationRowInputChange,onNewRow:this.handleRelationNewRow,onNewColumn:this.handleRelationNewColumn,onDeleteRow:this.handleRelationDeleteRow,onDeleteColumn:this.handleRelationDeleteColumn,onLoadRelation:this.handleLoadRelation,onLoadAllRelations:this.handleLoadAllRelations,onSelectDifferentRelation:this.handleSelectDifferentRelation,onNewRelation:this.handleCreateNewRelation,onDeleteStoredRelation:this.handleDeleteRelation,onDeleteLoadedRelation:this.handleDeleteLoadedRelation,onExportRelations:this.handleExportRelations,onImportRelations:this.handleImportRelations,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme}),a.a.createElement(ht,{ref:this.expressionSectionRef,expressions:this.state.expressions,currentExpressionIndex:this.state.selectedExpression,relations:this.state.loadedRelations,onChange:this.handleExprTextChange,onEval:this.handleExprEval,onSelectDifferentExpression:this.handleSelectDifferentExpression,onNewExpression:this.handleCreateNewExpression,onDeleteExpression:this.handleDeleteExpression,onExportExpressions:this.handleExportExpressions,onImportExpressions:this.handleImportExpressions,onUnexpectedError:this.reportUnexpectedError,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme})),e))}}]),n}(r.Component);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(dn,null)),document.getElementById("root")),document.body.classList.toggle("body-dark",nn.getDarkMode()),document.body.classList.toggle("body-light",!nn.getDarkMode()),document.body.classList.toggle("cursor-container-dark",nn.getDarkMode()),document.body.classList.toggle("cursor-container-light",!nn.getDarkMode()),function(e){if("serviceWorker"in navigator){if(new URL("/rachel",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rachel","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}()}},[[64,1,2]]]);
//# sourceMappingURL=main.957f2adc.chunk.js.map