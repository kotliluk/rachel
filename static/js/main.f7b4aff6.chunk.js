/*! For license information please see main.f7b4aff6.chunk.js.LICENSE.txt */
(this.webpackJsonprachel=this.webpackJsonprachel||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(24),i=n.n(o),s=(n(35),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(3),c=n(1),h=n(2),p=n(4),f=n(5),d=n(16),m=(n(36),function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:this.props.className,onClick:this.props.onClick,style:this.props.style},this.props.text,a.a.createElement("span",{className:this.props.tooltipClassName,style:this.props.tooltipStyle},this.props.tooltip))}}]),n}(a.a.Component)),v=n(10),g=n(19),y=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).range=r,a}return n}(Object(g.a)(Error));function b(e,t){return e instanceof y&&void 0===e.range&&(e.range=t),e}var x=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,"Syntax error: "+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(a),n),a.name="RASyntaxError",a}return n}(y),E=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,"Semantic error: "+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(a),n),a.name="RASemanticError",a}return n}(y);n(37);function k(e,t){var n="0123456789qwertyuiopasdfghjkllzxcvbnmQWERTYUIOOPASDFGHJKLLZXCVBNM!@#$%^&*()_+[];',./",r=document.createElement("div");r.setAttribute("style","font-family: ".concat(e,"; font-size: ").concat(t,"; position: absolute; white-space: nowrap;")),r.innerText=n,document.documentElement.appendChild(r);var a=r.clientWidth,o=r.clientHeight;return r.remove(),{fontWidth:a/n.length,fontHeight:o}}function _(e,t){for(var n=e.slice(0,t),r=n.length-1;;){if(!n.charAt(r).match(/\w/)){++r;break}if(0===r)break;--r}return r}var w=getComputedStyle(document.querySelector(":root")),R=w.getPropertyValue("--x-textarea-font-size"),S=w.getPropertyValue("--x-textarea-font-family"),N=k(S,R).fontWidth,C=Number(w.getPropertyValue("--x-textarea-line-height")),T=w.getPropertyValue("--light-color-b"),O=w.getPropertyValue("--dark-color-b"),j=w.getPropertyValue("--text-color-light"),V=w.getPropertyValue("--text-color-dark"),P=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).reactDiv=a.a.createRef(),e.textarea=void 0,e}return Object(h.a)(n,[{key:"getSelection",value:function(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}}},{key:"setSelection",value:function(e,t){this.textarea.setSelectionRange(e,t||e)}},{key:"isFocused",value:function(){return null!==document.activeElement&&document.activeElement.id===this.props.id+"-ta"}},{key:"focus",value:function(){this.textarea.focus()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=document.getElementById(t.id),r=document.createElement("table");r.setAttribute("cellspacing","0"),r.setAttribute("cellpadding","0"),r.classList.add("x-textarea-table");var a=document.createElement("tr"),o=document.createElement("td");o.setAttribute("id",t.id+"-td1"),o.classList.add("x-textarea-table-td1");var i=document.createElement("td");i.classList.add("x-textarea-table-td2"),a.appendChild(o),a.appendChild(i),r.appendChild(a);var s=document.createElement("textarea");s.setAttribute("id",t.id+"-ta"),s.setAttribute("spellcheck","false"),s.mouseIsDown=!1,s.setAttribute("placeholder",this.props.placeholder),s.classList.add("x-textarea","cursor-container"),s.value=t.text;var l=document.createElement("canvas");l.width=28,l.classList.add("x-textarea-canvas"),s.canvasLines=l,o.appendChild(l),i.appendChild(s),n.appendChild(r);var u=document.createElement("div");u.classList.add("whisper-div"),u.isShown=!1,u.selectedIndex=-1,u.changeSelected=function(e){this.setSelected(this.selectedIndex+e)},u.setSelected=function(e){var t,n;this.childElementCount>0&&(this.selectedIndex>-1&&this.selectedIndex<this.childElementCount&&this.children[this.selectedIndex].classList.remove("selected-whisper"),this.selectedIndex=(t=e,n=this.childElementCount,(t%n+n)%n),this.children[this.selectedIndex].classList.add("selected-whisper"))},u.getSelectedWhisper=function(){if(this.selectedIndex>-1&&this.childElementCount>0)return this.children[this.selectedIndex].innerText},s.whisperDiv=u,i.appendChild(u),s.paintLineNumbers=function(e){try{var t=this.canvasLines;t.height!==this.clientHeight&&(t.height=this.clientHeight);var n=t.getContext("2d");n.fillStyle=e?O:T,n.fillRect(0,0,26,this.scrollHeight+1),n.fillStyle=e?V:j,n.font=R+" "+S;for(var r=0;r<this.linesCount;r++){var a=""+(r+1);n.fillText(a,24-8*a.length,19+r*C)}}catch(o){console.log("XTextArea paintLineNumbers error: "+o)}},s.update=function(e,t){this.value=e;for(var n=1,r=0;r<e.length;++r)"\n"===e.charAt(r)&&++n;this.linesCount=n,this.style.height=n*C+8+"px",this.scrollHeight>this.clientHeight&&(this.style.height=this.scrollHeight+C+10+"px"),this.paintLineNumbers(t)},s.createWhisper=function(e){var n=this;0===e.length?this.hideWhisper():(this.whisperDiv.innerHTML="",e.forEach((function(e,r){var a=document.createElement("div");a.innerHTML=e,a.onclick=function(e){n.focus(),n.whisperDiv.setSelected(r),e.stopPropagation()},a.ondblclick=function(e){n.focus(),n.insertCurrentSelectedWhisper(t.onChange),n.notAutoShowWhisper=!0,e.stopPropagation()},n.whisperDiv.appendChild(a)})),this.whisperDiv.setSelected(0),this.whisperDiv.isShown=!0,this.moveWhisper())},s.moveWhisper=function(){if(this.whisperDiv.isShown){var e=A(this.value,this.selectionEnd),t=(e.line+1)*C,n=e.column*N,r=t-this.scrollTop,a=n-this.scrollLeft+4;0<=r&&r<this.clientHeight&&0<=a&&a<this.clientWidth?this.getBoundingClientRect().y+r<=window.innerHeight/2?this.whisperDiv.setAttribute("style","display: block; top: ".concat(r+4,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: block; bottom: ".concat(this.getBoundingClientRect().height-r+C,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: none;")}},s.hideWhisper=function(){this.whisperDiv.setAttribute("style","display: none;"),this.whisperDiv.isShown=!1},s.insertCurrentSelectedWhisper=function(e){var t=this.whisperDiv.getSelectedWhisper();if(void 0!==t){var n=_(this.value,this.selectionEnd),r=this.value.slice(0,n),a=this.value.slice(this.selectionEnd),o=n+t.length;e(r+t+a,o),this.setSelectionRange(o,o),this.hideWhisper()}},s.notAutoShowWhisper=!1,s.errorDivs=[],s.moveErrors=function(){var e=this;this.errorDivs.forEach((function(t){var n=(t.startLine+1)*C+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=t.rangeLength*N,a=t.startColumn*N+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),e.getBoundingClientRect().x+a>=window.innerWidth/2&&t.messageSpan.setAttribute("style","right: 50%; left: unset;"),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},s.updateErrors=function(e){var t=this;this.errorDivs.forEach((function(e){e.remove()})),this.errorDivs=[];var n=function(e){t.parentElement.appendChild(e),t.errorDivs.push(e)};e.forEach((function(e){var r=A(t.value,e.start),a=A(t.value,e.end);if(r.line===a.line)n(L(r.line,r.column,a.column-r.column,e.msg,t));else{n(L(r.line,r.column,I(t.value,r.line)-r.column,e.msg,t));for(var o=r.line+1;o<a.line;++o)n(L(o,0,I(t.value,o),e.msg,t));n(L(a.line,0,a.column,e.msg,t))}})),this.moveErrors()},window.addEventListener("scroll",(function(){return s.moveWhisper()})),window.addEventListener("resize",(function(){s.moveWhisper(),s.moveErrors()})),window.addEventListener("click",(function(){return s.hideWhisper()})),s.onscroll=function(){s.paintLineNumbers(e.props.darkTheme),s.moveWhisper(),s.moveErrors()},s.onmousedown=function(e){s.mouseIsDown=!0,e.stopPropagation()},s.onmouseup=function(){s.mouseIsDown=!1,s.paintLineNumbers(e.props.darkTheme)},s.onmousemove=function(){s.mouseIsDown&&s.paintLineNumbers(e.props.darkTheme)},s.oninput=function(t){e.props.onChange(t.target.value,t.target.selectionStart)},s.onkeydown=function(t){if(s.whisperDiv.isShown){if("ArrowDown"===t.key&&(s.whisperDiv.changeSelected(1),t.preventDefault()),"ArrowUp"===t.key&&(s.whisperDiv.changeSelected(-1),t.preventDefault()),"PageDown"===t.key&&(s.whisperDiv.setSelected(-1),t.preventDefault()),"PageUp"===t.key&&(s.whisperDiv.setSelected(0),t.preventDefault()),"End"!==t.key&&"Home"!==t.key||s.hideWhisper(),"Escape"!==t.key&&"Esc"!==t.key||(s.hideWhisper(),t.preventDefault()),"Enter"!==t.key||t.ctrlKey||(s.insertCurrentSelectedWhisper(e.props.onChange),t.preventDefault()),"Enter"===t.key&&t.ctrlKey&&(s.hideWhisper(),t.preventDefault()),"Tab"===t.key&&(s.insertCurrentSelectedWhisper(e.props.onChange),t.preventDefault()),"ArrowLeft"===t.key){var n=0===s.selectionStart?0:s.selectionStart-1;e.props.onChange(s.value,n)}if("ArrowRight"===t.key){var r=s.selectionStart===s.value.length?s.selectionStart:s.selectionStart+1;e.props.onChange(s.value,r)}}"Enter"!==t.key&&"Tab"!==t.key||(s.notAutoShowWhisper=!0),"Backspace"!==t.key||s.whisperDiv.isShown||(s.notAutoShowWhisper=!0),t.ctrlKey&&(" "===t.key&&(s.whisperDiv.isShown?s.hideWhisper():e.props.onChange(s.value,s.selectionStart)),e.props.onCtrlInput(t))},s.update(this.props.text,this.props.darkTheme),s.updateErrors(this.props.errors),this.textarea=s}},{key:"componentDidUpdate",value:function(e){this.textarea.update(this.props.text,this.props.darkTheme),e.darkTheme!==this.props.darkTheme&&this.textarea.paintLineNumbers(this.props.darkTheme),this.props.whispers!==e.whispers&&(this.textarea.notAutoShowWhisper?this.textarea.notAutoShowWhisper=!1:this.textarea.createWhisper(this.props.whispers)),void 0!==this.props.errors?this.textarea.updateErrors(this.props.errors):this.props.errors!==e.errors&&this.textarea.classList.remove("x-textarea-err")}},{key:"render",value:function(){return a.a.createElement("div",{ref:this.reactDiv,id:this.props.id,className:"x-textarea-div"})}}]),n}(a.a.Component);function A(e,t){var n=e.slice(0,t),r=(n.match(/\n/g)||[]).length,a=n.lastIndexOf("\n");return{line:r,column:n.length-a-1}}function I(e,t){for(var n=0,r=0,a=0,o=0;o<e.length;++o)if("\n"===e.charAt(o))if(++n===t)r=o;else if(n===t+1){a=o;break}return 0===a&&(a=e.length),a-r}function L(e,t,n,r,a){var o=document.createElement("div");o.classList.add("x-textarea-highlight"),o.startLine=e,o.startColumn=t,o.rangeLength=n,o.onclick=function(e){var t=new MouseEvent(e.type,Object(d.a)({},e));a.dispatchEvent(t),e.stopPropagation()};var i=document.createElement("span");return i.classList.add("highlight-tooltip"),i.innerText=r,o.messageSpan=i,o.appendChild(i),o}var W,D,B,F=n(8),J=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.columns=new Map,this.columnNames=[],this.rows=[],this.finishedSchema=!1,this.name=t}return Object(h.a)(e,[{key:"getName",value:function(){return this.name}},{key:"hasFinishedSchema",value:function(){return this.finishedSchema}},{key:"finishSchema",value:function(){this.finishedSchema=!0}},{key:"addColumn",value:function(e,t){return!this.hasColumn(e)&&!this.hasFinishedSchema()&&(this.columns.set(e,t),this.columnNames.push(e),!0)}},{key:"hasColumn",value:function(e){return this.columnNames.some((function(t){return t===e}))}},{key:"getColumns",value:function(){return this.columns}},{key:"forEachColumn",value:function(e){return this.columns.forEach(e)}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"getColumnsCount",value:function(){return this.columnNames.length}},{key:"addRow",value:function(e){return!!Object(F.isEqual)(e.getTypes(),this.columns)&&(this.finishSchema(),e.finish(),this.rows.some((function(t){return t.equals(e)}))||this.rows.push(e),!0)}},{key:"getRows",value:function(){return this.rows}},{key:"getRowsCount",value:function(){return this.rows.length}},{key:"getSchemaString",value:function(){return this.name+"("+Object(u.a)(this.columns).map((function(e){return e[0]+": "+e[1]})).join(", ")+")"}},{key:"getNamesSchemaString",value:function(){return this.name+"("+this.columnNames.join(", ")+")"}},{key:"contentString",value:function(){var e=this;return this.columnNames.join(", ")+"\n"+(this.columnNames.map((function(t){return e.columns.get(t)})).join(", ")+"\n")+Object(u.a)(this.rows).map((function(t){return t.getOrderedPrintValues(e.columnNames).join(", ")})).join("\n")}},{key:"equals",value:function(t){return t instanceof e&&(this.name===t.name&&Object(F.isEqual)(this.columns,t.columns)&&Object(F.isEqual)(new Set(this.rows),new Set(t.rows)))}}]),e}(),U=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),r=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(r),n),r.name="CodeError",r}return n}(Object(g.a)(Error));!function(e){e[e.resultSection_getCurrentRelation_nodeIndexNotFound=1]="resultSection_getCurrentRelation_nodeIndexNotFound",e[e.resultSection_getCurrentRelation_evalError=2]="resultSection_getCurrentRelation_evalError",e[e.resultSection_saveResultRelation_nullRelationToSave=3]="resultSection_saveResultRelation_nullRelationToSave",e[e.resultSection_handleAddRelation_nullRelationToAdd=4]="resultSection_handleAddRelation_nullRelationToAdd",e[e.row_getOrderedValues_absentColumn=5]="row_getOrderedValues_absentColumn",e[e.valueParser_rpnToVETreeRecursive_unexpectedToken=6]="valueParser_rpnToVETreeRecursive_unexpectedToken",e[e.exprParser_isValidSequence_unexpectedToken=7]="exprParser_isValidSequence_unexpectedToken",e[e.exprParser_rpnToVETreeRecursive_unexpectedToken=8]="exprParser_rpnToVETreeRecursive_unexpectedToken",e[e.exprParser_parseTokensForWhisper_thetaJoinBranchError=9]="exprParser_parseTokensForWhisper_thetaJoinBranchError",e[e.exprParser_parseTokensForWhisper_projectionBranchError=10]="exprParser_parseTokensForWhisper_projectionBranchError"}(W||(W={})),function(e){e[e.exprParser_parse_relationNotDefined=1001]="exprParser_parse_relationNotDefined",e[e.binaryNode_eval_commonColumnsInSources=1002]="binaryNode_eval_commonColumnsInSources",e[e.setOperationNode_eval_notEqualColumnsInSources=1003]="setOperationNode_eval_notEqualColumnsInSources",e[e.divisionNode_eval_rightColumnsNotSubsetOfLeft=1004]="divisionNode_eval_rightColumnsNotSubsetOfLeft",e[e.divisionNode_eval_rightColumnsNotProperSubsetOfLeft=1005]="divisionNode_eval_rightColumnsNotProperSubsetOfLeft",e[e.renameNode_eval_absentOriginalColumn=1006]="renameNode_eval_absentOriginalColumn",e[e.renameNode_eval_changeToDuplicitName=1007]="renameNode_eval_changeToDuplicitName",e[e.projectionNode_eval_absentColumn=1008]="projectionNode_eval_absentColumn",e[e.referenceValue_eval_absentColumn=1009]="referenceValue_eval_absentColumn"}(D||(D={})),function(e){e[e.exprParser_parse_emptyStringGiven=2001]="exprParser_parse_emptyStringGiven",e[e.exprParser_parseTokens_outerJoinWhenNullNotSupported=2002]="exprParser_parseTokens_outerJoinWhenNullNotSupported",e[e.exprParser_parseTokens_unexpectedPart=2003]="exprParser_parseTokens_unexpectedPart",e[e.exprParser_parseTokens_bothBranchesError=2004]="exprParser_parseTokens_bothBranchesError",e[e.exprParser_rpnToVETree_invalidExpression=2005]="exprParser_rpnToVETree_invalidExpression",e[e.exprParser_assertValidInfixTokens_invalidParentheses=2006]="exprParser_assertValidInfixTokens_invalidParentheses",e[e.exprParser_assertValidInfixTokens_invalidStart=2007]="exprParser_assertValidInfixTokens_invalidStart",e[e.exprParser_assertValidInfixTokens_invalidEnd=2008]="exprParser_assertValidInfixTokens_invalidEnd",e[e.exprParser_assertValidInfixTokens_relationAfterRelation=2009]="exprParser_assertValidInfixTokens_relationAfterRelation",e[e.exprParser_assertValidInfixTokens_relationAfterUnary=2010]="exprParser_assertValidInfixTokens_relationAfterUnary",e[e.exprParser_assertValidInfixTokens_relationAfterClosing=2011]="exprParser_assertValidInfixTokens_relationAfterClosing",e[e.exprParser_assertValidInfixTokens_unaryAfterBinary=2012]="exprParser_assertValidInfixTokens_unaryAfterBinary",e[e.exprParser_assertValidInfixTokens_unaryAfterOpening=2013]="exprParser_assertValidInfixTokens_unaryAfterOpening",e[e.exprParser_assertValidInfixTokens_binaryAfterBinary=2014]="exprParser_assertValidInfixTokens_binaryAfterBinary",e[e.exprParser_assertValidInfixTokens_binaryAfterOpening=2015]="exprParser_assertValidInfixTokens_binaryAfterOpening",e[e.exprParser_assertValidInfixTokens_openingAfterRelation=2016]="exprParser_assertValidInfixTokens_openingAfterRelation",e[e.exprParser_assertValidInfixTokens_openingAfterUnary=2017]="exprParser_assertValidInfixTokens_openingAfterUnary",e[e.exprParser_assertValidInfixTokens_openingAfterClosing=2018]="exprParser_assertValidInfixTokens_openingAfterClosing",e[e.exprParser_assertValidInfixTokens_closingAfterBinary=2019]="exprParser_assertValidInfixTokens_closingAfterBinary",e[e.exprParser_assertValidInfixTokens_closingAfterOpening=2020]="exprParser_assertValidInfixTokens_closingAfterOpening",e[e.valueParser_parseTokens_emptyInput=2021]="valueParser_parseTokens_emptyInput",e[e.valueParser_parseTokens_unsupportedNull=2022]="valueParser_parseTokens_unsupportedNull",e[e.valueParser_parseTokens_unexpectedPart=2023]="valueParser_parseTokens_unexpectedPart",e[e.valueParser_toRPN_missingOpeningParenthesis=2024]="valueParser_toRPN_missingOpeningParenthesis",e[e.valueParser_toRPN_missingClosingParenthesis=2025]="valueParser_toRPN_missingClosingParenthesis",e[e.valueParser_rpnToVETree_invalidExpression=2026]="valueParser_rpnToVETree_invalidExpression",e[e.valueParser_rpnToVETree_invalidStart=2027]="valueParser_rpnToVETree_invalidStart",e[e.valueParser_rpnToVETree_invalidEnd=2028]="valueParser_rpnToVETree_invalidEnd",e[e.valueParser_rpnToVETree_literalAfterLiteral=2029]="valueParser_rpnToVETree_literalAfterLiteral",e[e.valueParser_rpnToVETree_literalAfterReference=2030]="valueParser_rpnToVETree_literalAfterReference",e[e.valueParser_rpnToVETree_literalAfterClosing=2031]="valueParser_rpnToVETree_literalAfterClosing",e[e.valueParser_rpnToVETree_referenceAfterLiteral=2032]="valueParser_rpnToVETree_referenceAfterLiteral",e[e.valueParser_rpnToVETree_referenceAfterReference=2033]="valueParser_rpnToVETree_referenceAfterReference",e[e.valueParser_rpnToVETree_referenceAfterClosing=2034]="valueParser_rpnToVETree_referenceAfterClosing",e[e.valueParser_rpnToVETree_notAfterLiteral=2035]="valueParser_rpnToVETree_notAfterLiteral",e[e.valueParser_rpnToVETree_notAfterReference=2036]="valueParser_rpnToVETree_notAfterReference",e[e.valueParser_rpnToVETree_notAfterClosing=2037]="valueParser_rpnToVETree_notAfterClosing",e[e.valueParser_rpnToVETree_binaryAfterOperator=2038]="valueParser_rpnToVETree_binaryAfterOperator",e[e.valueParser_rpnToVETree_binaryAfterOpening=2039]="valueParser_rpnToVETree_binaryAfterOpening",e[e.valueParser_rpnToVETree_openingAfterLiteral=2040]="valueParser_rpnToVETree_openingAfterLiteral",e[e.valueParser_rpnToVETree_openingAfterReference=2041]="valueParser_rpnToVETree_openingAfterReference",e[e.valueParser_rpnToVETree_openingAfterClosing=2042]="valueParser_rpnToVETree_openingAfterClosing",e[e.valueParser_rpnToVETree_closingAfterOperator=2043]="valueParser_rpnToVETree_closingAfterOperator",e[e.valueParser_rpnToVETree_closingAfterOpening=2044]="valueParser_rpnToVETree_closingAfterOpening",e[e.parser_nextBorderedPart_missingClosingChar=2045]="parser_nextBorderedPart_missingClosingChar",e[e.parser_skipWhitespacesAndChar_charNotFound=2046]="parser_skipWhitespacesAndChar_charNotFound",e[e.projectionNode_constructor_invalidProjectionString=2047]="projectionNode_constructor_invalidProjectionString",e[e.projectionNode_parseProjection_invalidProjectedColumnName=2048]="projectionNode_parseProjection_invalidProjectedColumnName",e[e.renameNode_parseChanges_invalidRenameString=2049]="renameNode_parseChanges_invalidRenameString",e[e.renameNode_parseChanges_missingArrow=2050]="renameNode_parseChanges_missingArrow",e[e.renameNode_parseChanges_invalidNewName=2051]="renameNode_parseChanges_invalidNewName",e[e.renameNode_parseChanges_keywordNewName=2052]="renameNode_parseChanges_keywordNewName",e[e.renameNode_parseChanges_multipleRenameOfTheColumn=2053]="renameNode_parseChanges_multipleRenameOfTheColumn",e[e.selectionNode_constructor_invalidString=2054]="selectionNode_constructor_invalidString",e[e.selectionNode_constructor_emptyString=2055]="selectionNode_constructor_emptyString",e[e.selectionNode_eval_resultNotBoolean=2056]="selectionNode_eval_resultNotBoolean",e[e.thetaJoinNode_constructor_invalidString=2057]="thetaJoinNode_constructor_invalidString",e[e.thetaJoinNode_constructor_emptyString=2058]="thetaJoinNode_constructor_emptyString",e[e.thetaJoinNode_eval_resultNotBoolean=2059]="thetaJoinNode_eval_resultNotBoolean",e[e.thetaSemiJoinNode_constructor_invalidString=2060]="thetaSemiJoinNode_constructor_invalidString",e[e.thetaSemiJoinNode_constructor_emptyString=2061]="thetaSemiJoinNode_constructor_emptyString",e[e.thetaSemiJoinNode_eval_resultNotBoolean=2062]="thetaSemiJoinNode_eval_resultNotBoolean",e[e.comparingOperator_eval_differentInputTypes=2063]="comparingOperator_eval_differentInputTypes",e[e.computingOperator_eval_inputTypesNotNumbers=2064]="computingOperator_eval_inputTypesNotNumbers",e[e.logicalOperator_eval_leftInputNotBoolean=2065]="logicalOperator_eval_leftInputNotBoolean",e[e.logicalOperator_eval_rightInputNotBoolean=2066]="logicalOperator_eval_rightInputNotBoolean"}(B||(B={}));var q=new Map([[W.resultSection_getCurrentRelation_nodeIndexNotFound,["ResultSection.getCurrentRelation: Selected node index in evaluation tree not found."]],[W.resultSection_getCurrentRelation_evalError,["ResultSection.getCurrentRelation: Evaluation error in result section: ",""]],[W.resultSection_saveResultRelation_nullRelationToSave,["ResultSection.saveResultRelation: Result relation is null when tried to save it."]],[W.resultSection_handleAddRelation_nullRelationToAdd,["ResultSection.handleAddRelation: Result relation is null when tried to add it."]],[W.row_getOrderedValues_absentColumn,["Row.getOrderedValues: Column "," is absent in row with columns: ",""]],[W.valueParser_rpnToVETreeRecursive_unexpectedToken,["ValueParser.rpnToVETreeRecursive: Unexpected token: ","."]],[W.exprParser_isValidSequence_unexpectedToken,["ExprParser.isValidSequence: Unexpected token: ","."]],[W.exprParser_rpnToVETreeRecursive_unexpectedToken,["ExprParser.rpnToVETreeRecursive: Unexpected token: ","."]],[W.exprParser_parseTokensForWhisper_thetaJoinBranchError,["ExprParser.parseTokensForWhisper: Error in theta join branch: ","."]],[W.exprParser_parseTokensForWhisper_projectionBranchError,["ExprParser.parseTokensForWhisper: Error in projection branch: ","."]]]),M=new Map([[D.exprParser_parse_relationNotDefined,['Relation "','" is not defined. Please check relations definitions.']],[D.binaryNode_eval_commonColumnsInSources,["Source relations for ",' have common columns "','".']],[D.setOperationNode_eval_notEqualColumnsInSources,['Source relations "','" and "','" for set '," do not have the same column sets."]],[D.divisionNode_eval_rightColumnsNotSubsetOfLeft,['Right source relation "','" is not a subset of the left source relation "','".']],[D.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,['Right source relation "','" is not a proper subset of the left source relation "',". There must exist a column in the left relation which is not present in the right relation."]],[D.renameNode_eval_absentOriginalColumn,['Invalid rename, column "','" does not exist in the source relation.']],[D.renameNode_eval_changeToDuplicitName,['Invalid rename, new column name "','" is duplicit in the changed relation.']],[D.projectionNode_eval_absentColumn,['Invalid projection of the column "','". It does not exist in the source relation.']],[D.referenceValue_eval_absentColumn,['Column "','" is absent in a schema with columns: ',"."]]]),H=new Map([[B.exprParser_parse_emptyStringGiven,["Cannot parse an expression from an empty string."]],[B.exprParser_parseTokens_outerJoinWhenNullNotSupported,["Found "," when null values are not supported."]],[B.exprParser_parseTokens_unexpectedPart,['Unexpected part "','" in RA expression.']],[B.exprParser_parseTokens_bothBranchesError,['All combinations throw error in "','". When treated as projection:\n',"\nWhen treated as theta join:\n",""]],[B.exprParser_rpnToVETree_invalidExpression,["Given string is not a valid expression."]],[B.exprParser_assertValidInfixTokens_invalidParentheses,["Invalid structure of parentheses in the expression."]],[B.exprParser_assertValidInfixTokens_invalidStart,["RA expression cannot start with ","."]],[B.exprParser_assertValidInfixTokens_invalidEnd,["RA expression cannot end with ","."]],[B.exprParser_assertValidInfixTokens_relationAfterRelation,['Relation "','" after relation "','".']],[B.exprParser_assertValidInfixTokens_relationAfterUnary,['Relation "','" after unary operator "','".']],[B.exprParser_assertValidInfixTokens_relationAfterClosing,['Relation "','" after closing parenthesis.']],[B.exprParser_assertValidInfixTokens_unaryAfterBinary,['Unary operator "','" after binary operator "','".']],[B.exprParser_assertValidInfixTokens_unaryAfterOpening,['Unary operator "','" after opening parenthesis.']],[B.exprParser_assertValidInfixTokens_binaryAfterBinary,['Binary operator "','" after binary operator "','".']],[B.exprParser_assertValidInfixTokens_binaryAfterOpening,['Binary operator "','" after opening parenthesis.']],[B.exprParser_assertValidInfixTokens_openingAfterRelation,['Opening parentheses after relation "','".']],[B.exprParser_assertValidInfixTokens_openingAfterUnary,['Opening parentheses after unary operator "','".']],[B.exprParser_assertValidInfixTokens_openingAfterClosing,["Opening parentheses after closing parentheses."]],[B.exprParser_assertValidInfixTokens_closingAfterBinary,['Closing parentheses after binary operator "','".']],[B.exprParser_assertValidInfixTokens_closingAfterOpening,["Closing parentheses after opening parentheses."]],[B.valueParser_parseTokens_emptyInput,["An empty string given as a condition."]],[B.valueParser_parseTokens_unsupportedNull,["Null constant used when null values are not supported."]],[B.valueParser_parseTokens_unexpectedPart,['Unexpected part "','" in expression.']],[B.valueParser_toRPN_missingOpeningParenthesis,["Missing opening parenthesis '(' in an expression."]],[B.valueParser_toRPN_missingClosingParenthesis,["Missing closing parenthesis ')' in an expression."]],[B.valueParser_rpnToVETree_invalidExpression,["Given string is not a valid expression."]],[B.valueParser_rpnToVETree_invalidStart,['Expression cannot start with "','".']],[B.valueParser_rpnToVETree_invalidEnd,['Expression cannot end with "','".']],[B.valueParser_rpnToVETree_literalAfterLiteral,['Literal "','" after literal "','".']],[B.valueParser_rpnToVETree_literalAfterReference,['Literal "','" after reference to column "','".']],[B.valueParser_rpnToVETree_literalAfterClosing,['Literal "','" after closing parentheses.']],[B.valueParser_rpnToVETree_referenceAfterLiteral,['Reference to column "','" after literal "','".']],[B.valueParser_rpnToVETree_referenceAfterReference,['Reference to column "','" after reference to column "','".']],[B.valueParser_rpnToVETree_referenceAfterClosing,['Reference to column "','" after closing parentheses.']],[B.valueParser_rpnToVETree_notAfterLiteral,['Logical not operator "','" after literal "','".']],[B.valueParser_rpnToVETree_notAfterReference,['Logical not operator "','" after reference to column "','".']],[B.valueParser_rpnToVETree_notAfterClosing,['Logical not operator "','" after closing parentheses.']],[B.valueParser_rpnToVETree_binaryAfterOperator,['Binary operator "','" after binary operator "','".']],[B.valueParser_rpnToVETree_binaryAfterOpening,['Binary operator "','" after opening parentheses.']],[B.valueParser_rpnToVETree_openingAfterLiteral,['Opening parentheses after literal "','".']],[B.valueParser_rpnToVETree_openingAfterReference,['Opening parentheses after reference to column "','".']],[B.valueParser_rpnToVETree_openingAfterClosing,["Opening parentheses after closing parentheses."]],[B.valueParser_rpnToVETree_closingAfterOperator,['Closing parentheses after binary operator "','".']],[B.valueParser_rpnToVETree_closingAfterOpening,["Closing parentheses after opening parentheses."]],[B.parser_nextBorderedPart_missingClosingChar,["Missing '","' after opening '","'."]],[B.parser_skipWhitespacesAndChar_charNotFound,['Expected "','" not found.']],[B.projectionNode_constructor_invalidProjectionString,['"',"\" is not a projection string. It must be bordered with '[' and ']'."]],[B.projectionNode_parseProjection_invalidProjectedColumnName,['Invalid projection of column "','". Column name must contain letters, number and underscores only and start with a letter.']],[B.renameNode_parseChanges_invalidRenameString,['"',"\" is not a rename string. It must be bordered with '<' and '>'."]],[B.renameNode_parseChanges_missingArrow,["Invalid rename, please use \"OldName -> NewName\" for each column renaming separated by commas ','."]],[B.renameNode_parseChanges_invalidNewName,['Invalid rename to "','". New column name must contain letters, number and underscores only and start with a letter.']],[B.renameNode_parseChanges_keywordNewName,['Invalid rename to "','". New column name cannot be a keyword.']],[B.renameNode_parseChanges_multipleRenameOfTheColumn,['Multiple rename of column "','".']],[B.selectionNode_constructor_invalidString,["Invalid selection, it must be bordered with '(' and ')'."]],[B.selectionNode_constructor_emptyString,["The selection cannot be empty."]],[B.selectionNode_eval_resultNotBoolean,["Result of the selection condition "," is not a boolean value, but ","."]],[B.thetaJoinNode_constructor_invalidString,["Invalid theta join, it must be bordered with '[' and ']'."]],[B.thetaJoinNode_constructor_emptyString,["The theta join condition cannot be empty."]],[B.thetaJoinNode_eval_resultNotBoolean,["Result of the theta join condition "," is not a boolean value, but ","."]],[B.thetaSemiJoinNode_constructor_invalidString,["Invalid theta semijoin, it must be bordered with '<' and ']' or '[' and '>'."]],[B.thetaSemiJoinNode_constructor_emptyString,["The theta semijoin condition cannot be empty."]],[B.thetaSemiJoinNode_eval_resultNotBoolean,["Result of the theta semijoin condition "," is not a boolean value, but ","."]],[B.comparingOperator_eval_differentInputTypes,['Inputs for "','"  have different types '," and ","."]],[B.computingOperator_eval_inputTypesNotNumbers,['Inputs for "','" are not both numbers, they are '," and ","."]],[B.logicalOperator_eval_leftInputNotBoolean,['Left input value for "','" is not a boolean, but ',"."]],[B.logicalOperator_eval_rightInputNotBoolean,['Right input value for "','" is not a boolean, but ',"."]]]),z=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"codeError",value:function(e){var t=q.get(e);void 0===t&&(console.log("Unknown code of code error given: "+e),t=["Code error"]);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return K(t.length-1,r,e),new U(G(t,r))}},{key:"semanticError",value:function(e,t){var n=M.get(e);void 0===n&&(console.log("Unknown code of semantic error given: "+e),n=["Semantic error"]);for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return K(n.length-1,a,e),new E(G(n,a),t)}},{key:"syntaxError",value:function(e,t){var n=H.get(e);void 0===n&&(console.log("Unknown code of syntax error given: "+e),n=["Syntax error"]);for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return K(n.length-1,a,e),new x(G(n,a),t)}}]),e}();function K(e,t,n){if(t.length!==e)for(console.log("Unexpected params count for error "+n+", expected "+e+", given "+t.length);t.length<e;)t.push("")}function G(e,t){for(var n,r=e.length,a=Array(2*r-2),o=1;o<r;o++)a[2*o-2]=t[o-1],a[2*o-1]=e[o];return(n=e[0]).concat.apply(n,a)}var Q=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"isWord",value:function(t){return t.length>0&&t.split("").every((function(t){return e.isLetter(t)}))}},{key:"isName",value:function(t){return 0!==t.length&&(!(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))&&t.split("").every((function(t){return e.isNameChar(t)})))}},{key:"isWhitespacesOnly",value:function(e){var t=/\s*/.exec(e);return null!==t&&t[0]===e}},{key:"isLetter",value:function(e){return 1===e.length&&e.toLowerCase()!==e.toUpperCase()}},{key:"isNameChar",value:function(t){return e.isLetter(t)||e.isDigit(t)||"_"===t}},{key:"isDigit",value:function(e){return 1===e.length&&null!==e.match(/\d/)}},{key:"isNumber",value:function(e){return/^[-]?[\d]+([.][\d]+)?$/.test(e)}},{key:"nextWord",value:function(t){if(""===t)return{first:"",second:""};for(var n=0;n<t.length;){if(!e.isLetter(t.charAt(n)))return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextName",value:function(t){if(""===t)return{first:"",second:""};if(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))return{first:"",second:t};for(var n=0;n<t.length;){var r=t.charAt(n);if(!e.isLetter(r)&&!e.isDigit(r)&&"_"!==r)return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextNonWhitespacePart",value:function(e){if(""===e)return{first:"",second:""};for(var t=0;t<e.length;){if(e.charAt(t).match(/\s/))return{first:e.substring(0,t),second:e.substring(t)};++t}return{first:e,second:""}}},{key:"nextNumber",value:function(t){if(""===t)return{first:"",second:""};var n=0;if("-"===t.charAt(0)){if(!(t.length>1&&e.isDigit(t.charAt(1))))return{first:"",second:t};n=1}for(var r=!1,a=!1;n<t.length;)if(e.isDigit(t.charAt(n)))r=!0,++n;else{if("."!==t.charAt(n))break;if(a||!r)break;a=!0,++n}return{first:t.substring(0,n),second:t.substring(n)}}},{key:"nextQuotedString",value:function(e){for(var t=1,n=0;t<e.length;){var r=e.charAt(t);if(++t,'"'===r&&n%2===0)return{first:e.slice(0,t),second:e.slice(t),error:void 0};if("\n"===r)return{first:e.slice(0,t),second:e.slice(t),error:z.syntaxError(B.parser_nextBorderedPart_missingClosingChar,void 0,'"','"')};"\\"===r?++n:n=0}return{first:e,second:"",error:z.syntaxError(B.parser_nextBorderedPart_missingClosingChar,void 0,'"','"')}}},{key:"nextBorderedPart",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0",a=1,o=1,i=!1,s=1===n.length,l=0,u=0;o<e.length;){var c=e.charAt(o);if(n.indexOf(c)>-1&&u%2===0&&!i?--a:c===t&&u%2===0&&s&&!i?++a:'"'===c&&l%2===0&&(i=!i),c===r?++u:u=0,"\\"===c?++l:l=0,++o,0===a)return{first:e.slice(0,o),second:e.slice(o)}}throw z.syntaxError(B.parser_nextBorderedPart_missingClosingChar,void 0,n.split("").join("' or '"),t)}},{key:"skipWhitespacesAndChar",value:function(e,t){for(var n=!1,r=0;r<e.length;)if(e.charAt(r).match(/\s/))++r;else{if(e.charAt(r)!==t||n)break;n=!0,++r}if(!n)throw z.syntaxError(B.parser_skipWhitespacesAndChar_charNotFound,void 0,t);return e.substring(r)}},{key:"deleteCommentLines",value:function(e){return e.split("\n").map((function(e){for(var t=!1,n=0,r=0;r<e.length;++r){var a=e.charAt(r);if('"'===a&&n%2===0&&(t=!t),t&&"\\"===a?++n:n=0,!t&&"/"===a&&r>0&&"/"===e.charAt(r-1))return e.slice(0,r-1)}return e})).join("\n")}}]),e}(),X=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"isWord",value:function(e){return Q.isWord(e.toString())}},{key:"isName",value:function(e){return Q.isName(e.toString())}},{key:"isWhitespacesOnly",value:function(e){return Q.isWhitespacesOnly(e.toString())}},{key:"isLetter",value:function(e){return Q.isLetter(e.toString())}},{key:"isNameChar",value:function(e){return Q.isNameChar(e.toString())}},{key:"isDigit",value:function(e){return Q.isDigit(e.toString())}},{key:"isNumber",value:function(e){return Q.isNumber(e.toString())}},{key:"nextWord",value:function(e){var t=Q.nextWord(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextName",value:function(e){var t=Q.nextName(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNonWhitespacePart",value:function(e){var t=Q.nextNonWhitespacePart(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNumber",value:function(e){var t=Q.nextNumber(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextQuotedString",value:function(e){var t=Q.nextQuotedString(e.toString()),n=e.getFirstNonNaNIndex();return void 0!==n&&(t.error=b(t.error,{start:n,end:n})),{first:e.slice(0,t.first.length),second:e.slice(t.first.length),error:t.error}}},{key:"nextBorderedPart",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0";try{var a=Q.nextBorderedPart(e.toString(),t,n,r);return{first:e.slice(0,a.first.length),second:e.slice(a.first.length)}}catch(i){var o=e.getFirstNonNaNIndex();if(void 0!==o)throw b(i,{start:o,end:o});throw i}}},{key:"skipWhitespacesAndChar",value:function(e,t){try{var n=Q.skipWhitespacesAndChar(e.toString(),t);return e.slice(e.length()-n.length)}catch(r){throw b(r,e.getNonNaNRange())}}},{key:"deleteCommentLines",value:function(e){var t=e.splitToLines(),n=t.split,r=t.separatorIndexes,a=n.map((function(e,t){for(var n=!1,r=0,a=0;a<e.length();++a){var o=e.charAt(a);if('"'===o&&r%2===0&&(n=!n),n&&"\\"===o?++r:r=0,!n&&"/"===o&&a>0&&"/"===e.charAt(a-1))return e.slice(0,a-1)}return e}));return $.join(a,"\n",r)}}]),e}(),$=function(){function e(t,n){Object(c.a)(this,e),this.str=t,this.chars=n}return Object(h.a)(e,null,[{key:"new",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t,t.split("").map((function(e,t){return{char:e,index:t+n}})))}},{key:"empty",value:function(){return new e("",[])}},{key:"newFromArray",value:function(t){return new e(t.map((function(e){return e.char})).join(""),t.map((function(e){return{char:e.char,index:e.index}})))}},{key:"join",value:function(t,n,r){var a;if(0===t.length)return e.empty();if(1===t.length)return t[0];for(var o=Array(2*t.length-2),i=1;i<t.length;i++)o[2*i-2]=e.new(n,r[i-1]),o[2*i-1]=t[i];return(a=t[0]).concat.apply(a,o)}}]),Object(h.a)(e,[{key:"toString",value:function(){return this.str}},{key:"length",value:function(){return this.str.length}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"getChars",value:function(){return this.chars}},{key:"getFirstIndex",value:function(){if(!this.isEmpty())return this.chars[0].index}},{key:"getLastIndex",value:function(){if(!this.isEmpty())return this.chars[this.length()-1].index}},{key:"getFirstNonNaNIndex",value:function(){if(!this.isEmpty()){for(var e=0;e<this.length();e++)if(!isNaN(this.chars[e].index))return this.chars[e].index;return NaN}}},{key:"getLastNonNaNIndex",value:function(){if(!this.isEmpty()){for(var e=this.length()-1;e>=0;e--)if(!isNaN(this.chars[e].index))return this.chars[e].index;return NaN}}},{key:"getRange",value:function(){if(!this.isEmpty())return{start:this.chars[0].index,end:this.chars[this.length()-1].index}}},{key:"getNonNaNRange",value:function(){if(!this.isEmpty()){var e=this.getFirstNonNaNIndex();if(!isNaN(e))return{start:e,end:this.getLastNonNaNIndex()}}}},{key:"indexedCharAt",value:function(t){if(t<0||t>=this.length())throw new RangeError;return e.newFromArray([this.chars[t]])}},{key:"charAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].char}},{key:"indexAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].index}},{key:"split",value:function(t){var n=this;if(this.isEmpty())return""===t?[]:[e.empty()];var r=t.length,a=this.str.split(t),o=Array(a.length);o[0]=0;for(var i=1;i<a.length;i++)o[i]=o[i-1]+a[i-1].length+r;return a.map((function(t,r){return new e(t,n.chars.slice(o[r],o[r]+t.length))}))}},{key:"splitToLines",value:function(){var t=this;if(this.isEmpty())return{split:[e.empty()],separatorIndexes:[]};var n=this.str.split("\n"),r=n.length-1,a=Array(n.length),o=Array(n.length-1);a[0]=0;for(var i=0;i<r;i++){var s=a[i]+n[i].length+1;o[i]=this.indexAt(s-1),a[i+1]=s}return{split:n.map((function(n,r){return new e(n,t.chars.slice(a[r],a[r]+n.length))})),separatorIndexes:o}}},{key:"slice",value:function(t,n){var r=t<0?this.length()+t:t,a=void 0!==n?n<0?this.length()+n:n:this.length();if(r>a||r<0||a>this.length())throw new RangeError;return e.newFromArray(this.chars.slice(r,a))}},{key:"trim",value:function(){var t=this.str.trim();if(""===t)return new e("",[]);var n=this.str.indexOf(t.charAt(0));return e.newFromArray(this.chars.slice(n,n+t.length))}},{key:"concat",value:function(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.newFromArray((t=this.chars).concat.apply(t,Object(u.a)(r.map((function(e){return e.chars})))))}},{key:"startsWith",value:function(e,t){return this.str.startsWith(e,t)}},{key:"endsWith",value:function(e,t){return this.str.endsWith(e,t)}},{key:"replace",value:function(e,t){return this.str.replace(e,t)}},{key:"indexOf",value:function(e,t){return this.str.indexOf(e,t)}},{key:"match",value:function(e){return this.str.match(e)}},{key:"copy",value:function(){return new e(this.str,this.chars.map((function(e){return{char:e.char,index:e.index}})))}},{key:"removeWhitespaces",value:function(){return new e(this.str.replace(/\s/g,""),this.chars.filter((function(e){return!/\s/.test(e.char)})).map((function(e){return{char:e.char,index:e.index}})))}},{key:"getNextIndexOrNaN",value:function(){var e=this.getLastIndex();return void 0===e?NaN:e+1}}]),e}();function Y(e){return e instanceof $?e.getNonNaNRange():void 0}function Z(e){return e instanceof $?e.length():e.length}function ee(e){return e instanceof $?e.isEmpty():""===e}function te(e){return e instanceof $?X.nextQuotedString(e):Q.nextQuotedString(e)}function ne(e,t,n,r){return e instanceof $?X.nextBorderedPart(e,t,n,r):Q.nextBorderedPart(e,t,n,r)}function re(e,t){for(var n=0;n<t.length;++n)if(e.indexOf(t[n])>-1)return!0;return!1}var ae=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(h.a)(e,[{key:"getRange",value:function(){return Y(this.str)}}]),e}(),oe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return n}(ae),ie=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(oe),se=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(oe),le=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(ae),ue=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).type=r,a}return Object(h.a)(n,null,[{key:"selection",value:function(e){return new n(e,"selection")}},{key:"projection",value:function(e){return new n(e,"projection")}},{key:"rename",value:function(e){return new n(e,"rename")}}]),n}(ae),ce=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).precedence=r,o.type=a,o}return Object(h.a)(n,null,[{key:"naturalJoin",value:function(e){return new n(e,10,"natural join")}},{key:"cartesianProduct",value:function(e){return new n(e,10,"cartesian product")}},{key:"union",value:function(e){return new n(e,4,"union")}},{key:"intersection",value:function(e){return new n(e,6,"intersection")}},{key:"difference",value:function(e){return new n(e,5,"difference")}},{key:"leftSemijoin",value:function(e){return new n(e,9,"left semijoin")}},{key:"rightSemijoin",value:function(e){return new n(e,9,"right semijoin")}},{key:"leftAntijoin",value:function(e){return new n(e,9,"left antijoin")}},{key:"rightAntijoin",value:function(e){return new n(e,9,"right antijoin")}},{key:"thetaJoin",value:function(e){return new n(e,10,"theta join")}},{key:"leftThetaSemijoin",value:function(e){return new n(e,9,"left theta semijoin")}},{key:"rightThetaSemijoin",value:function(e){return new n(e,9,"right theta semijoin")}},{key:"fullOuterJoin",value:function(e){return new n(e,8,"full outer join")}},{key:"leftOuterJoin",value:function(e){return new n(e,8,"left outer join")}},{key:"rightOuterJoin",value:function(e){return new n(e,8,"right outer join")}},{key:"division",value:function(e){return new n(e,7,"division")}}]),n}(ae),he=function(){function e(){Object(c.a)(this,e),this.resultRelation=void 0}return Object(h.a)(e,[{key:"isEvaluated",value:function(){return void 0!==this.resultRelation}},{key:"getResult",value:function(){return void 0===this.resultRelation&&this.eval(),this.resultRelation}}]),e}(),pe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).resultRelation=e,r}return Object(h.a)(n,[{key:"eval",value:function(){}},{key:"fakeEval",value:function(e){return{result:this.resultRelation,whispers:[],errors:[]}}},{key:"printInLine",value:function(){return this.resultRelation.getName()}},{key:"getOperationName",value:function(){return this.resultRelation.getName()}},{key:"getOperationSymbol",value:function(){return""}}]),n}(he),fe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).subtree=void 0,r.subtree=e,r}return Object(h.a)(n,[{key:"getSubtree",value:function(){return this.subtree}}]),n}(he),de=function(){function e(t){var n=this;Object(c.a)(this,e),this.types=new Map,this.values=new Map,this.finished=void 0,t.forEach((function(e,t){n.values.set(t,null)})),this.types=t,this.finished=!1}return Object(h.a)(e,[{key:"isFinished",value:function(){return this.finished}},{key:"finish",value:function(){this.finished=!0}},{key:"getColumnNames",value:function(){return this.types.keys()}},{key:"addValue",value:function(e,t){return!(this.finished||!this.types.has(e))&&((null===t||typeof t===this.types.get(e))&&(this.values.set(e,t),!0))}},{key:"getValue",value:function(e){return this.values.get(e)}},{key:"getType",value:function(e){return this.types.get(e)}},{key:"getTypes",value:function(){return this.types}},{key:"getValues",value:function(){return this.values}},{key:"getOrderedPrintValues",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.values.get(e),a=t.types.get(e);if(void 0===r||void 0===a)throw z.codeError(W.row_getOrderedValues_absentColumn,e,Object(u.a)(t.types.values()).join(", "));if("string"===a){var o=String(r).replace(/\\"/g,'"').replace(/\\\\/g,"\\");n.push(o)}else n.push(String(r))})),n}},{key:"equals",value:function(t){return t instanceof e&&(Object(F.isEqual)(this.types,t.types)&&Object(F.isEqual)(this.values,t.values))}}]),e}(),me=["null","true","false",""],ve=["F","L","R",""];function ge(e){return me.indexOf(e.toString().toLowerCase())>-1}var ye,be=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).projection=void 0,a.stringRange=void 0,a.projection=e,a.stringRange=Y(e),a}return Object(h.a)(n,[{key:"parseProjection",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=new Set,a=this.projection instanceof $,o=this.projection.slice(1,-1),i=o.split(",");return i.forEach((function(o){if(o=o.trim(),(a?X.isName(o):Q.isName(o))&&!ge(o))r.add(o);else{var i=Y(o);ee(o)&&void 0!==t.stringRange&&(i={start:t.stringRange.start,end:t.stringRange.start});var s=z.syntaxError(B.projectionNode_parseProjection_invalidProjectedColumnName,i,o.toString());if(e)throw s;n.push(s)}})),r}},{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.subtree.getResult(),t=Object(u.a)(this.parseProjection(!0)).map((function(e){return e.toString()}));t.forEach((function(t){if(!e.hasColumn(t.toString()))throw z.semanticError(D.projectionNode_eval_absentColumn,Y(t),t.toString())}));var n=new J(e.getName()+"[...]");e.forEachColumn((function(e,r){t.indexOf(r)>-1&&n.addColumn(r,e)})),e.getRows().forEach((function(e){var r=new de(n.getColumns());e.getValues().forEach((function(e,n){t.indexOf(n)>-1&&r.addValue(n,e)})),n.addRow(r)})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=this.parseProjection(!1,r),o=new J(t.result.name+"[...]"),i=[];return a.forEach((function(e){var n=e.toString();t.result.hasColumn(n)?o.addColumn(n,t.result.getColumns().get(n)):i.push(e)})),i.forEach((function(e){r.push(z.semanticError(D.projectionNode_eval_absentColumn,Y(e),e.toString()))})),{result:o,whispers:n,errors:r}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return"Projection"}},{key:"getOperationSymbol",value:function(){return this.projection.replace(/\s+/g," ")}}]),n}(fe),xe=n(25),Ee=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(h.a)(e,[{key:"get",value:function(e){var t=this.map.get(e.toString());return void 0===t?void 0:t.value}},{key:"set",value:function(e,t){this.map.set(e.toString(),{key:e,value:t})}},{key:"delete",value:function(e){return this.map.delete(e.toString())}},{key:"has",value:function(e){return this.map.has(e.toString())}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(e){Object(u.a)(this.map.values()).forEach((function(t,n){return e(t.value,t.key,n)}))}}]),e}(),ke=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).rename=void 0,a.stringRange=void 0,a.rename=e,a.stringRange=Y(e),a}return Object(h.a)(n,[{key:"parseChanges",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){if(e)throw t;n.push(t)},a=this.rename.slice(1,-1).split(","),o=new Ee,i=Object(xe.a)(a);try{for(i.s();!(t=i.n()).done;){var s=t.value,l=s.split("->").map((function(e){return e.trim()})),u=!1,c=!1;if(2!==l.length){var h=Y(s);ee(s)&&void 0!==this.stringRange&&(h={start:this.stringRange.start,end:this.stringRange.start}),r(z.syntaxError(B.renameNode_parseChanges_missingArrow,h)),u=!0,c=!0}!u&&o.has(l[0].toString())&&(r(z.syntaxError(B.renameNode_parseChanges_multipleRenameOfTheColumn,Y(l[0]),l[0].toString())),u=!0),c||Q.isName(l[1].toString())||(r(z.syntaxError(B.renameNode_parseChanges_invalidNewName,Y(l[1]),l[1].toString())),c=!0),!c&&ge(l[1])&&(r(z.syntaxError(B.renameNode_parseChanges_keywordNewName,Y(l[1]),l[1].toString())),c=!0),u||c?u?c||o.set("",l[0]):o.set(l[0],l[0]):o.set(l[0],l[1])}}catch(p){i.e(p)}finally{i.f()}return o}},{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.parseChanges(!0),n=this.subtree.getResult();t.forEach((function(e,t){if(-1===n.getColumnNames().indexOf(t.toString()))throw z.semanticError(D.renameNode_eval_absentOriginalColumn,Y(t),t.toString())}));var r=new J(n.getName()+"<...>"),a=new Map;n.forEachColumn((function(e,n){t.has(n)?a.set(n,e):r.addColumn(n,e)})),a.forEach((function(n,a){if(!r.addColumn(t.get(a).toString(),n))throw z.semanticError(D.renameNode_eval_changeToDuplicitName,Y(e.rename),t.get(a))})),n.getRows().forEach((function(e){var n=new de(r.getColumns());e.getValues().forEach((function(e,r){var a=t.get(r);"undefined"===typeof a?n.addValue(r,e):n.addValue(a.toString(),e)})),r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;if(void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end){var r=this.rename.slice(0,e-this.stringRange.start).trim().match(/.*[^\w\s]/);null!==r&&(r[0].endsWith("<")||r[0].endsWith(","))&&(n=t.result.getColumnNames())}var a=t.errors,o=this.parseChanges(!1,a),i=new J(t.result.getName()+"<...>");t.result.forEachColumn((function(e,t){o.has(t)||i.addColumn(t,e)}));var s=[],l=[];return o.forEach((function(e,n){var r=n.toString(),a=e.toString();t.result.hasColumn(r)||""===n?i.addColumn(a,t.result.getColumns().get(r))||l.push(e):s.push(n)})),s.forEach((function(e){a.push(z.semanticError(D.renameNode_eval_absentOriginalColumn,Y(e),e.toString()))})),l.forEach((function(e){a.push(z.semanticError(D.renameNode_eval_changeToDuplicitName,Y(e),e.toString()))})),{result:i,whispers:n,errors:a}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return"Rename"}},{key:"getOperationSymbol",value:function(){return this.rename.replace(/\s+/g," ")}}]),n}(fe),_e=function e(){Object(c.a)(this,e)};!function(e){e[e.equal=0]="equal",e[e.nonEqual=1]="nonEqual",e[e.less=2]="less",e[e.more=3]="more",e[e.lessOrEqual=4]="lessOrEqual",e[e.moreOrEqual=5]="moreOrEqual"}(ye||(ye={}));var we,Re=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(h.a)(n,null,[{key:"equal",value:function(e,t,r){return new n(ye.equal,e,t,r)}},{key:"nonEqual",value:function(e,t,r){return new n(ye.nonEqual,e,t,r)}},{key:"less",value:function(e,t,r){return new n(ye.less,e,t,r)}},{key:"more",value:function(e,t,r){return new n(ye.more,e,t,r)}},{key:"lessOrEqual",value:function(e,t,r){return new n(ye.lessOrEqual,e,t,r)}},{key:"moreOrEqual",value:function(e,t,r){return new n(ye.moreOrEqual,e,t,r)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("null"!==t.type&&"null"!==n.type&&t.type!==n.type)throw z.syntaxError(B.comparingOperator_eval_differentInputTypes,Y(this.operator),this.operator.toString(),t.type,n.type);return null===t.value&&null===n.value&&"null"!==t.type&&"null"!==n.type?{value:!1,type:"boolean"}:this.type===ye.equal?{value:t.value===n.value,type:"boolean"}:this.type===ye.nonEqual?null===t.value&&"null"!==t.type||null===n.value&&"null"!==n.type?{value:!1,type:"boolean"}:{value:t.value!==n.value,type:"boolean"}:this.type===ye.less?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<n.value,type:"boolean"}:this.type===ye.more?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>n.value,type:"boolean"}:this.type===ye.lessOrEqual?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<=n.value,type:"boolean"}:null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>=n.value,type:"boolean"}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.operator+" "+this.right.toString()+")"}}]),n}(_e);!function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(we||(we={}));var Se,Ne=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(h.a)(n,null,[{key:"and",value:function(e,t,r){return new n(we.and,e,t,r)}},{key:"or",value:function(e,t,r){return new n(we.or,e,t,r)}},{key:"not",value:function(e,t){return new n(we.not,e,t)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e);if("boolean"!==t.type)throw z.syntaxError(B.logicalOperator_eval_leftInputNotBoolean,Y(this.operator),this.operator.toString(),t.type);if(this.type===we.not)return null===t.value?{value:!1,type:"boolean"}:{value:!t.value,type:"boolean"};var n=this.right.eval(e);if("boolean"!==n.type)throw z.syntaxError(B.logicalOperator_eval_rightInputNotBoolean,Y(this.operator),this.operator.toString(),n.type);return this.type===we.and?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value&&n.value,type:"boolean"}:null===t.value&&null===n.value?{value:!1,type:"boolean"}:null===t.value?{value:n.value,type:"boolean"}:null===n.value?{value:t.value,type:"boolean"}:{value:t.value||n.value,type:"boolean"}}},{key:"toString",value:function(){return this.type===we.not?this.operator+"("+this.left.toString()+")":"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(_e),Ce=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).value=e,a.type=r,a}return Object(h.a)(n,[{key:"eval",value:function(e){return{value:this.value,type:this.type}}},{key:"toString",value:function(){return null===this.value?"null":this.value.toString()}}]),n}(_e),Te=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).columnName=e,r}return Object(h.a)(n,[{key:"eval",value:function(e){var t=e.getValue(this.columnName.toString()),n=e.getType(this.columnName.toString());if(void 0===t||void 0===n)throw z.semanticError(D.referenceValue_eval_absentColumn,Y(this.columnName),this.columnName.toString(),Object(u.a)(e.getColumnNames()).join(", "));return{value:t,type:n}}},{key:"toString",value:function(){return this.columnName.toString()}}]),n}(_e);!function(e){e.plus="+",e.minus="-",e.multiplication="*",e.division="/"}(Se||(Se={}));var Oe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.left=r,i.right=a,i.range=o,i}return Object(h.a)(n,null,[{key:"add",value:function(e,t,r){return new n(Se.plus,e,t,r)}},{key:"deduct",value:function(e,t,r){return new n(Se.minus,e,t,r)}},{key:"multiply",value:function(e,t,r){return new n(Se.multiplication,e,t,r)}},{key:"divide",value:function(e,t,r){return new n(Se.division,e,t,r)}}]),Object(h.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("number"!==t.type||"number"!==n.type)throw z.syntaxError(B.computingOperator_eval_inputTypesNotNumbers,this.range,this.type,t.type,n.type);if(null===t.value||null===n.value)return{value:null,type:"number"};switch(this.type){case Se.plus:return{value:t.value+n.value,type:"number"};case Se.minus:return{value:t.value-n.value,type:"number"};case Se.multiplication:return{value:t.value*n.value,type:"number"};case Se.division:return{value:t.value/n.value,type:"number"}}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.type+" "+this.right.toString()+")"}}]),n}(_e),je=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(h.a)(e,[{key:"getRange",value:function(){return this.str instanceof $?this.str.getNonNaNRange():void 0}}]),e}(),Ve=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).precedence=r,a}return n}(je),Pe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,50)}return n}(Ve),Ae=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,10)}return n}(Ve),Ie=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,5)}return n}(Ve),Le=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Ve),We=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Ve),De=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Ve),Be=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Ve),Fe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r,20)).type=e,a}return n}(Ve),Je=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(je),Ue=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Je),qe=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Je),Me=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).value=r,o.type=a,o}return n}(je),He=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(je),ze=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"parse",value:function(t,n){var r=e.parseTokens(t,n,!0);this.assertValidInfixTokens(r,!0),r=this.simplify(r);try{var a=e.toRPN(r);return e.rpnToVETree(a)}catch(o){throw b(o,Y(t))}}},{key:"fakeParse",value:function(t,n,r){var a=[],o=e.parseTokens(t,n,!1,a);return o.forEach((function(e){e instanceof He&&-1===r.indexOf(e.str.toString())&&a.push(z.semanticError(D.referenceValue_eval_absentColumn,Y(e.str),e.str.toString(),r.join(", ")))})),this.assertValidInfixTokens(o,!1,a),a}},{key:"parseTokens",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(e){if(n)throw e;r.push(e)},o=e.trim();ee(o)&&a(z.syntaxError(B.valueParser_parseTokens_emptyInput,void 0));for(var i=[];!ee(o);)if((o=o.trim()).startsWith("("))i.push(new Ue(o.slice(0,1))),o=o.slice(1);else if(o.startsWith(")"))i.push(new qe(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("+"))i.push(new De(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("-"))i.push(new Be(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("*"))i.push(new Le(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("/"))i.push(new We(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("=="))i.push(new Fe(ye.equal,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("="))i.push(new Fe(ye.equal,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!="))i.push(new Fe(ye.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<>"))i.push(new Fe(ye.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<="))i.push(new Fe(ye.lessOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith(">="))i.push(new Fe(ye.moreOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<"))i.push(new Fe(ye.less,o.slice(0,1))),o=o.slice(1);else if(o.startsWith(">"))i.push(new Fe(ye.more,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!")||o.startsWith("~")||o.startsWith("\xac"))i.push(new Pe(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("&&"))i.push(new Ae(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("&")||o.startsWith("\u2227"))i.push(new Ae(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("||"))i.push(new Ie(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("|")||o.startsWith("\u2228"))i.push(new Ie(o.slice(0,1))),o=o.slice(1);else if(o.startsWith('"')){var s=te(o);void 0!==s.error&&a(s.error);var l=Z(s.first)>1?-1:void 0,u=s.first.slice(1,l);i.push(new Me(u,u.toString(),"string")),o=s.second}else if(Q.isDigit(o.charAt(0))){var c=o instanceof $?X.nextNumber(o):Q.nextNumber(o);i.push(new Me(c.first,Number(c.first.toString()),"number")),o=c.second}else if(o.startsWith("null"))t||a(z.syntaxError(B.valueParser_parseTokens_unsupportedNull,Y(o.slice(0,4)))),i.push(new Me(o.slice(0,4),null,"null")),o=o.slice(4);else if(o.startsWith("true")||o.startsWith("True")||o.startsWith("TRUE"))i.push(new Me(o.slice(0,4),!0,"boolean")),o=o.slice(4);else if(o.startsWith("false")||o.startsWith("False")||o.startsWith("FALSE"))i.push(new Me(o.slice(0,5),!1,"boolean")),o=o.slice(5);else if(Q.isLetter(o.charAt(0))||"_"===o.charAt(0)){var h=o instanceof $?X.nextName(o):Q.nextName(o);i.push(new He(h.first)),o=h.second}else{var p=o instanceof $?X.nextNonWhitespacePart(o):Q.nextNonWhitespacePart(o);a(z.syntaxError(B.valueParser_parseTokens_unexpectedPart,Y(p.first),p.first.toString())),o=o.slice(Z(p.first))}return i}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0!==e.length){var r=function(e){if(t)throw e;n.push(e)};(e[0]instanceof qe||e[0]instanceof Ve&&!(e[0]instanceof Pe))&&r(z.syntaxError(B.valueParser_rpnToVETree_invalidStart,e[0].getRange(),e[0].str.toString())),(e[e.length-1]instanceof Ue||e[e.length-1]instanceof Ve)&&r(z.syntaxError(B.valueParser_rpnToVETree_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString()));for(var a=1;a<e.length;){var o=e[a-1],i=e[a];++a,i instanceof Me?(o instanceof Me&&r(z.syntaxError(B.valueParser_rpnToVETree_literalAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(z.syntaxError(B.valueParser_rpnToVETree_literalAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof qe&&r(z.syntaxError(B.valueParser_rpnToVETree_literalAfterClosing,i.getRange(),i.str.toString()))):i instanceof He?(o instanceof Me&&r(z.syntaxError(B.valueParser_rpnToVETree_referenceAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(z.syntaxError(B.valueParser_rpnToVETree_referenceAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof qe&&r(z.syntaxError(B.valueParser_rpnToVETree_referenceAfterClosing,i.getRange(),i.str.toString()))):i instanceof Pe?(o instanceof Me&&r(z.syntaxError(B.valueParser_rpnToVETree_notAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof He&&r(z.syntaxError(B.valueParser_rpnToVETree_notAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof qe&&r(z.syntaxError(B.valueParser_rpnToVETree_notAfterClosing,i.getRange(),i.str.toString()))):i instanceof Ve?(o instanceof Ve&&r(z.syntaxError(B.valueParser_rpnToVETree_binaryAfterOperator,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Ue&&r(z.syntaxError(B.valueParser_rpnToVETree_binaryAfterOpening,i.getRange(),i.str.toString()))):i instanceof Ue?(o instanceof Me&&r(z.syntaxError(B.valueParser_rpnToVETree_openingAfterLiteral,i.getRange(),o.str.toString())),o instanceof He&&r(z.syntaxError(B.valueParser_rpnToVETree_openingAfterReference,i.getRange(),o.str.toString())),o instanceof qe&&r(z.syntaxError(B.valueParser_rpnToVETree_openingAfterClosing,i.getRange()))):i instanceof qe&&(o instanceof Ve&&r(z.syntaxError(B.valueParser_rpnToVETree_closingAfterOperator,i.getRange(),o.str.toString())),o instanceof Ue&&r(z.syntaxError(B.valueParser_rpnToVETree_closingAfterOpening,i.getRange())))}}}},{key:"simplify",value:function(e){var t=[],n=new Set;e.forEach((function(e,n){e instanceof Pe&&t.push(n)}));for(var r=1;r<t.length;++r)t[r-1]+1===t[r]&&(n.add(t[r-1]),n.add(t[r]),t[r]=NaN);return 0===n.size?e:e.filter((function(e,t){return!n.has(t)}))}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof Me||e instanceof He)t.push(e);else if(e instanceof Ve){for(;n.length>0&&n[n.length-1]instanceof Ve;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof Ue)n.push(e);else if(e instanceof qe)for(;;){if(0===n.length)throw z.syntaxError(B.valueParser_toRPN_missingOpeningParenthesis,void 0);if(n[n.length-1]instanceof Ue){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof Ue)throw z.syntaxError(B.valueParser_toRPN_missingClosingParenthesis,void 0);t.push(r)}return t}},{key:"rpnToVETree",value:function(e){var t=this.rpnToVETreeRecursive(e);if(e.length>0)throw z.syntaxError(B.valueParser_rpnToVETree_invalidExpression,void 0);return t}},{key:"rpnToVETreeRecursive",value:function(t){if(0===t.length)throw z.syntaxError(B.valueParser_rpnToVETree_invalidExpression,void 0);var n=t.pop();if(n instanceof Pe){var r=e.rpnToVETreeRecursive(t);return Ne.not(n.str,r)}if(n instanceof Ae){var a=e.rpnToVETreeRecursive(t),o=e.rpnToVETreeRecursive(t);return Ne.and(n.str,o,a)}if(n instanceof Ie){var i=e.rpnToVETreeRecursive(t),s=e.rpnToVETreeRecursive(t);return Ne.or(n.str,s,i)}if(n instanceof Fe){var l=e.rpnToVETreeRecursive(t),u=e.rpnToVETreeRecursive(t);return new Re(n.type,n.str.toString(),u,l)}if(n instanceof Me)return new Ce(n.value,n.type);if(n instanceof He)return new Te(n.str);if(n instanceof De){var c=e.rpnToVETreeRecursive(t),h=e.rpnToVETreeRecursive(t);return Oe.add(h,c,n.getRange())}if(n instanceof Be){var p=e.rpnToVETreeRecursive(t),f=e.rpnToVETreeRecursive(t);return Oe.deduct(f,p,n.getRange())}if(n instanceof Le){var d=e.rpnToVETreeRecursive(t),m=e.rpnToVETreeRecursive(t);return Oe.multiply(m,d,n.getRange())}if(n instanceof We){var v=e.rpnToVETreeRecursive(t),g=e.rpnToVETreeRecursive(t);return Oe.divide(g,v,n.getRange())}throw z.codeError(W.valueParser_rpnToVETreeRecursive_unexpectedToken,JSON.stringify(n))}}]),e}(),Ke=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).leftSubtree=void 0,a.rightSubtree=void 0,a.leftSubtree=e,a.rightSubtree=r,a}return Object(h.a)(n,[{key:"getLeftSubtree",value:function(){return this.leftSubtree}},{key:"getRightSubtree",value:function(){return this.rightSubtree}},{key:"fakeEvalBinary",value:function(e,t){var n,r=this.leftSubtree.fakeEval(e),a=this.rightSubtree.fakeEval(e),o=new J("");return"left"!==t&&"union"!==t||r.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),"right"!==t&&"union"!==t||a.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),(n=r.errors).push.apply(n,Object(u.a)(a.errors)),{result:o,whispers:0!==r.whispers.length?r.whispers:a.whispers,errors:r.errors}}}]),n}(he);function Ge(e,t){var n=0;return function e(r){if(n===t)return r;if(n++,r instanceof fe)return e(r.getSubtree());if(r instanceof Ke){var a=e(r.getLeftSubtree());return null===a?e(r.getRightSubtree()):a}return null}(e)}function Qe(e){if(e instanceof Ke){var t=Qe(e.getLeftSubtree()),n=Qe(e.getRightSubtree());return Math.max(t,n)+1}return e instanceof fe?Qe(e.getSubtree())+1:0}function Xe(e,t,n){if(void 0!==t&&n instanceof $&&t.start<e&&e<=t.end){for(var r=t.end-t.start,a=n.toString(),o=e-t.start,i=!1,s=0,l=0;l<r;++l){var u=a.charAt(l);if('"'===u&&s%2===0&&(i=!i),i&&"\\"===u?++s:s=0,l===o-1)return!i}console.warn("isInRangeAndNotInQuotes outside range")}return!1}var $e,Ye=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r)).selection=void 0,o.stringRange=void 0,o.nullValuesSupport=void 0,o.selection=e,o.stringRange=Y(e),o.nullValuesSupport=a,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=ze.parse(this.selection.slice(1,-1),this.nullValuesSupport)}catch(a){throw b(a,this.stringRange)}var n=this.subtree.getResult(),r=new J(n.name+"(...)");n.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.getRows().forEach((function(n){var a=t.eval(n);if("boolean"!==a.type)throw z.syntaxError(B.selectionNode_eval_resultNotBoolean,e.stringRange,e.selection.replace(/\s+/g," "),a.type);a.value&&r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.result,r=t.whispers,a=t.errors,o=new J(n.getName()+"(...)");return n.forEachColumn((function(e,t){o.addColumn(t,e)})),n=o,Xe(e,this.stringRange,this.selection)&&(r=n.getColumnNames()),0===this.selection.toString().slice(1,-1).trim().length?a.push(z.syntaxError(B.valueParser_parseTokens_emptyInput,this.stringRange)):this.selection instanceof $&&a.push.apply(a,Object(u.a)(ze.fakeParse(this.selection.slice(1,-1),this.nullValuesSupport,n.getColumnNames()))),{result:n,whispers:r,errors:a}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return"Selection"}},{key:"getOperationSymbol",value:function(){return this.selection.replace(/\s+/g," ")}}]),n}(fe);!function(e){e.left="\u22b3",e.right="\u22b2"}($e||($e={}));var Ze,et=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e,t,n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult(),a=n.getColumnNames().filter((function(e){return r.hasColumn(e)})),o=new J("("+n.getName()+this.type+r.getName()+")");this.type===$e.left?(n.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=n.getRows(),t=r.getRows()):(r.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=r.getRows(),t=n.getRows()),e.forEach((function(e){if(!t.some((function(t){return a.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var n=new de(o.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),o.addRow(n)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.type===$e.left?"left":"right";return this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return this.type===$e.left?"Left antijoin":"Right antijoin"}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ke),tt=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=new J("("+t.getName()+"\u2a2f"+n.getName()+")");t.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.forEachColumn((function(t,n){if(!r.addColumn(n,t))throw z.semanticError(D.binaryNode_eval_commonColumnsInSources,e.stringRange,"cartesian product",n)})),t.getRows().forEach((function(e){n.getRows().forEach((function(t){var n=new de(r.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),t.getValues().forEach((function(e,t){return n.addValue(t,e)})),r.addRow(n)}))})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t,n=this.leftSubtree.fakeEval(e),r=this.rightSubtree.fakeEval(e),a=new J("");n.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),r.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),(t=n.errors).push.apply(t,Object(u.a)(r.errors));var o=[];return n.result.getColumnNames().forEach((function(e){r.result.hasColumn(e)&&o.push(e)})),o.length>0&&n.errors.push(z.semanticError(D.binaryNode_eval_commonColumnsInSources,this.stringRange,"cartesian product",o.join('", "'))),{result:a,whispers:0!==n.whispers.length?n.whispers:r.whispers,errors:n.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return"Cartesian product"}},{key:"getOperationSymbol",value:function(){return"\u2a2f"}}]),n}(Ke),nt=n(29),rt=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=e.getColumns(),r=t.getColumns();if(!Object(u.a)(r).every((function(e){return n.has(e[0])&&n.get(e[0])===e[1]})))throw z.semanticError(D.divisionNode_eval_rightColumnsNotSubsetOfLeft,this.stringRange,t.getSchemaString(),e.getSchemaString());var a=new Map;if(n.forEach((function(e,t){r.has(t)||a.set(t,e)})),0===a.size)throw z.semanticError(D.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,this.stringRange,t.getNamesSchemaString(),e.getNamesSchemaString());var o=new J("("+e.getName()+"\xf7"+t.getName()+")");a.forEach((function(e,t){return o.addColumn(t,e)}));var i=e.getRows(),s=t.getRows();i.forEach((function(e){if(s.every((function(t){var r=new de(n);return a.forEach((function(t,n){return r.addValue(n,e.getValue(n))})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),Object(u.a)(i).some((function(e){return e.equals(r)}))}))){var t=new de(o.getColumns());a.forEach((function(n,r){return t.addValue(r,e.getValue(r))})),o.addRow(t)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=t.result.getColumns(),a=n.result.getColumns(),o=new Map(Object(u.a)(r.entries()).filter((function(e){var t=Object(nt.a)(e,2),n=t[0];t[1];return!a.has(n)}))),i=new J("("+t.result.getName()+"\xf7"+n.result.getName()+")");o.forEach((function(e,t){return i.addColumn(t,e)}));var s=t.errors;return s.push.apply(s,Object(u.a)(n.errors)),Object(u.a)(a).every((function(e){return r.has(e[0])&&r.get(e[0])===e[1]}))||""===t.result.getName()?0===o.size&&""!==t.result.getName()&&s.push(z.semanticError(D.divisionNode_eval_rightColumnsNotProperSubsetOfLeft,this.stringRange,n.result.getNamesSchemaString(),t.result.getNamesSchemaString())):s.push(z.semanticError(D.divisionNode_eval_rightColumnsNotSubsetOfLeft,this.stringRange,n.result.getSchemaString(),t.result.getSchemaString())),{result:i,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:s}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return"Division"}},{key:"getOperationSymbol",value:function(){return"\xf7"}}]),n}(Ke);!function(e){e.left="*L*",e.right="*R*",e.full="*F*"}(Ze||(Ze={}));var at,ot=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=new J("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return n.addColumn(t,e)})),t.forEachColumn((function(e,t){return n.addColumn(t,e)}));var r=e.getRows(),a=t.getRows(),o=e.getColumnNames().filter((function(e){return t.hasColumn(e)}));r.forEach((function(e){a.forEach((function(t){if(o.every((function(n){return e.getValue(n)===t.getValue(n)}))){var r=new de(n.getColumns());e.getValues().forEach((function(e,t){return r.addValue(t,e)})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),n.addRow(r)}}))})),this.type!==Ze.left&&this.type!==Ze.full||r.forEach((function(e){if(!a.some((function(t){return o.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var t=new de(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.type!==Ze.right&&this.type!==Ze.full||a.forEach((function(e){if(!r.some((function(t){return o.every((function(n){return t.getValue(n)===e.getValue(n)}))}))){var t=new de(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){return this.fakeEvalBinary(e,"union")}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return(this.type===Ze.left?"Left":this.type===Ze.right?"Right":"Full")+" outer join"}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ke);!function(e){e.natural="*",e.leftSemi="<*",e.rightSemi="*>"}(at||(at={}));var it,st=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=t.getColumnNames().filter((function(e){return n.hasColumn(e)})),a=new J("("+t.getName()+this.type+n.getName()+")");this.type!==at.leftSemi&&this.type!==at.natural||t.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==at.rightSemi&&this.type!==at.natural||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),t.getRows().forEach((function(t){n.getRows().forEach((function(n){if(Object(u.a)(r).every((function(e){return t.getValue(e)===n.getValue(e)}))){var o=new de(a.getColumns());e.type!==at.leftSemi&&e.type!==at.natural||t.getValues().forEach((function(e,t){return o.addValue(t,e)})),e.type!==at.rightSemi&&e.type!==at.natural||n.getValues().forEach((function(e,t){return o.addValue(t,e)})),a.addRow(o)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t="union";return this.type===at.leftSemi?t="left":this.type===at.rightSemi&&(t="right"),this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return this.type===at.leftSemi?"Left semijoin":this.type===at.rightSemi?"Right semijoin":"Natural join"}},{key:"getOperationSymbol",value:function(){return"*"}},{key:"getType",value:function(){return this.type}}]),n}(Ke);!function(e){e.union="\u222a",e.intersection="\u2229",e.difference="\\"}(it||(it={}));var lt,ut=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).stringRange=o,i.type=void 0,i.type=e,i}return Object(h.a)(n,[{key:"getTypeStr",value:function(){return this.type===it.union?"Union":this.type===it.intersection?"Intersection":"Difference"}},{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult();if(!Object(F.isEqual)(e.getColumns(),t.getColumns())){var n=this.getTypeStr().toLowerCase();throw z.semanticError(D.setOperationNode_eval_notEqualColumnsInSources,this.stringRange,e.getSchemaString(),t.getSchemaString(),n)}var r=new J("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return r.addColumn(t,e)}));var a=e.getRows(),o=t.getRows();(this.type===it.union?[].concat(Object(u.a)(a),Object(u.a)(o)):this.type===it.intersection?Object(u.a)(a).filter((function(e){return Object(u.a)(o).some((function(t){return e.equals(t)}))})):Object(u.a)(a).filter((function(e){return!Object(u.a)(o).some((function(t){return e.equals(t)}))}))).forEach((function(e){return r.addRow(e)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=new J("("+t.result.getName()+this.type+n.result.getName()+")");t.result.forEachColumn((function(e,t){n.result.hasColumn(t)&&r.addColumn(t,e)}));var a=t.errors;if(a.push.apply(a,Object(u.a)(n.errors)),!Object(F.isEqual)(t.result.getColumns(),n.result.getColumns())&&""!==t.result.getName()&&""!==n.result.getName()){var o=this.getTypeStr().toLowerCase();a.push(z.semanticError(D.setOperationNode_eval_notEqualColumnsInSources,this.stringRange,t.result.getSchemaString(),n.result.getSchemaString(),o))}return{result:r,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:a}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return this.getTypeStr()}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Ke);!function(e){e.full="[]",e.left="<]",e.right="[>"}(lt||(lt={}));var ct,ht=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o,i){var s;return Object(c.a)(this,n),(s=t.call(this,a,o)).type=void 0,s.condition=void 0,s.stringRange=void 0,s.nullValuesSupport=void 0,s.condition=r,s.stringRange=Y(r),s.nullValuesSupport=i,s.type=e,s}return Object(h.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=ze.parse(this.condition.slice(1,-1),this.nullValuesSupport)}catch(i){throw b(i,this.stringRange)}var n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult();n.getColumnNames().forEach((function(t){if(r.hasColumn(t))throw z.semanticError(D.binaryNode_eval_commonColumnsInSources,e.stringRange,e.getOperationName().toLowerCase(),t)}));var a=new J("("+n.getName()+this.type.charAt(0)+"..."+this.type.charAt(1)+r.getName()+")");this.type!==lt.left&&this.type!==lt.full||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==lt.right&&this.type!==lt.full||r.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=new Map(n.getColumns());r.forEachColumn((function(e,t){return o.set(t,e)})),n.getRows().forEach((function(n){r.getRows().forEach((function(r){var i=new de(o);n.getValues().forEach((function(e,t){return i.addValue(t,e)})),r.getValues().forEach((function(e,t){return i.addValue(t,e)}));var s=t.eval(i);if("boolean"!==s.type)throw z.syntaxError(B.thetaSemiJoinNode_eval_resultNotBoolean,e.stringRange,e.condition.replace(/\s+/g," "),s.type);if(s.value){var l=new de(a.getColumns());e.type!==lt.left&&e.type!==lt.full||n.getValues().forEach((function(e,t){return l.addValue(t,e)})),e.type!==lt.right&&e.type!==lt.full||r.getValues().forEach((function(e,t){return l.addValue(t,e)})),a.addRow(l)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=[];r.push.apply(r,Object(u.a)(t.result.getColumnNames())),r.push.apply(r,Object(u.a)(n.result.getColumnNames()));var a=new J("");this.type!==lt.left&&this.type!==lt.full||t.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==lt.right&&this.type!==lt.full||n.result.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=0!==t.whispers.length?t.whispers:n.whispers;Xe(e,this.stringRange,this.condition)&&(o=r);var i=t.errors;i.push.apply(i,Object(u.a)(n.errors));var s=[];return t.result.getColumnNames().forEach((function(e){n.result.hasColumn(e)&&s.push(e)})),s.length>0&&void 0!==this.stringRange&&i.push(z.semanticError(D.binaryNode_eval_commonColumnsInSources,{start:this.stringRange.start,end:this.stringRange.start},this.getOperationName().toLowerCase(),s.join('", "'))),0===this.condition.toString().slice(1,-1).trim().length?i.push(z.syntaxError(B.valueParser_parseTokens_emptyInput,this.stringRange)):this.condition instanceof $&&i.push.apply(i,Object(u.a)(ze.fakeParse(this.condition.slice(1,-1),this.nullValuesSupport,r))),{result:a,whispers:o,errors:i}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return this.type===lt.left?"Left theta semijoin":this.type===lt.right?"Right theta semijoin":"Theta join"}},{key:"getOperationSymbol",value:function(){return this.condition.replace(/\s+/g," ")}},{key:"getType",value:function(){return this.type}}]),n}(Ke),pt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"createUnary",value:function(e,t,n,r){switch(e){case"projection":return new be(r,t);case"rename":return new ke(r,t);case"selection":return new Ye(r,t,n)}}},{key:"createBinary",value:function(e,t,n,r,a){switch(e){case"left antijoin":return new et($e.left,t,n);case"right antijoin":return new et($e.right,t,n);case"cartesian product":return new tt(t,n,Y(a));case"division":return new rt(t,n,Y(a));case"natural join":return new st(at.natural,t,n);case"left outer join":return new ot(Ze.left,t,n);case"right outer join":return new ot(Ze.right,t,n);case"full outer join":return new ot(Ze.full,t,n);case"left semijoin":return new st(at.leftSemi,t,n);case"right semijoin":return new st(at.rightSemi,t,n);case"union":return new ut(it.union,t,n,Y(a));case"intersection":return new ut(it.intersection,t,n,Y(a));case"difference":return new ut(it.difference,t,n,Y(a));case"theta join":return new ht(lt.full,a,t,n,r);case"left theta semijoin":return new ht(lt.left,a,t,n,r);case"right theta semijoin":return new ht(lt.right,a,t,n,r)}}}]),e}();!function(e){e[e.NOT_THROW=0]="NOT_THROW",e[e.THROW_STRICT=1]="THROW_STRICT",e[e.THROW_NOT_STRICT=2]="THROW_NOT_STRICT"}(ct||(ct={}));var ft=function(){function e(t,n){Object(c.a)(this,e),this.relations=t,this.nullValuesSupport=n}return Object(h.a)(e,[{key:"parse",value:function(e){if(""===(e=Q.deleteCommentLines(e)).trim())throw z.syntaxError(B.exprParser_parse_emptyStringGiven,void 0);var t=this.parseTokens(e);this.assertValidInfixTokens(t,ct.THROW_STRICT);var n=this.toRPN(t);return this.rpnToRATree(n,!0)}},{key:"indexedParse",value:function(e){var t=X.deleteCommentLines($.new(e));if(t.trim().isEmpty())throw z.syntaxError(B.exprParser_parse_emptyStringGiven,void 0);var n=this.parseTokens(t);this.assertValidInfixTokens(n,ct.THROW_STRICT);var r=this.toRPN(n);return this.rpnToRATree(r,!0)}},{key:"fakeParse",value:function(e,t){if(""===e.trim())return{whispers:Object(u.a)(this.relations.keys()),errors:[]};var n=X.deleteCommentLines($.new(e)),r=this.fakeParseTokens(n,t),a=r.whispers,o=r.tokens,i=r.errors;if(0===o.length)return{whispers:a,errors:i};this.assertValidInfixTokens(o,ct.NOT_THROW,i);var s=this.toRPN(o),l=this.rpnToRATree(s,!1,i).fakeEval(t);return i.push.apply(i,Object(u.a)(l.errors)),l.whispers.length>0?{whispers:l.whispers,errors:i}:{whispers:a,errors:i}}},{key:"parseTokens",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=[],a=e;!ee(a);)if((a=a.trim()).startsWith("(")){var o,i=ne(a,"(",")");if(t)n.push(ue.selection(i.first));else n.push(new ie(i.first.slice(0,1))),(o=n).push.apply(o,Object(u.a)(this.parseTokens(i.first.slice(1,-1)))),n.push(new se(i.first.slice(-1))),t=!0;a=i.second}else if(a.startsWith("[")){var s=ne(a,"[","]>");if(!s.first.endsWith(">")){if(ee(s.second)){n.push(ue.projection(s.first));break}var l=void 0,c=void 0;try{var h,p;(h=r).push.apply(h,Object(u.a)(n)),r.push(ce.thetaJoin(s.first)),(p=r).push.apply(p,Object(u.a)(this.parseTokens(s.second,!1)))}catch(y){if(y instanceof U)throw y;l=y}try{var f;n.push(ue.projection(s.first)),(f=n).push.apply(f,Object(u.a)(this.parseTokens(s.second,!0)))}catch(y){if(y instanceof U)throw y;c=y}if(void 0!==l&&void 0!==c){if(l.message===c.message)throw c;throw z.syntaxError(B.exprParser_parseTokens_bothBranchesError,void 0,s.first.toString(),c.message,l.message)}void 0!==l&&(r=[]),void 0!==c&&(n=r,r=[]);break}n.push(ce.rightThetaSemijoin(s.first)),t=!1,a=s.second}else if(a.startsWith("*F*")||a.startsWith("*L*")||a.startsWith("*R*")){if(!this.nullValuesSupport){var d=void 0;throw a instanceof $&&void 0!==a.getFirstNonNaNIndex()&&(d={start:a.getFirstNonNaNIndex(),end:a.getFirstNonNaNIndex()+2}),z.syntaxError(B.exprParser_parseTokens_outerJoinWhenNullNotSupported,d,"*F*")}a.startsWith("*F")?n.push(ce.fullOuterJoin(a.slice(0,3))):a.startsWith("*L")?n.push(ce.leftOuterJoin(a.slice(0,3))):n.push(ce.rightOuterJoin(a.slice(0,3))),a=a.slice(3),t=!1}else if(a.startsWith("<*"))n.push(ce.leftSemijoin(a.slice(0,2))),a=a.slice(2),t=!1;else if(a.startsWith("*>"))n.push(ce.rightSemijoin(a.slice(0,2))),a=a.slice(2),t=!1;else if(a.startsWith("*"))n.push(ce.naturalJoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u2a2f"))n.push(ce.cartesianProduct(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u222a"))n.push(ce.union(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u2229"))n.push(ce.intersection(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\\"))n.push(ce.difference(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u22b3"))n.push(ce.leftAntijoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u22b2"))n.push(ce.rightAntijoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\xf7"))n.push(ce.division(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("<")){var m=ne(a,"<",">]","-");m.first.endsWith(">")?(n.push(ue.rename(m.first)),t=!0):(n.push(ce.leftThetaSemijoin(m.first)),t=!1),a=m.second}else{if(!Q.isLetter(a.charAt(0))&&"_"!==a.charAt(0)){var v=a instanceof $?X.nextNonWhitespacePart(a):Q.nextNonWhitespacePart(a);throw z.syntaxError(B.exprParser_parseTokens_unexpectedPart,Y(v.first),v.first.toString())}var g=a instanceof $?X.nextName(a):Q.nextName(a);n.push(new le(g.first)),a=g.second,t=!0}if(r.length>0)try{return this.assertValidInfixTokens(r,ct.THROW_NOT_STRICT,[]),r}catch(b){}return n}},{key:"fakeParseTokens",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],a=[],o=[],i=e;!i.isEmpty();){var s=i.getFirstNonNaNIndex();if(s===t&&(r=Object(u.a)(this.relations.keys())),i.startsWith("(")){var l=void 0;try{l=X.nextBorderedPart(i,"(",")")}catch(j){if(j instanceof y&&o.push(j),n)a.push(ue.selection(i.concat($.newFromArray([{char:" ",index:i.getNextIndexOrNaN()},{char:")",index:NaN}]))));else{var c;s===t-1&&(r=Object(u.a)(this.relations.keys())),a.push(new ie(i.slice(0,1)));var h=this.fakeParseTokens(i.slice(1),t);o.push.apply(o,Object(u.a)(h.errors)),(c=r).push.apply(c,Object(u.a)(h.whispers)),a.push.apply(a,Object(u.a)(h.tokens)),a.push(new se($.new(")",NaN)))}break}if(n)a.push(ue.selection(l.first));else{var p;a.push(new ie(l.first.slice(0,1)));var f=this.fakeParseTokens(l.first.slice(1,-1),t);o.push.apply(o,Object(u.a)(f.errors)),(p=r).push.apply(p,Object(u.a)(f.whispers)),a.push.apply(a,Object(u.a)(f.tokens)),a.push(new se(l.first.slice(-1))),n=!0}i=l.second}else if(i.startsWith("[")){var d=void 0,m=!1;try{d=X.nextBorderedPart(i,"[","]>")}catch(j){m=!0,j instanceof y&&o.push(j),d={first:i.concat($.new("]",i.getNextIndexOrNaN())),second:$.empty()}}var v=d.first.getLastNonNaNIndex();m||v!==t-1||(r=Object(u.a)(this.relations.keys())),d.first.endsWith(">")?(a.push(ce.rightThetaSemijoin(d.first)),n=!1,i=d.second):re(d.first,'=<>+/*&|~"()!')?(a.push(ce.thetaJoin(d.first)),n=!1,i=d.second):(a.push(ue.projection(d.first)),n=!0,i=d.second)}else if(i.startsWith("*F*")||i.startsWith("*L*")||i.startsWith("*R*")){var g=i.slice(0,3),b=g.getLastNonNaNIndex();b===t-1&&(r=Object(u.a)(this.relations.keys())),i.startsWith("*F")?a.push(ce.fullOuterJoin(g)):i.startsWith("*L")?a.push(ce.leftOuterJoin(g)):a.push(ce.rightOuterJoin(g)),i=i.slice(3),n=!1}else if(i.startsWith("<*")||i.startsWith("*>")){var x=i.slice(0,2),E=x.getLastNonNaNIndex();E===t-1&&(r=Object(u.a)(this.relations.keys())),i.startsWith("<*")?a.push(ce.leftSemijoin(x)):a.push(ce.rightSemijoin(x)),i=i.slice(2),n=!1}else if("*\u2a2f\u222a\u2229\\\u22b3\u22b2\xf7".indexOf(i.charAt(0))>-1){var k=i.slice(0,1),_=k.getLastNonNaNIndex();_===t-1&&(r=Object(u.a)(this.relations.keys())),i.startsWith("*")?a.push(ce.naturalJoin(k)):i.startsWith("\u2a2f")?a.push(ce.cartesianProduct(k)):i.startsWith("\u222a")?a.push(ce.union(k)):i.startsWith("\u2229")?a.push(ce.intersection(k)):i.startsWith("\\")?a.push(ce.difference(k)):i.startsWith("\u22b3")?a.push(ce.leftAntijoin(k)):i.startsWith("\u22b2")?a.push(ce.rightAntijoin(k)):i.startsWith("\xf7")&&a.push(ce.division(k)),i=i.slice(1),n=!1}else if(i.startsWith("<"))try{var w=X.nextBorderedPart(i,"<",">]","-"),R=w.first.getLastNonNaNIndex();R===t-1&&(r=Object(u.a)(this.relations.keys())),w.first.endsWith(">")?(a.push(ue.rename(w.first)),n=!0):(a.push(ce.leftThetaSemijoin(w.first)),n=!1),i=w.second}catch(V){a.push(ue.rename(i.concat($.new(">",i.getNextIndexOrNaN()))));break}else if(Q.isLetter(i.charAt(0))||"_"===i.charAt(0)){var S=X.nextName(i),N=S.first.getFirstNonNaNIndex(),C=S.first.getLastNonNaNIndex();"number"===typeof N&&"number"===typeof C&&N<=t-1&&t-1<=C&&(r=Object(u.a)(this.relations.keys())),a.push(new le(S.first)),i=S.second,n=!0}else if(i.charAt(0).match(/\s/)){for(var T=0;T<i.length()&&i.charAt(T).match(/\s/);)i.indexAt(T)===t-1&&(r=Object(u.a)(this.relations.keys())),++T;i=i.slice(T)}else{var O=X.nextNonWhitespacePart(i);o.push(z.syntaxError(B.exprParser_parseTokens_unexpectedPart,Y(O.first),O.first.toString())),i=i.slice(O.first.length())}}return{tokens:a,whispers:r,errors:o}}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(r,a,o,i){for(var s=arguments.length,l=new Array(s>4?s-4:0),u=4;u<s;u++)l[u-4]=arguments[u];var c=z.syntaxError.apply(z,[o,i].concat(l));if(t!==ct.NOT_THROW)throw c;"binary"===a?(n.push(c),e.splice(r,0,ce.naturalJoin("*"))):(n.push(c),e.splice(r,0,new le("")))};t!==ct.THROW_NOT_STRICT&&(e[0]instanceof ue||e[0]instanceof ce||e[0]instanceof se)&&r(0,"relation",B.exprParser_assertValidInfixTokens_invalidStart,e[0].getRange(),e[0].str.toString()),(e[e.length-1]instanceof ie||e[e.length-1]instanceof ce)&&r(e.length,"relation",B.exprParser_assertValidInfixTokens_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString());for(var a=1;a<e.length;){var o=e[a-1],i=e[a];if(i instanceof le)o instanceof le&&r(a,"binary",B.exprParser_assertValidInfixTokens_relationAfterRelation,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ue&&r(a,"binary",B.exprParser_assertValidInfixTokens_relationAfterUnary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof se&&r(a,"binary",B.exprParser_assertValidInfixTokens_relationAfterClosing,i.getRange(),i.str.toString());else if(i instanceof ue)o instanceof ce&&r(a,"relation",B.exprParser_assertValidInfixTokens_unaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ie&&r(a,"relation",B.exprParser_assertValidInfixTokens_unaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof ce)o instanceof ce&&r(a,"relation",B.exprParser_assertValidInfixTokens_binaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ie&&r(a,"relation",B.exprParser_assertValidInfixTokens_binaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof ie)o instanceof le&&r(a,"binary",B.exprParser_assertValidInfixTokens_openingAfterRelation,i.getRange(),o.str.toString()),o instanceof ue&&r(a,"binary",B.exprParser_assertValidInfixTokens_openingAfterUnary,i.getRange(),o.str.toString()),o instanceof se&&r(a,"binary",B.exprParser_assertValidInfixTokens_openingAfterClosing,i.getRange());else{if(!(i instanceof se))throw z.codeError(W.exprParser_isValidSequence_unexpectedToken,JSON.stringify(i));o instanceof ce&&r(a,"relation",B.exprParser_assertValidInfixTokens_closingAfterBinary,i.getRange(),o.str.toString()),o instanceof ie&&r(a,"relation",B.exprParser_assertValidInfixTokens_closingAfterOpening,i.getRange())}++a}}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof le||e instanceof ue)t.push(e);else if(e instanceof ce){for(;n.length>0&&n[n.length-1]instanceof ce;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof ie)n.push(e);else if(e instanceof se)for(;;){if(0===n.length)throw z.syntaxError(B.exprParser_assertValidInfixTokens_invalidParentheses,void 0);if(n[n.length-1]instanceof ie){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof ie)throw z.syntaxError(B.exprParser_assertValidInfixTokens_invalidParentheses,void 0);t.push(r)}return t}},{key:"rpnToRATree",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.rpnToRATreeRecursive(e,t,n);if(e.length>0){if(t)throw z.syntaxError(B.exprParser_rpnToVETree_invalidExpression,void 0);return new pe(new J(""))}return r}},{key:"rpnToRATreeRecursive",value:function(e,t,n){if(0===e.length)throw z.syntaxError(B.exprParser_rpnToVETree_invalidExpression,void 0);var r=e.pop();if(r instanceof le){var a=this.relations.get(r.str.toString());if(void 0===a){var o=z.semanticError(D.exprParser_parse_relationNotDefined,r.getRange(),r.str.toString());if(t)throw o;return n.push(o),new pe(new J(""))}return new pe(a)}if(r instanceof ue){var i=this.rpnToRATreeRecursive(e,t,n);return pt.createUnary(r.type,i,this.nullValuesSupport,r.str)}if(r instanceof ce){var s=this.rpnToRATreeRecursive(e,t,n),l=this.rpnToRATreeRecursive(e,t,n);return pt.createBinary(r.type,l,s,this.nullValuesSupport,r.str)}throw z.codeError(W.exprParser_rpnToVETreeRecursive_unexpectedToken,JSON.stringify(r))}}]),e}(),dt=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).inputRef=void 0,r.handleChange=function(e){e=e.replace(/\t/g,"    ");var t=r.props.forbidden(e);r.setState({value:e,buttonDisable:t})},r.handleKeyDown=function(e){"Enter"===e.key?r.state.buttonDisable||r.handleSubmit():"Escape"!==e.key&&"Esc"!==e.key||null!==r.inputRef.current&&r.inputRef.current.blur()},r.handleSubmit=function(){r.props.onSubmit(r.state.value)},r.state={value:r.props.value,buttonDisable:r.props.forbidden(r.props.value)},r.inputRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement("label",{htmlFor:this.props.id},this.props.label),a.a.createElement("input",{ref:this.inputRef,type:"text",id:this.props.id,spellCheck:!1,autoComplete:"off",value:this.state.value,onChange:function(t){return e.handleChange(t.target.value)},onKeyDown:this.handleKeyDown,className:"text-input"}),a.a.createElement("button",{onClick:this.handleSubmit,disabled:this.state.buttonDisable},this.props.buttonText))}}]),n}(a.a.Component),mt=(n(39),getComputedStyle(document.querySelector(":root"))),vt=Number(mt.getPropertyValue("--message-box-margin-num")),gt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"init",value:function(){var t=document.createElement("div");t.classList.add("message-box"),t.style.visibility="hidden",t.onmouseenter=function(){e.clearHideTimeout()},t.onmouseleave=function(){e.setHideTimeout()};var n=document.createElement("p");t.appendChild(n);var r=document.createElement("button");return r.innerText="\u2716",r.onclick=function(){e.hideBox()},t.appendChild(r),window.addEventListener("resize",(function(){e.moveBox()})),document.body.appendChild(t),t}},{key:"display",value:function(t,n){var r=e.box;r.firstElementChild.innerText=t,r.style.visibility="visible",r.classList.toggle("message-box-message",!n),r.classList.toggle("message-box-error",n),e.moveBox(),e.setHideTimeout()}},{key:"message",value:function(t){e.display(t,!1)}},{key:"error",value:function(t){e.display(t,!0)}}]),e}();gt.hideTimeout=5e3,gt.box=gt.init(),gt.hideIntervalId=void 0,gt.setHideTimeout=function(){gt.clearHideTimeout(),gt.hideIntervalId=setTimeout(gt.hideBox,gt.hideTimeout)},gt.clearHideTimeout=function(){clearTimeout(gt.hideIntervalId)},gt.hideBox=function(){gt.box.style.visibility="hidden"},gt.moveBox=function(){"visible"===gt.box.style.visibility&&(gt.box.style.width=document.body.clientWidth-2*vt+"px")};var yt=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).unaryButtons=[{key:"unary_a",char:"()",text:"()",tooltip:"Selection",shift:1},{key:"unary_b",char:"[]",text:"[]",tooltip:"Projection",shift:1},{key:"unary_c",char:"< -> >",text:"<>",tooltip:"Rename",shift:5}],r.setOperatorsButtons=[{key:"set_a",char:"\u222a",text:"\u222a",tooltip:"Union",shift:0},{key:"set_b",char:"\u2229",text:"\u2229",tooltip:"Intersection",shift:0},{key:"set_c",char:"\\",text:"\\",tooltip:"Difference",shift:0}],r.innerJoinsButtons=[{key:"inner_a",char:"*",text:"*",tooltip:"Natural join",shift:0},{key:"inner_b",char:"\u2a2f",text:"\u2a2f",tooltip:"Cartesian product",shift:0},{key:"inner_c",char:"<*",text:"<*",tooltip:"Left semijoin",shift:0},{key:"inner_d",char:"*>",text:"*>",tooltip:"Right semijoin",shift:0},{key:"inner_e",char:"\u22b3",text:"\u22b3",tooltip:"Left antijoin",shift:0},{key:"inner_f",char:"\u22b2",text:"\u22b2",tooltip:"Right antijoin",shift:0},{key:"inner_g",char:"[]",text:"[]",tooltip:"Theta join",shift:1},{key:"inner_h",char:"<]",text:"<]",tooltip:"Left theta semijoin",shift:1},{key:"inner_i",char:"[>",text:"[>",tooltip:"Right theta semijoin",shift:1}],r.outerJoinsButtons=[{key:"outer_a",char:"*F*",text:"*F*",tooltip:"Full outer join",shift:0},{key:"outer_b",char:"*L*",text:"*L*",tooltip:"Left outer join",shift:0},{key:"outer_c",char:"*R*",text:"*R*",tooltip:"Right outer join",shift:0}],r.divisionButton=[{key:"division",char:"\xf7",text:"\xf7",tooltip:"Division",shift:0}],r.specialButtons=[{key:"special_a",char:"//",text:"//",tooltip:"Comment",shift:0}],r.textAreaRef=void 0,r.lastChange=0,r.lastWhisperAndErrorsUpdate=0,r.whispersAndErrorsUpdateRate=200,r.updateErrors=function(){var e=r.getCurExpr().text,t=new ft(r.props.relations,r.props.nullValuesSupport).fakeParse(e,r.state.cursorIndex).errors;r.setState({errors:t.filter((function(e){return void 0!==e.range})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}}))})},r.evalExpr=function(){try{var e=new ft(r.props.relations,r.props.nullValuesSupport).indexedParse(r.props.expressions[r.props.currentExpressionIndex].text);e.eval(),r.setState({errors:[]}),r.props.onEval(e)}catch(t){t instanceof y&&void 0!==t.range&&(t.range.end+=1,r.setState((function(e){var n=e.errors;return n.every((function(e){return e.start!==t.range.start||e.end!==t.range.end}))&&n.push(Object(d.a)(Object(d.a)({},t.range),{},{msg:t.message})),{errors:n}}))),r.showError(t)}},r.newExpression=function(){r.props.onNewExpression()},r.deleteExpression=function(){r.props.onDeleteExpression(r.updateErrors)},r.saveExpressions=function(){r.props.onExportExpressions(gt.message)},r.loadExpressions=function(){r.setState({errors:[]}),r.props.onImportExpressions((function(e){gt.message(e),r.updateErrors()}))},r.addSpecialString=function(e,t){var n=r.textAreaRef.current.getSelection(),a=n.start,o=n.end,i=r.getCurExpr().text.substring(0,a),s=r.getCurExpr().text.substring(o),l=i.length+e.length-t,u=i+e+s;r.handleExprChange(u,l,(function(){r.textAreaRef.current.setSelection(l),r.textAreaRef.current.focus()}))},r.handleExprChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};r.props.onChange(r.getCurExpr().name,e),r.setState({cursorIndex:t},n),r.lastChange=Date.now()},r.handleCtrlInput=function(e){"Enter"===e.key&&r.evalExpr()},r.updateWhispersAndErrors=function(){var e=r.textAreaRef.current;if(null!==e&&e.isFocused()&&r.lastChange>r.lastWhisperAndErrorsUpdate){var t=r.getCurExpr().text,n=new ft(r.props.relations,r.props.nullValuesSupport).fakeParse(t,r.state.cursorIndex),a=t.slice(_(t,r.state.cursorIndex),r.state.cursorIndex),o=function(e,t){var n=e.map((function(e){var n=0,r=e.toLowerCase().indexOf(t.toLowerCase());if(r>-1){n+=0===r?2:1;var a=r+t.length;e=e.slice(0,r)+"<span class='whisper-matched-word'>"+e.slice(r,a)+"</span>"+e.slice(a)}return 0===n&&(e="<span class='whisper-rejected-word'>"+e+"</span>"),{whisper:e,likelihood:n}}));return""!==t&&n.sort((function(e,t){return t.likelihood-e.likelihood})),n.map((function(e){return e.whisper}))}(n.whispers,a);r.setState({whispers:o,errors:n.errors.filter((function(e){return void 0!==e.range})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}}))}),r.lastWhisperAndErrorsUpdate=Date.now()}},r.handleExprNameChange=function(e){r.props.onChange(e,r.getCurExpr().text)},r.showError=function(e){e instanceof x||e instanceof E?gt.error(e.message):(r.props.onUnexpectedError(e),gt.error("UNEXPECTED ERROR: "+e.message+"\nPlease, report it with your last actions, thank you!"))},r.state={sectionClicked:!1,whispers:[],errors:[],cursorIndex:0},r.textAreaRef=a.a.createRef(),setInterval((function(){return r.updateWhispersAndErrors()}),r.whispersAndErrorsUpdateRate),r}return Object(h.a)(n,[{key:"getCurExpr",value:function(){return this.props.expressions[this.props.currentExpressionIndex]}},{key:"handleSelectDifferentExpression",value:function(e){this.setState({errors:[]}),this.props.onSelectDifferentExpression(e)}},{key:"render",value:function(){var e=this,t=function(e,t,n,r){return a.a.createElement(m,{key:e,text:e,onClick:t,className:"",style:r,tooltip:n,tooltipClassName:"tooltip"})},n=function(t){return t.map((function(n,r){var o=r===t.length-1?{marginRight:"10px"}:void 0;return a.a.createElement(m,{key:n.key,text:n.text,onClick:function(){return e.addSpecialString(n.char,n.shift)},className:"",tooltip:n.tooltip,tooltipClassName:"tooltip",style:o})}))};return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,"Expressions"),t("Import",this.loadExpressions,"Loads expressions from a file"),t("Export",this.saveExpressions,"Saves expressions to a file")),a.a.createElement("menu",{className:"page-section-tab-menu"},e.props.expressions.map((function(t,n){var r=e.props.currentExpressionIndex===n?"button-clicked":"";return a.a.createElement("button",{key:n,onClick:function(){return e.handleSelectDifferentExpression(n)},className:r},t.name)})),a.a.createElement("button",{onClick:this.newExpression,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(P,{ref:this.textAreaRef,id:"expression-section-textarea",text:this.getCurExpr().text,placeholder:"Write RA expression here...",errors:this.state.errors,whispers:this.state.whispers,onChange:this.handleExprChange,onCtrlInput:this.handleCtrlInput,darkTheme:this.props.darkTheme}),a.a.createElement("menu",{className:"expressions-operators-menu"},n(this.unaryButtons),n(this.setOperatorsButtons),n(this.innerJoinsButtons),this.props.nullValuesSupport?n(this.outerJoinsButtons):null,n(this.divisionButton),n(this.specialButtons)),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(m,{key:"Evaluate",text:"Evaluate",onClick:this.evalExpr,className:"action-button",style:{marginRight:"40px"},tooltip:"Evaluates given RA expression",tooltipClassName:"tooltip"}),a.a.createElement(dt,{label:"",value:this.getCurExpr().name,buttonText:"Rename",onSubmit:this.handleExprNameChange,forbidden:function(){return!1},id:"expression-name-input"}),t("Delete",this.deleteExpression,"Deletes current RA expression")))}}]),n}(a.a.Component),bt=n(26),xt=n.n(bt),Et=(n(40),function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).getOrderByText=function(){return 1===r.state.orderDir?" \u25bc":" \u25b2"},r.state={orderBy:-1,orderDir:1},r}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.relation!==this.props.relation&&this.setState({orderDir:1,orderBy:-1})}},{key:"updateOrderBy",value:function(e){this.setState((function(t){return t.orderBy===e?{orderDir:-t.orderDir,orderBy:e}:{orderDir:1,orderBy:e}}))}},{key:"createHeaderRow",value:function(e){var t=this;return a.a.createElement("tr",null,a.a.createElement("td",{className:"row-number-td"}),e.map((function(e,n){var r=t.state.orderBy===n?e+t.getOrderByText():e;return a.a.createElement("th",{key:n,onClick:function(){return t.updateOrderBy(n)}},r)})))}},{key:"createRows",value:function(e){var t=this;if(0===this.props.relation.getRowsCount())return a.a.createElement("tr",{key:"1"},a.a.createElement("td",{className:"row-number-td"}),a.a.createElement("td",{key:"1",colSpan:e.length},"<<NO ROWS>>"));var n=this.props.relation.getRows();if(this.state.orderBy>-1&&this.state.orderBy<e.length){var r=e[this.state.orderBy];"number"===n[0].getType(r)?n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*(e.getValue(r)-n.getValue(r)):0})):n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*String(e.getValue(r)).localeCompare(String(n.getValue(r))):0}))}return n.map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1),t.getOrderedPrintValues(e).map((function(e,t){return a.a.createElement("td",{key:t},e)})))}))}},{key:"render",value:function(){var e=this.props.relation.getColumnNames(),t=this.createHeaderRow(e),n=this.createRows(e);return a.a.createElement("div",{className:"result-table-container"},a.a.createElement("table",{className:"result-table"},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,n)))}}]),n}(a.a.Component)),kt=n(72),_t=n(28),wt=n(74),Rt=n(73),St=n(27),Nt=n.n(St),Ct=n(71),Tt=(n(41),function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(Nt.a,null,(function(t){var n=t.width;return a.a.createElement(zt,{raTree:e.props.tree,selected:e.props.selected,width:n,onClick:e.props.onClick,darkTheme:e.props.darkTheme})}))}}]),n}(a.a.Component)),Ot=getComputedStyle(document.querySelector(":root")),jt=Ot.getPropertyValue("--eval-tree-font-size"),Vt=Ot.getPropertyValue("--eval-tree-font-family"),Pt=k(Vt,jt),At=Pt.fontWidth,It=Pt.fontHeight,Lt=2*It+24,Wt=Ot.getPropertyValue("--light-color-a"),Dt=Ot.getPropertyValue("--dark-color-a"),Bt=Ot.getPropertyValue("--text-color-light"),Ft=Ot.getPropertyValue("--text-color-dark"),Jt=Ot.getPropertyValue("--light-color-c"),Ut=Ot.getPropertyValue("--light-color-b"),qt=Ot.getPropertyValue("--dark-color-d"),Mt=Ot.getPropertyValue("--dark-color-c");function Ht(e){var t=e.node,n=e.selected,r=e.onClick,o=e.darkTheme,i=Object(Ct.a)(),s=i.tooltipOpen,l=i.showTooltip,u=i.hideTooltip,c=Math.max(t.data.title.length,t.data.symbol.length)*At+24;return c<Lt&&(c=Lt),a.a.createElement(kt.a,{top:t.y,left:t.x},a.a.createElement("rect",{height:Lt,width:c,y:-Lt/2,x:-c/2,rx:20,fill:o?n||s?qt:Mt:n||s?Jt:Ut,onClick:function(){r(t.data.index)},cursor:"pointer",onMouseOver:function(){l({tooltipLeft:0,tooltipTop:0})},onMouseOut:u}),a.a.createElement("text",{y:"-4px",dy:".2em",fontSize:jt,fontFamily:Vt,textAnchor:"middle",style:{pointerEvents:"none"},fill:o?Ft:Bt},""===t.data.symbol?a.a.createElement("tspan",{x:"0",dy:".5em"},t.data.title):a.a.createElement(a.a.Fragment,null,a.a.createElement("tspan",{x:"0",dy:"0"},t.data.title),a.a.createElement("tspan",{x:"0",dy:"1.2em"},t.data.symbol))))}function zt(e){var t=e.raTree,n=e.selected,r=e.width,o=e.onClick,i=e.darkTheme,s=Qe(t),l=(s+1)*Lt+s*Lt/2+Lt,u={top:Lt,left:0,right:0,bottom:Lt},c=l-u.top-u.bottom,h=r-u.left-u.right,p=function(e){var t=0;return function e(n){var r=n.getOperationSymbol();return r.length>30&&(r=r.slice(0,26)+"..."+r.charAt(r.length-1)),n instanceof fe?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getSubtree())]}:n instanceof Ke?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getLeftSubtree()),e(n.getRightSubtree())]}:{title:n.getOperationName(),symbol:r,index:t++}}(e)}(t),f=Object(_t.b)(p);return r<10?null:a.a.createElement("svg",{id:"eval-tree-svg",width:r,height:l},a.a.createElement("rect",{width:r,height:l,rx:14,fill:i?Dt:Wt}),a.a.createElement(wt.a,{root:f,size:[h,c]},(function(e){return a.a.createElement(kt.a,{top:u.top,left:u.left},e.links().map((function(e,t){return a.a.createElement(Rt.a,{key:"cluster-link-".concat(t),data:e,stroke:i?Ft:Bt,strokeWidth:"1",strokeOpacity:1,fill:"none"})})),e.descendants().map((function(e){return a.a.createElement(Ht,{key:"node-".concat(e.data.index),node:e,selected:e.data.index===n,onClick:o,darkTheme:i})})))})))}var Kt=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"openFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(e,">");var r=n.firstChild;r.addEventListener("change",(function(){var e=r.files[0],n=new FileReader;n.onload=function(){t({name:e.name,text:n.result})},n.readAsText(e)})),r.click()}))}},{key:"openFiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(n){e.openFilesHelper(n,t)}))}},{key:"openFilesHelper",value:function(e,t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(t," multiple>");var r=n.firstChild,a=[];r.addEventListener("change",(function(){var t=r.files;!function n(r){if(r===t.length)return e(a);var o=t[r],i=new FileReader;i.onload=function(e){a.push({name:o.name,text:e.target.result}),n(r+1),console.log("File "+(r+1)+"/"+t.length+" loaded")},i.readAsText(o)}(0)})),r.click()}}]),e}();var Gt=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(h.a)(e,[{key:"get",value:function(e,t){return this.map.get(e+":"+t)}},{key:"set",value:function(e,t,n){this.map.set(e+":"+t,n)}},{key:"delete",value:function(e,t){return this.map.delete(e+":"+t)}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(t){Object(u.a)(this.map.entries()).map((function(t){return{value:t[1],key:e.parseKey(t[0])}})).forEach((function(e,n){return t(e.value,e.key.row,e.key.column,n)}))}}],[{key:"parseKey",value:function(e){var t=e.split(":");return{row:Number(t[0]),column:Number(t[1])}}}]),e}();var Qt=function(){function e(t,n,r,a,o){Object(c.a)(this,e),this.name=void 0,this.columnNames=void 0,this.columnTypes=void 0,this.rows=void 0,this.columnCount=void 0,this.rowCount=void 0,this.errors=void 0,this.nullValuesSupport=void 0,this.actual=void 0,this.revertState=void 0,this.name=t,this.columnNames=n,this.columnTypes=r,this.rows=a,this.columnCount=n.length,this.rowCount=a.length,this.errors=new Gt,this.nullValuesSupport=o,this.actual=!1,this.revertState=this.toDataObject(),this.recomputeErrors()}return Object(h.a)(e,null,[{key:"new",value:function(t,n){return new e(t,["Column1"],["number"],[],n)}},{key:"fromData",value:function(t,n){if(Xt(t)){var r=t;return new e(r.name,r.columnNames,r.columnTypes,r.rows,n)}throw new Error("Given object is not a valid relation.")}},{key:"fromRelation",value:function(t,n,r){var a=[],o=[];n.getColumns().forEach((function(e,t){a.push(t),o.push(e)}));var i=n.getRows().map((function(e){return e.getOrderedPrintValues(a)}));return new e(t,a,o,i,r)}},{key:"copy",value:function(t){return new e(t.name,Object(u.a)(t.columnNames),Object(u.a)(t.columnTypes),t.rows.map((function(e){return Object(u.a)(e)})),t.nullValuesSupport)}}]),Object(h.a)(e,[{key:"recomputeErrors",value:function(){var e=this;this.errors.clear(),this.checkColumnNames();for(var t=function(t){Object(u.a)(new Array(e.rowCount).keys()).forEach((function(n){return e.checkRowInput(t,n)}))},n=0;n<this.columnCount;++n)t(n)}},{key:"checkColumnNames",value:function(){for(var e=this,t=function(t){var n=e.columnNames[t].trim();return""===n?(e.errors.set("name",t,"Column name cannot be empty"),"continue"):e.columnNames.reduce((function(e,t){return t===n?e+1:e}),0)>1?(e.errors.set("name",t,"Duplicit column name"),"continue"):ge(n)?(e.errors.set("name",t,"Column name cannot be a keyword"),"continue"):Q.isName(n)?void e.errors.delete("name",t):(e.errors.set("name",t,"Invalid characters in column name"),"continue")},n=0;n<this.columnCount;++n)t(n)}},{key:"checkRowInput",value:function(e,t){this.errors.delete(t,e);var n=this.rows[t][e].trim();if(""===n)this.nullValuesSupport?this.errors.delete(t,e):this.errors.set(t,e,"Null values are not supported");else if("number"===this.columnTypes[e])Q.isNumber(n.replace(/\s/g,""))||this.errors.set(t,e,"Given string is not a number");else if("boolean"===this.columnTypes[e]){var r=n.toLowerCase();"true"!==r&&"t"!==r&&"false"!==r&&"f"!==r&&this.errors.set(t,e,"Given string is not a boolean")}}},{key:"checkColumnTypes",value:function(e){var t=this;this.rows.forEach((function(n,r){return t.checkRowInput(e,r)}))}},{key:"createRelation",value:function(){for(var e=this,t=new J(this.name),n=0;n<this.columnCount;++n)t.addColumn(this.columnNames[n],this.columnTypes[n]);return this.rows.forEach((function(n){var r=new de(t.getColumns());n.forEach((function(t,n){if(""===(t=t.trim())||"null"===t)r.addValue(e.columnNames[n],null);else if("string"===e.columnTypes[n])t=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),r.addValue(e.columnNames[n],t);else if("number"===e.columnTypes[n])r.addValue(e.columnNames[n],Number(t.replace(/\s/g,"")));else{var a=t.toLowerCase();r.addValue(e.columnNames[n],"t"===a||"true"===a)}})),t.addRow(r)})),t.finishSchema(),t}},{key:"toDataObject",value:function(){return{name:this.name,columnNames:Object(u.a)(this.columnNames),columnTypes:Object(u.a)(this.columnTypes),rows:this.rows.map((function(e){return Object(u.a)(e)})),columnCount:this.columnCount,rowCount:this.rowCount}}},{key:"getErrors",value:function(){return this.errors}},{key:"isValid",value:function(){return 0===this.errors.size()}},{key:"setNullValuesSupport",value:function(e){e!==this.nullValuesSupport&&(this.nullValuesSupport=e,this.recomputeErrors())}},{key:"addNewColumn",value:function(){for(var e=this.columnNames.length+1,t="Column"+e;this.columnNames.indexOf(t)>-1;)t="Column"+ ++e;this.columnNames.push(t),this.columnTypes.push("number"),this.nullValuesSupport?this.rows.forEach((function(e){return e.push("")})):this.rows.forEach((function(e){return e.push("0")})),++this.columnCount,this.checkColumnNames(),this.actual=!1}},{key:"addNewRow",value:function(){var e=this;this.nullValuesSupport?this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(e){return""}))):this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(t){return"number"===e.columnTypes[t]?"0":"boolean"===e.columnTypes[t]?"false":'""'}))),++this.rowCount,this.actual=!1}},{key:"deleteColumn",value:function(e){var t=this;this.columnNames.splice(e,1),this.columnTypes.splice(e,1),this.rows.forEach((function(t){return t.splice(e,1)})),--this.columnCount,0===this.columnCount&&(this.rows=[],this.addNewColumn()),this.errors.forEach((function(n,r,a){a===e?t.errors.delete(r,a):a>e&&(t.errors.delete(r,a),t.errors.set(r,a,n))})),this.actual=!1}},{key:"deleteRow",value:function(e){var t=this;this.rows.splice(e,1),--this.rowCount,this.errors.forEach((function(n,r,a){r===e?t.errors.delete(r,a):"number"===typeof r&&r>e&&(t.errors.delete(r,a),t.errors.set(r-1,a,n))})),this.actual=!1}},{key:"getRowCount",value:function(){return this.rowCount}},{key:"getColumnCount",value:function(){return this.columnCount}},{key:"setName",value:function(e){this.name=e,this.actual=!1}},{key:"getName",value:function(){return this.name}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"setColumnName",value:function(e,t){this.columnNames[t]=e,this.checkColumnNames(),this.actual=!1}},{key:"getColumnTypes",value:function(){return this.columnTypes}},{key:"setColumnType",value:function(e,t){this.columnTypes[t]=e,this.checkColumnTypes(t),this.actual=!1}},{key:"getRows",value:function(){return this.rows}},{key:"setRowInput",value:function(e,t,n){this.rows[t][n]=e,this.checkRowInput(n,t),this.actual=!1}},{key:"isActual",value:function(){return this.actual}},{key:"setActual",value:function(e){this.actual=e,e&&(this.revertState=this.toDataObject())}},{key:"canRevert",value:function(){return void 0!==this.revertState}},{key:"getRevertName",value:function(){return void 0!==this.revertState?this.revertState.name:""}},{key:"revert",value:function(){void 0!==this.revertState&&(this.name=this.revertState.name,this.columnNames=Object(u.a)(this.revertState.columnNames),this.columnTypes=Object(u.a)(this.revertState.columnTypes),this.rows=this.revertState.rows.map((function(e){return Object(u.a)(e)})),this.columnCount=this.revertState.columnCount,this.rowCount=this.revertState.rowCount,this.actual=!1,this.recomputeErrors())}}]),e}();function Xt(e){return"object"===typeof e&&("name"in e&&"string"===typeof e.name&&("columnCount"in e&&"number"===typeof e.columnCount&&!(e.columnCount<1)&&("rowCount"in e&&"number"===typeof e.rowCount&&(!(!("columnNames"in e)||!Array.isArray(e.columnNames)||e.columnNames.length!==e.columnCount||e.columnNames.some((function(e){return"string"!==typeof e})))&&(!(!("columnTypes"in e)||!Array.isArray(e.columnTypes)||e.columnTypes.length!==e.columnCount||e.columnTypes.some((function(e){return!function(e){return"string"===typeof e&&("string"===e||"number"===e||"boolean"===e)}(e)})))&&("rows"in e&&Array.isArray(e.rows)&&e.rows.every((function(t){return Array.isArray(t)&&t.length===e.columnCount&&t.every((function(e){return"string"===typeof e}))}))))))))}var $t=n(7),Yt=n(18),Zt=n.n(Yt),en=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(t){var n=this;return new Promise((function(r){Kt.openFiles(".csv").then((function(a){var o=[],i=0;a.forEach((function(r){if(r.name.match(/\.csv$/))try{o.push(n.csvToRelation(e.createValidName(r.name.slice(0,-4)),r.text,t))}catch(a){console.log("File "+r.name+" skipped for bad format of csv"),i+=1}else console.log("Unsupported filetype: "+r.name),i+=1})),r({relations:o,skipped:i})}))}))}},{key:"save",value:function(e,t,n){var r=this;if(0!==e.length)if(1!==e.length){var a=Zt()();e.forEach((function(e){a.file(e.getName()+".csv",r.relationToCsv(e,n))})),a.generateAsync({type:"blob"}).then((function(e){Object($t.saveAs)(e,t+".zip")})).catch((function(e){throw e}))}else{var o=new Blob([this.relationToCsv(e[0],n)],{type:"text/plain;charset=utf-8"});Object($t.saveAs)(o,e[0].getName()+".csv")}}},{key:"csvToRelation",value:function(t,n,r){if(null===n||""===n)throw console.log("null or empty string read from file "+t),Error();var a=(n=n.trim().replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ")).split("\n");if(a.length<2)throw console.log("file "+t+" has only one line"),Error();a[0]=a[0].replace(/\s/g,""),a[1]=a[1].replace(/\s/g,"");var o=function(e){for(var t=0;t<e.length;++t){var n=e.charAt(t);if(","===n)return",";if(";"===n)return";"}}(a[1]);void 0===o&&(o=";");var i=a[0].split(o),s=a[1].split(o).map((function(e){var t=e.toLowerCase();return"string"===t||"str"===t||"s"===t?"string":"number"===t||"num"===t||"n"===t?"number":"boolean"})),l=a.slice(2).map((function(t){var n=[];for(t=t.trim();;){var r=e.nextRowInput(t,o);if(n.push(r.input),void 0===r.rest)break;t=r.rest}return n})),u=i.length;if(s.length!==u||l.some((function(e){return e.length!==u})))throw console.log("rows in file "+t+" do not have the same number of columns"),new Error;return new Qt(t,i,s,l,r)}},{key:"createValidName",value:function(e){return""===(e=e.split("").filter((function(e){return Q.isNameChar(e)})).join(""))?"relation":e}},{key:"nextRowInput",value:function(e,t){for(var n=!1,r=0,a=0;a<e.length;){var o=e.charAt(a);if(!n&&o===t)return{input:e.slice(0,a),rest:e.slice(a+1)};"\\"===o?++r:r=0,'"'===o&&r%2===0&&(n=!n),++a}return{input:e,rest:void 0}}},{key:"relationToCsv",value:function(e,t){var n=e.getColumnNames().join(t),r=e.getColumnTypes().join(t),a=e.getRows().map((function(e){return e.join(t)}));return[n,r].concat(Object(u.a)(a)).join("\n")}}]),e}(),tn=(n(61),function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.getCurrentRelation=function(){var e=Ge(r.props.evaluationTreeRoot,r.state.selectedIndex);if(null===e&&null===(e=Ge(r.props.evaluationTreeRoot,0)))return r.props.onUnexpectedError(z.codeError(W.resultSection_getCurrentRelation_nodeIndexNotFound)),null;try{return e.getResult()}catch(t){return r.props.onUnexpectedError(z.codeError(W.resultSection_getCurrentRelation_evalError,t.message)),null}},r.handleSelectedNodeChange=function(e){r.setState({selectedIndex:e})},r.exportEvalTreeAsPng=function(){var e=document.getElementById("eval-tree-svg");if(null!==e){var t=e.getBoundingClientRect(),n={width:3*t.width,height:3*t.height,svg:e,filename:r.props.expressionName+" - evaluation tree.png"};xt()(n)}},r.exportRelation=function(){if(null!==r.getCurrentRelation())try{en.save([Qt.fromRelation("rachel_result",r.getCurrentRelation(),!0)],"rachel_result",r.props.csvValueSeparator)}catch(e){console.warn("Saving error: "+e,!0)}else r.props.onUnexpectedError(z.codeError(W.resultSection_saveResultRelation_nullRelationToSave))},r.addRelation=function(){null!==r.getCurrentRelation()?r.props.onAddResult(r.getCurrentRelation()):r.props.onUnexpectedError(z.codeError(W.resultSection_handleAddRelation_nullRelationToAdd))},r.state={selectedIndex:0},r.sectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(e){e.evaluationTreeRoot!==this.props.evaluationTreeRoot&&this.setState({selectedIndex:0})}},{key:"render",value:function(){if(null===this.getCurrentRelation())return null;var e=0===this.state.selectedIndex?"Result":"Intermediate",t=Ge(this.props.evaluationTreeRoot,this.state.selectedIndex),n=null===t?null:t.printInLine();return a.a.createElement("section",{ref:this.sectionRef,className:"page-section result-section"},a.a.createElement("header",null,a.a.createElement("h2",null,"Result"),a.a.createElement(m,{text:"Export",onClick:this.exportEvalTreeAsPng,className:"",tooltip:"Saves the evaluation tree as png",tooltipClassName:"tooltip"})),a.a.createElement("p",{className:"upper-p"},a.a.createElement("strong",null,"Evaluation tree of "+this.props.evaluationTreeRoot.printInLine()+":")),a.a.createElement(Tt,{tree:this.props.evaluationTreeRoot,selected:this.state.selectedIndex,onClick:this.handleSelectedNodeChange,darkTheme:this.props.darkTheme}),a.a.createElement("p",{className:"lower-p"},a.a.createElement("strong",null,e," relation ",n,":")),a.a.createElement("menu",{className:"page-section-tab-menu"},a.a.createElement(m,{text:"Add",onClick:this.addRelation,className:"",tooltip:"Adds given relation to stored ones",tooltipClassName:"tooltip"}),a.a.createElement(m,{text:"Export",onClick:this.exportRelation,className:"",tooltip:"Saves given relation to a file",tooltipClassName:"tooltip"})),a.a.createElement(Et,{relation:this.getCurrentRelation()}))}}]),n}(a.a.Component)),nn=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(){var e=this;return new Promise((function(t){Kt.openFiles(".txt").then((function(n){var r=[],a=0,o=0,i=0;n.forEach((function(t){null===t.text?(console.log("Null read from file "+t.name),i+=1):t.name.match(/\.txt$/)?(t.text=t.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    "),"\n".concat(t.text).split("\n### ").forEach((function(t){try{0!==t.trim().length&&r.push(e.splitExpressionNameAndText(t))}catch(n){a+=1}})),o+=1):(console.log("Unsupported filetype: "+t.name),i+=1)})),t({expressions:r,skippedExpressions:a,loadedFiles:o,skippedFiles:i})}))}))}},{key:"splitExpressionNameAndText",value:function(e){var t=e.indexOf("\n");if(-1===t)throw console.log("Expression does not contain first name line."),Error();var n=e.slice(0,t).trim();if(!n.endsWith(" ###"))throw console.log("Expression does not contain name between hashes."),Error();return{name:n.slice(0,-4),text:e.slice(t).trim()}}},{key:"save",value:function(e,t){var n=e.map((function(e){return"### "+e.name+" ###\n\n"+e.text})).join("\n\n"),r=new Blob([n],{type:"text/plain;charset=utf-8"});Object($t.saveAs)(r,t+".txt")}}]),e}(),rn=(n(62),[{name:"Cars and Owners",project:{relations:[{name:"Car",columnNames:["Id","Owner","Color","Electric","Weight"],columnTypes:["number","number","string","boolean","number"],rows:[["1","1","Blue","True","1000"],["2","1","Green","false","1 200"],["3","2","Blue","F","850.42"],["4","3","Black","t","1 111.111 111"]],columnCount:5,rowCount:4},{name:"Owner",columnNames:["Id","Name"],columnTypes:["number","string"],rows:[["1","George Smith"],["2",'Adam "Driver /\\" Jackson'],["3","Michael Trueman"],["Fix errors","before loading"],["Or delete","invalid rows"]],columnCount:2,rowCount:3}],expressions:[{name:"Relation only",text:"// You can use comments until the line end after '//'\n// You must load relations before using them in expressions\n\nCar\n\n// After evaluation, you will see the evaluation tree\n// and the result relation at the bottom of the page\n"},{name:"Unary operator",text:"// Unary operator comes after the source relation\n// If the relation is still not defined, go check its definition\n// This expression returns all owners with id 1\n\nOwner(Id = 1)\n"},{name:"Binary operator",text:"// Binary operator comes between source relations\n// This expression returns natural join of cars and owners\n\nCar*Owner\n"},{name:"Escapes",text:'// Strings in expressions are enclosed in quotes\n// To use quotes inside a string, you must escape them by a backslash \'\\"\'\n// To use backslash inside a string, you must escape it with second one \'\\\\\'\n\nOwner(Name == "Adam \\"Driver /\\\\\\" Jackson")\n\n// This does not work: Owner(Name == "Adam "Driver /\\" Jackson")\n'},{name:"Example",text:"// Errors are highlighted by red underline - hover mouse over it to see details\n// While typing, Rachel shows you available relations or columns\n// (if relations are loaded in the application)\n// Try to write a query for: all cars' ids and their owners' names\n\nTODO...\n"},{name:"Example result",text:"// One possible expression is like this...\n\n(\n  Car\n  *\n  Owner< Id -> Owner >\n)[Id, Name]\n\n// For more detailed manual click 'About' button in the page header\n"}],nullValuesSupport:!0}}]);function an(){return rn}var on=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={sectionClicked:!1},r}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement("header",{className:"management-section"},a.a.createElement("h1",null,"RACHEL"),a.a.createElement("button",{onClick:e.props.onLoadProject},"Load"),a.a.createElement("button",{onClick:e.props.onSaveProject},"Save"),function(){var t=a.a.createElement("ul",{className:"list-menu"},"Prepared sample projects",an().map((function(t,n){return a.a.createElement("li",{key:n},"- ",a.a.createElement("button",{onClick:function(){return e.props.onLoadSample(t.project)}},t.name))})));return a.a.createElement("div",{className:"button-like"},"Samples",t)}(),function(){var t=a.a.createElement("ul",{className:"list-menu"},a.a.createElement("li",null,a.a.createElement("span",null,"Null values:"),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"allowed",id:"null_values_support_allowed",checked:e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!0)}}),a.a.createElement("label",{htmlFor:"null_values_support_allowed"},"allowed"),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"forbidden",id:"null_values_support_forbid",checked:!e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!1)}}),a.a.createElement("label",{htmlFor:"null_values_support_forbid"},"forbidden")),a.a.createElement("li",null,a.a.createElement("span",null,"CSV separator:"),a.a.createElement("input",{type:"radio",name:"value_separator",value:"semicolon",id:"value_separator_semi",checked:";"===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(";")}}),a.a.createElement("label",{htmlFor:"value_separator_semi"},"semicolon"),a.a.createElement("input",{type:"radio",name:"value_separator",value:"comma",id:"value_separator_comma",checked:","===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(",")}}),a.a.createElement("label",{htmlFor:"value_separator_comma"},"comma")),a.a.createElement("li",null,a.a.createElement("span",null,"Theme:"),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"on",id:"dark_mode_on",checked:!e.props.darkTheme,onChange:function(){return e.props.onDarkModeChange(!1)}}),a.a.createElement("label",{htmlFor:"dark_mode_on"},"light"),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"off",id:"dark_mode_off",checked:e.props.darkTheme,onChange:function(){return e.props.onDarkModeChange(!0)}}),a.a.createElement("label",{htmlFor:"dark_mode_off"},"dark")));return a.a.createElement("div",{className:"button-like"},"Settings",t)}(),a.a.createElement("a",{href:"https://github.com/kotliluk/rachel",target:"_blank",rel:"noreferrer",className:"button-like"},"About"))}}]),n}(a.a.Component);function sn(e){return"object"!==typeof e?"The file cannot be parsed to an object.":"relations"in e&&Array.isArray(e.relations)&&0!==e.relations.length&&!e.relations.some((function(e){return!Xt(e)}))?"expressions"in e&&Array.isArray(e.expressions)&&0!==e.expressions.length&&!e.expressions.some((function(e){return!function(e){return"object"===typeof e&&"name"in e&&"string"===typeof e.name&&"text"in e&&"string"===typeof e.text}(e)}))?"nullValuesSupport"in e&&"boolean"===typeof e.nullValuesSupport?"OK":'The file must contain the field "nullValuesSupport: boolean"':'The file must contain the field "expressions: Expression[]" of length at least one':'The file must contain the field "relations: StoredRelationData[]" of length at least one'}function ln(e){return{relations:e.relations.map((function(e){return{name:(t=e).name,columnNames:Object(u.a)(t.columnNames),columnTypes:Object(u.a)(t.columnTypes),rows:t.rows.map((function(e){return Object(u.a)(e)})),columnCount:t.columnCount,rowCount:t.rowCount};var t})),expressions:e.expressions.map((function(e){return{name:(t=e).name,text:t.text};var t})),nullValuesSupport:e.nullValuesSupport}}var un=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(){return new Promise((function(e,t){Kt.openFile(".rachel").then((function(n){if(null===n.text)t("Reading of the content of the file "+n.name+" failed.");else if(n.name.match(/\.rachel$/)){n.text=n.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");var r=JSON.parse(n.text),a=sn(r);if("OK"===a)e(r);else t("Invalid structure of the JSON file. "+a)}else t("Please select a JSON file to load a project relation from.")}))}))}},{key:"save",value:function(e,t){var n=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});Object($t.saveAs)(n,t+".rachel")}}]),e}();var cn="ENG",hn="false",pn=function(){function e(){Object(c.a)(this,e)}return Object(h.a)(e,null,[{key:"init",value:function(){if(e.storageSupported){var t=localStorage.getItem("csvValueSeparator");";"!==t&&","!==t?(console.log("csvValueSeparator not found in localStorage and set to default"),localStorage.setItem("csvValueSeparator",";"),e.csvValueSeparator=";"):e.csvValueSeparator=localStorage.getItem("csvValueSeparator"),"ENG"!==(n=localStorage.getItem("language"))&&"CZE"!==n?(console.log("language not found in localStorage and set to default"),localStorage.setItem("language",cn),e.language=cn):e.language=localStorage.getItem("language"),"true"!==localStorage.getItem("darkTheme")&&"false"!==localStorage.getItem("darkTheme")?(console.log("darkTheme not found in localStorage and set to default"),localStorage.setItem("darkTheme",hn),e.darkTheme=hn):e.darkTheme=localStorage.getItem("darkTheme")}else console.warn("LocalStorage not supported in the browser. Default values used."),e.csvValueSeparator=";",e.language=cn,e.darkTheme=hn;var n;e.isInit=!0}},{key:"getCsvValueSeparator",value:function(){return e.isInit||e.init(),e.csvValueSeparator}},{key:"setCsvValueSeparator",value:function(t){e.csvValueSeparator=t,e.storageSupported&&localStorage.setItem("csvValueSeparator",t)}},{key:"getLanguage",value:function(){return e.isInit||e.init(),e.language}},{key:"setLanguage",value:function(t){e.language=t,e.storageSupported&&localStorage.setItem("language",t)}},{key:"getDarkMode",value:function(){return e.isInit||e.init(),"true"===e.darkTheme}},{key:"setDarkMode",value:function(t){e.darkTheme=String(t),e.storageSupported&&localStorage.setItem("darkTheme",String(t))}}]),e}();pn.isInit=!1,pn.storageSupported="undefined"!==typeof Storage,pn.csvValueSeparator=void 0,pn.language=void 0,pn.darkTheme=void 0;var fn=function(){function e(){var t=this;Object(c.a)(this,e),this.processFile=function(e){var n=JSON.parse(e.text),r=sn(n);if("OK"!==r)return{name:e.name.slice(0,-4)+"-eval-report.txt",text:"Invalid JSON file: "+r};var a=t.parseRelations(n.relations,n.nullValuesSupport),o=new ft(a,n.nullValuesSupport),i=n.expressions.length,s=n.expressions.map((function(e){return t.processExpression(e,o)})),l=mn.apply(void 0,Object(u.a)(s.map((function(e){return e.counts})))),c=s.reduce((function(e,t){return e+t.error}),0);return{name:e.name.slice(0,-5)+"-eval-report.txt",text:t.reportHeader(i,c,l,n.nullValuesSupport)+t.formatRelations(n.relations)+s.map((function(e){return e.text})).join("")}},this.processExpression=function(e,t){try{var n=t.parse(e.text),r=yn(n),a=n.getResult();return{text:"### "+e.name+" ###\n\n"+e.text+"\n\n# Result #\n\n"+a.contentString()+"\n\n",counts:r,error:0}}catch(o){return{text:"### "+e.name+" ###\n\n"+e.text+"\n\n# Error #\n\n"+o.message+"\n\n",counts:dn(),error:1}}},this.reportHeader=function(e,t,n,r){var a,o,i=vn(a=n)+gn(a),s=vn(n),l=gn(n);return"Rachel project report from "+(o=new Date,String(o.getDate()).padStart(2,"0")+"."+String(o.getMonth()+1).padStart(2,"0")+"."+String(o.getFullYear())+" "+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+"\n\nExpressions: ")+e+"    Errors: "+t+"\n\nUsed operations ("+i+" in total: "+s+" binary, "+l+" unary):\n    Antijoin: "+n.antijoin+"\n    Cartesian product: "+n.cartesian+"\n    Division: "+n.division+"\n    Natural join: "+n.natural+"\n    Outer Join: "+n.outerJoin+"\n    Projection: "+n.projection+"\n    Rename: "+n.rename+"\n    Selection: "+n.selection+"\n    Semijoin: "+n.semijoin+"\n    Set Operations: "+n.setOperation+"\n    Theta Join: "+n.thetaJoin+"\n    Theta Semijoin: "+n.thetaSemijoin+"\n\n"+(r?"Null values ALLOWED.\n\n":"Null values FORBIDDEN.\n\n")},this.formatRelations=function(e){return"### Defined relations ###\n\n"+e.map((function(e){return"# "+e.name+" #\n"+e.columnNames.join(", ")+"\n"+e.columnTypes.join(", ")+"\n"+e.rows.map((function(e){return e.join(", ")})).join("\n")+"\n\n"})).join("")}}return Object(h.a)(e,[{key:"process",value:function(e){var t=this;return new Promise((function(n,r){Kt.openFiles(".rachel").then((function(a){console.log(a.length+" files loaded to BatchProcessor"),console.time("Batch duration");var o=[],i=0,s=0;a.forEach((function(e){null===e.text?(o.push({name:e.name+"-eval-report.txt",text:"ERROR: Source file cannot be loaded."}),s+=1,console.warn("Null read from "+e.name)):e.name.match(/\.rachel$/)?(o.push(t.processFile(e)),i+=1):(o.push({name:e.name+"-eval-report.txt",text:"ERROR: Source file is not a .rachel file, but: "+e.name}),s+=1,console.warn("Unsupported filetype: "+e.name)),console.log("Batch in progress... "+(i+s)+"/"+a.length)})),console.timeEnd("Batch duration"),0===o.length&&n("Batch finished: "+i+" files processed, "+s+" skipped.");var l=Zt()();o.forEach((function(e){l.file(e.name,e.text)})),l.generateAsync({type:"blob"}).then((function(t){Object($t.saveAs)(t,e+".zip"),console.log("Batch finished: "+i+" files processed, "+s+" skipped."),n("Batch finished: "+i+" files processed, "+s+" skipped.")})).catch((function(e){r("Results saving error: "+e.message)}))}))}))}},{key:"parseRelations",value:function(e,t){var n=new Map;return e.forEach((function(e){try{var r=Qt.fromData(e,t);r.isValid()&&n.set(r.getName(),r.createRelation())}catch(a){console.log("Definition of relation "+e.name+" has errors, skipping.")}})),n}}]),e}();function dn(){return mn()}function mn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{antijoin:t.reduce((function(e,t){return e+t.antijoin}),0),cartesian:t.reduce((function(e,t){return e+t.cartesian}),0),division:t.reduce((function(e,t){return e+t.division}),0),natural:t.reduce((function(e,t){return e+t.natural}),0),outerJoin:t.reduce((function(e,t){return e+t.outerJoin}),0),projection:t.reduce((function(e,t){return e+t.projection}),0),rename:t.reduce((function(e,t){return e+t.rename}),0),selection:t.reduce((function(e,t){return e+t.selection}),0),semijoin:t.reduce((function(e,t){return e+t.semijoin}),0),setOperation:t.reduce((function(e,t){return e+t.setOperation}),0),thetaJoin:t.reduce((function(e,t){return e+t.thetaJoin}),0),thetaSemijoin:t.reduce((function(e,t){return e+t.thetaSemijoin}),0)}}function vn(e){return e.antijoin+e.cartesian+e.division+e.natural+e.outerJoin+e.semijoin+e.setOperation+e.thetaJoin+e.thetaSemijoin}function gn(e){return e.projection+e.rename+e.selection}function yn(e){return e instanceof fe?mn(function(e){var t=dn();if(e instanceof be)return t.projection=1,t;if(e instanceof ke)return t.rename=1,t;if(e instanceof Ye)return t.selection=1,t;return t}(e),yn(e.getSubtree())):e instanceof Ke?mn(function(e){var t=dn();if(e instanceof et)return t.antijoin=1,t;if(e instanceof tt)return t.cartesian=1,t;if(e instanceof rt)return t.division=1,t;if(e instanceof ot)return t.outerJoin=1,t;if(e instanceof st)return e.getType()===at.natural?t.natural=1:t.semijoin=1,t;if(e instanceof ut)return t.setOperation=1,t;if(e instanceof ht)return e.getType()===lt.full?t.thetaJoin=1:t.thetaSemijoin=1,t;return t}(e),yn(e.getLeftSubtree()),yn(e.getRightSubtree())):dn()}n(63);var bn=getComputedStyle(document.querySelector(":root")),xn=Number(bn.getPropertyValue("--cell-padding-sides-num")),En=Number(bn.getPropertyValue("--input-margin-sides-num")),kn=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).containerRef=void 0,r.tableHeadRowRef=void 0,r.columnWidths=[],r.handleInputResize=function(e,t){e.scrollWidth>r.columnWidths[t]&&(r.columnWidths[t]=e.scrollWidth)},r.getErrors=function(){return r.props.relation.getErrors()},r.setSelectedInput=function(e,t){r.setState({selectedColumn:e,selectedRow:t})},r.moveSelectedInputRight=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e<r.props.relation.getColumnCount()-1&&r.setState({selectedColumn:e+1})},r.moveSelectedInputLeft=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e>0&&r.setState({selectedColumn:e-1})},r.moveSelectedInputUp=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&"number"===typeof t&&(0===t?r.setState({selectedRow:"names"}):r.setState({selectedRow:t-1}))},r.moveSelectedInputDown=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&("names"===t&&r.props.relation.getRowCount()>0&&r.setState({selectedRow:0}),"number"===typeof t&&t<r.props.relation.getRowCount()-1&&r.setState({selectedRow:t+1}))},r.handleKeyDown=function(e){"Enter"===e.key||"Esc"===e.key||"Escape"===e.key?r.setSelectedInput(void 0,void 0):"Tab"===e.key||e.ctrlKey&&"ArrowRight"===e.key?(r.moveSelectedInputRight(),e.preventDefault()):e.ctrlKey&&"ArrowLeft"===e.key?(r.moveSelectedInputLeft(),e.preventDefault()):e.ctrlKey&&"ArrowUp"===e.key?(r.moveSelectedInputUp(),e.preventDefault()):e.ctrlKey&&"ArrowDown"===e.key&&(r.moveSelectedInputDown(),e.preventDefault()),e.ctrlKey&&r.props.onCtrlInput(e)},r.handleChange=function(e,t,n){e=e.replace(/\t/g,"    "),"names"===n?r.props.onColumnNameChange(e,t):"types"===n?r.props.onColumnTypeChange(e,t):r.props.onRowInputChange(e,t,n)},r.handleNewColumn=function(){r.props.onNewColumn((function(){r.containerRef.current.scrollTo(r.containerRef.current.clientWidth,r.containerRef.current.scrollTop)}))},r.handleNewRow=function(){r.props.onNewRow((function(){r.containerRef.current.scrollTo(r.containerRef.current.scrollLeft,r.containerRef.current.clientHeight)}))},r.handleDeleteColumn=function(e){r.props.onDeleteColumn(e)},r.handleDeleteRow=function(e){r.props.onDeleteRow(e)},r.createInput=function(e,t,n){return a.a.createElement("input",{type:"text",className:"text-input",spellCheck:!1,value:e,onChange:function(e){r.handleChange(e.target.value,t,n),r.handleInputResize(e.target,t)},autoFocus:!0,style:{width:r.columnWidths[t]+"px"}})},r.createDeleteButton=function(e){return a.a.createElement("button",{className:"delete-row-or-column-button",onClick:e},"\u2716")},r.state={selectedColumn:void 0,selectedRow:void 0},r.containerRef=a.a.createRef(),r.tableHeadRowRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(){e.setSelectedInput(void 0,void 0)}))}},{key:"componentDidUpdate",value:function(){var e=this.tableHeadRowRef.current;if(null!==e){var t=Object(u.a)(e.cells).slice(1,-1);this.columnWidths=t.map((function(e){return e.clientWidth-2*(xn+En)}))}}},{key:"createTooltip",value:function(e,t){return a.a.createElement("span",{className:"tooltip",style:t},e)}},{key:"createNamesRow",value:function(){var e=this,t=this.props.relation.getColumnNames().map((function(t,n){var r=t;e.state.selectedColumn===n&&"names"===e.state.selectedRow&&(r=e.createInput(t,n,"names"));var o=null,i="name-th",s=e.getErrors().get("name",n);return void 0!==s&&(o=e.createTooltip(s,{top:"90%",bottom:"auto"}),i+=" error-input"),a.a.createElement("th",{key:n,className:i,onClick:function(t){e.setSelectedInput(n,"names"),t.stopPropagation()}},r,o)}));return t.push(a.a.createElement("td",{key:"add-column",rowSpan:2,style:{width:"24px",border:"none",padding:"1px"}},a.a.createElement("button",{onClick:this.handleNewColumn,style:{width:"100%",height:"100%"}},a.a.createElement("strong",null,"+")))),a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createTypesRow",value:function(){var e=this,t=this.props.relation.getColumnTypes().map((function(t,n){var r=a.a.createElement("select",{value:t,onChange:function(t){return e.handleChange(t.target.value,n,"types")}},a.a.createElement("option",null,"number"),a.a.createElement("option",null,"string"),a.a.createElement("option",null,"boolean"));return a.a.createElement("th",{key:n,className:"type-th"},r,e.createDeleteButton((function(){return e.handleDeleteColumn(n)})))}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createRows",value:function(){var e=this;return 0===this.props.relation.getRows().length?null:this.props.relation.getRows().map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1,e.createDeleteButton((function(){return e.handleDeleteRow(n)}))),t.map((function(t,r){var o=t;e.state.selectedColumn===r&&e.state.selectedRow===n&&(o=e.createInput(t,r,n));var i=null,s="",l=e.getErrors().get(n,r);return void 0!==l&&(i=e.createTooltip(l),s="error-input"),a.a.createElement("td",{key:r,className:s,onClick:function(t){e.setSelectedInput(r,n),t.stopPropagation()}},o,i)})))}))}},{key:"createAddRow",value:function(){return a.a.createElement("tr",{key:"add-row"},a.a.createElement("td",{key:"add-row-column",className:"add-row-td"},a.a.createElement("button",{onClick:this.handleNewRow},a.a.createElement("strong",null,"+"))))}},{key:"render",value:function(){return a.a.createElement("div",{className:"edit-table-container cursor-container",ref:this.containerRef,onKeyDown:this.handleKeyDown},a.a.createElement("table",{className:"edit-table"},a.a.createElement("thead",null,a.a.createElement("tr",{ref:this.tableHeadRowRef},this.createNamesRow()),a.a.createElement("tr",null,this.createTypesRow())),a.a.createElement("tbody",null,this.createRows(),this.createAddRow())))}}]),n}(a.a.Component),_n=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).getCurRel=function(){return r.props.storedRelations[r.props.storedRelationIndex]},r.handleRelationNameChange=function(e){r.props.onRelationNameChange(e)},r.loadRelation=function(){r.getCurRel().isValid()?r.props.onLoadRelation(gt.message):gt.error("Cannot use the invalid relation. Check errors and try again.")},r.loadAllRelations=function(){r.props.onLoadAllRelations(gt.message)},r.exportRelations=function(){r.props.onExportRelations(gt.message)},r.importRelations=function(){r.props.onImportRelations(gt.message)},r.deleteRelation=function(){r.props.onDeleteStoredRelation()},r.revertRelation=function(){r.props.onRevertRelation()},r.newRelation=function(){r.props.onNewRelation()},r.deleteAllLoadedRelations=function(){r.props.onDeleteLoadedRelations(gt.message)},r.handleCtrlInput=function(e){"Enter"===e.key&&r.loadRelation()},r.createRelationMenuButtons=function(){return r.props.storedRelations.map((function(e,t){var n=r.props.storedRelationIndex===t?"button-clicked":"",o=e.isActual()?"":"*",i=e.isValid()?{}:{border:"2px solid #fd3030"};return a.a.createElement("button",{key:t,onClick:function(){return r.handleSelectDifferentRelation(t)},className:n,style:i},o+e.getName())}))},r.state={sectionClicked:!1},r}return Object(h.a)(n,[{key:"handleSelectDifferentRelation",value:function(e){this.props.onSelectDifferentRelation(e)}},{key:"render",value:function(){var e=this,t=function(e,t,n,r){return a.a.createElement(m,{key:e,text:e,onClick:t,className:"",style:r,tooltip:n,tooltipClassName:"tooltip"})},n=this.props.storedRelations.filter((function(t,n){return n!==e.props.storedRelationIndex})).map((function(e){return e.getName()}));n.push.apply(n,Object(u.a)(ve));return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,"Relations"),t("Load all",this.loadAllRelations,"Loads all valid relations into the application"),t("Delete loaded",this.deleteAllLoadedRelations,"Deletes relations loaded in the application"),t("Import",this.importRelations,"Adds new relations from files"),t("Export",this.exportRelations,"Saves stored relations to files")),a.a.createElement("menu",{className:"page-section-tab-menu"},this.createRelationMenuButtons(),a.a.createElement("button",{onClick:this.newRelation,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(kn,{relation:this.getCurRel(),onColumnNameChange:this.props.onColumnNameChange,onColumnTypeChange:this.props.onColumnTypeChange,onRowInputChange:this.props.onRowInputChange,onNewRow:this.props.onNewRow,onNewColumn:this.props.onNewColumn,onDeleteRow:this.props.onDeleteRow,onDeleteColumn:this.props.onDeleteColumn,onCtrlInput:this.handleCtrlInput}),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(m,{key:"Load",text:"Load",onClick:this.loadRelation,className:"action-button",style:{marginRight:"40px"},tooltip:"Loads the relation into the application",tooltipClassName:"tooltip"}),a.a.createElement(dt,{label:"",value:this.getCurRel().getName(),buttonText:"Rename",onSubmit:this.handleRelationNameChange,forbidden:function(e){return n.indexOf(e)>-1||!Q.isName(e)},id:"relation-name-input"}),t("Delete",this.deleteRelation,"Deletes the relation"),this.getCurRel().canRevert()&&t("Revert",this.revertRelation,"Reverts to last loaded state ("+this.getCurRel().getRevertName()+")")))}}]),n}(a.a.Component),wn=function(){function e(t){Object(c.a)(this,e),this.accessToken=t}return Object(h.a)(e,[{key:"send",value:function(t,n){var r={access_token:this.accessToken,subject:t,text:n},a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status||4===a.readyState&&console.log("failed creating XMLHttpRequest in PostMail.send: "+a.response)};var o=e.toParams(r);a.open("POST","https://postmail.invotes.com/send",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(o)}}],[{key:"toParams",value:function(e){return encodeURIComponent("access_token")+"="+encodeURIComponent(e.access_token)+"&"+encodeURIComponent("subject")+"="+encodeURIComponent(e.subject)+"&"+encodeURIComponent("text")+"="+encodeURIComponent(e.text)}}]),e}(),Rn=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).expressionSectionRef=void 0,r.reportUnexpectedError=function(e){var t,n=new wn("5uog26ex8q9qu7sqib8ea0qd"),a="Unexpected error "+e.name+" in Rachel application.\n\nMessage:\n"+e.message+"\n\nDate:\n"+(new Date).toString()+"\n\nStack trace:\n"+e.stack+"\n\nLoaded relations: ----------------------------\n"+Object(u.a)(r.state.loadedRelations.values()).map((function(e){return e.getName()+"\n"+e.contentString()})).join("\n\n")+"\n\nStored relations: ----------------------------\nSelected relation (1-index): "+(r.state.selectedRelation+1)+"\n\n"+r.state.storedRelations.map((function(e){return e.getName()+"\n"+e.getColumnNames().join(", ")+"\n"+e.getColumnTypes().join(", ")+"\n"+e.getRows().map((function(e){return e.join(", ")})).join("\n")})).join("\n\n")+"\n\nExpressions: ----------------------------\nSelected expression (1-index): "+(r.state.selectedExpression+1)+"\n\n"+r.state.expressions.map((function(e){return e.text})).join("\n\n###\n\n")+"\n\nEvaluation tree:\n"+(null===(t=r.state.evaluationTreeRoot)||void 0===t?void 0:t.printInLine())+"\n\nOther state: ----------------------------\ncsvValueSeparator: "+r.state.csvValueSeparator+"\nlanguage:          "+r.state.language+"\nnullValuesSupport: "+r.state.nullValuesSupport+"\ndarkTheme:         "+r.state.darkTheme;n.send("Rachel application unexpected error",a),console.error("Unexpected error: "+e.stack)},r.loadProject=function(e){r.setState({loadedRelations:new Map,storedRelations:e.relations.map((function(t){return Qt.fromData(t,e.nullValuesSupport)})),selectedRelation:0,expressions:e.expressions,nullValuesSupport:e.nullValuesSupport,selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:""},(function(){console.log("Project loaded."),r.updateExpressionsErrors()}))},r.handleBatch=function(){(new fn).process("rachel-eval-results").then(console.log).catch(console.warn)},r.handleLoadProject=function(){un.load().then(r.loadProject).catch(console.warn)},r.handleSaveProject=function(){try{un.save({relations:r.state.storedRelations.map((function(e){return e.toDataObject()})),expressions:r.state.expressions,nullValuesSupport:r.state.nullValuesSupport},"rachel_project"),console.log("Project saved.")}catch(e){console.warn("Project saving failed: "+e.message)}},r.handleLoadSampleProject=function(e){r.loadProject(ln(e))},r.handleNullValuesSupportChange=function(e){r.state.storedRelations.forEach((function(t){return t.setNullValuesSupport(e)})),r.setState({nullValuesSupport:e},r.updateExpressionsErrors)},r.handleCsvValueSeparatorChange=function(e){pn.setCsvValueSeparator(e),r.setState({csvValueSeparator:e})},r.handleLanguageChange=function(e){pn.setLanguage(e),r.setState({language:e})},r.handleDarkModeChange=function(e){pn.setDarkMode(e),r.setState({darkTheme:e}),document.body.classList.toggle("body-dark",e),document.body.classList.toggle("body-light",!e)},r.handleRelationNameChange=function(e){r.setState((function(t){var n=t.storedRelations;return n[r.state.selectedRelation].setName(e),{storedRelations:n}}))},r.handleRelationColumnNameChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnName(e,t),{storedRelations:a}}))},r.handleRelationColumnTypeChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnType(e,t),{storedRelations:a}}))},r.handleRelationRowInputChange=function(e,t,n){r.setState((function(a){var o=a.storedRelations;return o[r.state.selectedRelation].setRowInput(e,n,t),{storedRelations:o}}))},r.handleRelationNewRow=function(e){r.state.storedRelations[r.state.selectedRelation].addNewRow(),r.setState({},e)},r.handleRelationNewColumn=function(e){r.state.storedRelations[r.state.selectedRelation].addNewColumn(),r.setState({},e)},r.handleRelationDeleteRow=function(e){r.state.storedRelations[r.state.selectedRelation].deleteRow(e),r.setState({})},r.handleRelationDeleteColumn=function(e){r.state.storedRelations[r.state.selectedRelation].deleteColumn(e),r.setState({})},r.handleSelectDifferentRelation=function(e){r.setState({selectedRelation:e})},r.handleCreateNewRelation=function(){for(var e=r.state.selectedRelation+1,t="NewRelation",n=1;;++n)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t+n)){t+=n;break}r.state.storedRelations.splice(e,0,Qt.new(t,r.state.nullValuesSupport)),r.setState({selectedRelation:e})},r.handleDeleteRelation=function(){if(1!==r.state.storedRelations.length){var e=r.state.selectedRelation;r.state.storedRelations.splice(e,1),e===r.state.storedRelations.length?r.setState({selectedRelation:e-1},r.updateExpressionsErrors):r.setState({},r.updateExpressionsErrors)}else r.setState({storedRelations:[Qt.new("Relation",r.state.nullValuesSupport)]})},r.handleRevertRelation=function(){r.setState((function(e){var t=e.storedRelations;return t[r.state.selectedRelation].revert(),{storedRelations:t}}))},r.handleDeleteLoadedRelations=function(e){r.state.loadedRelations.clear(),r.state.storedRelations.forEach((function(e){return e.setActual(!1)})),e("All loaded relations deleted."),r.setState({},r.updateExpressionsErrors)},r.handleExportRelations=function(e){try{en.save(r.state.storedRelations,"rachel_relations",r.state.csvValueSeparator),e(r.state.storedRelations.length+" relations saved.")}catch(t){e("Saving error: "+t)}},r.handleImportRelations=function(e){en.load(r.state.nullValuesSupport).then((function(t){var n=r.state.storedRelations.length;t.relations.forEach((function(e){var t=e.getName();if(r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t)>-1)for(var n=2;;++n)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t+n)){e.setName(t+n);break}r.state.storedRelations.push(e)})),t.relations.length>0&&r.setState({selectedRelation:n}),e(t.relations.length+" relations loaded, "+t.skipped+" files skipped.")}))},r.handleLoadRelation=function(e){var t=r.state.storedRelations[r.state.selectedRelation];t.setActual(!0),r.state.loadedRelations.set(t.getName(),t.createRelation()),e("Relation loaded to application.\n"+(0===r.state.loadedRelations.size?"No relations loaded in the application at the moment.":"All current loaded relations ("+r.state.loadedRelations.size+"): "+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+".")),r.setState({},r.updateExpressionsErrors)},r.handleLoadAllRelations=function(e){var t=0,n=0;r.state.storedRelations.forEach((function(e){e.isValid()?(e.setActual(!0),r.state.loadedRelations.set(e.getName(),e.createRelation()),++t):++n}));var a=0===r.state.loadedRelations.size?"No relations loaded in the application at the moment.":"All current loaded relations ("+r.state.loadedRelations.size+"): "+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+".";e(t+" relations loaded to application, "+n+" skipped for errors.\n"+a),r.setState({},r.updateExpressionsErrors)},r.updateExpressionsErrors=function(){var e=r.expressionSectionRef.current;null!==e&&e.updateErrors()},r.handleExprEval=function(e){r.setState({evaluationTreeRoot:e,evaluatedExpressionName:r.state.expressions[r.state.selectedExpression].name})},r.handleExprTextChange=function(e,t){r.setState((function(n){var r=n.expressions;return r[n.selectedExpression]={name:e,text:t},{expressions:r}}))},r.handleSelectDifferentExpression=function(e){r.setState({selectedExpression:e},r.updateExpressionsErrors)},r.handleCreateNewExpression=function(){var e=r.state.selectedExpression+1;r.state.expressions.splice(e,0,{name:"New expression",text:""}),r.setState({selectedExpression:e})},r.handleDeleteExpression=function(e){if(1===r.state.expressions.length)return r.handleExprTextChange("Expression 1","");var t=r.state.selectedExpression;r.state.expressions.splice(t,1),t===r.state.expressions.length?r.setState({selectedExpression:t-1},e):r.setState({},e)},r.handleExportExpressions=function(e){try{nn.save(r.state.expressions,"rachel_expressions"),e("Expressions saved in a textual file.")}catch(t){e("Expressions saving failed: "+t.message)}},r.handleImportExpressions=function(e){nn.load().then((function(t){var n;(n=r.state.expressions).push.apply(n,Object(u.a)(t.expressions)),r.setState({}),e(t.expressions.length+" expressions loaded from "+t.loadedFiles+" files ("+ +t.skippedExpressions+" expressions skipped, "+t.skippedFiles+" files skipped).")}))},r.addResultRelation=function(e){var t="Evaluated",n=Qt.fromRelation(t,e,r.state.nullValuesSupport);if(r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t)>-1)for(var a=2;;++a)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(t+a)){n.setName(t+a);break}r.state.storedRelations.push(n),r.setState({selectedRelation:r.state.storedRelations.length-1})},document.body.classList.toggle("body-dark",pn.getDarkMode()),document.body.classList.toggle("body-light",!pn.getDarkMode());return r.state={samples:an(),loadedRelations:new Map,storedRelations:[Qt.fromData({name:"Relation",columnNames:["Column1","Column2","Column3"],columnTypes:["number","string","boolean"],rows:[["","",""]],columnCount:3,rowCount:1},!0)],selectedRelation:0,expressions:[{name:"Expression 1",text:""}],selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:"",nullValuesSupport:!0,csvValueSeparator:pn.getCsvValueSeparator(),language:pn.getLanguage(),darkTheme:pn.getDarkMode()},r.expressionSectionRef=a.a.createRef(),r}return Object(h.a)(n,[{key:"render",value:function(){var e=null;return null!==this.state.evaluationTreeRoot&&(e=a.a.createElement(tn,{evaluationTreeRoot:this.state.evaluationTreeRoot,expressionName:this.state.evaluatedExpressionName,onAddResult:this.addResultRelation,onUnexpectedError:this.reportUnexpectedError,csvValueSeparator:this.state.csvValueSeparator,darkTheme:this.state.darkTheme})),a.a.createElement("main",null,a.a.createElement(on,{onBatch:this.handleBatch,onLoadProject:this.handleLoadProject,onSaveProject:this.handleSaveProject,onLoadSample:this.handleLoadSampleProject,csvValueSeparator:this.state.csvValueSeparator,language:this.state.language,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,onCsvValueSeparatorChange:this.handleCsvValueSeparatorChange,onLanguageChange:this.handleLanguageChange,onNullValuesSupportChange:this.handleNullValuesSupportChange,onDarkModeChange:this.handleDarkModeChange}),a.a.createElement(_n,{storedRelations:this.state.storedRelations,storedRelationIndex:this.state.selectedRelation,loadedRelations:Object(u.a)(this.state.loadedRelations.values()),onRelationNameChange:this.handleRelationNameChange,onColumnNameChange:this.handleRelationColumnNameChange,onColumnTypeChange:this.handleRelationColumnTypeChange,onRowInputChange:this.handleRelationRowInputChange,onNewRow:this.handleRelationNewRow,onNewColumn:this.handleRelationNewColumn,onDeleteRow:this.handleRelationDeleteRow,onDeleteColumn:this.handleRelationDeleteColumn,onSelectDifferentRelation:this.handleSelectDifferentRelation,onNewRelation:this.handleCreateNewRelation,onLoadRelation:this.handleLoadRelation,onDeleteStoredRelation:this.handleDeleteRelation,onRevertRelation:this.handleRevertRelation,onLoadAllRelations:this.handleLoadAllRelations,onDeleteLoadedRelations:this.handleDeleteLoadedRelations,onExportRelations:this.handleExportRelations,onImportRelations:this.handleImportRelations,nullValuesSupport:this.state.nullValuesSupport}),a.a.createElement(yt,{ref:this.expressionSectionRef,expressions:this.state.expressions,currentExpressionIndex:this.state.selectedExpression,relations:this.state.loadedRelations,onChange:this.handleExprTextChange,onEval:this.handleExprEval,onSelectDifferentExpression:this.handleSelectDifferentExpression,onNewExpression:this.handleCreateNewExpression,onDeleteExpression:this.handleDeleteExpression,onExportExpressions:this.handleExportExpressions,onImportExpressions:this.handleImportExpressions,onUnexpectedError:this.reportUnexpectedError,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme}),e)}}]),n}(r.Component);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Rn,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rachel",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rachel","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}()}},[[64,1,2]]]);
//# sourceMappingURL=main.f7b4aff6.chunk.js.map