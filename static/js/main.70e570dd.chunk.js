/*! For license information please see main.70e570dd.chunk.js.LICENSE.txt */
(this.webpackJsonprachel=this.webpackJsonprachel||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(24),i=n.n(o),s=(n(35),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(3),c=n(1),p=n(2),h=n(4),f=n(5),d=n(14),m=(n(36),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:this.props.className,onClick:this.props.onClick,style:this.props.style},this.props.text,a.a.createElement("span",{className:"tooltip "+(void 0!==this.props.tooltipClassName?this.props.tooltipClassName:""),style:this.props.tooltipStyle,onClick:function(e){e.stopPropagation(),e.preventDefault()}},this.props.tooltip))}}]),n}(a.a.Component)),v=n(10),g=n(19),y=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).range=r,a}return n}(Object(g.a)(Error));function b(e,t){return e instanceof y&&void 0===e.range&&(e.range=t),e}var E="EN",x="false",k=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"init",value:function(){if(e.storageSupported){var t=localStorage.getItem("csvValueSeparator");";"!==t&&","!==t?(console.log("csvValueSeparator not found in localStorage and set to default"),localStorage.setItem("csvValueSeparator",";"),e.csvValueSeparator=";"):e.csvValueSeparator=localStorage.getItem("csvValueSeparator"),n=localStorage.getItem("language"),R.includes(n)?e.language=localStorage.getItem("language"):(console.log("language not found in localStorage and set to default"),localStorage.setItem("language",E),e.language=E),"true"!==localStorage.getItem("darkTheme")&&"false"!==localStorage.getItem("darkTheme")?(console.log("darkTheme not found in localStorage and set to default"),localStorage.setItem("darkTheme",x),e.darkTheme=x):e.darkTheme=localStorage.getItem("darkTheme")}else console.warn("LocalStorage not supported in the browser. Default values used."),e.csvValueSeparator=";",e.language=E,e.darkTheme=x;var n;e.isInit=!0}},{key:"getCsvValueSeparator",value:function(){return e.isInit||e.init(),e.csvValueSeparator}},{key:"setCsvValueSeparator",value:function(t){e.csvValueSeparator=t,e.storageSupported&&localStorage.setItem("csvValueSeparator",t)}},{key:"getLanguage",value:function(){return e.isInit||e.init(),e.language}},{key:"setLanguage",value:function(t){e.language=t,e.storageSupported&&localStorage.setItem("language",t)}},{key:"getDarkMode",value:function(){return e.isInit||e.init(),"true"===e.darkTheme}},{key:"setDarkMode",value:function(t){e.darkTheme=String(t),e.storageSupported&&localStorage.setItem("darkTheme",String(t))}}]),e}();k.isInit=!1,k.storageSupported="undefined"!==typeof Storage,k.csvValueSeparator=void 0,k.language=void 0,k.darkTheme=void 0;var S={abbr:"EN",relationErrors:{emptyColumn:"Column name cannot be empty",duplicitColumn:"Duplicit column name",keywordColumn:"Column name cannot be a keyword",invalidColumn:"Invalid characters in column name",unsupportedNull:"Null values are not supported",invalidNumber:"Given string is not a number",invalidBoolean:"Given string is not a boolean"},codeErrors:{resultSection_nodeIndexNotFound:["ResultSection.getCurrentRelation: Selected node index in evaluation tree not found."],resultSection_evalError:["ResultSection.getCurrentRelation: Evaluation error in result section: ","."],resultSection_nullRelationToSave:["ResultSection.saveResultRelation: Result relation is null when tried to save it."],resultSection_nullRelationToAdd:["ResultSection.handleAddRelation: Result relation is null when tried to add it."],row_absentColumn:["Row.getOrderedValues: Column "," is absent in row with columns: ","."],valueParser_unexpectedToken:["ValueParser.rpnToVETreeRecursive: Unexpected token: ","."],exprParser_unexpectedToken:["ExprParser.isValidSequence: Unexpected token: ","."],exprParser_thetaJoinBranchError:["ExprParser.parseTokensForWhisper: Error in theta join branch: ","."],exprParser_projectionBranchError:["ExprParser.parseTokensForWhisper: Error in projection branch: ","."]},semanticErrors:{exprParser_relationNotDefined:['Relation "','" is not defined. Check relations definitions.'],binaryNode_commonColumns:["Source relations for ",' have common columns "','".'],setOperationNode_notEqualColumns:['Source relations "','" and "','" for set '," do not have the same column sets."],divisionNode_rightColumnsNotSubset:['Right source relation schema "','" is not a subset of the left source relation schema "','".'],divisionNode_rightColumnsNotProperSubset:['Right source relation schema "','" is not a proper subset of the left source relation schema "',". There must exist a column in the left relation which is not present in the right relation."],renameNode_absentOriginalColumn:['Invalid rename, column "','" does not exist in the source relation.'],renameNode_changeToDuplicit:['Invalid rename, new column name "','" is duplicit in the changed relation.'],projectionNode_absentColumn:['Invalid projection of the column "','". It does not exist in the source relation.'],referenceValue_absentColumn:['Column "','" is absent in a schema with columns: ',"."]},semanticError:"Semantic error: ",syntaxErrors:{exprParser_emptyStringGiven:["Cannot parse an expression from an empty string."],exprParser_outerJoinWhenNullNotSupported:["Found "," when null values are not supported."],exprParser_unexpectedPart:['Unexpected part "','" in RA expression.'],exprParser_bothBranchesError:['All combinations throw error in "','". When treated as projection:\n',"\nWhen treated as theta join:\n",""],exprParser_invalidExpression:["Given string is not a valid expression."],exprParser_invalidParentheses:["Invalid structure of parentheses in the expression."],exprParser_invalidStart:["RA expression cannot start with ","."],exprParser_invalidEnd:["RA expression cannot end with ","."],exprParser_relationAfterRelation:['Relation "','" after relation "','".'],exprParser_relationAfterUnary:['Relation "','" after unary operator "','".'],exprParser_relationAfterClosing:['Relation "','" after closing parenthesis.'],exprParser_unaryAfterBinary:['Unary operator "','" after binary operator "','".'],exprParser_unaryAfterOpening:['Unary operator "','" after opening parenthesis.'],exprParser_binaryAfterBinary:['Binary operator "','" after binary operator "','".'],exprParser_binaryAfterOpening:['Binary operator "','" after opening parenthesis.'],exprParser_openingAfterRelation:['Opening parentheses after relation "','".'],exprParser_openingAfterUnary:['Opening parentheses after unary operator "','".'],exprParser_openingAfterClosing:["Opening parentheses after closing parentheses."],exprParser_closingAfterBinary:['Closing parentheses after binary operator "','".'],exprParser_closingAfterOpening:["Closing parentheses after opening parentheses."],valueParser_emptyInput:["An empty string given as a condition."],valueParser_unsupportedNull:["Null constant used when null values are not supported."],valueParser_unexpectedPart:['Unexpected part "','" in expression.'],valueParser_missingOpeningParenthesis:["Missing opening parenthesis '(' in an expression."],valueParser_missingClosingParenthesis:["Missing closing parenthesis ')' in an expression."],valueParser_invalidExpression:["Given string is not a valid expression."],valueParser_invalidStart:['Expression cannot start with "','".'],valueParser_invalidEnd:['Expression cannot end with "','".'],valueParser_literalAfterLiteral:['Literal "','" after literal "','".'],valueParser_literalAfterReference:['Literal "','" after reference to column "','".'],valueParser_literalAfterClosing:['Literal "','" after closing parentheses.'],valueParser_referenceAfterLiteral:['Reference to column "','" after literal "','".'],valueParser_referenceAfterReference:['Reference to column "','" after reference to column "','".'],valueParser_referenceAfterClosing:['Reference to column "','" after closing parentheses.'],valueParser_notAfterLiteral:['Logical not operator "','" after literal "','".'],valueParser_notAfterReference:['Logical not operator "','" after reference to column "','".'],valueParser_notAfterClosing:['Logical not operator "','" after closing parentheses.'],valueParser_binaryAfterOperator:['Binary operator "','" after binary operator "','".'],valueParser_binaryAfterOpening:['Binary operator "','" after opening parentheses.'],valueParser_openingAfterLiteral:['Opening parentheses after literal "','".'],valueParser_openingAfterReference:['Opening parentheses after reference to column "','".'],valueParser_openingAfterClosing:["Opening parentheses after closing parentheses."],valueParser_closingAfterOperator:['Closing parentheses after binary operator "','".'],valueParser_closingAfterOpening:["Closing parentheses after opening parentheses."],stringUtils_missingClosingChar:["Missing '","' after opening '","'."],stringUtils_charNotFound:['Expected "','" not found.'],renameNode_missingArrow:['Invalid rename, use "OldName -> NewName" format separated by commas.'],renameNode_invalidNewName:['Invalid rename to "','". New column name must contain letters, numbers and underscores only and start with a letter or an underscore.'],renameNode_keywordNewName:['Invalid rename to "','". New column name cannot be a keyword.'],renameNode_multipleRenameOfTheColumn:['Multiple rename of column "','".'],selectionNode_resultNotBoolean:["Result of the selection condition "," is not a boolean value, but ","."],thetaJoinNode_resultNotBoolean:["Result of the theta join condition "," is not a boolean value, but ","."],comparingOperator_differentInputTypes:['Inputs for "','"  have different types '," and ","."],computingOperator_inputTypesNotNumbers:['Inputs for "','" are not both numbers, they are '," and ","."],logicalOperator_leftInputNotBoolean:['Left input value for "','" is not a boolean, but ',"."],logicalOperator_rightInputNotBoolean:['Right input value for "','" is not a boolean, but ',"."]},syntaxError:"Syntax error: ",userMessages:{loadedRelationsTotalNo:"No relations loaded in the application at the moment.",loadedRelationsTotalSome:" relations loaded at the moment: ",loadRelationNew:"Relation loaded to application.",loadAllRelationsNew:[" relations loaded to application, "," skipped for errors."],deleteLoadedRelations:" relations deleted.",relationsExportOK:"Relations saved.",relationsExportErr:"Relations saving failed: ",relationsImport:[" relations loaded, "," files skipped."],expressionsExportOK:"Expressions saved.",expressionsExportErr:"Expressions saving failed: ",expressionsImport:[" expressions loaded from "," files ("," expressions skipped, "," files skipped)."]},operations:{selection:"Selection",projection:"Projection",rename:"Rename",union:"Union",intersection:"Intersection",difference:"Difference",naturalJoin:"Natural join",cartesianProduct:"Cartesian product",leftSemiJoin:"Left semijoin",rightSemiJoin:"Right semijoin",leftAntijoin:"Left antijoin",rightAntijoin:"Right antijoin",thetaJoin:"Theta join",leftThetaSemiJoin:"Left theta semijoin",rightThetaSemiJoin:"Right theta semijoin",fullOuterJoin:"Full outer join",leftOuterJoin:"Left outer join",rightOuterJoin:"Right outer join",division:"Division"},managementSection:{batchButton:"Batch",loadButton:"Load",saveButton:"Save",samplesButton:"Samples",samplesMenuTitle:"Prepared sample projects",settingsButton:"Settings",settingsNullValues:"Null values",settingsNullValuesAllowed:"allowed",settingsNullValuesForbidden:"forbidden",settingsCSVSeparator:"CSV separator",settingsCSVSeparatorSemicolon:"semicolon",settingsCSVSeparatorComma:"comma",settingsTheme:"Theme",settingsThemeLight:"light",settingsThemeDark:"dark",settingsLanguage:"Language",aboutButton:"About"},relationSection:{relationSectionHeader:"Relations",loadAllButton:"Load all",loadAllButtonTooltip:"Loads all valid relation into the application",removeLoadedButton:"Remove loaded",removeLoadedButtonTooltip:"Removes all loaded relations",importButton:"Import",importButtonTooltip:"Adds new relations from files",exportButton:"Export",exportButtonTooltip:"Saves stored relations to files",loadButton:"Load",loadButtonTooltip:"Loads the relation into the application",renameButton:"Rename",deleteButton:"Delete",deleteButtonTooltip:"Deletes the relation",revertButton:"Revert",revertButtonTooltip:"Reverts to last loaded state"},expressionSection:{expressionSectionHeader:"Expressions",importButton:"Import",importButtonTooltip:"Adds new expressions from a file",exportButton:"Export",exportButtonTooltip:"Saves expressions to a file",evaluateButton:"Evaluate",evaluateButtonTooltip:"Evaluates selected RA expression",renameButton:"Rename",deleteButton:"Delete",deleteButtonTooltip:"Deletes selected RA expression",expressionTextareaPlaceholder:"Write RA expression here...",lineComment:"Line comment",blockComment:"Block comment"},resultSection:{resultSectionHeader:"Result",exportEvalTreeButton:"Export",exportEvalTreeButtonTooltip:"Saves the evaluation tree as a picture",evalTreeTitle:"Evaluation tree of",resultRelationTitle:"Result relation",intermediateRelationTitle:"Intermediate relation",addButton:"Add",addButtonTooltip:"Adds the given relation to stored ones",exportRelationButton:"Export",exportRelationButtonTooltip:"Saves the given relation to a file"}},R=["EN","CS"],w=new Map([["EN",S],["CS",{abbr:"CS",relationErrors:{emptyColumn:"N\xe1zev sloupce nem\u016f\u017ee b\xfdt pr\xe1zdn\xfd",duplicitColumn:"Duplicitn\xed n\xe1zev sloupce",keywordColumn:"N\xe1zev sloupce nem\u016f\u017ee b\xfdt kl\xed\u010dov\xe9 slovo",invalidColumn:"Nepovolen\xe9 znaky v n\xe1zvu sloupce",unsupportedNull:"Null hodonoty nejsou podporov\xe1ny",invalidNumber:"Dan\xfd \u0159et\u011bzec nen\xed \u010d\xedslo",invalidBoolean:"Dan\xfd \u0159et\u011bzec nen\xed boolean"},codeErrors:S.codeErrors,semanticErrors:{exprParser_relationNotDefined:['Relace "','" nen\xed definov\xe1na. Zkontrolujte definice relac\xed.'],binaryNode_commonColumns:["Vstupn\xed relace pro ",' maj\xed spole\u010dn\xe9 sloupce "','".'],setOperationNode_notEqualColumns:['Vstupn\xed relace "','" a "','" pro mno\u017einov\xe9 '," nemaj\xed stejn\xe9 sch\xe9ma."],divisionNode_rightColumnsNotSubset:['Sch\xe9ma prav\xe9 vstupn\xed relace "','" nen\xed podmno\u017einou sch\xe9matu lev\xe9 vstupn\xed relace "','".'],divisionNode_rightColumnsNotProperSubset:['Sch\xe9ma prav\xe9 vstupn\xed relace "','" nen\xed vlastn\xed podmno\u017einou sch\xe9matu lev\xe9 vstupn\xed relace "',". V lev\xe9 relaci mus\xed existovat sloupec, kter\xfd neexistuje v prav\xe9 relaci."],renameNode_absentOriginalColumn:['Nepovolen\xe9 p\u0159ejmenov\xe1n\xed, sloupec "','" neexistuje ve vstupn\xed relaci.'],renameNode_changeToDuplicit:['Nepovolen\xe9 p\u0159ejmenov\xe1n\xed, nov\xfd n\xe1zev sloupce "','" je duplicitn\xed ve zm\u011bn\u011bn\xe9 relaci.'],projectionNode_absentColumn:['Nepovolen\xe1 projekce sloupce "','". Tento sloupec neexistuje ve vstupn\xed relaci.'],referenceValue_absentColumn:['Sloupec "','" neexistuje ve sch\xe9matu se sloupci ',"."]},semanticError:"S\xe9mantick\xe1 chyba: ",syntaxErrors:{exprParser_emptyStringGiven:["V\xfdraz nelze parsovat z pr\xe1zdn\xe9ho \u0159et\u011bzce."],exprParser_outerJoinWhenNullNotSupported:["Nalezeno ",", p\u0159esto\u017ee null hodnoty jsou zak\xe1z\xe1ny."],exprParser_unexpectedPart:['Ne\u010dekan\xe1 \u010d\xe1st "','" v RA v\xfdrazu.'],exprParser_bothBranchesError:['V\u0161echny kombinace zp\u016fsobuj\xed chybu v "','". Pova\u017eov\xe1no za projekci:\n',"\nPova\u017eov\xe1no za theta spojen\xed:\n",""],exprParser_invalidExpression:["Dan\xfd v\xfdraz nen\xed korektn\xed v\xfdraz rela\u010dn\xed algebry."],exprParser_invalidParentheses:["Chybn\xe9 uz\xe1vorkov\xe1n\xed ve v\xfdrazu."],exprParser_invalidStart:["RA v\xfdraz nem\u016f\u017ee za\u010d\xednat na ","."],exprParser_invalidEnd:["RA v\xfdraz nem\u016f\u017ee kon\u010dit na ","."],exprParser_relationAfterRelation:['Relace "','" po relaci "','".'],exprParser_relationAfterUnary:['Relace "','" po un\xe1rn\xedm oper\xe1toru "','".'],exprParser_relationAfterClosing:['Relace "','" po uzav\xedrac\xed z\xe1vorce.'],exprParser_unaryAfterBinary:['Un\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_unaryAfterOpening:['Un\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vorce.'],exprParser_binaryAfterBinary:['Bin\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_binaryAfterOpening:['Bin\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vorce.'],exprParser_openingAfterRelation:['Otev\xedrac\xed z\xe1vorka po relaci "','".'],exprParser_openingAfterUnary:['Otev\xedrac\xed z\xe1vorka po un\xe1rn\xedm oper\xe1toru "','".'],exprParser_openingAfterClosing:["Otev\xedrac\xed z\xe1vorka po uzav\xedrac\xed z\xe1vorce."],exprParser_closingAfterBinary:['Uzav\xedrac\xed z\xe1vorka po bin\xe1rn\xedm oper\xe1toru "','".'],exprParser_closingAfterOpening:["Uzav\xedrac\xed z\xe1vorka po otev\xedrac\xed z\xe1vorce."],valueParser_emptyInput:["Jako podm\xednka nem\u016f\u017ee b\xfdt pr\xe1zdn\xfd \u0159et\u011bzec."],valueParser_unsupportedNull:["Nalezena null konstanta, p\u0159esto\u017ee null hodnoty jsou zak\xe1z\xe1ny."],valueParser_unexpectedPart:['Ne\u010dekan\xe1 \u010d\xe1st "','" ve v\xfdrazu.'],valueParser_missingOpeningParenthesis:["Chyb\u011bj\xedc\xed otev\xedrac\xed z\xe1vorka ve v\xfdrazu."],valueParser_missingClosingParenthesis:["Chyb\u011bj\xedc\xed uzav\xedrac\xed z\xe1vorka ve v\xfdrazu."],valueParser_invalidExpression:["Dan\xfd v\xfdraz nen\xed korektn\xed."],valueParser_invalidStart:['V\xfdraz nem\u016f\u017ee za\u010d\xednat na "','".'],valueParser_invalidEnd:['V\xfdraz nem\u016f\u017ee kon\u010dit na "','".'],valueParser_literalAfterLiteral:['Konstanta "','" po konstant\u011b "','".'],valueParser_literalAfterReference:['Konstanta "','" po referenci sloupce "','".'],valueParser_literalAfterClosing:['Konstanta "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_referenceAfterLiteral:['Reference sloupce "','" po konstant\u011b "','".'],valueParser_referenceAfterReference:['Reference sloupce "','" po referenci sloupce "','".'],valueParser_referenceAfterClosing:['Reference sloupce "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_notAfterLiteral:['Logick\xe1 negace "','" po konstant\u011b "','".'],valueParser_notAfterReference:['Logick\xe1 negace "','" po referenci sloupce "','".'],valueParser_notAfterClosing:['Logick\xe1 negace "','" po uzav\xedrac\xed z\xe1vorce.'],valueParser_binaryAfterOperator:['Bin\xe1rn\xed oper\xe1tor "','" po bin\xe1rn\xedm oper\xe1toru "','".'],valueParser_binaryAfterOpening:['Bin\xe1rn\xed oper\xe1tor "','" po otev\xedrac\xed z\xe1vroce.'],valueParser_openingAfterLiteral:['Otev\xedrac\xed z\xe1vorka po konstant\u011b "','".'],valueParser_openingAfterReference:['Otev\xedrac\xed z\xe1vorka po referenci sloupce "','".'],valueParser_openingAfterClosing:["Otev\xedrac\xed z\xe1vorka po uzav\xedrac\xed z\xe1vorce."],valueParser_closingAfterOperator:['Uzav\xedrac\xed z\xe1vorka po bin\xe1rn\xedm oper\xe1toru "','".'],valueParser_closingAfterOpening:["Uzav\xedrac\xed z\xe1vorka po otev\xedrac\xed z\xe1vroce."],stringUtils_missingClosingChar:["Chyb\u011bj\xedc\xed '","' po \xfavodn\xed '","'."],stringUtils_charNotFound:['O\u010dek\xe1van\xfd znak "','" nenalezen.'],renameNode_missingArrow:['Chybn\xe9 p\u0159ejmenov\xe1n\xed, pou\u017eijte form\xe1t "Star\xfdN\xe1zev -> Nov\xfdN\xe1zev" odd\u011blen\xfd \u010d\xe1rkami.'],renameNode_invalidNewName:['Chybn\xe9 p\u0159ejmenov\xe1n\xed na "','". Nov\xfd n\xe1zev sloupce mus\xed obsahovat pouze p\xedsmena, \u010d\xedsla a podtr\u017e\xedtka a za\u010d\xednat p\xedsmenem nebo podtr\u017e\xedtkem.'],renameNode_keywordNewName:['Chybn\xe9 p\u0159ejmenov\xe1n\xed na "','". Nov\xfd n\xe1zev nem\u016f\u017ee b\xfdt kl\xed\u010dov\xe9 slovo.'],renameNode_multipleRenameOfTheColumn:['V\xedcen\xe1sobn\xe9 p\u0159ejmenov\xe1n\xed sloupce "','".'],selectionNode_resultNotBoolean:["V\xfdsledek podm\xednky v selekci "," nen\xed boolean, ale ","."],thetaJoinNode_resultNotBoolean:["V\xfdsledek podm\xednky v theta joinu "," nen\xed boolean, ale ","."],comparingOperator_differentInputTypes:['Vstupy pro "','" nemaj\xed stejn\xe9 typy, ale '," a ","."],computingOperator_inputTypesNotNumbers:['Vstupy pro "','" nejsou \u010d\xedsla, ale '," a ","."],logicalOperator_leftInputNotBoolean:['Lev\xfd vstup logick\xe9ho oper\xe1toru "','" nen\xed boolean, ale ',"."],logicalOperator_rightInputNotBoolean:['Prav\xfd vstup logick\xe9ho oper\xe1toru "','" nen\xed boolean, ale ',"."]},syntaxError:"Syntaktick\xe1 chyba: ",userMessages:{loadedRelationsTotalNo:"Nyn\xed nejsou v aplikaci nahran\xe9 \u017e\xe1dn\xe9 relace.",loadedRelationsTotalSome:" relac\xed celkov\u011b nahr\xe1no v aplikaci: ",loadRelationNew:"Relace nahr\xe1na do aplikace.",loadAllRelationsNew:[" relac\xed nahr\xe1no do aplikace, "," p\u0159esko\u010deno kv\u016fli chyb\xe1m."],deleteLoadedRelations:" relac\xed odebr\xe1no.",relationsExportOK:"Relace sta\u017eeny.",relationsExportErr:"Stahov\xe1n\xed relac\xed selhalo: ",relationsImport:[" relac\xed nahr\xe1no, "," soubor\u016f p\u0159esko\u010deno."],expressionsExportOK:"V\xfdrazy sta\u017eeny do souboru.",expressionsExportErr:"Stahov\xe1n\xed v\xfdraz\u016f selhalo: ",expressionsImport:[" v\xfdraz\u016f nahr\xe1no z "," soubor\u016f ("," v\xfdraz\u016f p\u0159esko\u010deno, "," soubor\u016f p\u0159esko\u010deno)."]},operations:{selection:"Selekce",projection:"Projekce",rename:"P\u0159ejmenov\xe1n\xed",union:"Sjednocen\xed",intersection:"Pr\u016fnik",difference:"Rozd\xedl",naturalJoin:"P\u0159irozen\xe9 spojen\xed",cartesianProduct:"Kart\xe9zsk\xfd sou\u010din",leftSemiJoin:"Lev\xe9 vnit\u0159n\xed spojen\xed",rightSemiJoin:"Prav\xe9 vnit\u0159n\xed spojen\xed",leftAntijoin:"Lev\xfd antijoin",rightAntijoin:"Prav\xfd antijoin",thetaJoin:"Theta spojen\xed",leftThetaSemiJoin:"Lev\xe9 theta spojen\xed",rightThetaSemiJoin:"Prav\xe9 theta spojen\xed",fullOuterJoin:"Pln\xe9 vn\u011bj\u0161\xed spojen\xed",leftOuterJoin:"Lev\xe9 vn\u011bj\u0161\xed spojen\xed",rightOuterJoin:"Prav\xe9 vn\u011bj\u0161\xed spojen\xed",division:"D\u011blen\xed"},managementSection:{batchButton:"Batch",loadButton:"Nahr\xe1t",saveButton:"Ulo\u017eit",samplesButton:"Uk\xe1zky",samplesMenuTitle:"P\u0159ipraven\xe9 vzorov\xe9 projekty",settingsButton:"Nastaven\xed",settingsNullValues:"Null hodnoty",settingsNullValuesAllowed:"povoleny",settingsNullValuesForbidden:"zak\xe1z\xe1ny",settingsCSVSeparator:"CSV odd\u011blova\u010d",settingsCSVSeparatorSemicolon:"st\u0159edn\xedk",settingsCSVSeparatorComma:"\u010d\xe1rka",settingsTheme:"Re\u017eim",settingsThemeLight:"sv\u011btl\xfd",settingsThemeDark:"tmav\xfd",settingsLanguage:"Jazyk",aboutButton:"O aplikaci"},relationSection:{relationSectionHeader:"Relace",loadAllButton:"Nahr\xe1t v\u0161echny",loadAllButtonTooltip:"Nahraje v\u0161echny bezchybn\xe9 relace do aplikace",removeLoadedButton:"Odebrat nahran\xe9",removeLoadedButtonTooltip:"Odebere v\u0161echny nahran\xe9 relace z aplikace",importButton:"Import",importButtonTooltip:"Nahraje nov\xe9 relace ze soubor\u016f",exportButton:"Export",exportButtonTooltip:"St\xe1hne editovan\xe9 relace do soubor\u016f",loadButton:"Nahr\xe1t",loadButtonTooltip:"Nahraje relaci do aplikace",renameButton:"P\u0159ejmenovat",deleteButton:"Odstranit",deleteButtonTooltip:"Odstran\xed vybranou relaci",revertButton:"Obnovit",revertButtonTooltip:"Obnov\xed relaci do posledn\xedho nahran\xe9ho stavu"},expressionSection:{expressionSectionHeader:"V\xfdrazy",importButton:"Import",importButtonTooltip:"Nahraje nov\xe9 v\xfdrazy ze souboru",exportButton:"Export",exportButtonTooltip:"St\xe1hne v\xfdrazy do souboru",evaluateButton:"Vyhodnotit",evaluateButtonTooltip:"Vyhodnot\xed vybran\xfd rela\u010dn\xed v\xfdraz",renameButton:"P\u0159ejmenovat",deleteButton:"Odstranit",deleteButtonTooltip:"Odstran\xed vybran\xfd rela\u010dn\xed v\xfdraz",expressionTextareaPlaceholder:"Zde napi\u0161te sv\u016fj rela\u010dn\xed v\xfdraz...",lineComment:"\u0158\xe1dkov\xfd koment\xe1\u0159",blockComment:"Blokov\xfd koment\xe1\u0159"},resultSection:{resultSectionHeader:"V\xfdsledek",exportEvalTreeButton:"Export",exportEvalTreeButtonTooltip:"Ulo\u017e\xed evalua\u010dn\xed strom jako obr\xe1zek",evalTreeTitle:"Evalua\u010dn\xed strom pro",resultRelationTitle:"V\xfdsledn\xe1 relace",intermediateRelationTitle:"Meziv\xfdsledn\xe1 relace",addButton:"P\u0159idat",addButtonTooltip:"P\u0159id\xe1 zvolenou relaci mezi editovan\xe9",exportRelationButton:"Export",exportRelationButtonTooltip:"St\xe1hne zvolenou relaci do souboru"}}]]);function C(){var e=w.get(k.getLanguage());return void 0===e?S:e}var j=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,C().syntaxError+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(a),n),a.name="RASyntaxError",a}return n}(y),O=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),a=t.call(this,C().semanticError+e,r),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(a),n),a.name="RASemanticError",a}return n}(y);n(37);function N(e,t){var n="0123456789qwertyuiopasdfghjkllzxcvbnmQWERTYUIOOPASDFGHJKLLZXCVBNM!@#$%^&*()_+[];',./",r=document.createElement("div");r.setAttribute("style","font-family: ".concat(e,"; font-size: ").concat(t,"; position: absolute; white-space: nowrap;")),r.innerText=n,document.documentElement.appendChild(r);var a=r.clientWidth,o=r.clientHeight;return r.remove(),{fontWidth:a/n.length,fontHeight:o}}function T(e,t){for(var n=e.slice(0,t),r=n.length-1;;){if(!n.charAt(r).match(/\w/)){++r;break}if(0===r)break;--r}return r}var A=getComputedStyle(document.querySelector(":root")),P=A.getPropertyValue("--x-textarea-font-size"),_=A.getPropertyValue("--x-textarea-font-family"),V=N(_,P).fontWidth,I=Number(A.getPropertyValue("--x-textarea-line-height")),L=A.getPropertyValue("--light-color-b"),B=A.getPropertyValue("--dark-color-b"),D=A.getPropertyValue("--text-color-light"),W=A.getPropertyValue("--text-color-dark"),z=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).textarea=void 0,e}return Object(p.a)(n,[{key:"getSelection",value:function(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}}},{key:"setSelection",value:function(e,t){this.textarea.setSelectionRange(e,t||e)}},{key:"isFocused",value:function(){return null!==document.activeElement&&document.activeElement.id===this.props.id+"-ta"}},{key:"focus",value:function(){this.textarea.focus()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=document.getElementById(t.id),r=document.createElement("table");r.setAttribute("cellspacing","0"),r.setAttribute("cellpadding","0"),r.classList.add("x-textarea-table");var a=document.createElement("tr"),o=document.createElement("td");o.setAttribute("id",t.id+"-td1"),o.classList.add("x-textarea-table-td1");var i=document.createElement("td");i.classList.add("x-textarea-table-td2"),a.appendChild(o),a.appendChild(i),r.appendChild(a);var s=document.createElement("textarea");s.setAttribute("id",t.id+"-ta"),s.setAttribute("spellcheck","false"),s.mouseIsDown=!1,s.setAttribute("placeholder",this.props.placeholder),s.classList.add("x-textarea","scrollbar-container"),s.value=t.text;var l=document.createElement("canvas");l.width=28,l.classList.add("x-textarea-canvas"),s.canvasLines=l,o.appendChild(l),i.appendChild(s),n.appendChild(r);var u=document.createElement("div");u.classList.add("whisper-div"),u.isShown=!1,u.selectedIndex=-1,u.changeSelected=function(e){this.setSelected(this.selectedIndex+e)},u.setSelected=function(e){var t,n;this.childElementCount>0&&(this.selectedIndex>-1&&this.selectedIndex<this.childElementCount&&this.children[this.selectedIndex].classList.remove("selected-whisper"),this.selectedIndex=(t=e,n=this.childElementCount,(t%n+n)%n),this.children[this.selectedIndex].classList.add("selected-whisper"))},u.getSelectedWhisper=function(){if(this.selectedIndex>-1&&this.childElementCount>0)return this.children[this.selectedIndex].innerText},s.whisperDiv=u,i.appendChild(u),s.paintLineNumbers=function(e){try{var t=this.canvasLines;t.height!==this.clientHeight&&(t.height=this.clientHeight);var n=t.getContext("2d");n.fillStyle=e?B:L,n.fillRect(0,0,26,this.scrollHeight+1),n.fillStyle=e?W:D,n.font=P+" "+_;for(var r=0;r<this.linesCount;r++){var a=""+(r+1);n.fillText(a,24-8*a.length,19+r*I)}}catch(o){console.log("XTextArea paintLineNumbers error: "+o)}},s.update=function(e,t){this.value=e;for(var n=1,r=0;r<e.length;++r)"\n"===e.charAt(r)&&++n;this.linesCount=n,this.style.height=n*I+8+"px",this.scrollHeight>this.clientHeight&&(this.style.height=this.scrollHeight+I+10+"px"),this.paintLineNumbers(t),this.updateParentheses()},s.createWhisper=function(e){var t=this;0===e.length?this.hideWhisper():(this.whisperDiv.innerHTML="",e.forEach((function(e,n){var r=document.createElement("div");r.innerHTML=e,r.onclick=function(e){t.focus(),t.whisperDiv.setSelected(n),e.stopPropagation()},r.ondblclick=function(e){t.focus(),t.insertCurrentSelectedWhisper(),t.notAutoShowWhisper=!0,e.stopPropagation()},t.whisperDiv.appendChild(r)})),this.whisperDiv.setSelected(0),this.whisperDiv.isShown=!0,this.moveWhisper())},s.moveWhisper=function(){if(this.whisperDiv.isShown){var e=J(this.value,this.selectionEnd),t=(e.line+1)*I,n=e.column*V,r=t-this.scrollTop,a=n-this.scrollLeft+4;0<=r&&r<this.clientHeight&&0<=a&&a<this.clientWidth?this.getBoundingClientRect().y+r<=window.innerHeight/2?this.whisperDiv.setAttribute("style","display: block; top: ".concat(r+4,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: block; bottom: ".concat(this.getBoundingClientRect().height-r+I,"px; left: ").concat(a,"px;")):this.whisperDiv.setAttribute("style","display: none;")}},s.hideWhisper=function(){this.whisperDiv.setAttribute("style","display: none;"),this.whisperDiv.isShown=!1},s.insertCurrentSelectedWhisper=function(){var e=this.whisperDiv.getSelectedWhisper();if(void 0!==e){var n=T(this.value,this.selectionEnd),r=this.value.slice(0,n),a=this.value.slice(this.selectionEnd),o=n+e.length;t.onChange(r+e+a,o),this.setSelectionRange(o,o),this.hideWhisper()}},s.notAutoShowWhisper=!1,s.errorDivs=[],s.moveErrors=function(){var e=this;this.errorDivs.forEach((function(t){var n=(t.startLine+1)*I+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=t.rangeLength*V,a=t.startColumn*V+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),e.getBoundingClientRect().x+a>=window.innerWidth/2&&t.messageSpan.setAttribute("style","right: 50%; left: unset;"),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},s.updateErrors=function(e){var t=this;this.errorDivs.forEach((function(e){e.remove()})),this.errorDivs=[];var n=function(e){t.parentElement.appendChild(e),t.errorDivs.push(e)};e.forEach((function(e){var r=J(t.value,e.start),a=J(t.value,e.end);if(r.line===a.line)n(F(r.line,r.column,a.column-r.column,e.msg,t));else{n(F(r.line,r.column,U(t.value,r.line)-r.column,e.msg,t));for(var o=r.line+1;o<a.line;++o)n(F(o,0,U(t.value,o),e.msg,t));n(F(a.line,0,a.column,e.msg,t))}})),this.moveErrors()},s.parentheses=[],s.parenthesesDivs=[],s.updateParentheses=function(){if(s.parenthesesDivs.forEach((function(e){e.remove()})),s.parenthesesDivs=[],s.selectionStart===s.selectionEnd){var e=s.selectionStart,t=e-1,n=s.parentheses.filter((function(n){return n.start===e||n.start===t||n.end===e||n.end===t})),r=!0;n.forEach((function(e){var t=J(s.value,e.start),n=J(s.value,e.end),a=M(t.line,t.column,s),o=M(n.line,n.column,s);s.parentElement.appendChild(a),s.parentElement.appendChild(o),s.parenthesesDivs.push(a),s.parenthesesDivs.push(o),a.classList.toggle("first-pair",r),a.classList.toggle("second-pair",!r),o.classList.toggle("first-pair",r),o.classList.toggle("second-pair",!r),r=!1})),s.moveParentheses()}},s.moveParentheses=function(){var e=this;s.parenthesesDivs.forEach((function(t){var n=(t.startLine+1)*I+1-e.scrollTop;if(1<n&&n<e.clientHeight){var r=V,a=t.startColumn*V+7-e.scrollLeft;a>e.clientWidth||a+r<3?t.setAttribute("style","display: none;"):(a<3&&(r+=a-3,a=3),a+r>e.clientWidth&&(r=e.clientWidth-a),t.setAttribute("style","display: block; top: ".concat(n,"px; left: ").concat(a,"px; width: ").concat(r,"px")))}else t.setAttribute("style","display: none;")}))},s.insertPairSymbol=function(e,n){var r=s.value.slice(0,this.selectionStart),a=s.value.slice(this.selectionStart,this.selectionEnd),o=s.value.slice(this.selectionEnd),i=s.selectionEnd+1;t.onChange(r+e+a+n+o,i),this.setSelectionRange(i,i),this.hideWhisper()},s.checkPairSymbolDelete=function(){if(s.selectionStart===s.selectionEnd){var e=s.selectionStart-1,n=s.selectionStart;if(0<=e&&n<s.value.length){var r=this.value.charAt(e),a=this.value.charAt(n);if("("===r&&")"===a||"["===r&&"]"===a||'"'===r&&'"'===a){var o=s.value.slice(0,e),i=s.value.slice(n+1);return t.onChange(o+i,e),this.setSelectionRange(e,e),!0}}}return!1},window.addEventListener("scroll",(function(){return s.moveWhisper()})),window.addEventListener("resize",(function(){s.moveWhisper(),s.moveErrors(),s.moveParentheses()})),window.addEventListener("click",(function(){return s.hideWhisper()})),s.onscroll=function(){s.paintLineNumbers(e.props.darkTheme),s.moveWhisper(),s.moveErrors(),s.moveParentheses()},s.onmousedown=function(e){s.mouseIsDown=!0,setTimeout(s.updateParentheses,0),e.stopPropagation()},s.onmouseup=function(){s.mouseIsDown=!1,s.paintLineNumbers(e.props.darkTheme),setTimeout(s.updateParentheses,0)},s.onmousemove=function(){s.mouseIsDown&&s.paintLineNumbers(e.props.darkTheme)},s.oninput=function(t){e.props.onChange(t.target.value,t.target.selectionStart)},s.onkeydown=function(t){if(s.whisperDiv.isShown){if("ArrowDown"===t.key&&(s.whisperDiv.changeSelected(1),t.preventDefault()),"ArrowUp"===t.key&&(s.whisperDiv.changeSelected(-1),t.preventDefault()),"PageDown"===t.key&&(s.whisperDiv.setSelected(-1),t.preventDefault()),"PageUp"===t.key&&(s.whisperDiv.setSelected(0),t.preventDefault()),"End"!==t.key&&"Home"!==t.key||s.hideWhisper(),"Escape"!==t.key&&"Esc"!==t.key||(s.hideWhisper(),t.preventDefault()),"Enter"!==t.key||t.ctrlKey||(s.insertCurrentSelectedWhisper(),t.preventDefault()),"Enter"===t.key&&t.ctrlKey&&(s.hideWhisper(),t.preventDefault()),"Tab"===t.key&&(s.insertCurrentSelectedWhisper(),t.preventDefault()),"ArrowLeft"===t.key){var n=0===s.selectionStart?0:s.selectionStart-1;e.props.onChange(s.value,n)}if("ArrowRight"===t.key){var r=s.selectionStart===s.value.length?s.selectionStart:s.selectionStart+1;e.props.onChange(s.value,r)}}"Enter"!==t.key&&"Tab"!==t.key||(s.notAutoShowWhisper=!0),"Backspace"!==t.key||s.whisperDiv.isShown||(s.notAutoShowWhisper=!0),t.ctrlKey&&(" "===t.key&&(s.whisperDiv.isShown?s.hideWhisper():e.props.onChange(s.value,s.selectionStart)),e.props.onCtrlInput(t)),"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key&&"PageUp"!==t.key&&"PageDown"!==t.key||setTimeout(s.updateParentheses,0),"("===t.key&&(s.insertPairSymbol("(",")"),t.preventDefault()),"["===t.key&&(s.insertPairSymbol("[","]"),t.preventDefault()),'"'===t.key&&(s.insertPairSymbol('"','"'),t.preventDefault()),"Backspace"===t.key&&s.checkPairSymbolDelete()&&t.preventDefault()},s.update(this.props.text,this.props.darkTheme),s.updateErrors(this.props.errors),this.textarea=s}},{key:"componentDidUpdate",value:function(e){this.textarea.update(this.props.text,this.props.darkTheme),e.darkTheme!==this.props.darkTheme&&this.textarea.paintLineNumbers(this.props.darkTheme),this.props.whispers!==e.whispers&&(this.textarea.notAutoShowWhisper?this.textarea.notAutoShowWhisper=!1:this.textarea.createWhisper(this.props.whispers)),void 0!==this.props.errors?this.textarea.updateErrors(this.props.errors):this.props.errors!==e.errors&&this.textarea.classList.remove("x-textarea-err"),this.props.parentheses!==e.parentheses&&(this.textarea.parentheses=this.props.parentheses,this.textarea.updateParentheses())}},{key:"render",value:function(){return a.a.createElement("div",{id:this.props.id,className:"x-textarea-div"})}}]),n}(a.a.Component);function J(e,t){var n=e.slice(0,t),r=(n.match(/\n/g)||[]).length,a=n.lastIndexOf("\n");return{line:r,column:n.length-a-1}}function U(e,t){for(var n=0,r=0,a=0,o=0;o<e.length;++o)if("\n"===e.charAt(o))if(++n===t)r=o;else if(n===t+1){a=o;break}return 0===a&&(a=e.length),a-r}function F(e,t,n,r,a){var o=document.createElement("div");o.classList.add("x-textarea-highlight"),o.startLine=e,o.startColumn=t,o.rangeLength=n,o.onclick=function(e){var t=new MouseEvent(e.type,Object(d.a)({},e));a.dispatchEvent(t),e.stopPropagation()};var i=document.createElement("span");return i.classList.add("highlight-tooltip"),i.innerText=r,o.messageSpan=i,o.appendChild(i),o}function M(e,t,n){var r=document.createElement("div");return r.classList.add("x-textarea-parentheses"),r.startLine=e,r.startColumn=t,r.onclick=function(e){var t=new MouseEvent(e.type,Object(d.a)({},e));n.dispatchEvent(t),e.stopPropagation()},r}var H=n(8),q=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.columns=new Map,this.columnNames=[],this.rows=[],this.finishedSchema=!1,this.name=t}return Object(p.a)(e,[{key:"getName",value:function(){return this.name}},{key:"hasFinishedSchema",value:function(){return this.finishedSchema}},{key:"finishSchema",value:function(){this.finishedSchema=!0}},{key:"addColumn",value:function(e,t){return!this.hasColumn(e)&&!this.hasFinishedSchema()&&(this.columns.set(e,t),this.columnNames.push(e),!0)}},{key:"hasColumn",value:function(e){return this.columnNames.some((function(t){return t===e}))}},{key:"getColumns",value:function(){return this.columns}},{key:"forEachColumn",value:function(e){return this.columns.forEach(e)}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"getColumnsCount",value:function(){return this.columnNames.length}},{key:"addRow",value:function(e){return!!Object(H.isEqual)(e.getTypes(),this.columns)&&(this.finishSchema(),e.finish(),this.rows.some((function(t){return t.equals(e)}))||this.rows.push(e),!0)}},{key:"getRows",value:function(){return this.rows}},{key:"getRowsCount",value:function(){return this.rows.length}},{key:"getSchemaString",value:function(){return this.name+"("+Object(u.a)(this.columns).map((function(e){return e[0]+": "+e[1]})).join(", ")+")"}},{key:"getNamesSchemaString",value:function(){return this.name+"("+this.columnNames.join(", ")+")"}},{key:"contentString",value:function(){var e=this,t=this.columnNames.map((function(t){return e.columns.get(t)})),n=Object(u.a)(this.rows).map((function(t){return t.getOrderedPrintValues(e.columnNames)})),r=this.columnNames.map((function(e){return e.length}));t.forEach((function(e,t){e.length>r[t]&&(r[t]=e.length)})),n.forEach((function(e){e.forEach((function(e,t){r[t]<e.length&&(r[t]=e.length)}))}));var a=function(e){return e.map((function(e,t){return e.padEnd(r[t]," ")})).join(" | ")};return a(this.columnNames)+"\n"+a(t)+"\n"+r.map((function(e){return"-".repeat(e)})).join("-+-")+"\n"+n.map((function(e){return a(e)})).join("\n")}},{key:"equals",value:function(t){return t instanceof e&&(this.name===t.name&&Object(H.isEqual)(this.columns,t.columns)&&Object(H.isEqual)(new Set(this.rows),new Set(t.rows)))}}]),e}(),K=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),r=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(Object(v.a)(r),n),r.name="CodeError",r}return n}(Object(g.a)(Error)),G=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"codeError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Z(e.length-1,n),new K(Q(e,n))}},{key:"semanticError",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return Z(e.length-1,r),new O(Q(e,r),t)}},{key:"syntaxError",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return Z(e.length-1,r),new j(Q(e,r),t)}}]),e}();function Z(e,t){if(t.length!==e)for(console.log("Unexpected params count, expected "+e+", given "+t.length);t.length<e;)t.push("")}function Q(e,t){for(var n,r=e.length,a=Array(2*r-2),o=1;o<r;o++)a[2*o-2]=t[o-1],a[2*o-1]=e[o];return(n=e[0]).concat.apply(n,a)}var X=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(p.a)(e,[{key:"getRange",value:function(){return this.str.getRange()}}]),e}(),$=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return n}(X),Y=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}($),ee=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}($),te=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(X),ne=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).type=r,a}return Object(p.a)(n,null,[{key:"selection",value:function(e){return new n(e,"selection")}},{key:"projection",value:function(e){return new n(e,"projection")}},{key:"rename",value:function(e){return new n(e,"rename")}}]),n}(X),re=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).precedence=r,o.type=a,o}return Object(p.a)(n,null,[{key:"naturalJoin",value:function(e){return new n(e,10,"natural join")}},{key:"cartesianProduct",value:function(e){return new n(e,10,"cartesian product")}},{key:"union",value:function(e){return new n(e,4,"union")}},{key:"intersection",value:function(e){return new n(e,6,"intersection")}},{key:"difference",value:function(e){return new n(e,5,"difference")}},{key:"leftSemijoin",value:function(e){return new n(e,9,"left semijoin")}},{key:"rightSemijoin",value:function(e){return new n(e,9,"right semijoin")}},{key:"leftAntijoin",value:function(e){return new n(e,9,"left antijoin")}},{key:"rightAntijoin",value:function(e){return new n(e,9,"right antijoin")}},{key:"thetaJoin",value:function(e){return new n(e,10,"theta join")}},{key:"leftThetaSemijoin",value:function(e){return new n(e,9,"left theta semijoin")}},{key:"rightThetaSemijoin",value:function(e){return new n(e,9,"right theta semijoin")}},{key:"fullOuterJoin",value:function(e){return new n(e,8,"full outer join")}},{key:"leftOuterJoin",value:function(e){return new n(e,8,"left outer join")}},{key:"rightOuterJoin",value:function(e){return new n(e,8,"right outer join")}},{key:"division",value:function(e){return new n(e,7,"division")}}]),n}(X),ae=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"isWord",value:function(t){return t.length>0&&t.split("").every((function(t){return e.isLetter(t)}))}},{key:"isName",value:function(t){return 0!==t.length&&(!(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))&&t.split("").every((function(t){return e.isNameChar(t)})))}},{key:"isWhitespacesOnly",value:function(e){var t=/\s*/.exec(e);return null!==t&&t[0]===e}},{key:"isLetter",value:function(e){return 1===e.length&&e.toLowerCase()!==e.toUpperCase()}},{key:"isNameChar",value:function(t){return e.isLetter(t)||e.isDigit(t)||"_"===t}},{key:"isDigit",value:function(e){return 1===e.length&&null!==e.match(/\d/)}},{key:"isNumber",value:function(e){return/^[-]?[\d]+([.][\d]+)?$/.test(e)}},{key:"nextWord",value:function(t){if(""===t)return{first:"",second:""};for(var n=0;n<t.length;){if(!e.isLetter(t.charAt(n)))return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextName",value:function(t){if(""===t)return{first:"",second:""};if(!e.isLetter(t.charAt(0))&&"_"!==t.charAt(0))return{first:"",second:t};for(var n=0;n<t.length;){var r=t.charAt(n);if(!e.isLetter(r)&&!e.isDigit(r)&&"_"!==r)return{first:t.substring(0,n),second:t.substring(n)};++n}return{first:t,second:""}}},{key:"nextNonWhitespacePart",value:function(e){if(""===e)return{first:"",second:""};for(var t=0;t<e.length;){if(e.charAt(t).match(/\s/))return{first:e.substring(0,t),second:e.substring(t)};++t}return{first:e,second:""}}},{key:"nextNumber",value:function(t){if(""===t)return{first:"",second:""};var n=0;if("-"===t.charAt(0)){if(!(t.length>1&&e.isDigit(t.charAt(1))))return{first:"",second:t};n=1}for(var r=!1,a=!1;n<t.length;)if(e.isDigit(t.charAt(n)))r=!0,++n;else{if("."!==t.charAt(n))break;if(a||!r)break;a=!0,++n}return{first:t.substring(0,n),second:t.substring(n)}}},{key:"nextQuotedString",value:function(e){for(var t=1,n=0;t<e.length;){var r=e.charAt(t);if(++t,'"'===r&&n%2===0)return{first:e.slice(0,t),second:e.slice(t),error:void 0};if("\n"===r)return{first:e.slice(0,t),second:e.slice(t),error:G.syntaxError(C().syntaxErrors.stringUtils_missingClosingChar,void 0,'"','"')};"\\"===r?++n:n=0}return{first:e,second:"",error:G.syntaxError(C().syntaxErrors.stringUtils_missingClosingChar,void 0,'"','"')}}},{key:"nextBorderedPart",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0",a=1,o=1,i=!1,s=1===n.length,l=0,u=0;o<e.length;){var c=e.charAt(o);if(n.indexOf(c)>-1&&u%2===0&&!i?--a:c===t&&u%2===0&&s&&!i?++a:'"'===c&&l%2===0&&(i=!i),c===r?++u:u=0,"\\"===c?++l:l=0,++o,0===a)return{first:e.slice(0,o),second:e.slice(o)}}throw G.syntaxError(C().syntaxErrors.stringUtils_missingClosingChar,void 0,n.split("").join("' / '"),t)}},{key:"skipWhitespacesAndChar",value:function(e,t){for(var n=!1,r=0;r<e.length;)if(e.charAt(r).match(/\s/))++r;else{if(e.charAt(r)!==t||n)break;n=!0,++r}if(!n)throw G.syntaxError(C().syntaxErrors.stringUtils_charNotFound,void 0,t);return e.substring(r)}}]),e}(),oe=function(){function e(){Object(c.a)(this,e),this.resultRelation=void 0}return Object(p.a)(e,[{key:"isEvaluated",value:function(){return void 0!==this.resultRelation}},{key:"getResult",value:function(){return void 0===this.resultRelation&&this.eval(),this.resultRelation}}]),e}(),ie=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).resultRelation=e,r}return Object(p.a)(n,[{key:"eval",value:function(){}},{key:"fakeEval",value:function(e){return{result:this.resultRelation,whispers:[],errors:[]}}},{key:"printInLine",value:function(){return this.resultRelation.getName()}},{key:"getOperationName",value:function(){return this.resultRelation.getName()}},{key:"getOperationSymbol",value:function(){return""}}]),n}(oe),se=function(){function e(t,n){Object(c.a)(this,e),this.str=t,this.chars=n}return Object(p.a)(e,null,[{key:"new",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t,t.split("").map((function(e,t){return{char:e,index:t+n}})))}},{key:"empty",value:function(){return new e("",[])}},{key:"newFromArray",value:function(t){return new e(t.map((function(e){return e.char})).join(""),t)}}]),Object(p.a)(e,[{key:"toString",value:function(){return this.str}},{key:"length",value:function(){return this.str.length}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"getChars",value:function(){return this.chars}},{key:"getFirstIndex",value:function(){return this.isEmpty()?NaN:this.chars[0].index}},{key:"getLastIndex",value:function(){return this.isEmpty()?NaN:this.chars[this.length()-1].index}},{key:"getRange",value:function(){if(!this.isEmpty())return{start:this.chars[0].index,end:this.chars[this.length()-1].index}}},{key:"charAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].char}},{key:"indexAt",value:function(e){if(e<0||e>=this.length())throw new RangeError;return this.chars[e].index}},{key:"split",value:function(t){var n=this;if(this.isEmpty())return""===t?[]:[e.empty()];var r=t.length,a=this.str.split(t),o=Array(a.length);o[0]=0;for(var i=1;i<a.length;i++)o[i]=o[i-1]+a[i-1].length+r;return a.map((function(t,r){return new e(t,n.chars.slice(o[r],o[r]+t.length))}))}},{key:"splitToLines",value:function(){var t=this;if(this.isEmpty())return{split:[e.empty()],separatorIndexes:[]};var n=this.str.split("\n"),r=n.length-1,a=Array(n.length),o=Array(n.length-1);a[0]=0;for(var i=0;i<r;i++){var s=a[i]+n[i].length+1;o[i]=this.indexAt(s-1),a[i+1]=s}return{split:n.map((function(n,r){return new e(n,t.chars.slice(a[r],a[r]+n.length))})),separatorIndexes:o}}},{key:"slice",value:function(t,n){var r=t<0?this.length()+t:t,a=void 0!==n?n<0?this.length()+n:n:this.length();if(r>a||r<0||a>this.length())throw new RangeError;return e.newFromArray(this.chars.slice(r,a))}},{key:"trim",value:function(){var t=this.str.trim();if(""===t)return new e("",[]);var n=this.str.indexOf(t.charAt(0));return e.newFromArray(this.chars.slice(n,n+t.length))}},{key:"concat",value:function(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.newFromArray((t=this.chars).concat.apply(t,Object(u.a)(r.map((function(e){return e.chars})))))}},{key:"startsWith",value:function(e,t){return this.str.startsWith(e,t)}},{key:"endsWith",value:function(e,t){return this.str.endsWith(e,t)}},{key:"replace",value:function(e,t){return this.str.replace(e,t)}},{key:"copy",value:function(){return new e(this.str,this.chars.map((function(e){return{char:e.char,index:e.index}})))}},{key:"containsAny",value:function(e){for(var t=0;t<e.length;++t)if(this.str.indexOf(e[t])>-1)return!0;return!1}}]),e}(),le=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"isWord",value:function(e){return ae.isWord(e.toString())}},{key:"isName",value:function(e){return ae.isName(e.toString())}},{key:"isWhitespacesOnly",value:function(e){return ae.isWhitespacesOnly(e.toString())}},{key:"isLetter",value:function(e){return ae.isLetter(e.toString())}},{key:"isNameChar",value:function(e){return ae.isNameChar(e.toString())}},{key:"isDigit",value:function(e){return ae.isDigit(e.toString())}},{key:"isNumber",value:function(e){return ae.isNumber(e.toString())}},{key:"nextWord",value:function(e){var t=ae.nextWord(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextName",value:function(e){var t=ae.nextName(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNonWhitespacePart",value:function(e){var t=ae.nextNonWhitespacePart(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextNumber",value:function(e){var t=ae.nextNumber(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length)}}},{key:"nextQuotedString",value:function(e){var t=ae.nextQuotedString(e.toString());return{first:e.slice(0,t.first.length),second:e.slice(t.first.length),error:b(t.error,{start:e.getFirstIndex(),end:e.getFirstIndex()})}}},{key:"nextBorderedPart",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\0";try{var a=ae.nextBorderedPart(e.toString(),t,n,r);return{first:e.slice(0,a.first.length),second:e.slice(a.first.length)}}catch(o){throw b(o,{start:e.getFirstIndex(),end:e.getFirstIndex()})}}},{key:"deleteAllComments",value:function(e){for(var t=e.copy().getChars(),n=!1,r=!1,a=-1,o=0,i=0;i<t.length;++i){var s=t[i].char;'"'!==s||o%2!==0||r||-1!==a?"/"===s&&i+1<t.length&&"/"===t[i+1].char&&!n&&!r&&-1===a?(r=!0,t[i].char="\0",++i):"\n"===s?r=!1:"/"===s&&i+1<t.length&&"*"===t[i+1].char&&!n&&!r&&-1===a?(a=i,t[i].char="\0",t[++i].char=" "):"*"===s&&i+1<t.length&&"/"===t[i+1].char&&-1!==a&&(a=-1,t[i].char="\0",t[++i].char=" "):n=!n,"\\"===s?++o:o=0,(r||-1!==a)&&(t[i].char="\0")}var l=void 0;if(-1!==a){var u=t[a].index;l=G.syntaxError(C().syntaxErrors.stringUtils_missingClosingChar,{start:u,end:u+1},"*/","/*")}return{str:se.newFromArray(t.filter((function(e){return"\0"!==e.char}))),err:l}}},{key:"skipWhitespacesAndChar",value:function(e,t){try{var n=ae.skipWhitespacesAndChar(e.toString(),t);return e.slice(e.length()-n.length)}catch(r){throw b(r,e.getRange())}}}]),e}(),ue=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).subtree=void 0,r.subtree=e,r}return Object(p.a)(n,[{key:"getSubtree",value:function(){return this.subtree}}]),n}(oe),ce=function(){function e(t){var n=this;Object(c.a)(this,e),this.types=new Map,this.values=new Map,this.finished=void 0,t.forEach((function(e,t){n.values.set(t,null)})),this.types=t,this.finished=!1}return Object(p.a)(e,[{key:"isFinished",value:function(){return this.finished}},{key:"finish",value:function(){this.finished=!0}},{key:"getColumnNames",value:function(){return this.types.keys()}},{key:"addValue",value:function(e,t){return!(this.finished||!this.types.has(e))&&((null===t||typeof t===this.types.get(e))&&(this.values.set(e,t),!0))}},{key:"getValue",value:function(e){return this.values.get(e)}},{key:"getType",value:function(e){return this.types.get(e)}},{key:"getTypes",value:function(){return this.types}},{key:"getValues",value:function(){return this.values}},{key:"getOrderedPrintValues",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.values.get(e),a=t.types.get(e);if(void 0===r||void 0===a)throw G.codeError(C().codeErrors.row_absentColumn,e,Object(u.a)(t.types.values()).join(", "));if("string"===a){var o=String(r).replace(/\\"/g,'"').replace(/\\\\/g,"\\");n.push(o)}else n.push(String(r))})),n}},{key:"equals",value:function(t){return t instanceof e&&(Object(H.isEqual)(this.types,t.types)&&Object(H.isEqual)(this.values,t.values))}}]),e}(),pe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).projection=void 0,a.stringRange=void 0,a.projection=e,a.stringRange=e.getRange(),a}return Object(p.a)(n,[{key:"parseProjection",value:function(){var e=new Set;return this.projection.slice(1,-1).split(",").forEach((function(t){return e.add(t.trim())})),e}},{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.subtree.getResult(),t=Object(u.a)(this.parseProjection());t.forEach((function(t){if(!e.hasColumn(t.toString()))throw G.semanticError(C().semanticErrors.projectionNode_absentColumn,t.getRange(),t.toString())}));var n=t.map((function(e){return e.toString()})),r=new q(e.getName()+"[...]");e.forEachColumn((function(e,t){n.indexOf(t)>-1&&r.addColumn(t,e)})),e.getRows().forEach((function(e){var t=new ce(r.getColumns());e.getValues().forEach((function(e,r){n.indexOf(r)>-1&&t.addValue(r,e)})),r.addRow(t)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=this.parseProjection(),o=new q(t.result.name+"[...]"),i=[];return a.forEach((function(e){var n=e.toString();t.result.hasColumn(n)?o.addColumn(n,t.result.getColumns().get(n)):i.push(e)})),i.forEach((function(e){r.push(G.semanticError(C().semanticErrors.projectionNode_absentColumn,e.getRange(),e.toString()))})),{result:o,whispers:n,errors:r}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return C().operations.projection}},{key:"getOperationSymbol",value:function(){return this.projection.replace(/\s+/g," ")}}]),n}(ue),he=n(25),fe=["null","true","false",""],de=["F","L","R",""];function me(e){return fe.indexOf(e.toString().toLowerCase())>-1}var ve,ge=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(p.a)(e,[{key:"get",value:function(e){var t=this.map.get(e.toString());return void 0===t?void 0:t.value}},{key:"set",value:function(e,t){this.map.set(e.toString(),{key:e,value:t})}},{key:"delete",value:function(e){return this.map.delete(e.toString())}},{key:"has",value:function(e){return this.map.has(e.toString())}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(e){Object(u.a)(this.map.values()).forEach((function(t,n){return e(t.value,t.key,n)}))}}]),e}(),ye=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r)).rename=void 0,a.stringRange=void 0,a.rename=e,a.stringRange=e.getRange(),a}return Object(p.a)(n,[{key:"parseChanges",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){if(e)throw t;n.push(t)},a=this.rename.slice(1,-1).split(","),o=new ge,i=Object(he.a)(a);try{for(i.s();!(t=i.n()).done;){var s=t.value,l=s.split("->").map((function(e){return e.trim()})),u=!1,c=!1;if(2!==l.length){var p=s.getRange();s.isEmpty()&&void 0!==this.stringRange&&(p={start:this.stringRange.start,end:this.stringRange.start}),r(G.syntaxError(C().syntaxErrors.renameNode_missingArrow,p)),u=!0,c=!0}!u&&o.has(l[0])&&(r(G.syntaxError(C().syntaxErrors.renameNode_multipleRenameOfTheColumn,l[0].getRange(),l[0].toString())),u=!0),c||ae.isName(l[1].toString())||(r(G.syntaxError(C().syntaxErrors.renameNode_invalidNewName,l[1].getRange(),l[1].toString())),c=!0),!c&&me(l[1])&&(r(G.syntaxError(C().syntaxErrors.renameNode_keywordNewName,l[1].getRange(),l[1].toString())),c=!0),u||c?u?c||o.set(se.empty(),l[0]):o.set(l[0],l[0]):o.set(l[0],l[1])}}catch(h){i.e(h)}finally{i.f()}return o}},{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.parseChanges(!0),n=this.subtree.getResult();t.forEach((function(e,t){if(-1===n.getColumnNames().indexOf(t.toString()))throw G.semanticError(C().semanticErrors.renameNode_absentOriginalColumn,t.getRange(),t.toString())}));var r=new q(n.getName()+"<...>"),a=new Map;n.forEachColumn((function(e,n){t.has(n)?a.set(n,e):r.addColumn(n,e)})),a.forEach((function(n,a){if(!r.addColumn(t.get(a).toString(),n)){var o=t.get(a);throw G.semanticError(C().semanticErrors.renameNode_changeToDuplicit,e.rename.getRange(),o?o.toString():"")}})),n.getRows().forEach((function(e){var n=new ce(r.getColumns());e.getValues().forEach((function(e,r){var a=t.get(r);"undefined"===typeof a?n.addValue(r,e):n.addValue(a.toString(),e)})),r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.whispers;void 0!==this.stringRange&&this.stringRange.start<e&&e<=this.stringRange.end&&(n=t.result.getColumnNames());var r=t.errors,a=this.parseChanges(!1,r),o=new q(t.result.getName()+"<...>");t.result.forEachColumn((function(e,t){a.has(t)||o.addColumn(t,e)}));var i=[],s=[];return a.forEach((function(e,n){var r=n.toString(),a=e.toString();t.result.hasColumn(r)||n.isEmpty()?o.addColumn(a,t.result.getColumns().get(r))||s.push(e):i.push(n)})),i.forEach((function(e){r.push(G.semanticError(C().semanticErrors.renameNode_absentOriginalColumn,e.getRange(),e.toString()))})),s.forEach((function(e){r.push(G.semanticError(C().semanticErrors.renameNode_changeToDuplicit,e.getRange(),e.toString()))})),{result:o,whispers:n,errors:r}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return C().operations.rename}},{key:"getOperationSymbol",value:function(){return this.rename.replace(/\s+/g," ")}}]),n}(ue),be=function e(){Object(c.a)(this,e)};!function(e){e[e.equal=0]="equal",e[e.nonEqual=1]="nonEqual",e[e.less=2]="less",e[e.more=3]="more",e[e.lessOrEqual=4]="lessOrEqual",e[e.moreOrEqual=5]="moreOrEqual"}(ve||(ve={}));var Ee,xe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(p.a)(n,null,[{key:"equal",value:function(e,t,r){return new n(ve.equal,e,t,r)}},{key:"nonEqual",value:function(e,t,r){return new n(ve.nonEqual,e,t,r)}},{key:"less",value:function(e,t,r){return new n(ve.less,e,t,r)}},{key:"more",value:function(e,t,r){return new n(ve.more,e,t,r)}},{key:"lessOrEqual",value:function(e,t,r){return new n(ve.lessOrEqual,e,t,r)}},{key:"moreOrEqual",value:function(e,t,r){return new n(ve.moreOrEqual,e,t,r)}}]),Object(p.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("null"!==t.type&&"null"!==n.type&&t.type!==n.type)throw G.syntaxError(C().syntaxErrors.comparingOperator_differentInputTypes,this.operator.getRange(),this.operator.toString(),t.type,n.type);return null===t.value&&null===n.value&&"null"!==t.type&&"null"!==n.type?{value:!1,type:"boolean"}:this.type===ve.equal?{value:t.value===n.value,type:"boolean"}:this.type===ve.nonEqual?null===t.value&&"null"!==t.type||null===n.value&&"null"!==n.type?{value:!1,type:"boolean"}:{value:t.value!==n.value,type:"boolean"}:this.type===ve.less?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<n.value,type:"boolean"}:this.type===ve.more?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>n.value,type:"boolean"}:this.type===ve.lessOrEqual?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value<=n.value,type:"boolean"}:null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value>=n.value,type:"boolean"}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(be);!function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(Ee||(Ee={}));var ke,Se=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.operator=r,i.left=a,i.right=o,i}return Object(p.a)(n,null,[{key:"and",value:function(e,t,r){return new n(Ee.and,e,t,r)}},{key:"or",value:function(e,t,r){return new n(Ee.or,e,t,r)}},{key:"not",value:function(e,t){return new n(Ee.not,e,t)}}]),Object(p.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e);if("boolean"!==t.type)throw G.syntaxError(C().syntaxErrors.logicalOperator_leftInputNotBoolean,this.operator.getRange(),this.operator.toString(),t.type);if(this.type===Ee.not)return null===t.value?{value:!1,type:"boolean"}:{value:!t.value,type:"boolean"};var n=this.right.eval(e);if("boolean"!==n.type)throw G.syntaxError(C().syntaxErrors.logicalOperator_rightInputNotBoolean,this.operator.getRange(),this.operator.toString(),n.type);return this.type===Ee.and?null===t.value||null===n.value?{value:!1,type:"boolean"}:{value:t.value&&n.value,type:"boolean"}:null===t.value&&null===n.value?{value:!1,type:"boolean"}:null===t.value?{value:n.value,type:"boolean"}:null===n.value?{value:t.value,type:"boolean"}:{value:t.value||n.value,type:"boolean"}}},{key:"toString",value:function(){return this.type===Ee.not?this.operator.toString()+"("+this.left.toString()+")":"("+this.left.toString()+" "+this.operator.toString()+" "+this.right.toString()+")"}}]),n}(be),Re=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).value=e,a.type=r,a}return Object(p.a)(n,[{key:"eval",value:function(e){return{value:this.value,type:this.type}}},{key:"toString",value:function(){return null===this.value?"null":this.value.toString()}}]),n}(be),we=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).columnName=e,r}return Object(p.a)(n,[{key:"eval",value:function(e){var t=e.getValue(this.columnName.toString()),n=e.getType(this.columnName.toString());if(void 0===t||void 0===n)throw G.semanticError(C().semanticErrors.referenceValue_absentColumn,this.columnName.getRange(),this.columnName.toString(),Object(u.a)(e.getColumnNames()).join(", "));return{value:t,type:n}}},{key:"toString",value:function(){return this.columnName.toString()}}]),n}(be);!function(e){e.plus="+",e.minus="-",e.multiplication="*",e.division="/"}(ke||(ke={}));var Ce=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this)).type=e,i.left=r,i.right=a,i.range=o,i}return Object(p.a)(n,null,[{key:"add",value:function(e,t,r){return new n(ke.plus,e,t,r)}},{key:"deduct",value:function(e,t,r){return new n(ke.minus,e,t,r)}},{key:"multiply",value:function(e,t,r){return new n(ke.multiplication,e,t,r)}},{key:"divide",value:function(e,t,r){return new n(ke.division,e,t,r)}}]),Object(p.a)(n,[{key:"eval",value:function(e){var t=this.left.eval(e),n=this.right.eval(e);if("number"!==t.type||"number"!==n.type)throw G.syntaxError(C().syntaxErrors.computingOperator_inputTypesNotNumbers,this.range,this.type,t.type,n.type);if(null===t.value||null===n.value)return{value:null,type:"number"};switch(this.type){case ke.plus:return{value:t.value+n.value,type:"number"};case ke.minus:return{value:t.value-n.value,type:"number"};case ke.multiplication:return{value:t.value*n.value,type:"number"};case ke.division:return{value:t.value/n.value,type:"number"}}}},{key:"toString",value:function(){return"("+this.left.toString()+" "+this.type+" "+this.right.toString()+")"}}]),n}(be),je=function(){function e(t){Object(c.a)(this,e),this.str=t}return Object(p.a)(e,[{key:"getRange",value:function(){return this.str.getRange()}}]),e}(),Oe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).precedence=r,a}return n}(je),Ne=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,50)}return n}(Oe),Te=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,10)}return n}(Oe),Ae=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,5)}return n}(Oe),Pe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Oe),_e=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,30)}return n}(Oe),Ve=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Oe),Ie=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e,25)}return n}(Oe),Le=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,r,20)).type=e,a}return n}(Oe),Be=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(je),De=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Be),We=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(Be),ze=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e)).value=r,o.type=a,o}return n}(je),Je=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(je),Ue=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"parse",value:function(t,n){var r=e.parseTokens(t,n,!0);this.assertValidInfixTokens(r,!0),r=this.simplify(r);try{var a=e.toRPN(r);return e.rpnToVETree(a)}catch(o){throw b(o,t.getRange())}}},{key:"fakeParse",value:function(t,n,r){var a=[],o=e.parseTokens(t,n,!1,a);return o.forEach((function(e){e instanceof Je&&-1===r.indexOf(e.str.toString())&&a.push(G.semanticError(C().semanticErrors.referenceValue_absentColumn,e.str.getRange(),e.str.toString(),r.join(", ")))})),this.assertValidInfixTokens(o,!1,a),a}},{key:"parseTokens",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(e){if(n)throw e;r.push(e)},o=e.trim();o.isEmpty()&&a(G.syntaxError(C().syntaxErrors.valueParser_emptyInput,void 0));for(var i=[];!o.isEmpty();){if(o.startsWith("("))i.push(new De(o.slice(0,1))),o=o.slice(1);else if(o.startsWith(")"))i.push(new We(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("+"))i.push(new Ve(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("-"))i.push(new Ie(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("*"))i.push(new Pe(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("/"))i.push(new _e(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("=="))i.push(new Le(ve.equal,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("="))i.push(new Le(ve.equal,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!="))i.push(new Le(ve.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<>"))i.push(new Le(ve.nonEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<="))i.push(new Le(ve.lessOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith(">="))i.push(new Le(ve.moreOrEqual,o.slice(0,2))),o=o.slice(2);else if(o.startsWith("<"))i.push(new Le(ve.less,o.slice(0,1))),o=o.slice(1);else if(o.startsWith(">"))i.push(new Le(ve.more,o.slice(0,1))),o=o.slice(1);else if(o.startsWith("!")||o.startsWith("~")||o.startsWith("\xac"))i.push(new Ne(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("&&"))i.push(new Te(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("&")||o.startsWith("\u2227"))i.push(new Te(o.slice(0,1))),o=o.slice(1);else if(o.startsWith("||"))i.push(new Ae(o.slice(0,2))),o=o.slice(2);else if(o.startsWith("|")||o.startsWith("\u2228"))i.push(new Ae(o.slice(0,1))),o=o.slice(1);else if(o.startsWith('"')){var s=le.nextQuotedString(o);void 0!==s.error&&a(s.error);var l=s.first.length()>1?-1:void 0,u=s.first.slice(1,l);i.push(new ze(u,u.toString(),"string")),o=s.second}else if(ae.isDigit(o.charAt(0))){var c=le.nextNumber(o);i.push(new ze(c.first,Number(c.first.toString()),"number")),o=c.second}else if(o.startsWith("null"))t||a(G.syntaxError(C().syntaxErrors.valueParser_unsupportedNull,o.slice(0,4).getRange())),i.push(new ze(o.slice(0,4),null,"null")),o=o.slice(4);else if(o.startsWith("true")||o.startsWith("True")||o.startsWith("TRUE"))i.push(new ze(o.slice(0,4),!0,"boolean")),o=o.slice(4);else if(o.startsWith("false")||o.startsWith("False")||o.startsWith("FALSE"))i.push(new ze(o.slice(0,5),!1,"boolean")),o=o.slice(5);else if(ae.isLetter(o.charAt(0))||"_"===o.charAt(0)){var p=le.nextName(o);i.push(new Je(p.first)),o=p.second}else{var h=le.nextNonWhitespacePart(o);a(G.syntaxError(C().syntaxErrors.valueParser_unexpectedPart,h.first.getRange(),h.first.toString())),o=o.slice(h.first.length())}o=o.trim()}return i}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0!==e.length){var r=function(e){if(t)throw e;n.push(e)};(e[0]instanceof We||e[0]instanceof Oe&&!(e[0]instanceof Ne))&&r(G.syntaxError(C().syntaxErrors.valueParser_invalidStart,e[0].getRange(),e[0].str.toString())),(e[e.length-1]instanceof De||e[e.length-1]instanceof Oe)&&r(G.syntaxError(C().syntaxErrors.valueParser_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString()));for(var a=1;a<e.length;){var o=e[a-1],i=e[a];++a,i instanceof ze?(o instanceof ze&&r(G.syntaxError(C().syntaxErrors.valueParser_literalAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Je&&r(G.syntaxError(C().syntaxErrors.valueParser_literalAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof We&&r(G.syntaxError(C().syntaxErrors.valueParser_literalAfterClosing,i.getRange(),i.str.toString()))):i instanceof Je?(o instanceof ze&&r(G.syntaxError(C().syntaxErrors.valueParser_referenceAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Je&&r(G.syntaxError(C().syntaxErrors.valueParser_referenceAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof We&&r(G.syntaxError(C().syntaxErrors.valueParser_referenceAfterClosing,i.getRange(),i.str.toString()))):i instanceof Ne?(o instanceof ze&&r(G.syntaxError(C().syntaxErrors.valueParser_notAfterLiteral,i.getRange(),i.str.toString(),o.str.toString())),o instanceof Je&&r(G.syntaxError(C().syntaxErrors.valueParser_notAfterReference,i.getRange(),i.str.toString(),o.str.toString())),o instanceof We&&r(G.syntaxError(C().syntaxErrors.valueParser_notAfterClosing,i.getRange(),i.str.toString()))):i instanceof Oe?(o instanceof Oe&&r(G.syntaxError(C().syntaxErrors.valueParser_binaryAfterOperator,i.getRange(),i.str.toString(),o.str.toString())),o instanceof De&&r(G.syntaxError(C().syntaxErrors.valueParser_binaryAfterOpening,i.getRange(),i.str.toString()))):i instanceof De?(o instanceof ze&&r(G.syntaxError(C().syntaxErrors.valueParser_openingAfterLiteral,i.getRange(),o.str.toString())),o instanceof Je&&r(G.syntaxError(C().syntaxErrors.valueParser_openingAfterReference,i.getRange(),o.str.toString())),o instanceof We&&r(G.syntaxError(C().syntaxErrors.valueParser_openingAfterClosing,i.getRange()))):i instanceof We&&(o instanceof Oe&&r(G.syntaxError(C().syntaxErrors.valueParser_closingAfterOperator,i.getRange(),o.str.toString())),o instanceof De&&r(G.syntaxError(C().syntaxErrors.valueParser_closingAfterOpening,i.getRange())))}}}},{key:"simplify",value:function(e){var t=[],n=new Set;e.forEach((function(e,n){e instanceof Ne&&t.push(n)}));for(var r=1;r<t.length;++r)t[r-1]+1===t[r]&&(n.add(t[r-1]),n.add(t[r]),t[r]=NaN);return 0===n.size?e:e.filter((function(e,t){return!n.has(t)}))}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof ze||e instanceof Je)t.push(e);else if(e instanceof Oe){for(;n.length>0&&n[n.length-1]instanceof Oe;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof De)n.push(e);else if(e instanceof We)for(;;){if(0===n.length)throw G.syntaxError(C().syntaxErrors.valueParser_missingOpeningParenthesis,void 0);if(n[n.length-1]instanceof De){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof De)throw G.syntaxError(C().syntaxErrors.valueParser_missingClosingParenthesis,void 0);t.push(r)}return t}},{key:"rpnToVETree",value:function(e){var t=this.rpnToVETreeRecursive(e);if(e.length>0)throw G.syntaxError(C().syntaxErrors.valueParser_invalidExpression,void 0);return t}},{key:"rpnToVETreeRecursive",value:function(t){if(0===t.length)throw G.syntaxError(C().syntaxErrors.valueParser_invalidExpression,void 0);var n=t.pop();if(n instanceof Ne){var r=e.rpnToVETreeRecursive(t);return Se.not(n.str,r)}if(n instanceof Te){var a=e.rpnToVETreeRecursive(t),o=e.rpnToVETreeRecursive(t);return Se.and(n.str,o,a)}if(n instanceof Ae){var i=e.rpnToVETreeRecursive(t),s=e.rpnToVETreeRecursive(t);return Se.or(n.str,s,i)}if(n instanceof Le){var l=e.rpnToVETreeRecursive(t),u=e.rpnToVETreeRecursive(t);return new xe(n.type,n.str,u,l)}if(n instanceof ze)return new Re(n.value,n.type);if(n instanceof Je)return new we(n.str);if(n instanceof Ve){var c=e.rpnToVETreeRecursive(t),p=e.rpnToVETreeRecursive(t);return Ce.add(p,c,n.getRange())}if(n instanceof Ie){var h=e.rpnToVETreeRecursive(t),f=e.rpnToVETreeRecursive(t);return Ce.deduct(f,h,n.getRange())}if(n instanceof Pe){var d=e.rpnToVETreeRecursive(t),m=e.rpnToVETreeRecursive(t);return Ce.multiply(m,d,n.getRange())}if(n instanceof _e){var v=e.rpnToVETreeRecursive(t),g=e.rpnToVETreeRecursive(t);return Ce.divide(g,v,n.getRange())}throw G.codeError(C().codeErrors.valueParser_unexpectedToken,JSON.stringify(n))}}]),e}(),Fe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).leftSubtree=void 0,a.rightSubtree=void 0,a.leftSubtree=e,a.rightSubtree=r,a}return Object(p.a)(n,[{key:"getLeftSubtree",value:function(){return this.leftSubtree}},{key:"getRightSubtree",value:function(){return this.rightSubtree}},{key:"fakeEvalBinary",value:function(e,t){var n,r=this.leftSubtree.fakeEval(e),a=this.rightSubtree.fakeEval(e),o=new q("");return"left"!==t&&"union"!==t||r.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),"right"!==t&&"union"!==t||a.result.forEachColumn((function(e,t){return o.addColumn(t,e)})),(n=r.errors).push.apply(n,Object(u.a)(a.errors)),{result:o,whispers:0!==r.whispers.length?r.whispers:a.whispers,errors:r.errors}}}]),n}(oe);function Me(e,t){var n=0;return function e(r){if(n===t)return r;if(n++,r instanceof ue)return e(r.getSubtree());if(r instanceof Fe){var a=e(r.getLeftSubtree());return null===a?e(r.getRightSubtree()):a}return null}(e)}function He(e){if(e instanceof Fe){var t=He(e.getLeftSubtree()),n=He(e.getRightSubtree());return Math.max(t,n)+1}return e instanceof ue?He(e.getSubtree())+1:0}function qe(e,t,n){if(void 0!==t&&t.start<e&&e<=t.end){for(var r=t.end-t.start,a=n.toString(),o=e-t.start,i=!1,s=0,l=0;l<r;++l){var u=a.charAt(l);if('"'===u&&s%2===0&&(i=!i),i&&"\\"===u?++s:s=0,l===o-1)return!i&&n.getChars().some((function(t){return t.index===e-1}))}console.warn("isInRangeAndNotInQuotes outside range")}return!1}var Ke,Ge=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r)).selection=void 0,o.stringRange=void 0,o.nullValuesSupport=void 0,o.selection=e,o.stringRange=e.getRange(),o.nullValuesSupport=a,o}return Object(p.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=Ue.parse(this.selection.slice(1,-1),this.nullValuesSupport)}catch(a){throw b(a,this.stringRange)}var n=this.subtree.getResult(),r=new q(n.name+"(...)");n.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.getRows().forEach((function(n){var a=t.eval(n);if("boolean"!==a.type)throw G.syntaxError(C().syntaxErrors.selectionNode_resultNotBoolean,e.stringRange,e.selection.replace(/\s+/g," "),a.type);a.value&&r.addRow(n)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.subtree.fakeEval(e),n=t.result,r=t.whispers,a=t.errors,o=new q(n.getName()+"(...)");return n.forEachColumn((function(e,t){o.addColumn(t,e)})),n=o,qe(e,this.stringRange,this.selection)&&(r=n.getColumnNames()),0===this.selection.toString().slice(1,-1).trim().length?a.push(G.syntaxError(C().syntaxErrors.valueParser_emptyInput,this.stringRange)):a.push.apply(a,Object(u.a)(Ue.fakeParse(this.selection.slice(1,-1),this.nullValuesSupport,n.getColumnNames()))),{result:n,whispers:r,errors:a}}},{key:"printInLine",value:function(){return this.subtree.printInLine()+this.getOperationSymbol()}},{key:"getOperationName",value:function(){return C().operations.selection}},{key:"getOperationSymbol",value:function(){return this.selection.replace(/\s+/g," ")}}]),n}(ue);!function(e){e.left="\u22b3",e.right="\u22b2"}(Ke||(Ke={}));var Ze,Qe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(p.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e,t,n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult(),a=n.getColumnNames().filter((function(e){return r.hasColumn(e)})),o=new q("("+n.getName()+this.type+r.getName()+")");this.type===Ke.left?(n.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=n.getRows(),t=r.getRows()):(r.forEachColumn((function(e,t){return o.addColumn(t,e)})),e=r.getRows(),t=n.getRows()),e.forEach((function(e){if(!t.some((function(t){return a.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var n=new ce(o.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),o.addRow(n)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.type===Ke.left?"left":"right";return this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=C().operations;return this.type===Ke.left?e.leftAntijoin:e.rightAntijoin}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Fe),Xe=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(p.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=new q("("+t.getName()+"\u2a2f"+n.getName()+")");t.forEachColumn((function(e,t){return r.addColumn(t,e)})),n.forEachColumn((function(t,n){if(!r.addColumn(n,t))throw G.semanticError(C().semanticErrors.binaryNode_commonColumns,e.stringRange,"cartesian product",n)})),t.getRows().forEach((function(e){n.getRows().forEach((function(t){var n=new ce(r.getColumns());e.getValues().forEach((function(e,t){return n.addValue(t,e)})),t.getValues().forEach((function(e,t){return n.addValue(t,e)})),r.addRow(n)}))})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t,n=this.leftSubtree.fakeEval(e),r=this.rightSubtree.fakeEval(e),a=new q("");n.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),r.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),(t=n.errors).push.apply(t,Object(u.a)(r.errors));var o=[];return n.result.getColumnNames().forEach((function(e){r.result.hasColumn(e)&&o.push(e)})),o.length>0&&n.errors.push(G.semanticError(C().semanticErrors.binaryNode_commonColumns,this.stringRange,"cartesian product",o.join('", "'))),{result:a,whispers:0!==n.whispers.length?n.whispers:r.whispers,errors:n.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return C().operations.cartesianProduct}},{key:"getOperationSymbol",value:function(){return"\u2a2f"}}]),n}(Fe),$e=n(29),Ye=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).stringRange=a,o}return Object(p.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=e.getColumns(),r=t.getColumns();if(!Object(u.a)(r).every((function(e){return n.has(e[0])&&n.get(e[0])===e[1]})))throw G.semanticError(C().semanticErrors.divisionNode_rightColumnsNotSubset,this.stringRange,t.getSchemaString(),e.getSchemaString());var a=new Map;if(n.forEach((function(e,t){r.has(t)||a.set(t,e)})),0===a.size)throw G.semanticError(C().semanticErrors.divisionNode_rightColumnsNotProperSubset,this.stringRange,t.getNamesSchemaString(),e.getNamesSchemaString());var o=new q("("+e.getName()+"\xf7"+t.getName()+")");a.forEach((function(e,t){return o.addColumn(t,e)}));var i=e.getRows(),s=t.getRows();i.forEach((function(e){if(s.every((function(t){var r=new ce(n);return a.forEach((function(t,n){return r.addValue(n,e.getValue(n))})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),Object(u.a)(i).some((function(e){return e.equals(r)}))}))){var t=new ce(o.getColumns());a.forEach((function(n,r){return t.addValue(r,e.getValue(r))})),o.addRow(t)}})),this.resultRelation=o}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=t.result.getColumns(),a=n.result.getColumns(),o=new Map(Object(u.a)(r.entries()).filter((function(e){var t=Object($e.a)(e,2),n=t[0];t[1];return!a.has(n)}))),i=new q("("+t.result.getName()+"\xf7"+n.result.getName()+")");o.forEach((function(e,t){return i.addColumn(t,e)}));var s=t.errors;return s.push.apply(s,Object(u.a)(n.errors)),Object(u.a)(a).every((function(e){return r.has(e[0])&&r.get(e[0])===e[1]}))||""===t.result.getName()?0===o.size&&""!==t.result.getName()&&s.push(G.semanticError(C().semanticErrors.divisionNode_rightColumnsNotProperSubset,this.stringRange,n.result.getNamesSchemaString(),t.result.getNamesSchemaString())):s.push(G.semanticError(C().semanticErrors.divisionNode_rightColumnsNotSubset,this.stringRange,n.result.getSchemaString(),t.result.getSchemaString())),{result:i,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:t.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){return C().operations.division}},{key:"getOperationSymbol",value:function(){return"\xf7"}}]),n}(Fe);!function(e){e.left="*L*",e.right="*R*",e.full="*F*"}(Ze||(Ze={}));var et,tt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(p.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult(),n=new q("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return n.addColumn(t,e)})),t.forEachColumn((function(e,t){return n.addColumn(t,e)}));var r=e.getRows(),a=t.getRows(),o=e.getColumnNames().filter((function(e){return t.hasColumn(e)}));r.forEach((function(e){a.forEach((function(t){if(o.every((function(n){return e.getValue(n)===t.getValue(n)}))){var r=new ce(n.getColumns());e.getValues().forEach((function(e,t){return r.addValue(t,e)})),t.getValues().forEach((function(e,t){return r.addValue(t,e)})),n.addRow(r)}}))})),this.type!==Ze.left&&this.type!==Ze.full||r.forEach((function(e){if(!a.some((function(t){return o.every((function(n){return e.getValue(n)===t.getValue(n)}))}))){var t=new ce(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.type!==Ze.right&&this.type!==Ze.full||a.forEach((function(e){if(!r.some((function(t){return o.every((function(n){return t.getValue(n)===e.getValue(n)}))}))){var t=new ce(n.getColumns());e.getValues().forEach((function(e,n){return t.addValue(n,e)})),n.addRow(t)}})),this.resultRelation=n}}},{key:"fakeEval",value:function(e){return this.fakeEvalBinary(e,"union")}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=C().operations;return this.type===Ze.left?e.leftOuterJoin:this.type===Ze.right?e.rightOuterJoin:e.fullOuterJoin}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Fe);!function(e){e.natural="*",e.leftSemi="<*",e.rightSemi="*>"}(et||(et={}));var nt,rt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var o;return Object(c.a)(this,n),(o=t.call(this,r,a)).type=void 0,o.type=e,o}return Object(p.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t=this.leftSubtree.getResult(),n=this.rightSubtree.getResult(),r=t.getColumnNames().filter((function(e){return n.hasColumn(e)})),a=new q("("+t.getName()+this.type+n.getName()+")");this.type!==et.leftSemi&&this.type!==et.natural||t.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==et.rightSemi&&this.type!==et.natural||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),t.getRows().forEach((function(t){n.getRows().forEach((function(n){if(Object(u.a)(r).every((function(e){return t.getValue(e)===n.getValue(e)}))){var o=new ce(a.getColumns());e.type!==et.leftSemi&&e.type!==et.natural||t.getValues().forEach((function(e,t){return o.addValue(t,e)})),e.type!==et.rightSemi&&e.type!==et.natural||n.getValues().forEach((function(e,t){return o.addValue(t,e)})),a.addRow(o)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t="union";return this.type===et.leftSemi?t="left":this.type===et.rightSemi&&(t="right"),this.fakeEvalBinary(e,t)}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=C().operations;return this.type===et.leftSemi?e.leftSemiJoin:this.type===et.rightSemi?e.rightSemiJoin:e.naturalJoin}},{key:"getOperationSymbol",value:function(){return"*"}},{key:"getType",value:function(){return this.type}}]),n}(Fe);!function(e){e.union="\u222a",e.intersection="\u2229",e.difference="\\"}(nt||(nt={}));var at,ot=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).stringRange=o,i.type=void 0,i.type=e,i}return Object(p.a)(n,[{key:"eval",value:function(){if(!this.isEvaluated()){var e=this.leftSubtree.getResult(),t=this.rightSubtree.getResult();if(!Object(H.isEqual)(e.getColumns(),t.getColumns())){var n=this.getOperationName().toLowerCase();throw G.semanticError(C().semanticErrors.setOperationNode_notEqualColumns,this.stringRange,e.getSchemaString(),t.getSchemaString(),n)}var r=new q("("+e.getName()+this.type+t.getName()+")");e.forEachColumn((function(e,t){return r.addColumn(t,e)}));var a=e.getRows(),o=t.getRows();(this.type===nt.union?[].concat(Object(u.a)(a),Object(u.a)(o)):this.type===nt.intersection?Object(u.a)(a).filter((function(e){return Object(u.a)(o).some((function(t){return e.equals(t)}))})):Object(u.a)(a).filter((function(e){return!Object(u.a)(o).some((function(t){return e.equals(t)}))}))).forEach((function(e){return r.addRow(e)})),this.resultRelation=r}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=new q("("+t.result.getName()+this.type+n.result.getName()+")");t.result.forEachColumn((function(e,t){n.result.hasColumn(t)&&r.addColumn(t,e)}));var a=t.errors;if(a.push.apply(a,Object(u.a)(n.errors)),!Object(H.isEqual)(t.result.getColumns(),n.result.getColumns())&&""!==t.result.getName()&&""!==n.result.getName()){var o=this.getOperationName().toLowerCase();a.push(G.semanticError(C().semanticErrors.setOperationNode_notEqualColumns,this.stringRange,t.result.getSchemaString(),n.result.getSchemaString(),o))}return{result:r,whispers:0!==t.whispers.length?t.whispers:n.whispers,errors:t.errors}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=C().operations;return this.type===nt.union?e.union:this.type===nt.intersection?e.intersection:e.difference}},{key:"getOperationSymbol",value:function(){return this.type}}]),n}(Fe);!function(e){e.full="[]",e.left="<]",e.right="[>"}(at||(at={}));var it,st=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,o,i){var s;return Object(c.a)(this,n),(s=t.call(this,a,o)).type=void 0,s.condition=void 0,s.stringRange=void 0,s.nullValuesSupport=void 0,s.condition=r,s.stringRange=r.getRange(),s.nullValuesSupport=i,s.type=e,s}return Object(p.a)(n,[{key:"eval",value:function(){var e=this;if(!this.isEvaluated()){var t;try{t=Ue.parse(this.condition.slice(1,-1),this.nullValuesSupport)}catch(i){throw b(i,this.stringRange)}var n=this.leftSubtree.getResult(),r=this.rightSubtree.getResult();n.getColumnNames().forEach((function(t){if(r.hasColumn(t))throw G.semanticError(C().semanticErrors.binaryNode_commonColumns,e.stringRange,e.getOperationName().toLowerCase(),t)}));var a=new q("("+n.getName()+this.type.charAt(0)+"..."+this.type.charAt(1)+r.getName()+")");this.type!==at.left&&this.type!==at.full||n.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==at.right&&this.type!==at.full||r.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=new Map(n.getColumns());r.forEachColumn((function(e,t){return o.set(t,e)})),n.getRows().forEach((function(n){r.getRows().forEach((function(r){var i=new ce(o);n.getValues().forEach((function(e,t){return i.addValue(t,e)})),r.getValues().forEach((function(e,t){return i.addValue(t,e)}));var s=t.eval(i);if("boolean"!==s.type)throw G.syntaxError(C().syntaxErrors.thetaJoinNode_resultNotBoolean,e.stringRange,e.condition.replace(/\s+/g," "),s.type);if(s.value){var l=new ce(a.getColumns());e.type!==at.left&&e.type!==at.full||n.getValues().forEach((function(e,t){return l.addValue(t,e)})),e.type!==at.right&&e.type!==at.full||r.getValues().forEach((function(e,t){return l.addValue(t,e)})),a.addRow(l)}}))})),this.resultRelation=a}}},{key:"fakeEval",value:function(e){var t=this.leftSubtree.fakeEval(e),n=this.rightSubtree.fakeEval(e),r=[];r.push.apply(r,Object(u.a)(t.result.getColumnNames())),r.push.apply(r,Object(u.a)(n.result.getColumnNames()));var a=new q("");this.type!==at.left&&this.type!==at.full||t.result.forEachColumn((function(e,t){return a.addColumn(t,e)})),this.type!==at.right&&this.type!==at.full||n.result.forEachColumn((function(e,t){return a.addColumn(t,e)}));var o=0!==t.whispers.length?t.whispers:n.whispers;qe(e,this.stringRange,this.condition)&&(o=r);var i=t.errors;i.push.apply(i,Object(u.a)(n.errors));var s=[];return t.result.getColumnNames().forEach((function(e){n.result.hasColumn(e)&&s.push(e)})),s.length>0&&void 0!==this.stringRange&&i.push(G.semanticError(C().semanticErrors.binaryNode_commonColumns,{start:this.stringRange.start,end:this.stringRange.start},this.getOperationName().toLowerCase(),s.join('", "'))),0===this.condition.toString().slice(1,-1).trim().length?i.push(G.syntaxError(C().syntaxErrors.valueParser_emptyInput,this.stringRange)):i.push.apply(i,Object(u.a)(Ue.fakeParse(this.condition.slice(1,-1),this.nullValuesSupport,r))),{result:a,whispers:o,errors:i}}},{key:"printInLine",value:function(){return"("+this.leftSubtree.printInLine()+this.getOperationSymbol()+this.rightSubtree.printInLine()+")"}},{key:"getOperationName",value:function(){var e=C().operations;return this.type===at.left?e.leftThetaSemiJoin:this.type===at.right?e.rightThetaSemiJoin:e.thetaJoin}},{key:"getOperationSymbol",value:function(){return this.condition.replace(/\s+/g," ")}},{key:"getType",value:function(){return this.type}}]),n}(Fe),lt=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"createUnary",value:function(e,t,n,r){switch(e){case"projection":return new pe(r,t);case"rename":return new ye(r,t);case"selection":return new Ge(r,t,n)}}},{key:"createBinary",value:function(e,t,n,r,a){switch(e){case"left antijoin":return new Qe(Ke.left,t,n);case"right antijoin":return new Qe(Ke.right,t,n);case"cartesian product":return new Xe(t,n,a.getRange());case"division":return new Ye(t,n,a.getRange());case"natural join":return new rt(et.natural,t,n);case"left outer join":return new tt(Ze.left,t,n);case"right outer join":return new tt(Ze.right,t,n);case"full outer join":return new tt(Ze.full,t,n);case"left semijoin":return new rt(et.leftSemi,t,n);case"right semijoin":return new rt(et.rightSemi,t,n);case"union":return new ot(nt.union,t,n,a.getRange());case"intersection":return new ot(nt.intersection,t,n,a.getRange());case"difference":return new ot(nt.difference,t,n,a.getRange());case"theta join":return new st(at.full,a,t,n,r);case"left theta semijoin":return new st(at.left,a,t,n,r);case"right theta semijoin":return new st(at.right,a,t,n,r)}}}]),e}();!function(e){e[e.NOT_THROW=0]="NOT_THROW",e[e.THROW_STRICT=1]="THROW_STRICT",e[e.THROW_NOT_STRICT=2]="THROW_NOT_STRICT"}(it||(it={}));var ut=function(){function e(t,n){Object(c.a)(this,e),this.relations=t,this.nullValuesSupport=n}return Object(p.a)(e,[{key:"parse",value:function(e){var t=le.deleteAllComments(se.new(e)),n=t.str,r=t.err;if(void 0!==r)throw r;var a=this.parseTokens(n);if(0===a.length)throw G.syntaxError(C().syntaxErrors.exprParser_emptyStringGiven,void 0);this.assertValidInfixTokens(a,it.THROW_STRICT);var o=this.toRPN(a);return this.rpnToRATree(o,!0)}},{key:"fakeParse",value:function(e,t){if(""===e.trim())return{whispers:Object(u.a)(this.relations.keys()),errors:[],parentheses:[]};var n=le.deleteAllComments(se.new(e)),r=n.str,a=n.err,o=this.fakeParseTokens(r,t),i=o.whispers,s=o.tokens,l=o.errors,c=o.parentheses;if(void 0!==a&&l.push(a),0===s.length)return{whispers:i,errors:l,parentheses:c};this.assertValidInfixTokens(s,it.NOT_THROW,l);var p=this.toRPN(s),h=this.rpnToRATree(p,!1,l).fakeEval(t);return l.push.apply(l,Object(u.a)(h.errors)),h.whispers.length>0?{whispers:h.whispers,errors:l,parentheses:c}:{whispers:i,errors:l,parentheses:c}}},{key:"parseTokens",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=[],a=e.trim();!a.isEmpty();){if(a.startsWith("(")){var o,i=le.nextBorderedPart(a,"(",")");if(t)n.push(ne.selection(i.first));else n.push(new Y(i.first.slice(0,1))),(o=n).push.apply(o,Object(u.a)(this.parseTokens(i.first.slice(1,-1)))),n.push(new ee(i.first.slice(-1))),t=!0;a=i.second}else if(a.startsWith("[")){var s=le.nextBorderedPart(a,"[","]>");if(!s.first.endsWith(">")){if(s.second.isEmpty()){n.push(ne.projection(s.first));break}var l=void 0,c=void 0;try{var p,h;(p=r).push.apply(p,Object(u.a)(n)),r.push(re.thetaJoin(s.first)),(h=r).push.apply(h,Object(u.a)(this.parseTokens(s.second,!1)))}catch(y){if(y instanceof K)throw y;l=y}try{var f;n.push(ne.projection(s.first)),(f=n).push.apply(f,Object(u.a)(this.parseTokens(s.second,!0)))}catch(y){if(y instanceof K)throw y;c=y}if(void 0!==l&&void 0!==c){if(l.message===c.message)throw c;throw G.syntaxError(C().syntaxErrors.exprParser_bothBranchesError,void 0,s.first.toString(),c.message,l.message)}void 0!==l&&(r=[]),void 0!==c&&(n=r,r=[]);break}n.push(re.rightThetaSemijoin(s.first)),t=!1,a=s.second}else if(a.startsWith("*F*")||a.startsWith("*L*")||a.startsWith("*R*")){if(!this.nullValuesSupport){var d=void 0;throw isNaN(a.getFirstIndex())||(d={start:a.getFirstIndex(),end:a.getFirstIndex()+2}),G.syntaxError(C().syntaxErrors.exprParser_outerJoinWhenNullNotSupported,d,"*F*")}a.startsWith("*F")?n.push(re.fullOuterJoin(a.slice(0,3))):a.startsWith("*L")?n.push(re.leftOuterJoin(a.slice(0,3))):n.push(re.rightOuterJoin(a.slice(0,3))),a=a.slice(3),t=!1}else if(a.startsWith("<*"))n.push(re.leftSemijoin(a.slice(0,2))),a=a.slice(2),t=!1;else if(a.startsWith("*>"))n.push(re.rightSemijoin(a.slice(0,2))),a=a.slice(2),t=!1;else if(a.startsWith("*"))n.push(re.naturalJoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u2a2f"))n.push(re.cartesianProduct(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u222a"))n.push(re.union(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u2229"))n.push(re.intersection(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\\"))n.push(re.difference(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u22b3"))n.push(re.leftAntijoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\u22b2"))n.push(re.rightAntijoin(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("\xf7"))n.push(re.division(a.slice(0,1))),a=a.slice(1),t=!1;else if(a.startsWith("<")){var m=le.nextBorderedPart(a,"<",">]","-");m.first.endsWith(">")?(n.push(ne.rename(m.first)),t=!0):(n.push(re.leftThetaSemijoin(m.first)),t=!1),a=m.second}else{if(!ae.isLetter(a.charAt(0))&&"_"!==a.charAt(0)){var v=le.nextNonWhitespacePart(a);throw G.syntaxError(C().syntaxErrors.exprParser_unexpectedPart,v.first.getRange(),v.first.toString())}var g=le.nextName(a);n.push(new te(g.first)),a=g.second,t=!0}a=a.trim()}if(r.length>0)try{return this.assertValidInfixTokens(r,it.THROW_NOT_STRICT,[]),r}catch(b){}return n}},{key:"fakeParseTokens",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],a=[],o=[],i=[],s=function(e){i.push({start:e.getFirstIndex(),end:e.getLastIndex()})},l=e;!l.isEmpty();){var c=l.getFirstIndex();if(c===t&&(r=Object(u.a)(this.relations.keys())),l.startsWith("(")){var p=void 0;try{p=le.nextBorderedPart(l,"(",")")}catch(j){if(j instanceof y&&o.push(j),n)a.push(ne.selection(l.concat(se.new(")",l.getLastIndex()+1))));else{var h;c===t-1&&(r=Object(u.a)(this.relations.keys())),a.push(new Y(l.slice(0,1)));var f=this.fakeParseTokens(l.slice(1),t);o.push.apply(o,Object(u.a)(f.errors)),(h=r).push.apply(h,Object(u.a)(f.whispers)),a.push.apply(a,Object(u.a)(f.tokens)),i.push.apply(i,Object(u.a)(f.parentheses)),a.push(new ee(se.new(")",NaN)))}break}if(s(p.first),n)a.push(ne.selection(p.first));else{var d;a.push(new Y(p.first.slice(0,1)));var m=this.fakeParseTokens(p.first.slice(1,-1),t);o.push.apply(o,Object(u.a)(m.errors)),(d=r).push.apply(d,Object(u.a)(m.whispers)),a.push.apply(a,Object(u.a)(m.tokens)),i.push.apply(i,Object(u.a)(m.parentheses)),a.push(new ee(p.first.slice(-1))),n=!0}l=p.second}else if(l.startsWith("[")){var v=void 0,g=!1;try{v=le.nextBorderedPart(l,"[","]>")}catch(j){g=!0,j instanceof y&&o.push(j),v={first:l.concat(se.new("]",l.getLastIndex()+1)),second:se.empty()}}s(v.first),g||v.first.getLastIndex()!==t-1||(r=Object(u.a)(this.relations.keys())),v.first.endsWith(">")?(a.push(re.rightThetaSemijoin(v.first)),n=!1,l=v.second):v.first.containsAny('=<>+/*&|~"()!')?(a.push(re.thetaJoin(v.first)),n=!1,l=v.second):(a.push(ne.projection(v.first)),n=!0,l=v.second)}else if(l.startsWith("*F*")||l.startsWith("*L*")||l.startsWith("*R*")){var b=l.slice(0,3);b.getLastIndex()===t-1&&(r=Object(u.a)(this.relations.keys())),l.startsWith("*F")?a.push(re.fullOuterJoin(b)):l.startsWith("*L")?a.push(re.leftOuterJoin(b)):a.push(re.rightOuterJoin(b)),l=l.slice(3),n=!1}else if(l.startsWith("<*")||l.startsWith("*>")){var E=l.slice(0,2);E.getLastIndex()===t-1&&(r=Object(u.a)(this.relations.keys())),l.startsWith("<*")?a.push(re.leftSemijoin(E)):a.push(re.rightSemijoin(E)),l=l.slice(2),n=!1}else if("*\u2a2f\u222a\u2229\\\u22b3\u22b2\xf7".indexOf(l.charAt(0))>-1){var x=l.slice(0,1);x.getLastIndex()===t-1&&(r=Object(u.a)(this.relations.keys())),l.startsWith("*")?a.push(re.naturalJoin(x)):l.startsWith("\u2a2f")?a.push(re.cartesianProduct(x)):l.startsWith("\u222a")?a.push(re.union(x)):l.startsWith("\u2229")?a.push(re.intersection(x)):l.startsWith("\\")?a.push(re.difference(x)):l.startsWith("\u22b3")?a.push(re.leftAntijoin(x)):l.startsWith("\u22b2")?a.push(re.rightAntijoin(x)):l.startsWith("\xf7")&&a.push(re.division(x)),l=l.slice(1),n=!1}else if(l.startsWith("<"))try{var k=le.nextBorderedPart(l,"<",">]","-");s(k.first),k.first.getLastIndex()===t-1&&(r=Object(u.a)(this.relations.keys())),k.first.endsWith(">")?(a.push(ne.rename(k.first)),n=!0):(a.push(re.leftThetaSemijoin(k.first)),n=!1),l=k.second}catch(O){a.push(ne.rename(l.concat(se.new(">",l.getLastIndex()+1))));break}else if(ae.isLetter(l.charAt(0))||"_"===l.charAt(0)){var S=le.nextName(l);S.first.getFirstIndex()<=t-1&&t-1<=S.first.getLastIndex()&&(r=Object(u.a)(this.relations.keys())),a.push(new te(S.first)),l=S.second,n=!0}else if(l.charAt(0).match(/\s/)){for(var R=0;R<l.length()&&l.charAt(R).match(/\s/);)l.indexAt(R)===t-1&&(r=Object(u.a)(this.relations.keys())),++R;l=l.slice(R)}else{var w=le.nextNonWhitespacePart(l);o.push(G.syntaxError(C().syntaxErrors.exprParser_unexpectedPart,w.first.getRange(),w.first.toString())),l=l.slice(w.first.length())}}return{tokens:a,whispers:r,errors:o,parentheses:i}}},{key:"assertValidInfixTokens",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(r,a,o,i){for(var s=arguments.length,l=new Array(s>4?s-4:0),u=4;u<s;u++)l[u-4]=arguments[u];var c=G.syntaxError.apply(G,[o,i].concat(l));if(t!==it.NOT_THROW)throw c;"binary"===a?(n.push(c),e.splice(r,0,re.naturalJoin(se.new("*")))):(n.push(c),e.splice(r,0,new te(se.new(""))))};t!==it.THROW_NOT_STRICT&&(e[0]instanceof ne||e[0]instanceof re||e[0]instanceof ee)&&r(0,"relation",C().syntaxErrors.exprParser_invalidStart,e[0].getRange(),e[0].str.toString()),(e[e.length-1]instanceof Y||e[e.length-1]instanceof re)&&r(e.length,"relation",C().syntaxErrors.exprParser_invalidEnd,e[e.length-1].getRange(),e[e.length-1].str.toString());for(var a=1;a<e.length;){var o=e[a-1],i=e[a];if(i instanceof te)o instanceof te&&r(a,"binary",C().syntaxErrors.exprParser_relationAfterRelation,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ne&&r(a,"binary",C().syntaxErrors.exprParser_relationAfterUnary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof ee&&r(a,"binary",C().syntaxErrors.exprParser_relationAfterClosing,i.getRange(),i.str.toString());else if(i instanceof ne)o instanceof re&&r(a,"relation",C().syntaxErrors.exprParser_unaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof Y&&r(a,"relation",C().syntaxErrors.exprParser_unaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof re)o instanceof re&&r(a,"relation",C().syntaxErrors.exprParser_binaryAfterBinary,i.getRange(),i.str.toString(),o.str.toString()),o instanceof Y&&r(a,"relation",C().syntaxErrors.exprParser_binaryAfterOpening,i.getRange(),i.str.toString());else if(i instanceof Y)o instanceof te&&r(a,"binary",C().syntaxErrors.exprParser_openingAfterRelation,i.getRange(),o.str.toString()),o instanceof ne&&r(a,"binary",C().syntaxErrors.exprParser_openingAfterUnary,i.getRange(),o.str.toString()),o instanceof ee&&r(a,"binary",C().syntaxErrors.exprParser_openingAfterClosing,i.getRange());else{if(!(i instanceof ee))throw G.codeError(C().codeErrors.exprParser_unexpectedToken,JSON.stringify(i));o instanceof re&&r(a,"relation",C().syntaxErrors.exprParser_closingAfterBinary,i.getRange(),o.str.toString()),o instanceof Y&&r(a,"relation",C().syntaxErrors.exprParser_closingAfterOpening,i.getRange())}++a}}},{key:"toRPN",value:function(e){var t=[],n=[];for(e.forEach((function(e){if(e instanceof te||e instanceof ne)t.push(e);else if(e instanceof re){for(;n.length>0&&n[n.length-1]instanceof re;){var r=n[n.length-1];if(!(e.precedence<=r.precedence))break;t.push(n.pop())}n.push(e)}else if(e instanceof Y)n.push(e);else if(e instanceof ee)for(;;){if(0===n.length)throw G.syntaxError(C().syntaxErrors.exprParser_invalidParentheses,void 0);if(n[n.length-1]instanceof Y){n.pop();break}t.push(n.pop())}}));n.length>0;){var r=n.pop();if(r instanceof Y)throw G.syntaxError(C().syntaxErrors.exprParser_invalidParentheses,void 0);t.push(r)}return t}},{key:"rpnToRATree",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.rpnToRATreeRecursive(e,t,n);if(e.length>0){if(t)throw G.syntaxError(C().syntaxErrors.exprParser_invalidExpression,void 0);return new ie(new q(""))}return r}},{key:"rpnToRATreeRecursive",value:function(e,t,n){if(0===e.length)throw G.syntaxError(C().syntaxErrors.exprParser_invalidExpression,void 0);var r=e.pop();if(r instanceof te){var a=this.relations.get(r.str.toString());if(void 0===a){var o=G.semanticError(C().semanticErrors.exprParser_relationNotDefined,r.getRange(),r.str.toString());if(t)throw o;return n.push(o),new ie(new q(""))}return new ie(a)}if(r instanceof ne){var i=this.rpnToRATreeRecursive(e,t,n);return lt.createUnary(r.type,i,this.nullValuesSupport,r.str)}if(r instanceof re){var s=this.rpnToRATreeRecursive(e,t,n),l=this.rpnToRATreeRecursive(e,t,n);return lt.createBinary(r.type,l,s,this.nullValuesSupport,r.str)}throw G.codeError(C().codeErrors.exprParser_unexpectedToken,JSON.stringify(r))}}]),e}(),ct=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).inputRef=void 0,r.handleChange=function(e){e=e.replace(/\t/g,"    ");var t=r.props.forbidden(e);r.setState({value:e,buttonDisable:t})},r.handleKeyDown=function(e){"Enter"===e.key?r.state.buttonDisable||r.handleSubmit():"Escape"!==e.key&&"Esc"!==e.key||null!==r.inputRef.current&&r.inputRef.current.blur()},r.handleSubmit=function(){r.props.onSubmit(r.state.value)},r.state={value:r.props.value,buttonDisable:r.props.forbidden(r.props.value)},r.inputRef=a.a.createRef(),r}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{ref:this.inputRef,type:"text",id:this.props.id,spellCheck:!1,autoComplete:"off",value:this.state.value,onChange:function(t){return e.handleChange(t.target.value)},onKeyDown:this.handleKeyDown,className:"text-input"}),a.a.createElement("button",{onClick:this.handleSubmit,disabled:this.state.buttonDisable},this.props.buttonText))}}]),n}(a.a.Component),pt=(n(39),getComputedStyle(document.querySelector(":root"))),ht=Number(pt.getPropertyValue("--message-box-margin-num")),ft=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"init",value:function(){var t=document.createElement("div");t.classList.add("message-box"),t.style.visibility="hidden",t.onmouseenter=function(){e.clearHideTimeout()},t.onmouseleave=function(){e.setHideTimeout()};var n=document.createElement("p");t.appendChild(n);var r=document.createElement("button");return r.innerText="\u2716",r.onclick=function(){e.hideBox()},t.appendChild(r),window.addEventListener("resize",(function(){e.moveBox()})),document.body.appendChild(t),t}},{key:"display",value:function(t,n){var r=e.box;r.firstElementChild.innerText=t,r.style.visibility="visible",r.classList.toggle("message-box-message",!n),r.classList.toggle("message-box-error",n),e.moveBox(),e.setHideTimeout()}},{key:"message",value:function(t){e.display(t,!1)}},{key:"error",value:function(t){e.display(t,!0)}}]),e}();ft.hideTimeout=5e3,ft.box=ft.init(),ft.hideIntervalId=void 0,ft.setHideTimeout=function(){ft.clearHideTimeout(),ft.hideIntervalId=setTimeout(ft.hideBox,ft.hideTimeout)},ft.clearHideTimeout=function(){clearTimeout(ft.hideIntervalId)},ft.hideBox=function(){ft.box.style.visibility="hidden"},ft.moveBox=function(){"visible"===ft.box.style.visibility&&(ft.box.style.width=document.body.clientWidth-2*ht+"px")};var dt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).textAreaRef=void 0,r.lastChange=0,r.lastWhisperAndErrorsUpdate=0,r.whispersAndErrorsUpdateRate=400,r.updateErrorsAndParentheses=function(){var e=r.getCurExpr().text,t=new ut(r.props.relations,r.props.nullValuesSupport).fakeParse(e,r.state.cursorIndex),n=t.errors,a=t.parentheses;r.setState({errors:n.filter((function(e){return void 0!==e.range&&!isNaN(e.range.start)&&!isNaN(e.range.end)})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}})),parentheses:a.filter((function(e){return!isNaN(e.start)&&!isNaN(e.end)}))})},r.evalExpr=function(){try{var e=new ut(r.props.relations,r.props.nullValuesSupport).parse(r.props.expressions[r.props.currentExpressionIndex].text);e.eval(),r.setState({errors:[]}),r.props.onEval(e)}catch(t){t instanceof y&&void 0!==t.range&&(t.range.end+=1,r.setState((function(e){var n=e.errors;return n.every((function(e){return e.start!==t.range.start||e.end!==t.range.end}))&&n.push(Object(d.a)(Object(d.a)({},t.range),{},{msg:t.message})),{errors:n}}))),r.showError(t)}},r.newExpression=function(){r.props.onNewExpression()},r.deleteExpression=function(){r.props.onDeleteExpression(r.updateErrorsAndParentheses)},r.exportExpressions=function(){r.props.onExportExpressions(ft.message)},r.importExpressions=function(){r.props.onImportExpressions((function(e){ft.message(e),r.updateErrorsAndParentheses()}))},r.addSpecialString=function(e,t){var n=r.textAreaRef.current.getSelection(),a=n.start,o=n.end,i=r.getCurExpr().text.substring(0,a),s=r.getCurExpr().text.substring(o),l=i.length+e.length-t,u=i+e+s;r.handleExprChange(u,l,(function(){r.textAreaRef.current.setSelection(l),r.textAreaRef.current.focus()}))},r.handleExprChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};r.props.onChange(r.getCurExpr().name,e),r.setState({cursorIndex:t},n),r.lastChange=Date.now()},r.handleCtrlInput=function(e){"Enter"===e.key&&r.evalExpr()},r.updateWhispersAndErrors=function(){var e=r.textAreaRef.current;if(null!==e&&e.isFocused()&&r.lastChange>r.lastWhisperAndErrorsUpdate){var t=r.getCurExpr().text,n=new ut(r.props.relations,r.props.nullValuesSupport).fakeParse(t,r.state.cursorIndex),a=t.slice(T(t,r.state.cursorIndex),r.state.cursorIndex),o=function(e,t){var n=e.map((function(e){var n=0,r=e.toLowerCase().indexOf(t.toLowerCase());if(r>-1){n+=0===r?2:1;var a=r+t.length;e=e.slice(0,r)+"<span class='whisper-matched-word'>"+e.slice(r,a)+"</span>"+e.slice(a)}return 0===n&&(e="<span class='whisper-rejected-word'>"+e+"</span>"),{whisper:e,likelihood:n}}));return""!==t&&n.sort((function(e,t){return t.likelihood-e.likelihood})),n.map((function(e){return e.whisper}))}(n.whispers,a);r.setState({whispers:o,errors:n.errors.filter((function(e){return void 0!==e.range&&!isNaN(e.range.start)&&!isNaN(e.range.end)})).map((function(e){return{start:e.range.start,end:e.range.end+1,msg:e.message}})),parentheses:n.parentheses.filter((function(e){return!isNaN(e.start)&&!isNaN(e.end)}))}),r.lastWhisperAndErrorsUpdate=Date.now()}},r.handleExprNameChange=function(e){r.props.onChange(e,r.getCurExpr().text)},r.showError=function(e){e instanceof j||e instanceof O?ft.error(e.message):(r.props.onUnexpectedError(e),ft.error("UNEXPECTED ERROR: "+e.message+"\nPlease, help us and report your last actions, thank you!"))},r.state={sectionClicked:!1,whispers:[],errors:[],parentheses:[],cursorIndex:0},r.textAreaRef=a.a.createRef(),setInterval((function(){return r.updateWhispersAndErrors()}),r.whispersAndErrorsUpdateRate),r}return Object(p.a)(n,[{key:"getCurExpr",value:function(){return this.props.expressions[this.props.currentExpressionIndex]}},{key:"handleSelectDifferentExpression",value:function(e){this.props.onSelectDifferentExpression(e)}},{key:"render",value:function(){var e=this,t=this.props.language.expressionSection,n=this.props.language.operations,r=function(e,t,n,r){return a.a.createElement(m,{key:e,text:e,onClick:t,style:r,tooltip:n})},o=function(t,n,r,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return a.a.createElement(m,{key:t,text:r,onClick:function(){return e.addSpecialString(n,i)},tooltip:o,style:s})},i={marginRight:"10px"};return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.expressionSectionHeader),r(t.importButton,this.importExpressions,t.importButtonTooltip),r(t.exportButton,this.exportExpressions,t.exportButtonTooltip)),a.a.createElement("menu",{className:"page-section-tab-menu"},e.props.expressions.map((function(t,n){var r=e.props.currentExpressionIndex===n?"button-clicked":"";return a.a.createElement("button",{key:n,onClick:function(){return e.handleSelectDifferentExpression(n)},className:r},t.name)})),a.a.createElement("button",{onClick:this.newExpression,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(z,{ref:this.textAreaRef,id:"expression-section-textarea",text:this.getCurExpr().text,placeholder:t.expressionTextareaPlaceholder,errors:this.state.errors,whispers:this.state.whispers,parentheses:this.state.parentheses,onChange:this.handleExprChange,onCtrlInput:this.handleCtrlInput,darkTheme:this.props.darkTheme}),a.a.createElement("menu",{className:"expressions-operators-menu"},o("unary_a","()","()",n.selection,1),o("unary_b","[]","[]",n.projection,1),o("unary_c","< -> >","<>",n.rename,5,i),o("set_a","\u222a","\u222a",n.union,0),o("set_b","\u2229","\u2229",n.intersection,0),o("set_c","\\","\\",n.difference,0,i),o("inner_a","*","*",n.naturalJoin,0),o("inner_b","\u2a2f","\u2a2f",n.cartesianProduct,0),o("inner_c","<*","<*",n.leftSemiJoin,0),o("inner_d","*>","*>",n.rightSemiJoin,0),o("inner_e","\u22b3","\u22b3",n.leftAntijoin,0),o("inner_f","\u22b2","\u22b2",n.rightAntijoin,0),o("inner_g","[]","[]",n.thetaJoin,1),o("inner_h","<]","<]",n.leftThetaSemiJoin,1),o("inner_i","[>","[>",n.rightThetaSemiJoin,1,i),this.props.nullValuesSupport&&o("outer_a","*F*","*F*",n.fullOuterJoin,0),this.props.nullValuesSupport&&o("outer_b","*L*","*L*",n.leftOuterJoin,0),this.props.nullValuesSupport&&o("outer_c","*R*","*R*",n.rightOuterJoin,0,i),o("division","\xf7","\xf7",n.division,0,i),o("line_comment","//","//",t.lineComment,0),o("block_comment","/**/","/*",t.blockComment,2)),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(m,{text:t.evaluateButton,onClick:this.evalExpr,className:"action-button",style:{marginRight:"40px"},tooltip:t.evaluateButtonTooltip}),a.a.createElement(ct,{value:this.getCurExpr().name,buttonText:t.renameButton,onSubmit:this.handleExprNameChange,forbidden:function(){return!1},id:"expression-name-input"}),r(t.deleteButton,this.deleteExpression,t.deleteButtonTooltip)))}}]),n}(a.a.Component),mt=n(26),vt=n.n(mt),gt=(n(40),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).getOrderByText=function(){return 1===r.state.orderDir?" \u25bc":" \u25b2"},r.state={orderBy:-1,orderDir:1},r}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.relation!==this.props.relation&&this.setState({orderDir:1,orderBy:-1})}},{key:"updateOrderBy",value:function(e){this.setState((function(t){return t.orderBy===e?{orderDir:-t.orderDir,orderBy:e}:{orderDir:1,orderBy:e}}))}},{key:"createHeaderRow",value:function(e){var t=this;return a.a.createElement("tr",null,a.a.createElement("td",{className:"row-number-td"}),e.map((function(e,n){var r=t.state.orderBy===n?e+t.getOrderByText():e;return a.a.createElement("th",{key:n,onClick:function(){return t.updateOrderBy(n)}},r)})))}},{key:"createRows",value:function(e){var t=this;if(0===this.props.relation.getRowsCount())return a.a.createElement("tr",{key:"1"},a.a.createElement("td",{className:"row-number-td"}),a.a.createElement("td",{key:"1",colSpan:e.length},"<<NO ROWS>>"));var n=this.props.relation.getRows();if(this.state.orderBy>-1&&this.state.orderBy<e.length){var r=e[this.state.orderBy];"number"===n[0].getType(r)?n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*(e.getValue(r)-n.getValue(r)):0})):n.sort((function(e,n){var a=e.getValue(r),o=n.getValue(r);return null===a&&null!==o?t.state.orderDir*Number.MAX_SAFE_INTEGER:null!==a&&null===o?t.state.orderDir*Number.MIN_SAFE_INTEGER:null!==a&&null!==o?t.state.orderDir*String(e.getValue(r)).localeCompare(String(n.getValue(r))):0}))}return n.map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1),t.getOrderedPrintValues(e).map((function(e,t){return a.a.createElement("td",{key:t},e)})))}))}},{key:"render",value:function(){var e=this.props.relation.getColumnNames(),t=this.createHeaderRow(e),n=this.createRows(e);return a.a.createElement("div",{className:"result-table-container scrollbar-container"},a.a.createElement("table",{className:"result-table"},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,n)))}}]),n}(a.a.Component)),yt=n(72),bt=n(28),Et=n(74),xt=n(73),kt=n(27),St=n.n(kt),Rt=n(71),wt=(n(41),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(St.a,null,(function(t){var n=t.width;return a.a.createElement(Ut,{raTree:e.props.tree,selected:e.props.selected,width:n,onClick:e.props.onClick,darkTheme:e.props.darkTheme})}))}}]),n}(a.a.Component)),Ct=getComputedStyle(document.querySelector(":root")),jt=Ct.getPropertyValue("--eval-tree-font-size"),Ot=Ct.getPropertyValue("--eval-tree-font-family"),Nt=N(Ot,jt),Tt=Nt.fontWidth,At=Nt.fontHeight,Pt=2*At+24,_t=Ct.getPropertyValue("--light-color-a"),Vt=Ct.getPropertyValue("--dark-color-a"),It=Ct.getPropertyValue("--text-color-light"),Lt=Ct.getPropertyValue("--text-color-dark"),Bt=Ct.getPropertyValue("--light-color-c"),Dt=Ct.getPropertyValue("--light-color-b"),Wt=Ct.getPropertyValue("--dark-color-d"),zt=Ct.getPropertyValue("--dark-color-c");function Jt(e){var t=e.node,n=e.selected,r=e.onClick,o=e.darkTheme,i=Object(Rt.a)(),s=i.tooltipOpen,l=i.showTooltip,u=i.hideTooltip,c=Math.max(t.data.title.length,t.data.symbol.length)*Tt+24;return c<Pt&&(c=Pt),a.a.createElement(yt.a,{top:t.y,left:t.x},a.a.createElement("rect",{height:Pt,width:c,y:-Pt/2,x:-c/2,rx:5,fill:o?n||s?Wt:zt:n||s?Bt:Dt,onClick:function(){r(t.data.index)},cursor:"pointer",onMouseOver:function(){l({tooltipLeft:0,tooltipTop:0})},onMouseOut:u}),a.a.createElement("text",{y:"-4px",dy:".2em",fontSize:jt,fontFamily:Ot,textAnchor:"middle",style:{pointerEvents:"none"},fill:o?Lt:It},""===t.data.symbol?a.a.createElement("tspan",{x:"0",dy:".5em"},t.data.title):a.a.createElement(a.a.Fragment,null,a.a.createElement("tspan",{x:"0",dy:"0"},t.data.title),a.a.createElement("tspan",{x:"0",dy:"1.2em"},t.data.symbol))))}function Ut(e){var t=e.raTree,n=e.selected,r=e.width,o=e.onClick,i=e.darkTheme,s=He(t),l=(s+1)*Pt+s*Pt/2+Pt,u={top:Pt,left:0,right:0,bottom:Pt},c=l-u.top-u.bottom,p=r-u.left-u.right,h=function(e){var t=0;return function e(n){var r=n.getOperationSymbol();return r.length>30&&(r=r.slice(0,26)+"..."+r.charAt(r.length-1)),n instanceof ue?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getSubtree())]}:n instanceof Fe?{title:n.getOperationName(),symbol:r,index:t++,children:[e(n.getLeftSubtree()),e(n.getRightSubtree())]}:{title:n.getOperationName(),symbol:r,index:t++}}(e)}(t),f=Object(bt.b)(h);return r<10?null:a.a.createElement("svg",{id:"eval-tree-svg",width:r,height:l},a.a.createElement("rect",{width:r,height:l,rx:14,fill:i?Vt:_t}),a.a.createElement(Et.a,{root:f,size:[p,c]},(function(e){return a.a.createElement(yt.a,{top:u.top,left:u.left},e.links().map((function(e,t){return a.a.createElement(xt.a,{key:"cluster-link-".concat(t),data:e,stroke:i?Lt:It,strokeWidth:"1",strokeOpacity:1,fill:"none"})})),e.descendants().map((function(e){return a.a.createElement(Jt,{key:"node-".concat(e.data.index),node:e,selected:e.data.index===n,onClick:o,darkTheme:i})})))})))}var Ft=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"openFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(e,">");var r=n.firstChild;r.addEventListener("change",(function(){var e=r.files[0],n=new FileReader;n.onload=function(){t({name:e.name,text:n.result})},n.readAsText(e)})),r.click()}))}},{key:"openFiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new Promise((function(n){e.openFilesHelper(n,t)}))}},{key:"openFilesHelper",value:function(e,t){var n=document.createElement("div");n.innerHTML='<input type="file" accept='.concat(t," multiple>");var r=n.firstChild,a=[];r.addEventListener("change",(function(){var t=r.files;!function n(r){if(r===t.length)return e(a);var o=t[r],i=new FileReader;i.onload=function(e){a.push({name:o.name,text:e.target.result}),n(r+1),console.log("File "+(r+1)+"/"+t.length+" loaded")},i.readAsText(o)}(0)})),r.click()}}]),e}();var Mt=function(){function e(){Object(c.a)(this,e),this.map=new Map}return Object(p.a)(e,[{key:"get",value:function(e,t){return this.map.get(e+":"+t)}},{key:"set",value:function(e,t,n){this.map.set(e+":"+t,n)}},{key:"delete",value:function(e,t){return this.map.delete(e+":"+t)}},{key:"clear",value:function(){this.map.clear()}},{key:"size",value:function(){return this.map.size}},{key:"forEach",value:function(t){Object(u.a)(this.map.entries()).map((function(t){return{value:t[1],key:e.parseKey(t[0])}})).forEach((function(e,n){return t(e.value,e.key.row,e.key.column,n)}))}}],[{key:"parseKey",value:function(e){var t=e.split(":");return{row:Number(t[0]),column:Number(t[1])}}}]),e}();var Ht=function(){function e(t,n,r,a,o){Object(c.a)(this,e),this.name=void 0,this.columnNames=void 0,this.columnTypes=void 0,this.rows=void 0,this.columnCount=void 0,this.rowCount=void 0,this.errors=void 0,this.nullValuesSupport=void 0,this.actual=void 0,this.revertState=void 0,this.name=t,this.columnNames=n,this.columnTypes=r,this.rows=a,this.columnCount=n.length,this.rowCount=a.length,this.errors=new Mt,this.nullValuesSupport=o,this.actual=!1,this.revertState=this.toDataObject(),this.recomputeErrors()}return Object(p.a)(e,null,[{key:"new",value:function(t,n){return new e(t,["Column1"],["number"],[],n)}},{key:"fromData",value:function(t,n){if(qt(t)){var r=t;return new e(r.name,r.columnNames,r.columnTypes,r.rows,n)}throw new Error("Given object is not a valid relation.")}},{key:"fromRelation",value:function(t,n,r){var a=[],o=[];n.getColumns().forEach((function(e,t){a.push(t),o.push(e)}));var i=n.getRows().map((function(e){return e.getOrderedPrintValues(a)}));return new e(t,a,o,i,r)}},{key:"copy",value:function(t){return new e(t.name,Object(u.a)(t.columnNames),Object(u.a)(t.columnTypes),t.rows.map((function(e){return Object(u.a)(e)})),t.nullValuesSupport)}},{key:"format",value:function(e){var t=e.columnNames.map((function(e){return e.length}));e.columnTypes.forEach((function(e,n){t[n]<e.length&&(t[n]=e.length)})),e.rows.forEach((function(e){e.forEach((function(e,n){t[n]<e.length&&(t[n]=e.length)}))}));var n=function(e){return e.map((function(e,n){return e.padEnd(t[n]," ")})).join(" | ")};return n(e.columnNames)+"\n"+n(e.columnTypes)+"\n"+t.map((function(e){return"-".repeat(e)})).join("-+-")+"\n"+e.rows.map((function(e){return n(e)})).join("\n")+"\n\n"}}]),Object(p.a)(e,[{key:"recomputeErrors",value:function(){var e=this;this.errors.clear(),this.checkColumnNames();for(var t=function(t){Object(u.a)(new Array(e.rowCount).keys()).forEach((function(n){return e.checkRowInput(t,n)}))},n=0;n<this.columnCount;++n)t(n)}},{key:"checkColumnNames",value:function(){for(var e=this,t=C().relationErrors,n=function(n){var r=e.columnNames[n].trim();return""===r?(e.errors.set("name",n,t.emptyColumn),"continue"):e.columnNames.reduce((function(e,t){return t===r?e+1:e}),0)>1?(e.errors.set("name",n,t.duplicitColumn),"continue"):me(r)?(e.errors.set("name",n,t.keywordColumn),"continue"):ae.isName(r)?void e.errors.delete("name",n):(e.errors.set("name",n,t.invalidColumn),"continue")},r=0;r<this.columnCount;++r)n(r)}},{key:"checkRowInput",value:function(e,t){var n=C().relationErrors;this.errors.delete(t,e);var r=this.rows[t][e].trim();if(""===r||"null"===r)this.nullValuesSupport||this.errors.set(t,e,n.unsupportedNull);else if("number"===this.columnTypes[e])ae.isNumber(r.replace(/\s/g,""))||this.errors.set(t,e,n.invalidNumber);else if("boolean"===this.columnTypes[e]){var a=r.toLowerCase();"true"!==a&&"t"!==a&&"false"!==a&&"f"!==a&&this.errors.set(t,e,n.invalidBoolean)}}},{key:"checkColumnTypes",value:function(e){var t=this;this.rows.forEach((function(n,r){return t.checkRowInput(e,r)}))}},{key:"createRelation",value:function(){for(var e=this,t=new q(this.name),n=0;n<this.columnCount;++n)t.addColumn(this.columnNames[n],this.columnTypes[n]);return this.rows.forEach((function(n){var r=new ce(t.getColumns());n.forEach((function(t,n){if(""===(t=t.trim())||"null"===t)r.addValue(e.columnNames[n],null);else if("string"===e.columnTypes[n])t=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),r.addValue(e.columnNames[n],t);else if("number"===e.columnTypes[n])r.addValue(e.columnNames[n],Number(t.replace(/\s/g,"")));else{var a=t.toLowerCase();r.addValue(e.columnNames[n],"t"===a||"true"===a)}})),t.addRow(r)})),t.finishSchema(),t}},{key:"toDataObject",value:function(){return{name:this.name,columnNames:Object(u.a)(this.columnNames),columnTypes:Object(u.a)(this.columnTypes),rows:this.rows.map((function(e){return Object(u.a)(e)})),columnCount:this.columnCount,rowCount:this.rowCount}}},{key:"getErrors",value:function(){return this.errors}},{key:"isValid",value:function(){return 0===this.errors.size()}},{key:"setNullValuesSupport",value:function(e){e!==this.nullValuesSupport&&(this.nullValuesSupport=e,this.recomputeErrors())}},{key:"addNewColumn",value:function(){for(var e=this.columnNames.length+1,t="Column"+e;this.columnNames.indexOf(t)>-1;)t="Column"+ ++e;this.columnNames.push(t),this.columnTypes.push("number"),this.nullValuesSupport?this.rows.forEach((function(e){return e.push("")})):this.rows.forEach((function(e){return e.push("0")})),++this.columnCount,this.checkColumnNames(),this.actual=!1}},{key:"addNewRow",value:function(){var e=this;this.nullValuesSupport?this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(e){return""}))):this.rows.push(Object(u.a)(new Array(this.columnCount).keys()).map((function(t){return"number"===e.columnTypes[t]?"0":"boolean"===e.columnTypes[t]?"false":'""'}))),++this.rowCount,this.actual=!1}},{key:"deleteColumn",value:function(e){var t=this;this.columnNames.splice(e,1),this.columnTypes.splice(e,1),this.rows.forEach((function(t){return t.splice(e,1)})),--this.columnCount,0===this.columnCount&&(this.rows=[],this.addNewColumn()),this.errors.forEach((function(n,r,a){a===e?t.errors.delete(r,a):a>e&&(t.errors.delete(r,a),t.errors.set(r,a,n))})),this.actual=!1}},{key:"deleteRow",value:function(e){var t=this;this.rows.splice(e,1),--this.rowCount,this.errors.forEach((function(n,r,a){r===e?t.errors.delete(r,a):"number"===typeof r&&r>e&&(t.errors.delete(r,a),t.errors.set(r-1,a,n))})),this.actual=!1}},{key:"getRowCount",value:function(){return this.rowCount}},{key:"getColumnCount",value:function(){return this.columnCount}},{key:"setName",value:function(e){this.name=e,this.actual=!1}},{key:"getName",value:function(){return this.name}},{key:"getColumnNames",value:function(){return this.columnNames}},{key:"setColumnName",value:function(e,t){this.columnNames[t]=e,this.checkColumnNames(),this.actual=!1}},{key:"getColumnTypes",value:function(){return this.columnTypes}},{key:"setColumnType",value:function(e,t){this.columnTypes[t]=e,this.checkColumnTypes(t),this.actual=!1}},{key:"getRows",value:function(){return this.rows}},{key:"setRowInput",value:function(e,t,n){this.rows[t][n]=e,this.checkRowInput(n,t),this.actual=!1}},{key:"isActual",value:function(){return this.actual}},{key:"setActual",value:function(e){this.actual=e,e&&(this.revertState=this.toDataObject())}},{key:"getRevertName",value:function(){return void 0!==this.revertState?this.revertState.name:""}},{key:"revert",value:function(){void 0!==this.revertState&&(this.name=this.revertState.name,this.columnNames=Object(u.a)(this.revertState.columnNames),this.columnTypes=Object(u.a)(this.revertState.columnTypes),this.rows=this.revertState.rows.map((function(e){return Object(u.a)(e)})),this.columnCount=this.revertState.columnCount,this.rowCount=this.revertState.rowCount,this.actual=!1,this.recomputeErrors())}}]),e}();function qt(e){return"object"===typeof e&&("name"in e&&"string"===typeof e.name&&("columnCount"in e&&"number"===typeof e.columnCount&&!(e.columnCount<1)&&("rowCount"in e&&"number"===typeof e.rowCount&&(!(!("columnNames"in e)||!Array.isArray(e.columnNames)||e.columnNames.length!==e.columnCount||e.columnNames.some((function(e){return"string"!==typeof e})))&&(!(!("columnTypes"in e)||!Array.isArray(e.columnTypes)||e.columnTypes.length!==e.columnCount||e.columnTypes.some((function(e){return!function(e){return"string"===typeof e&&("string"===e||"number"===e||"boolean"===e)}(e)})))&&("rows"in e&&Array.isArray(e.rows)&&e.rows.every((function(t){return Array.isArray(t)&&t.length===e.columnCount&&t.every((function(e){return"string"===typeof e}))}))))))))}var Kt=n(7),Gt=n(18),Zt=n.n(Gt),Qt=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"load",value:function(t){var n=this;return new Promise((function(r){Ft.openFiles(".csv").then((function(a){var o=[],i=0;a.forEach((function(r){if(r.name.match(/\.csv$/))try{o.push(n.csvToRelation(e.createValidName(r.name.slice(0,-4)),r.text,t))}catch(a){console.log("File "+r.name+" skipped for bad format of csv"),i+=1}else console.log("Unsupported filetype: "+r.name),i+=1})),r({relations:o,skipped:i})}))}))}},{key:"save",value:function(e,t,n){var r=this;if(0!==e.length)if(1!==e.length){var a=Zt()();e.forEach((function(e){a.file(e.getName()+".csv",r.relationToCsv(e,n))})),a.generateAsync({type:"blob"}).then((function(e){Object(Kt.saveAs)(e,t+".zip")})).catch((function(e){throw e}))}else{var o=new Blob([this.relationToCsv(e[0],n)],{type:"text/plain;charset=utf-8"});Object(Kt.saveAs)(o,e[0].getName()+".csv")}}},{key:"csvToRelation",value:function(t,n,r){if(null===n||""===n)throw console.log("null or empty string read from file "+t),Error();var a=(n=n.trim().replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ")).split("\n");if(a.length<2)throw console.log("file "+t+" has only one line"),Error();a[0]=a[0].replace(/\s/g,""),a[1]=a[1].replace(/\s/g,"");var o=function(e){for(var t=0;t<e.length;++t){var n=e.charAt(t);if(","===n)return",";if(";"===n)return";"}}(a[1]);void 0===o&&(o=";");var i=a[0].split(o),s=a[1].split(o).map((function(e){var t=e.toLowerCase();return"string"===t||"str"===t||"s"===t?"string":"number"===t||"num"===t||"n"===t?"number":"boolean"})),l=a.slice(2).map((function(t){var n=[];for(t=t.trim();;){var r=e.nextRowInput(t,o);if(n.push(r.input),void 0===r.rest)break;t=r.rest}return n})),u=i.length;if(s.length!==u||l.some((function(e){return e.length!==u})))throw console.log("rows in file "+t+" do not have the same number of columns"),new Error;return new Ht(t,i,s,l,r)}},{key:"createValidName",value:function(e){return""===(e=e.split("").filter((function(e){return ae.isNameChar(e)})).join(""))?"relation":e}},{key:"nextRowInput",value:function(e,t){for(var n=!1,r=0,a=0;a<e.length;){var o=e.charAt(a);if(!n&&o===t)return{input:e.slice(0,a),rest:e.slice(a+1)};"\\"===o?++r:r=0,'"'===o&&r%2===0&&(n=!n),++a}return{input:e,rest:void 0}}},{key:"relationToCsv",value:function(e,t){var n=e.getColumnNames().join(t),r=e.getColumnTypes().join(t),a=e.getRows().map((function(e){return e.join(t)}));return[n,r].concat(Object(u.a)(a)).join("\n")}}]),e}(),Xt=(n(61),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).sectionRef=void 0,r.getCurrentRelation=function(){var e=Me(r.props.evaluationTreeRoot,r.state.selectedIndex);if(null===e&&null===(e=Me(r.props.evaluationTreeRoot,0)))return r.props.onUnexpectedError(G.codeError(C().codeErrors.resultSection_nodeIndexNotFound)),null;try{return e.getResult()}catch(t){return r.props.onUnexpectedError(G.codeError(C().codeErrors.resultSection_evalError,t.message)),null}},r.handleSelectedNodeChange=function(e){r.setState({selectedIndex:e})},r.exportEvalTreeAsPng=function(){var e=document.getElementById("eval-tree-svg");if(null!==e){var t=e.getBoundingClientRect(),n={width:3*t.width,height:3*t.height,svg:e,filename:r.props.expressionName+" - evaluation tree.png"};vt()(n)}},r.exportRelation=function(){if(null!==r.getCurrentRelation())try{Qt.save([Ht.fromRelation("rachel_result",r.getCurrentRelation(),!0)],"rachel_result",r.props.csvValueSeparator)}catch(e){console.warn("Saving error: "+e,!0)}else r.props.onUnexpectedError(G.codeError(C().codeErrors.resultSection_nullRelationToSave))},r.addRelation=function(){null!==r.getCurrentRelation()?r.props.onAddResult(r.getCurrentRelation()):r.props.onUnexpectedError(G.codeError(C().codeErrors.resultSection_nullRelationToAdd))},r.state={selectedIndex:0},r.sectionRef=a.a.createRef(),r}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(e){e.evaluationTreeRoot!==this.props.evaluationTreeRoot&&this.setState({selectedIndex:0})}},{key:"render",value:function(){var e=this.getCurrentRelation();if(null===e)return null;var t=this.props.language.resultSection,n=0===this.state.selectedIndex?t.resultRelationTitle:t.intermediateRelationTitle,r=Me(this.props.evaluationTreeRoot,this.state.selectedIndex),o=null===r?null:r.printInLine();return a.a.createElement("section",{ref:this.sectionRef,className:"page-section result-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.resultSectionHeader),a.a.createElement(m,{text:t.exportEvalTreeButton,onClick:this.exportEvalTreeAsPng,tooltip:t.exportEvalTreeButtonTooltip})),a.a.createElement("p",{className:"upper-p"},a.a.createElement("strong",null,t.evalTreeTitle+" "+this.props.evaluationTreeRoot.printInLine()+":")),a.a.createElement(wt,{tree:this.props.evaluationTreeRoot,selected:this.state.selectedIndex,onClick:this.handleSelectedNodeChange,darkTheme:this.props.darkTheme}),a.a.createElement("p",{className:"lower-p"},a.a.createElement("strong",null,n," ",o,":")),a.a.createElement("menu",{className:"page-section-tab-menu"},a.a.createElement(m,{text:t.addButton,onClick:this.addRelation,tooltip:t.addButtonTooltip}),a.a.createElement(m,{text:t.exportRelationButton,onClick:this.exportRelation,tooltip:t.exportRelationButtonTooltip})),a.a.createElement(gt,{relation:e}))}}]),n}(a.a.Component)),$t=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"load",value:function(){var e=this;return new Promise((function(t){Ft.openFiles(".txt").then((function(n){var r=[],a=0,o=0,i=0;n.forEach((function(t){null===t.text?(console.log("Null read from file "+t.name),i+=1):t.name.match(/\.txt$/)?(t.text=t.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    "),"\n".concat(t.text).split("\n### ").forEach((function(t){try{0!==t.trim().length&&r.push(e.splitExpressionNameAndText(t))}catch(n){a+=1}})),o+=1):(console.log("Unsupported filetype: "+t.name),i+=1)})),t({expressions:r,skippedExpressions:a,loadedFiles:o,skippedFiles:i})}))}))}},{key:"splitExpressionNameAndText",value:function(e){var t=e.indexOf("\n");if(-1===t)throw console.log("Expression does not contain first name line."),Error();var n=e.slice(0,t).trim();if(!n.endsWith(" ###"))throw console.log("Expression does not contain name between hashes."),Error();return{name:n.slice(0,-4),text:e.slice(t).trim()}}},{key:"save",value:function(e,t){var n=e.map((function(e){return"### "+e.name+" ###\n\n"+e.text})).join("\n\n"),r=new Blob([n],{type:"text/plain;charset=utf-8"});Object(Kt.saveAs)(r,t+".txt")}}]),e}(),Yt=(n(62),[{name:"Cars and Owners (EN)",project:{relations:[{name:"Car",columnNames:["Id","Owner","Color","Electric","Weight"],columnTypes:["number","number","string","boolean","number"],rows:[["1","1","Blue","True","1000"],["2","1","Green","false","1 200"],["3","2","Blue","F","850.42"],["4","3","Black","t","1 111.111 111"]],columnCount:5,rowCount:4},{name:"Owner",columnNames:["Id","Name"],columnTypes:["number","string"],rows:[["1","George Smith"],["2",'Adam "Driver /\\" Jackson'],["3","Michael Trueman"],["Fix errors","before loading"],["Or delete","invalid rows"]],columnCount:2,rowCount:3}],expressions:[{name:"Relation only",text:"// You can use comments until the line end after '//'\n// You must load relations before using them in expressions\n\nCar\n\n// After evaluation, you will see the evaluation tree\n// and the result relation at the bottom of the page\n"},{name:"Unary operator",text:"// Unary operator comes after the source relation\n// If the relation is still not defined, go check its definition\n// This expression returns all owners with id 1\n\nOwner(Id = 1)\n"},{name:"Binary operator",text:"// Binary operator comes between source relations\n// This expression returns natural join of cars and owners\n\nCar*Owner\n"},{name:"Escapes",text:'// Strings in expressions are enclosed in quotes\n// To use quotes inside a string, you must escape them by a backslash \'\\"\'\n// To use backslash inside a string, you must escape it with second one \'\\\\\'\n\nOwner(Name == "Adam \\"Driver /\\\\\\" Jackson")\n\n// This does not work: Owner(Name == "Adam "Driver /\\" Jackson")\n'},{name:"Example",text:"// Errors are highlighted by red underline - hover mouse over it to see details\n// While typing, Rachel shows you available relations or columns\n// (if relations are loaded in the application)\n// Try to write a query for: all cars' ids and their owners' names\n\nTODO...\n"},{name:"Example result",text:"// One possible expression is like this...\n\n(\n  Car\n  *\n  Owner< Id -> Owner >\n)[Id, Name]\n\n// For more detailed manual click 'About' button in the page header\n"}],nullValuesSupport:!0}},{name:"Auta a Majitel\xe9 (CS)",project:{relations:[{name:"Auto",columnNames:["Id","Majitel","Barva","Elektro","V\xe1ha"],columnTypes:["number","number","string","boolean","number"],rows:[["1","1","Modr\xe1","True","1000"],["2","1","Zelen\xe1","false","1 200"],["3","2","Modr\xe1","F","850.42"],["4","3","\u010cern\xe1","t","1 111.111 111"]],columnCount:5,rowCount:4},{name:"Majitel",columnNames:["Id","Jm\xe9no"],columnTypes:["number","string"],rows:[["1","Pepa Mr\xe1zek"],["2",'Adam "Z\xe1vodn\xedk /\\" Horv\xe1th'],["3","Michael Dvo\u0159\xe1k"],["P\u0159ed nahr\xe1n\xedm","oprav chyby"],["Nebo odstra\u0148","chybn\xe9 \u0159\xe1dky"]],columnCount:2,rowCount:3}],expressions:[{name:"Pouze relace",text:"// M\u016f\u017ee\u0161 pou\u017e\xedvat koment\xe1\u0159e po '//'\n// P\u0159ed pou\u017eit\xedm relac\xed ve v\xfdrazech je mus\xed\u0161 nahr\xe1t\n\nAuto\n\n// Po vyhodnocen\xed uvid\xed\u0161 evalua\u010dn\xed strom\n// a v\xfdslednou relaci dole na str\xe1nce\n"},{name:"Un\xe1rn\xed oper\xe1tor",text:"// Un\xe1rn\xed oper\xe1tory se p\xed\u0161\xed za vstupn\xed relaci\n// Pokud je tato relace st\xe1le nedefinovan\xe1, zkontroluj jej\xed definici\n// Tento dotaz vr\xe1t\xed v\u0161echny majitele s id = 1\n\nMajitel(Id = 1)\n"},{name:"Bin\xe1rn\xed oper\xe1tor",text:"// Bin\xe1rn\xed oper\xe1tory se p\xed\u0161\xed mezi vstupn\xed relace\n// Tento v\xfdraz vr\xe1t\xed p\u0159irozen\xe9 spojen\xed aut a majitel\u016f\n\nAuto*Majitel\n"},{name:"Escapes",text:'// Textov\xe9 \u0159et\u011bzce ve v\xfdrazech mus\xed b\xfdt mezi uvozovkami\n// Pro pou\u017eit\xed uvozovek v \u0159et\u011bzci p\u0159ed n\u011b mus\xed\u0161 napsat zp\u011btn\xe9 lom\xedtko \'\\"\'\n// Pro pou\u017eit\xed zp\u011btn\xe9ho lom\xedtka p\u0159ed n\u011bj mus\xed\u0161 napsat druh\xe9 \'\\\\\'\n\nMajitel(Jm\xe9no == "Adam \\"Z\xe1vodn\xedk /\\\\\\" Horv\xe1th")\n\n// Toto by nefungovalo: Majitel(Jm\xe9no == "Adam "Z\xe1vodn\xedk /\\" Horv\xe1th")\n'},{name:"P\u0159\xedklad",text:"// Chyby jsou zv\xfdrazn\u011bni \u010derven\xfdm podtr\u017een\xedm - p\u0159eje\u010f na n\u011b my\u0161\xed pro detaily\n// P\u0159i psan\xed ti Rachel nab\xedz\xed dostupn\xe9 relace nebo sloupce\n// (pokud jsou relace nahran\xe9 v aplikace)\n// Zkus napsat dotaz pro: id v\u0161ech aut a jm\xe9na jejich majitel\u016f\n\nTODO...\n"},{name:"V\xfdsledek p\u0159\xedkladu",text:"// Jedno mo\u017en\xe9 \u0159e\u0161en\xed je toto...\n\n(\n  Auto\n  *\n  Majitel< Id -> Majitel >\n)[Id, Jm\xe9no]\n\n// Pro v\xedce informac\xed nav\u0161tiv manu\xe1l p\u0159es odkaz 'O aplikaci' v horn\xedm menu\n"}],nullValuesSupport:!0}}]);function en(){return Yt}var tn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={sectionClicked:!1},r}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.props.language.managementSection;return a.a.createElement("header",{className:"management-section"},a.a.createElement("h1",null,"RACHEL"),a.a.createElement("button",{onClick:e.props.onBatch},t.batchButton),a.a.createElement("button",{onClick:e.props.onLoadProject},t.loadButton),a.a.createElement("button",{onClick:e.props.onSaveProject},t.saveButton),function(){var n=a.a.createElement("ul",{className:"list-menu"},t.samplesMenuTitle,en().map((function(t,n){return a.a.createElement("li",{key:n},a.a.createElement("button",{onClick:function(){return e.props.onLoadSample(t.project)}},t.name))})));return a.a.createElement("div",{className:"button-like"},t.samplesButton,n)}(),function(){var n=a.a.createElement("ul",{className:"list-menu"},a.a.createElement("li",null,a.a.createElement("span",null,t.settingsNullValues,":"),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"allowed",id:"null_values_support_allowed",checked:e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!0)}}),a.a.createElement("label",{htmlFor:"null_values_support_allowed"},t.settingsNullValuesAllowed),a.a.createElement("input",{type:"radio",name:"null_values_support",value:"forbidden",id:"null_values_support_forbid",checked:!e.props.nullValuesSupport,onChange:function(){return e.props.onNullValuesSupportChange(!1)}}),a.a.createElement("label",{htmlFor:"null_values_support_forbid"},t.settingsNullValuesForbidden)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsCSVSeparator,":"),a.a.createElement("input",{type:"radio",name:"value_separator",value:"semicolon",id:"value_separator_semi",checked:";"===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(";")}}),a.a.createElement("label",{htmlFor:"value_separator_semi"},t.settingsCSVSeparatorSemicolon),a.a.createElement("input",{type:"radio",name:"value_separator",value:"comma",id:"value_separator_comma",checked:","===e.props.csvValueSeparator,onChange:function(){return e.props.onCsvValueSeparatorChange(",")}}),a.a.createElement("label",{htmlFor:"value_separator_comma"},t.settingsCSVSeparatorComma)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsTheme,":"),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"on",id:"dark_mode_on",checked:!e.props.darkTheme,onChange:function(){return e.props.onDarkModeChange(!1)}}),a.a.createElement("label",{htmlFor:"dark_mode_on"},t.settingsThemeLight),a.a.createElement("input",{type:"radio",name:"dark_mode",value:"off",id:"dark_mode_off",checked:e.props.darkTheme,onChange:function(){return e.props.onDarkModeChange(!0)}}),a.a.createElement("label",{htmlFor:"dark_mode_off"},t.settingsThemeDark)),a.a.createElement("li",null,a.a.createElement("span",null,t.settingsLanguage,":"),R.map((function(t){return a.a.createElement("div",{key:t,style:{display:"inline"}},a.a.createElement("input",{type:"radio",name:"language",value:t,id:"language_"+t,checked:e.props.language.abbr===t,onChange:function(){return e.props.onLanguageChange(t)}}),a.a.createElement("label",{htmlFor:"language_"+t},t))}))));return a.a.createElement("div",{className:"button-like"},t.settingsButton,n)}(),a.a.createElement("a",{href:"https://github.com/kotliluk/rachel",target:"_blank",rel:"noreferrer",className:"button-like"},t.aboutButton))}}]),n}(a.a.Component);function nn(e){return"object"!==typeof e?"The file cannot be parsed to an object.":"relations"in e&&Array.isArray(e.relations)&&0!==e.relations.length&&!e.relations.some((function(e){return!qt(e)}))?"expressions"in e&&Array.isArray(e.expressions)&&0!==e.expressions.length&&!e.expressions.some((function(e){return!function(e){return"object"===typeof e&&"name"in e&&"string"===typeof e.name&&"text"in e&&"string"===typeof e.text}(e)}))?"nullValuesSupport"in e&&"boolean"===typeof e.nullValuesSupport?"OK":'The file must contain the field "nullValuesSupport: boolean"':'The file must contain the field "expressions: Expression[]" of length at least one':'The file must contain the field "relations: StoredRelationData[]" of length at least one'}function rn(e){return{relations:e.relations.map((function(e){return{name:(t=e).name,columnNames:Object(u.a)(t.columnNames),columnTypes:Object(u.a)(t.columnTypes),rows:t.rows.map((function(e){return Object(u.a)(e)})),columnCount:t.columnCount,rowCount:t.rowCount};var t})),expressions:e.expressions.map((function(e){return{name:(t=e).name,text:t.text};var t})),nullValuesSupport:e.nullValuesSupport}}var an=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"load",value:function(){return new Promise((function(e,t){Ft.openFile(".rachel").then((function(n){if(null===n.text)t("Reading of the content of the file "+n.name+" failed.");else if(n.name.match(/\.rachel$/)){n.text=n.text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");var r=JSON.parse(n.text),a=nn(r);if("OK"===a)e(r);else t("Invalid structure of the JSON file. "+a)}else t("Please select a JSON file to load a project relation from.")}))}))}},{key:"save",value:function(e,t){var n=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});Object(Kt.saveAs)(n,t+".rachel")}}]),e}();var on=function(){function e(){Object(c.a)(this,e)}return Object(p.a)(e,null,[{key:"process",value:function(t){Ft.openFiles(".rachel").then((function(n){console.log(n.length+" files loaded to BatchProcessor"),console.time("Batch duration");var r=[],a=0,o=0,i=function(){var e=Zt()();r.forEach((function(t){e.file(t.name,t.text)})),e.generateAsync({type:"blob"}).then((function(e){Object(Kt.saveAs)(e,t+".zip"),console.log("Batch finished: "+a+" files processed, "+o+" skipped."),ft.message("Batch finished: "+a+" files processed, "+o+" skipped.")})).catch((function(e){ft.error("Batch results saving error: "+e.message)})),console.timeEnd("Batch duration")};!function t(s){if(s>=n.length)return i();var l=n[s];null===l.text?(r.push({name:l.name+"-eval-report.txt",text:"ERROR: Source file cannot be loaded."}),o+=1,console.warn("Null read from "+l.name)):l.name.match(/\.rachel$/)?(r.push(e.processFile(l)),a+=1):(r.push({name:l.name+"-eval-report.txt",text:"ERROR: Source file is not a .rachel file, but: "+l.name}),o+=1,console.warn("Unsupported filetype: "+l.name)),ft.message("Batch in progress... "+(a+o)+"/"+n.length),setTimeout((function(){return t(s+1)}),0)}(0)}))}},{key:"parseRelations",value:function(e,t){var n=new Map;return e.forEach((function(e){try{var r=Ht.fromData(e,t);r.isValid()&&n.set(r.getName(),r.createRelation())}catch(a){}})),n}}]),e}();on.processFile=function(e){var t=JSON.parse(e.text),n=nn(t);if("OK"!==n)return{name:e.name.slice(0,-4)+"-eval-report.txt",text:"Invalid JSON file: "+n};var r=on.parseRelations(t.relations,t.nullValuesSupport),a=new ut(r,t.nullValuesSupport),o=t.expressions.length,i=t.expressions.map((function(e){return on.processExpression(e,a)})),s=cn.apply(void 0,Object(u.a)(i.map((function(e){return e.counts})))),l=i.reduce((function(e,t){return e+t.error}),0);return{name:e.name.slice(0,-7)+"-eval-report.txt",text:on.reportHeader(o,l,s,t.nullValuesSupport)+on.formatRelations(t.relations)+sn+"\n\nQUERIES ("+o+")\n\n"+i.map((function(e){return e.text})).join("")}},on.processExpression=function(e,t){try{var n=t.parse(e.text),r=fn(n),a=n.getResult();return{text:ln+"\n"+e.name+"\n\n"+e.text+"\n\n"+a.contentString()+"\n\n\n",counts:r,error:0}}catch(o){return{text:ln+"\n"+e.name+"\n\n"+e.text+"\n\nERROR: "+o.message+"\n\n\n",counts:un(),error:1}}},on.reportHeader=function(e,t,n,r){var a,o,i=pn(a=n)+hn(a),s=pn(n),l=hn(n);return sn+"\n\nRachel project report from "+(o=new Date,String(o.getDate()).padStart(2,"0")+"."+String(o.getMonth()+1).padStart(2,"0")+"."+String(o.getFullYear())+" "+String(o.getHours()).padStart(2,"0")+":"+String(o.getMinutes()).padStart(2,"0")+"\n\n")+sn+"\n\nExpressions: "+e+"    Errors: "+t+"\n\nUsed operations ("+i+" in total: "+s+" binary, "+l+" unary):\n    Selection: "+n.selection+"\n    Projection: "+n.projection+"\n    Rename: "+n.rename+"\n\n    Set Operations: "+n.setOperation+"\n\n    Natural join: "+n.natural+"\n    Cartesian product: "+n.cartesian+"\n    Semijoin: "+n.semijoin+"\n    Antijoin: "+n.antijoin+"\n    Theta Join: "+n.thetaJoin+"\n    Theta Semijoin: "+n.thetaSemijoin+"\n\n    Outer Join: "+n.outerJoin+"\n\n    Division: "+n.division+"\n\n"+(r?"Null values ALLOWED.\n\n":"Null values FORBIDDEN.\n\n")},on.formatRelations=function(e){var t=e.map((function(e){return e.name+"("+e.columnNames.join(", ")+")\n"})).join("");return sn+"\n\nTABLES ("+e.length+")\n\n"+t+"\n"+e.map((function(e){return ln+"\n"+e.name+"\n\n"+Ht.format(e)})).join("")};var sn="################################################################################",ln="--------------------------------------------------------------------------------";function un(){return cn()}function cn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{antijoin:t.reduce((function(e,t){return e+t.antijoin}),0),cartesian:t.reduce((function(e,t){return e+t.cartesian}),0),division:t.reduce((function(e,t){return e+t.division}),0),natural:t.reduce((function(e,t){return e+t.natural}),0),outerJoin:t.reduce((function(e,t){return e+t.outerJoin}),0),projection:t.reduce((function(e,t){return e+t.projection}),0),rename:t.reduce((function(e,t){return e+t.rename}),0),selection:t.reduce((function(e,t){return e+t.selection}),0),semijoin:t.reduce((function(e,t){return e+t.semijoin}),0),setOperation:t.reduce((function(e,t){return e+t.setOperation}),0),thetaJoin:t.reduce((function(e,t){return e+t.thetaJoin}),0),thetaSemijoin:t.reduce((function(e,t){return e+t.thetaSemijoin}),0)}}function pn(e){return e.antijoin+e.cartesian+e.division+e.natural+e.outerJoin+e.semijoin+e.setOperation+e.thetaJoin+e.thetaSemijoin}function hn(e){return e.projection+e.rename+e.selection}function fn(e){return e instanceof ue?cn(function(e){var t=un();if(e instanceof pe)return t.projection=1,t;if(e instanceof ye)return t.rename=1,t;if(e instanceof Ge)return t.selection=1,t;return t}(e),fn(e.getSubtree())):e instanceof Fe?cn(function(e){var t=un();if(e instanceof Qe)return t.antijoin=1,t;if(e instanceof Xe)return t.cartesian=1,t;if(e instanceof Ye)return t.division=1,t;if(e instanceof tt)return t.outerJoin=1,t;if(e instanceof rt)return e.getType()===et.natural?t.natural=1:t.semijoin=1,t;if(e instanceof ot)return t.setOperation=1,t;if(e instanceof st)return e.getType()===at.full?t.thetaJoin=1:t.thetaSemijoin=1,t;return t}(e),fn(e.getLeftSubtree()),fn(e.getRightSubtree())):un()}n(63);var dn=getComputedStyle(document.querySelector(":root")),mn=Number(dn.getPropertyValue("--cell-padding-sides-num")),vn=Number(dn.getPropertyValue("--input-margin-sides-num")),gn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).containerRef=void 0,r.tableHeadRowRef=void 0,r.columnWidths=[],r.handleInputResize=function(e,t){e.scrollWidth>r.columnWidths[t]&&(r.columnWidths[t]=e.scrollWidth)},r.getErrors=function(){return r.props.relation.getErrors()},r.setSelectedInput=function(e,t){r.setState({selectedColumn:e,selectedRow:t})},r.moveSelectedInputRight=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e<r.props.relation.getColumnCount()-1&&r.setState({selectedColumn:e+1})},r.moveSelectedInputLeft=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&e>0&&r.setState({selectedColumn:e-1})},r.moveSelectedInputUp=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&"number"===typeof t&&(0===t?r.setState({selectedRow:"names"}):r.setState({selectedRow:t-1}))},r.moveSelectedInputDown=function(){var e=r.state.selectedColumn,t=r.state.selectedRow;void 0!==e&&void 0!==t&&("names"===t&&r.props.relation.getRowCount()>0&&r.setState({selectedRow:0}),"number"===typeof t&&t<r.props.relation.getRowCount()-1&&r.setState({selectedRow:t+1}))},r.handleKeyDown=function(e){"Enter"===e.key||"Esc"===e.key||"Escape"===e.key?r.setSelectedInput(void 0,void 0):"Tab"===e.key||e.ctrlKey&&"ArrowRight"===e.key?(r.moveSelectedInputRight(),e.preventDefault()):e.ctrlKey&&"ArrowLeft"===e.key?(r.moveSelectedInputLeft(),e.preventDefault()):e.ctrlKey&&"ArrowUp"===e.key?(r.moveSelectedInputUp(),e.preventDefault()):e.ctrlKey&&"ArrowDown"===e.key&&(r.moveSelectedInputDown(),e.preventDefault()),e.ctrlKey&&r.props.onCtrlInput(e)},r.handleChange=function(e,t,n){e=e.replace(/\t/g,"    "),"names"===n?r.props.onColumnNameChange(e,t):"types"===n?r.props.onColumnTypeChange(e,t):r.props.onRowInputChange(e,t,n)},r.handleNewColumn=function(){r.props.onNewColumn((function(){r.containerRef.current.scrollTo(r.containerRef.current.clientWidth,r.containerRef.current.scrollTop)}))},r.handleNewRow=function(){r.props.onNewRow((function(){r.containerRef.current.scrollTo(r.containerRef.current.scrollLeft,r.containerRef.current.clientHeight)}))},r.handleDeleteColumn=function(e){r.props.onDeleteColumn(e)},r.handleDeleteRow=function(e){r.props.onDeleteRow(e)},r.createInput=function(e,t,n){return a.a.createElement("input",{type:"text",className:"text-input",spellCheck:!1,value:e,onChange:function(e){r.handleChange(e.target.value,t,n),r.handleInputResize(e.target,t)},autoFocus:!0,style:{width:r.columnWidths[t]+"px"}})},r.createDeleteButton=function(e){return a.a.createElement("button",{className:"delete-row-or-column-button",onClick:e},"\u2716")},r.state={selectedColumn:void 0,selectedRow:void 0},r.containerRef=a.a.createRef(),r.tableHeadRowRef=a.a.createRef(),r}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(){e.setSelectedInput(void 0,void 0)})),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e=this.tableHeadRowRef.current;if(null!==e){var t=Object(u.a)(e.cells).slice(1,-1);this.columnWidths=t.map((function(e){return e.clientWidth-2*(mn+vn)}))}}},{key:"createTooltip",value:function(e,t){return a.a.createElement("span",{className:"tooltip",style:t},e)}},{key:"createNamesRow",value:function(){var e=this,t=this.props.relation.getColumnNames().map((function(t,n){var r=t;e.state.selectedColumn===n&&"names"===e.state.selectedRow&&(r=e.createInput(t,n,"names"));var o=null,i="name-th",s=e.getErrors().get("name",n);return void 0!==s&&(o=e.createTooltip(s,{top:"90%",bottom:"auto"}),i+=" error-input"),a.a.createElement("th",{key:n,className:i,onClick:function(t){e.setSelectedInput(n,"names"),t.stopPropagation()}},r,o)}));return t.push(a.a.createElement("td",{key:"add-column",rowSpan:2,style:{width:"24px",border:"none",padding:"1px"}},a.a.createElement("button",{onClick:this.handleNewColumn,style:{width:"100%",height:"100%"}},a.a.createElement("strong",null,"+")))),a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createTypesRow",value:function(){var e=this,t=this.props.relation.getColumnTypes().map((function(t,n){var r=a.a.createElement("select",{value:t,onChange:function(t){return e.handleChange(t.target.value,n,"types")}},a.a.createElement("option",null,"number"),a.a.createElement("option",null,"string"),a.a.createElement("option",null,"boolean"));return a.a.createElement("th",{key:n,className:"type-th"},r,e.createDeleteButton((function(){return e.handleDeleteColumn(n)})))}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("td",{className:"row-number-td"}),t)}},{key:"createRows",value:function(){var e=this;return 0===this.props.relation.getRows().length?null:this.props.relation.getRows().map((function(t,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",{className:"row-number-td"},n+1,e.createDeleteButton((function(){return e.handleDeleteRow(n)}))),t.map((function(t,r){var o=t;e.state.selectedColumn===r&&e.state.selectedRow===n&&(o=e.createInput(t,r,n));var i=null,s="",l=e.getErrors().get(n,r);return void 0!==l&&(i=e.createTooltip(l),s="error-input"),a.a.createElement("td",{key:r,className:s,onClick:function(t){e.setSelectedInput(r,n),t.stopPropagation()}},o,i)})))}))}},{key:"createAddRow",value:function(){return a.a.createElement("tr",{key:"add-row"},a.a.createElement("td",{key:"add-row-column",className:"add-row-td"},a.a.createElement("button",{onClick:this.handleNewRow},a.a.createElement("strong",null,"+"))))}},{key:"render",value:function(){return a.a.createElement("div",{className:"edit-table-container scrollbar-container",ref:this.containerRef,onKeyDown:this.handleKeyDown},a.a.createElement("table",{className:"edit-table"},a.a.createElement("thead",null,a.a.createElement("tr",{ref:this.tableHeadRowRef},this.createNamesRow()),a.a.createElement("tr",null,this.createTypesRow())),a.a.createElement("tbody",null,this.createRows(),this.createAddRow())))}}]),n}(a.a.Component),yn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).getCurRel=function(){return r.props.storedRelations[r.props.storedRelationIndex]},r.handleRelationNameChange=function(e){r.props.onRelationNameChange(e)},r.loadRelation=function(){r.getCurRel().isValid()?r.props.onLoadRelation(ft.message):ft.error("Cannot use the invalid relation. Check errors and try again.")},r.loadAllRelations=function(){r.props.onLoadAllRelations(ft.message)},r.exportRelations=function(){r.props.onExportRelations(ft.message)},r.importRelations=function(){r.props.onImportRelations(ft.message)},r.deleteRelation=function(){r.props.onDeleteStoredRelation()},r.revertRelation=function(){r.props.onRevertRelation()},r.newRelation=function(){r.props.onNewRelation()},r.removeLoadedRelations=function(){r.props.onRemoveLoadedRelations(ft.message)},r.handleCtrlInput=function(e){"Enter"===e.key&&r.loadRelation()},r.createRelationMenuButtons=function(){return r.props.storedRelations.map((function(e,t){var n=r.props.storedRelationIndex===t?"button-clicked":"",o=e.isActual()?"":"*",i=e.isValid()?{}:{border:"2px solid #fd3030"};return a.a.createElement("button",{key:t,onClick:function(){return r.handleSelectDifferentRelation(t)},className:n,style:i},o+e.getName())}))},r.state={sectionClicked:!1},r}return Object(p.a)(n,[{key:"handleSelectDifferentRelation",value:function(e){this.props.onSelectDifferentRelation(e)}},{key:"render",value:function(){var e=this,t=this.props.language.relationSection,n=function(e,t,n,r){return a.a.createElement(m,{key:e,text:e,onClick:t,style:r,tooltip:n})},r=this.props.storedRelations.filter((function(t,n){return n!==e.props.storedRelationIndex})).map((function(e){return e.getName()}));return a.a.createElement("section",{className:"page-section"},a.a.createElement("header",null,a.a.createElement("h2",null,t.relationSectionHeader),n(t.loadAllButton,this.loadAllRelations,t.loadAllButtonTooltip),n(t.removeLoadedButton,this.removeLoadedRelations,t.removeLoadedButtonTooltip),n(t.importButton,this.importRelations,t.importButtonTooltip),n(t.exportButton,this.exportRelations,t.exportButtonTooltip)),a.a.createElement("menu",{className:"page-section-tab-menu"},this.createRelationMenuButtons(),a.a.createElement("button",{onClick:this.newRelation,style:{minWidth:"0",marginLeft:"10px",padding:"2px 6px 1px 6px"}},a.a.createElement("strong",null,"+"))),a.a.createElement(gn,{relation:this.getCurRel(),onColumnNameChange:this.props.onColumnNameChange,onColumnTypeChange:this.props.onColumnTypeChange,onRowInputChange:this.props.onRowInputChange,onNewRow:this.props.onNewRow,onNewColumn:this.props.onNewColumn,onDeleteRow:this.props.onDeleteRow,onDeleteColumn:this.props.onDeleteColumn,onCtrlInput:this.handleCtrlInput}),a.a.createElement("menu",{className:"page-section-management-menu"},a.a.createElement(m,{text:t.loadButton,onClick:this.loadRelation,className:"action-button",style:{marginRight:"40px"},tooltip:t.loadButtonTooltip}),a.a.createElement(ct,{value:this.getCurRel().getName(),buttonText:t.renameButton,onSubmit:this.handleRelationNameChange,forbidden:function(e){return r.indexOf(e)>-1||(!ae.isName(e)||(t=e,de.indexOf(t.toString())>-1));var t},id:"relation-name-input"}),n(t.deleteButton,this.deleteRelation,t.deleteButtonTooltip),n(t.revertButton,this.revertRelation,t.revertButtonTooltip+" ("+this.getCurRel().getRevertName()+")")))}}]),n}(a.a.Component),bn=function(){function e(t){Object(c.a)(this,e),this.accessToken=t}return Object(p.a)(e,[{key:"send",value:function(t,n){var r={access_token:this.accessToken,subject:t,text:n},a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status||4===a.readyState&&console.log("failed creating XMLHttpRequest in Mail.send: "+a.response)};var o=e.toParams(r);a.open("POST","https://postmail.invotes.com/send",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(o)}}],[{key:"toParams",value:function(e){return encodeURIComponent("access_token")+"="+encodeURIComponent(e.access_token)+"&"+encodeURIComponent("subject")+"="+encodeURIComponent(e.subject)+"&"+encodeURIComponent("text")+"="+encodeURIComponent(e.text)}}]),e}(),En=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).expressionSectionRef=void 0,r.reportUnexpectedError=function(e){var t,n=new bn("5uog26ex8q9qu7sqib8ea0qd"),a="Unexpected error "+e.name+" in Rachel application.\n\nMessage:\n"+e.message+"\n\nDate:\n"+(new Date).toString()+"\n\nStack trace:\n"+e.stack+"\n\nLoaded relations: ----------------------------\n"+Object(u.a)(r.state.loadedRelations.values()).map((function(e){return e.getName()+"\n"+e.contentString()})).join("\n\n")+"\n\nStored relations: ----------------------------\nSelected relation (1-index): "+(r.state.selectedRelation+1)+"\n\n"+r.state.storedRelations.map((function(e){return Ht.format(e)})).join("\n\n")+"\n\nExpressions: ----------------------------\nSelected expression (1-index): "+(r.state.selectedExpression+1)+"\n\n"+r.state.expressions.map((function(e){return e.text})).join("\n\n###\n\n")+"\n\nEvaluation tree:\n"+(null===(t=r.state.evaluationTreeRoot)||void 0===t?void 0:t.printInLine())+"\n\nOther state: ----------------------------\ncsvValueSeparator: "+r.state.csvValueSeparator+"\nlanguage:          "+r.state.language+"\nnullValuesSupport: "+r.state.nullValuesSupport+"\ndarkTheme:         "+r.state.darkTheme;n.send("Rachel application unexpected error",a),console.error("Unexpected error: "+e.stack)},r.loadProject=function(e){r.setState({loadedRelations:new Map,storedRelations:e.relations.map((function(t){return Ht.fromData(t,e.nullValuesSupport)})),selectedRelation:0,expressions:e.expressions,nullValuesSupport:e.nullValuesSupport,selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:""},(function(){console.log("Project loaded."),r.updateExpressionsErrors()}))},r.ensureUniqueRelationName=function(e){if(r.state.storedRelations.map((function(e){return e.getName()})).indexOf(e)>-1)for(var t=2;;++t)if(-1===r.state.storedRelations.map((function(e){return e.getName()})).indexOf(e+t)){e+=t;break}return e},r.handleBatch=function(){on.process("rachel-eval-results")},r.handleLoadProject=function(){an.load().then(r.loadProject).catch(console.warn)},r.handleSaveProject=function(){try{an.save({relations:r.state.storedRelations.map((function(e){return e.toDataObject()})),expressions:r.state.expressions,nullValuesSupport:r.state.nullValuesSupport},"project"),console.log("Project saved.")}catch(e){console.warn("Project saving failed: "+e.message)}},r.handleLoadSampleProject=function(e){r.loadProject(rn(e))},r.handleNullValuesSupportChange=function(e){r.state.storedRelations.forEach((function(t){return t.setNullValuesSupport(e)})),r.setState({nullValuesSupport:e},r.updateExpressionsErrors)},r.handleCsvValueSeparatorChange=function(e){k.setCsvValueSeparator(e),r.setState({csvValueSeparator:e})},r.handleLanguageChange=function(e){k.setLanguage(e),r.state.storedRelations.forEach((function(e){return e.recomputeErrors()})),r.setState({language:C()})},r.handleDarkModeChange=function(e){k.setDarkMode(e),r.setState({darkTheme:e}),document.body.classList.toggle("body-dark",e),document.body.classList.toggle("body-light",!e)},r.handleRelationNameChange=function(e){r.setState((function(t){var n=t.storedRelations;return n[r.state.selectedRelation].setName(e),{storedRelations:n}}))},r.handleRelationColumnNameChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnName(e,t),{storedRelations:a}}))},r.handleRelationColumnTypeChange=function(e,t){r.setState((function(n){var a=n.storedRelations;return a[r.state.selectedRelation].setColumnType(e,t),{storedRelations:a}}))},r.handleRelationRowInputChange=function(e,t,n){r.setState((function(a){var o=a.storedRelations;return o[r.state.selectedRelation].setRowInput(e,n,t),{storedRelations:o}}))},r.handleRelationNewRow=function(e){r.state.storedRelations[r.state.selectedRelation].addNewRow(),r.setState({},e)},r.handleRelationNewColumn=function(e){r.state.storedRelations[r.state.selectedRelation].addNewColumn(),r.setState({},e)},r.handleRelationDeleteRow=function(e){r.state.storedRelations[r.state.selectedRelation].deleteRow(e),r.setState({})},r.handleRelationDeleteColumn=function(e){r.state.storedRelations[r.state.selectedRelation].deleteColumn(e),r.setState({})},r.handleSelectDifferentRelation=function(e){r.setState({selectedRelation:e})},r.handleCreateNewRelation=function(){var e=r.state.selectedRelation+1,t=r.ensureUniqueRelationName("NewRelation");r.state.storedRelations.splice(e,0,Ht.new(t,r.state.nullValuesSupport)),r.setState({selectedRelation:e})},r.handleDeleteRelation=function(){if(1!==r.state.storedRelations.length){var e=r.state.selectedRelation;r.state.storedRelations.splice(e,1),e===r.state.storedRelations.length?r.setState({selectedRelation:e-1},r.updateExpressionsErrors):r.setState({},r.updateExpressionsErrors)}else r.setState({storedRelations:[Ht.new("Relation",r.state.nullValuesSupport)]})},r.handleRevertRelation=function(){r.setState((function(e){var t=e.storedRelations;return t[r.state.selectedRelation].revert(),{storedRelations:t}}))},r.handleRemoveLoadedRelations=function(e){var t=r.state.language.userMessages,n=r.state.loadedRelations.size;r.state.loadedRelations.clear(),r.state.storedRelations.forEach((function(e){return e.setActual(!1)})),e(n+t.deleteLoadedRelations),r.setState({},r.updateExpressionsErrors)},r.handleExportRelations=function(e){var t=r.state.language.userMessages;try{Qt.save(r.state.storedRelations,"relations",r.state.csvValueSeparator),e(r.state.storedRelations.length+t.relationsExportOK)}catch(n){e(t.relationsExportErr+n)}},r.handleImportRelations=function(e){var t=r.state.language.userMessages;Qt.load(r.state.nullValuesSupport).then((function(n){var a=r.state.storedRelations.length;n.relations.forEach((function(e){var t=r.ensureUniqueRelationName(e.getName());e.setName(t),r.state.storedRelations.push(e)})),n.relations.length>0&&r.setState({selectedRelation:a}),e(n.relations.length+t.relationsImport[0]+n.skipped+t.relationsImport[1])}))},r.handleLoadRelation=function(e){var t=r.state.language.userMessages,n=r.state.storedRelations[r.state.selectedRelation];n.setActual(!0),r.state.loadedRelations.set(n.getName(),n.createRelation());var a=0===r.state.loadedRelations.size?t.loadedRelationsTotalNo:r.state.loadedRelations.size+t.loadedRelationsTotalSome+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+".";e(t.loadRelationNew+"\n"+a),r.setState({},r.updateExpressionsErrors)},r.handleLoadAllRelations=function(e){var t=r.state.language.userMessages,n=0,a=0;r.state.storedRelations.forEach((function(e){e.isValid()?(e.setActual(!0),r.state.loadedRelations.set(e.getName(),e.createRelation()),++n):++a}));var o=0===r.state.loadedRelations.size?t.loadedRelationsTotalNo:r.state.loadedRelations.size+t.loadedRelationsTotalSome+Object(u.a)(r.state.loadedRelations.keys()).join(", ")+".";e(n+t.loadAllRelationsNew[0]+a+t.loadAllRelationsNew[1]+"\n"+o),r.setState({},r.updateExpressionsErrors)},r.updateExpressionsErrors=function(){var e=r.expressionSectionRef.current;null!==e&&e.updateErrorsAndParentheses()},r.handleExprEval=function(e){r.setState({evaluationTreeRoot:e,evaluatedExpressionName:r.state.expressions[r.state.selectedExpression].name})},r.handleExprTextChange=function(e,t){r.setState((function(n){var r=n.expressions;return r[n.selectedExpression]={name:e,text:t},{expressions:r}}))},r.handleSelectDifferentExpression=function(e){r.setState({selectedExpression:e},r.updateExpressionsErrors)},r.handleCreateNewExpression=function(){var e=r.state.selectedExpression+1;r.state.expressions.splice(e,0,{name:"New expression",text:""}),r.setState({selectedExpression:e})},r.handleDeleteExpression=function(e){if(1===r.state.expressions.length)return r.handleExprTextChange("Expression 1","");var t=r.state.selectedExpression;r.state.expressions.splice(t,1),t===r.state.expressions.length?r.setState({selectedExpression:t-1},e):r.setState({},e)},r.handleExportExpressions=function(e){var t=r.state.language.userMessages;try{$t.save(r.state.expressions,"expressions"),e(t.expressionsExportOK)}catch(n){e(t.expressionsExportErr+n.message)}},r.handleImportExpressions=function(e){var t=r.state.language.userMessages;$t.load().then((function(n){var a;(a=r.state.expressions).push.apply(a,Object(u.a)(n.expressions)),r.setState({}),e(n.expressions.length+t.expressionsImport[0]+n.loadedFiles+t.expressionsImport[1]+ +n.skippedExpressions+t.expressionsImport[2]+n.skippedFiles+t.expressionsImport[3])}))},r.addResultRelation=function(e){var t=r.ensureUniqueRelationName("Evaluated"),n=Ht.fromRelation(t,e,r.state.nullValuesSupport);r.state.storedRelations.push(n),r.setState({selectedRelation:r.state.storedRelations.length-1})},document.body.classList.toggle("body-dark",k.getDarkMode()),document.body.classList.toggle("body-light",!k.getDarkMode());return r.state={samples:en(),loadedRelations:new Map,storedRelations:[Ht.fromData({name:"Relation",columnNames:["Column1","Column2","Column3"],columnTypes:["number","string","boolean"],rows:[["","",""]],columnCount:3,rowCount:1},!0)],selectedRelation:0,expressions:[{name:"Expression 1",text:""}],selectedExpression:0,evaluationTreeRoot:null,evaluatedExpressionName:"",nullValuesSupport:!0,csvValueSeparator:k.getCsvValueSeparator(),language:C(),darkTheme:k.getDarkMode()},r.expressionSectionRef=a.a.createRef(),r}return Object(p.a)(n,[{key:"render",value:function(){var e=null;return null!==this.state.evaluationTreeRoot&&(e=a.a.createElement(Xt,{evaluationTreeRoot:this.state.evaluationTreeRoot,expressionName:this.state.evaluatedExpressionName,onAddResult:this.addResultRelation,onUnexpectedError:this.reportUnexpectedError,csvValueSeparator:this.state.csvValueSeparator,darkTheme:this.state.darkTheme,language:this.state.language})),a.a.createElement("main",null,a.a.createElement(tn,{onBatch:this.handleBatch,onLoadProject:this.handleLoadProject,onSaveProject:this.handleSaveProject,onLoadSample:this.handleLoadSampleProject,csvValueSeparator:this.state.csvValueSeparator,language:this.state.language,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,onCsvValueSeparatorChange:this.handleCsvValueSeparatorChange,onLanguageChange:this.handleLanguageChange,onNullValuesSupportChange:this.handleNullValuesSupportChange,onDarkModeChange:this.handleDarkModeChange}),a.a.createElement(yn,{storedRelations:this.state.storedRelations,storedRelationIndex:this.state.selectedRelation,loadedRelations:Object(u.a)(this.state.loadedRelations.values()),onRelationNameChange:this.handleRelationNameChange,onColumnNameChange:this.handleRelationColumnNameChange,onColumnTypeChange:this.handleRelationColumnTypeChange,onRowInputChange:this.handleRelationRowInputChange,onNewRow:this.handleRelationNewRow,onNewColumn:this.handleRelationNewColumn,onDeleteRow:this.handleRelationDeleteRow,onDeleteColumn:this.handleRelationDeleteColumn,onSelectDifferentRelation:this.handleSelectDifferentRelation,onNewRelation:this.handleCreateNewRelation,onLoadRelation:this.handleLoadRelation,onDeleteStoredRelation:this.handleDeleteRelation,onRevertRelation:this.handleRevertRelation,onLoadAllRelations:this.handleLoadAllRelations,onRemoveLoadedRelations:this.handleRemoveLoadedRelations,onExportRelations:this.handleExportRelations,onImportRelations:this.handleImportRelations,nullValuesSupport:this.state.nullValuesSupport,language:this.state.language}),a.a.createElement(dt,{ref:this.expressionSectionRef,expressions:this.state.expressions,currentExpressionIndex:this.state.selectedExpression,relations:this.state.loadedRelations,onChange:this.handleExprTextChange,onEval:this.handleExprEval,onSelectDifferentExpression:this.handleSelectDifferentExpression,onNewExpression:this.handleCreateNewExpression,onDeleteExpression:this.handleDeleteExpression,onExportExpressions:this.handleExportExpressions,onImportExpressions:this.handleImportExpressions,onUnexpectedError:this.reportUnexpectedError,nullValuesSupport:this.state.nullValuesSupport,darkTheme:this.state.darkTheme,language:this.state.language}),e)}}]),n}(r.Component);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(En,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rachel",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rachel","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}()}},[[64,1,2]]]);
//# sourceMappingURL=main.70e570dd.chunk.js.map